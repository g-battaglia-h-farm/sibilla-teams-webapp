import{g as ne,c as w,a as rE}from"./react.js";var mg=typeof window<"u"?window:self,iT=mg.crypto||mg.msCrypto,oT=function(t){if(!t)return Math.random;var e=Math.pow(2,32),r=new Uint32Array(1);return function(){return t.getRandomValues(r)[0]/e}}(iT);const sT=ne(oT);var Yn=function(t){return t&&t.Math===Math&&t},he=Yn(typeof globalThis=="object"&&globalThis)||Yn(typeof window=="object"&&window)||Yn(typeof self=="object"&&self)||Yn(typeof w=="object"&&w)||Yn(typeof w=="object"&&w)||function(){return this}()||Function("return this")(),ce=function(t){try{return!!t()}catch{return!0}},aT=ce,fa=!aT(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),cT=fa,nE=Function.prototype,Sg=nE.apply,bg=nE.call,$u=typeof Reflect=="object"&&Reflect.apply||(cT?bg.bind(Sg):function(){return bg.apply(Sg,arguments)}),iE=fa,oE=Function.prototype,Av=oE.call,uT=iE&&oE.bind.bind(Av,Av),ue=iE?uT:function(t){return function(){return Av.apply(t,arguments)}},sE=ue,pT=sE({}.toString),fT=sE("".slice),fr=function(t){return fT(pT(t),8,-1)},lT=fr,vT=ue,aE=function(t){if(lT(t)==="Function")return vT(t)},Rp=typeof document=="object"&&document.all,Ie=typeof Rp>"u"&&Rp!==void 0?function(t){return typeof t=="function"||t===Rp}:function(t){return typeof t=="function"},la={},hT=ce,Le=!hT(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),dT=fa,ic=Function.prototype.call,Ue=dT?ic.bind(ic):function(){return ic.apply(ic,arguments)},Eh={},cE={}.propertyIsEnumerable,uE=Object.getOwnPropertyDescriptor,gT=uE&&!cE.call({1:2},1);Eh.f=gT?function(e){var r=uE(this,e);return!!r&&r.enumerable}:cE;var Kr=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},yT=ue,mT=ce,ST=fr,Ep=Object,bT=yT("".split),pE=mT(function(){return!Ep("z").propertyIsEnumerable(0)})?function(t){return ST(t)==="String"?bT(t,""):Ep(t)}:Ep,Gr=function(t){return t==null},CT=Gr,PT=TypeError,va=function(t){if(CT(t))throw new PT("Can't call method on "+t);return t},wT=pE,RT=va,Qt=function(t){return wT(RT(t))},ET=Ie,Ee=function(t){return typeof t=="object"?t!==null:ET(t)},Te={},Op=Te,_p=he,OT=Ie,Cg=function(t){return OT(t)?t:void 0},Ve=function(t,e){return arguments.length<2?Cg(Op[t])||Cg(_p[t]):Op[t]&&Op[t][e]||_p[t]&&_p[t][e]},_T=ue,Jr=_T({}.isPrototypeOf),AT=he,Pg=AT.navigator,wg=Pg&&Pg.userAgent,ha=wg?String(wg):"",fE=he,Ap=ha,Rg=fE.process,Eg=fE.Deno,Og=Rg&&Rg.versions||Eg&&Eg.version,_g=Og&&Og.v8,bt,uu;_g&&(bt=_g.split("."),uu=bt[0]>0&&bt[0]<4?1:+(bt[0]+bt[1]));!uu&&Ap&&(bt=Ap.match(/Edge\/(\d+)/),(!bt||bt[1]>=74)&&(bt=Ap.match(/Chrome\/(\d+)/),bt&&(uu=+bt[1])));var ku=uu,Ag=ku,IT=ce,TT=he,MT=TT.String,Mn=!!Object.getOwnPropertySymbols&&!IT(function(){var t=Symbol("symbol detection");return!MT(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Ag&&Ag<41}),DT=Mn,lE=DT&&!Symbol.sham&&typeof Symbol.iterator=="symbol",$T=Ve,kT=Ie,xT=Jr,jT=lE,zT=Object,da=jT?function(t){return typeof t=="symbol"}:function(t){var e=$T("Symbol");return kT(e)&&xT(e.prototype,zT(t))},NT=String,ga=function(t){try{return NT(t)}catch{return"Object"}},LT=Ie,BT=ga,qT=TypeError,vt=function(t){if(LT(t))return t;throw new qT(BT(t)+" is not a function")},FT=vt,UT=Gr,Oh=function(t,e){var r=t[e];return UT(r)?void 0:FT(r)},Ip=Ue,Tp=Ie,Mp=Ee,VT=TypeError,WT=function(t,e){var r,n;if(e==="string"&&Tp(r=t.toString)&&!Mp(n=Ip(r,t))||Tp(r=t.valueOf)&&!Mp(n=Ip(r,t))||e!=="string"&&Tp(r=t.toString)&&!Mp(n=Ip(r,t)))return n;throw new VT("Can't convert object to primitive value")},vE={exports:{}},hE=!0,Ig=he,HT=Object.defineProperty,KT=function(t,e){try{HT(Ig,t,{value:e,configurable:!0,writable:!0})}catch{Ig[t]=e}return e},GT=he,JT=KT,Tg="__core-js_shared__",Mg=vE.exports=GT[Tg]||JT(Tg,{});(Mg.versions||(Mg.versions=[])).push({version:"3.38.1",mode:"pure",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"});var _h=vE.exports,Dg=_h,Dn=function(t,e){return Dg[t]||(Dg[t]=e||{})},QT=va,YT=Object,lr=function(t){return YT(QT(t))},XT=ue,ZT=lr,e1=XT({}.hasOwnProperty),Be=Object.hasOwn||function(e,r){return e1(ZT(e),r)},t1=ue,r1=0,n1=Math.random(),i1=t1(1 .toString),xu=function(t){return"Symbol("+(t===void 0?"":t)+")_"+i1(++r1+n1,36)},o1=he,s1=Dn,$g=Be,a1=xu,c1=Mn,u1=lE,yn=o1.Symbol,Dp=s1("wks"),p1=u1?yn.for||yn:yn&&yn.withoutSetter||a1,Ce=function(t){return $g(Dp,t)||(Dp[t]=c1&&$g(yn,t)?yn[t]:p1("Symbol."+t)),Dp[t]},f1=Ue,kg=Ee,xg=da,l1=Oh,v1=WT,h1=Ce,d1=TypeError,g1=h1("toPrimitive"),y1=function(t,e){if(!kg(t)||xg(t))return t;var r=l1(t,g1),n;if(r){if(e===void 0&&(e="default"),n=f1(r,t,e),!kg(n)||xg(n))return n;throw new d1("Can't convert object to primitive value")}return e===void 0&&(e="number"),v1(t,e)},m1=y1,S1=da,Ah=function(t){var e=m1(t,"string");return S1(e)?e:e+""},b1=he,jg=Ee,Iv=b1.document,C1=jg(Iv)&&jg(Iv.createElement),Ih=function(t){return C1?Iv.createElement(t):{}},P1=Le,w1=ce,R1=Ih,dE=!P1&&!w1(function(){return Object.defineProperty(R1("div"),"a",{get:function(){return 7}}).a!==7}),E1=Le,O1=Ue,_1=Eh,A1=Kr,I1=Qt,T1=Ah,M1=Be,D1=dE,zg=Object.getOwnPropertyDescriptor;la.f=E1?zg:function(e,r){if(e=I1(e),r=T1(r),D1)try{return zg(e,r)}catch{}if(M1(e,r))return A1(!O1(_1.f,e,r),e[r])};var $1=ce,k1=Ie,x1=/#|\.prototype\./,ya=function(t,e){var r=z1[j1(t)];return r===L1?!0:r===N1?!1:k1(e)?$1(e):!!e},j1=ya.normalize=function(t){return String(t).replace(x1,".").toLowerCase()},z1=ya.data={},N1=ya.NATIVE="N",L1=ya.POLYFILL="P",gE=ya,Ng=aE,B1=vt,q1=fa,F1=Ng(Ng.bind),Qr=function(t,e){return B1(t),e===void 0?t:q1?F1(t,e):function(){return t.apply(e,arguments)}},Ze={},U1=Le,V1=ce,yE=U1&&V1(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),W1=Ee,H1=String,K1=TypeError,ct=function(t){if(W1(t))return t;throw new K1(H1(t)+" is not an object")},G1=Le,J1=dE,Q1=yE,oc=ct,Lg=Ah,Y1=TypeError,$p=Object.defineProperty,X1=Object.getOwnPropertyDescriptor,kp="enumerable",xp="configurable",jp="writable";Ze.f=G1?Q1?function(e,r,n){if(oc(e),r=Lg(r),oc(n),typeof e=="function"&&r==="prototype"&&"value"in n&&jp in n&&!n[jp]){var i=X1(e,r);i&&i[jp]&&(e[r]=n.value,n={configurable:xp in n?n[xp]:i[xp],enumerable:kp in n?n[kp]:i[kp],writable:!1})}return $p(e,r,n)}:$p:function(e,r,n){if(oc(e),r=Lg(r),oc(n),J1)try{return $p(e,r,n)}catch{}if("get"in n||"set"in n)throw new Y1("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var Z1=Le,eM=Ze,tM=Kr,vr=Z1?function(t,e,r){return eM.f(t,e,tM(1,r))}:function(t,e,r){return t[e]=r,t},Xn=he,rM=$u,nM=aE,iM=Ie,oM=la.f,sM=gE,an=Te,aM=Qr,cn=vr,Bg=Be,cM=function(t){var e=function(r,n,i){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,n)}return new t(r,n,i)}return rM(t,this,arguments)};return e.prototype=t.prototype,e},Y=function(t,e){var r=t.target,n=t.global,i=t.stat,l=t.proto,f=n?Xn:i?Xn[r]:Xn[r]&&Xn[r].prototype,c=n?an:an[r]||cn(an,r,{})[r],o=c.prototype,s,a,u,p,v,g,h,d,y;for(p in e)s=sM(n?p:r+(i?".":"#")+p,t.forced),a=!s&&f&&Bg(f,p),g=c[p],a&&(t.dontCallGetSet?(y=oM(f,p),h=y&&y.value):h=f[p]),v=a&&h?h:e[p],!(!s&&!l&&typeof g==typeof v)&&(t.bind&&a?d=aM(v,Xn):t.wrap&&a?d=cM(v):l&&iM(v)?d=nM(v):d=v,(t.sham||v&&v.sham||g&&g.sham)&&cn(d,"sham",!0),cn(c,p,d),l&&(u=r+"Prototype",Bg(an,u)||cn(an,u,{}),cn(an[u],p,v),t.real&&o&&(s||!o[p])&&cn(o,p,v)))},uM=Dn,pM=xu,qg=uM("keys"),ju=function(t){return qg[t]||(qg[t]=pM(t))},fM=ce,mE=!fM(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),lM=Be,vM=Ie,hM=lr,dM=ju,gM=mE,Fg=dM("IE_PROTO"),Tv=Object,yM=Tv.prototype,zu=gM?Tv.getPrototypeOf:function(t){var e=hM(t);if(lM(e,Fg))return e[Fg];var r=e.constructor;return vM(r)&&e instanceof r?r.prototype:e instanceof Tv?yM:null},mM=ue,SM=vt,bM=function(t,e,r){try{return mM(SM(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},CM=Ee,PM=function(t){return CM(t)||t===null},wM=PM,RM=String,EM=TypeError,OM=function(t){if(wM(t))return t;throw new EM("Can't set "+RM(t)+" as a prototype")},_M=bM,AM=Ee,IM=va,TM=OM,SE=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=_M(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,l){return IM(i),TM(l),AM(i)&&(t?r(i,l):i.__proto__=l),i}}():void 0),ma={},MM=Math.ceil,DM=Math.floor,$M=Math.trunc||function(e){var r=+e;return(r>0?DM:MM)(r)},kM=$M,Th=function(t){var e=+t;return e!==e||e===0?0:kM(e)},xM=Th,jM=Math.max,zM=Math.min,bE=function(t,e){var r=xM(t);return r<0?jM(r+e,0):zM(r,e)},NM=Th,LM=Math.min,BM=function(t){var e=NM(t);return e>0?LM(e,9007199254740991):0},qM=BM,$n=function(t){return qM(t.length)},FM=Qt,UM=bE,VM=$n,Ug=function(t){return function(e,r,n){var i=FM(e),l=VM(i);if(l===0)return!t&&-1;var f=UM(n,l),c;if(t&&r!==r){for(;l>f;)if(c=i[f++],c!==c)return!0}else for(;l>f;f++)if((t||f in i)&&i[f]===r)return t||f||0;return!t&&-1}},WM={includes:Ug(!0),indexOf:Ug(!1)},Sa={},HM=ue,zp=Be,KM=Qt,GM=WM.indexOf,JM=Sa,Vg=HM([].push),CE=function(t,e){var r=KM(t),n=0,i=[],l;for(l in r)!zp(JM,l)&&zp(r,l)&&Vg(i,l);for(;e.length>n;)zp(r,l=e[n++])&&(~GM(i,l)||Vg(i,l));return i},Mh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],QM=CE,YM=Mh,XM=YM.concat("length","prototype");ma.f=Object.getOwnPropertyNames||function(e){return QM(e,XM)};var Nu={};Nu.f=Object.getOwnPropertySymbols;var ZM=Ve,eD=ue,tD=ma,rD=Nu,nD=ct,iD=eD([].concat),oD=ZM("Reflect","ownKeys")||function(e){var r=tD.f(nD(e)),n=rD.f;return n?iD(r,n(e)):r},Wg=Be,sD=oD,aD=la,cD=Ze,uD=function(t,e,r){for(var n=sD(e),i=cD.f,l=aD.f,f=0;f<n.length;f++){var c=n[f];!Wg(t,c)&&!(r&&Wg(r,c))&&i(t,c,l(e,c))}},Lu={},pD=CE,fD=Mh,Dh=Object.keys||function(e){return pD(e,fD)},lD=Le,vD=yE,hD=Ze,dD=ct,gD=Qt,yD=Dh;Lu.f=lD&&!vD?Object.defineProperties:function(e,r){dD(e);for(var n=gD(r),i=yD(r),l=i.length,f=0,c;l>f;)hD.f(e,c=i[f++],n[c]);return e};var mD=Ve,PE=mD("document","documentElement"),SD=ct,bD=Lu,Hg=Mh,CD=Sa,PD=PE,wD=Ih,RD=ju,Kg=">",Gg="<",Mv="prototype",Dv="script",wE=RD("IE_PROTO"),Np=function(){},RE=function(t){return Gg+Dv+Kg+t+Gg+"/"+Dv+Kg},Jg=function(t){t.write(RE("")),t.close();var e=t.parentWindow.Object;return t=null,e},ED=function(){var t=wD("iframe"),e="java"+Dv+":",r;return t.style.display="none",PD.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(RE("document.F=Object")),r.close(),r.F},sc,Jc=function(){try{sc=new ActiveXObject("htmlfile")}catch{}Jc=typeof document<"u"?document.domain&&sc?Jg(sc):ED():Jg(sc);for(var t=Hg.length;t--;)delete Jc[Mv][Hg[t]];return Jc()};CD[wE]=!0;var Yr=Object.create||function(e,r){var n;return e!==null?(Np[Mv]=SD(e),n=new Np,Np[Mv]=null,n[wE]=e):n=Jc(),r===void 0?n:bD.f(n,r)},OD=Ee,_D=vr,AD=function(t,e){OD(e)&&"cause"in e&&_D(t,"cause",e.cause)},ID=ue,EE=Error,TD=ID("".replace),MD=function(t){return String(new EE(t).stack)}("zxcasd"),OE=/\n\s*at [^:]*:[^\n]*/,DD=OE.test(MD),$D=function(t,e){if(DD&&typeof t=="string"&&!EE.prepareStackTrace)for(;e--;)t=TD(t,OE,"");return t},kD=ce,xD=Kr,jD=!kD(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",xD(1,7)),t.stack!==7):!0}),zD=vr,ND=$D,LD=jD,Qg=Error.captureStackTrace,BD=function(t,e,r,n){LD&&(Qg?Qg(t,e):zD(t,"stack",ND(r,n)))},kn={},qD=Ce,FD=kn,UD=qD("iterator"),VD=Array.prototype,_E=function(t){return t!==void 0&&(FD.Array===t||VD[UD]===t)},WD=Ce,HD=WD("toStringTag"),AE={};AE[HD]="z";var $h=String(AE)==="[object z]",KD=$h,GD=Ie,Qc=fr,JD=Ce,QD=JD("toStringTag"),YD=Object,XD=Qc(function(){return arguments}())==="Arguments",ZD=function(t,e){try{return t[e]}catch{}},Bu=KD?Qc:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=ZD(e=YD(t),QD))=="string"?r:XD?Qc(e):(n=Qc(e))==="Object"&&GD(e.callee)?"Arguments":n},e$=Bu,Yg=Oh,t$=Gr,r$=kn,n$=Ce,i$=n$("iterator"),qu=function(t){if(!t$(t))return Yg(t,i$)||Yg(t,"@@iterator")||r$[e$(t)]},o$=Ue,s$=vt,a$=ct,c$=ga,u$=qu,p$=TypeError,IE=function(t,e){var r=arguments.length<2?u$(t):e;if(s$(r))return a$(o$(r,t));throw new p$(c$(t)+" is not iterable")},f$=Ue,Xg=ct,l$=Oh,TE=function(t,e,r){var n,i;Xg(t);try{if(n=l$(t,"return"),!n){if(e==="throw")throw r;return r}n=f$(n,t)}catch(l){i=!0,n=l}if(e==="throw")throw r;if(i)throw n;return Xg(n),r},v$=Qr,h$=Ue,d$=ct,g$=ga,y$=_E,m$=$n,Zg=Jr,S$=IE,b$=qu,ey=TE,C$=TypeError,Yc=function(t,e){this.stopped=t,this.result=e},ty=Yc.prototype,Yt=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),l=!!(r&&r.IS_RECORD),f=!!(r&&r.IS_ITERATOR),c=!!(r&&r.INTERRUPTED),o=v$(e,n),s,a,u,p,v,g,h,d=function(m){return s&&ey(s,"normal",m),new Yc(!0,m)},y=function(m){return i?(d$(m),c?o(m[0],m[1],d):o(m[0],m[1])):c?o(m,d):o(m)};if(l)s=t.iterator;else if(f)s=t;else{if(a=b$(t),!a)throw new C$(g$(t)+" is not iterable");if(y$(a)){for(u=0,p=m$(t);p>u;u++)if(v=y(t[u]),v&&Zg(ty,v))return v;return new Yc(!1)}s=S$(t,a)}for(g=l?t.next:s.next;!(h=h$(g,s)).done;){try{v=y(h.value)}catch(m){ey(s,"throw",m)}if(typeof v=="object"&&v&&Zg(ty,v))return v}return new Yc(!1)},P$=Bu,w$=String,xn=function(t){if(P$(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return w$(t)},R$=xn,E$=function(t,e){return t===void 0?arguments.length<2?"":e:R$(t)},O$=Y,_$=Jr,A$=zu,pu=SE,I$=uD,ME=Yr,Lp=vr,Bp=Kr,T$=AD,M$=BD,D$=Yt,$$=E$,k$=Ce,x$=k$("toStringTag"),fu=Error,j$=[].push,Rn=function(e,r){var n=_$(qp,this),i;pu?i=pu(new fu,n?A$(this):qp):(i=n?this:ME(qp),Lp(i,x$,"Error")),r!==void 0&&Lp(i,"message",$$(r)),M$(i,Rn,i.stack,1),arguments.length>2&&T$(i,arguments[2]);var l=[];return D$(e,j$,{that:l}),Lp(i,"errors",l),i};pu?pu(Rn,fu):I$(Rn,fu,{name:!0});var qp=Rn.prototype=ME(fu.prototype,{constructor:Bp(1,Rn),message:Bp(1,""),name:Bp(1,"AggregateError")});O$({global:!0,constructor:!0,arity:2},{AggregateError:Rn});var z$=he,N$=Ie,ry=z$.WeakMap,DE=N$(ry)&&/native code/.test(String(ry)),L$=DE,$E=he,B$=Ee,q$=vr,Fp=Be,Up=_h,F$=ju,U$=Sa,ny="Object already initialized",$v=$E.TypeError,V$=$E.WeakMap,lu,na,vu,W$=function(t){return vu(t)?na(t):lu(t,{})},H$=function(t){return function(e){var r;if(!B$(e)||(r=na(e)).type!==t)throw new $v("Incompatible receiver, "+t+" required");return r}};if(L$||Up.state){var It=Up.state||(Up.state=new V$);It.get=It.get,It.has=It.has,It.set=It.set,lu=function(t,e){if(It.has(t))throw new $v(ny);return e.facade=t,It.set(t,e),e},na=function(t){return It.get(t)||{}},vu=function(t){return It.has(t)}}else{var un=F$("state");U$[un]=!0,lu=function(t,e){if(Fp(t,un))throw new $v(ny);return e.facade=t,q$(t,un,e),e},na=function(t){return Fp(t,un)?t[un]:{}},vu=function(t){return Fp(t,un)}}var hr={set:lu,get:na,has:vu,enforce:W$,getterFor:H$},kv=Le,K$=Be,kE=Function.prototype,G$=kv&&Object.getOwnPropertyDescriptor,kh=K$(kE,"name"),J$=kh&&(function(){}).name==="something",Q$=kh&&(!kv||kv&&G$(kE,"name").configurable),Y$={EXISTS:kh,PROPER:J$,CONFIGURABLE:Q$},X$=vr,jn=function(t,e,r,n){return n&&n.enumerable?t[e]=r:X$(t,e,r),t},Z$=ce,ek=Ie,tk=Ee,rk=Yr,iy=zu,nk=jn,ik=Ce,xv=ik("iterator"),xE=!1,Ht,Vp,Wp;[].keys&&(Wp=[].keys(),"next"in Wp?(Vp=iy(iy(Wp)),Vp!==Object.prototype&&(Ht=Vp)):xE=!0);var ok=!tk(Ht)||Z$(function(){var t={};return Ht[xv].call(t)!==t});ok?Ht={}:Ht=rk(Ht);ek(Ht[xv])||nk(Ht,xv,function(){return this});var jE={IteratorPrototype:Ht,BUGGY_SAFARI_ITERATORS:xE},sk=$h,ak=Bu,ck=sk?{}.toString:function(){return"[object "+ak(this)+"]"},uk=$h,pk=Ze.f,fk=vr,lk=Be,vk=ck,hk=Ce,oy=hk("toStringTag"),dr=function(t,e,r,n){var i=r?t:t&&t.prototype;i&&(lk(i,oy)||pk(i,oy,{configurable:!0,value:e}),n&&!uk&&fk(i,"toString",vk))},dk=jE.IteratorPrototype,gk=Yr,yk=Kr,mk=dr,Sk=kn,bk=function(){return this},Ck=function(t,e,r,n){var i=e+" Iterator";return t.prototype=gk(dk,{next:yk(+!n,r)}),mk(t,i,!1,!0),Sk[i]=bk,t},Pk=Y,wk=Ue,zE=Y$,Rk=Ck,Ek=zu,Ok=dr,sy=jn,_k=Ce,ay=kn,NE=jE,Ak=zE.PROPER;zE.CONFIGURABLE;NE.IteratorPrototype;var ac=NE.BUGGY_SAFARI_ITERATORS,Hp=_k("iterator"),cy="keys",cc="values",uy="entries",Ik=function(){return this},xh=function(t,e,r,n,i,l,f){Rk(r,e,n);var c=function(y){if(y===i&&p)return p;if(!ac&&y&&y in a)return a[y];switch(y){case cy:return function(){return new r(this,y)};case cc:return function(){return new r(this,y)};case uy:return function(){return new r(this,y)}}return function(){return new r(this)}},o=e+" Iterator",s=!1,a=t.prototype,u=a[Hp]||a["@@iterator"]||i&&a[i],p=!ac&&u||c(i),v=e==="Array"&&a.entries||u,g,h,d;if(v&&(g=Ek(v.call(new t)),g!==Object.prototype&&g.next&&(Ok(g,o,!0,!0),ay[o]=Ik)),Ak&&i===cc&&u&&u.name!==cc&&(s=!0,p=function(){return wk(u,this)}),i)if(h={values:c(cc),keys:l?p:c(cy),entries:c(uy)},f)for(d in h)(ac||s||!(d in a))&&sy(a,d,h[d]);else Pk({target:e,proto:!0,forced:ac||s},h);return f&&a[Hp]!==p&&sy(a,Hp,p,{name:i}),ay[e]=p,h},jh=function(t,e){return{value:t,done:e}},Tk=Qt,py=kn,LE=hr;Ze.f;var Mk=xh,uc=jh,BE="Array Iterator",Dk=LE.set,$k=LE.getterFor(BE);Mk(Array,"Array",function(t,e){Dk(this,{type:BE,target:Tk(t),index:0,kind:e})},function(){var t=$k(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=null,uc(void 0,!0);switch(t.kind){case"keys":return uc(r,!1);case"values":return uc(e[r],!1)}return uc([r,e[r]],!1)},"values");py.Arguments=py.Array;var Zn=he,kk=ha,xk=fr,pc=function(t){return kk.slice(0,t.length)===t},qE=function(){return pc("Bun/")?"BUN":pc("Cloudflare-Workers")?"CLOUDFLARE":pc("Deno/")?"DENO":pc("Node.js/")?"NODE":Zn.Bun&&typeof Bun.version=="string"?"BUN":Zn.Deno&&typeof Deno.version=="object"?"DENO":xk(Zn.process)==="process"?"NODE":Zn.window&&Zn.document?"BROWSER":"REST"}(),jk=qE,zh=jk==="NODE",zk=Ze,Nh=function(t,e,r){return zk.f(t,e,r)},Nk=Ve,Lk=Nh,Bk=Ce,qk=Le,fy=Bk("species"),FE=function(t){var e=Nk(t);qk&&e&&!e[fy]&&Lk(e,fy,{configurable:!0,get:function(){return this}})},Fk=Jr,Uk=TypeError,Fu=function(t,e){if(Fk(e,t))return t;throw new Uk("Incorrect invocation")},Vk=ue,Wk=Ie,jv=_h,Hk=Vk(Function.toString);Wk(jv.inspectSource)||(jv.inspectSource=function(t){return Hk(t)});var UE=jv.inspectSource,Kk=ue,Gk=ce,VE=Ie,Jk=Bu,Qk=Ve,Yk=UE,WE=function(){},HE=Qk("Reflect","construct"),Lh=/^\s*(?:class|function)\b/,Xk=Kk(Lh.exec),Zk=!Lh.test(WE),ei=function(e){if(!VE(e))return!1;try{return HE(WE,[],e),!0}catch{return!1}},KE=function(e){if(!VE(e))return!1;switch(Jk(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Zk||!!Xk(Lh,Yk(e))}catch{return!0}};KE.sham=!0;var Uu=!HE||Gk(function(){var t;return ei(ei.call)||!ei(Object)||!ei(function(){t=!0})||t})?KE:ei,ex=Uu,tx=ga,rx=TypeError,GE=function(t){if(ex(t))return t;throw new rx(tx(t)+" is not a constructor")},ly=ct,nx=GE,ix=Gr,ox=Ce,sx=ox("species"),JE=function(t,e){var r=ly(t).constructor,n;return r===void 0||ix(n=ly(r)[sx])?e:nx(n)},ax=ue,ba=ax([].slice),cx=TypeError,ux=function(t,e){if(t<e)throw new cx("Not enough arguments");return t},px=ha,QE=/(?:ipad|iphone|ipod).*applewebkit/i.test(px),at=he,fx=$u,lx=Qr,vy=Ie,vx=Be,YE=ce,hy=PE,hx=ba,dy=Ih,dx=ux,gx=QE,yx=zh,zv=at.setImmediate,Nv=at.clearImmediate,mx=at.process,Kp=at.Dispatch,Sx=at.Function,gy=at.MessageChannel,bx=at.String,Gp=0,Ys={},yy="onreadystatechange",ia,Sr,Jp,Qp;YE(function(){ia=at.location});var Bh=function(t){if(vx(Ys,t)){var e=Ys[t];delete Ys[t],e()}},Yp=function(t){return function(){Bh(t)}},my=function(t){Bh(t.data)},Sy=function(t){at.postMessage(bx(t),ia.protocol+"//"+ia.host)};(!zv||!Nv)&&(zv=function(e){dx(arguments.length,1);var r=vy(e)?e:Sx(e),n=hx(arguments,1);return Ys[++Gp]=function(){fx(r,void 0,n)},Sr(Gp),Gp},Nv=function(e){delete Ys[e]},yx?Sr=function(t){mx.nextTick(Yp(t))}:Kp&&Kp.now?Sr=function(t){Kp.now(Yp(t))}:gy&&!gx?(Jp=new gy,Qp=Jp.port2,Jp.port1.onmessage=my,Sr=lx(Qp.postMessage,Qp)):at.addEventListener&&vy(at.postMessage)&&!at.importScripts&&ia&&ia.protocol!=="file:"&&!YE(Sy)?(Sr=Sy,at.addEventListener("message",my,!1)):yy in dy("script")?Sr=function(t){hy.appendChild(dy("script"))[yy]=function(){hy.removeChild(this),Bh(t)}}:Sr=function(t){setTimeout(Yp(t),0)});var XE={set:zv,clear:Nv},by=he,Cx=Le,Px=Object.getOwnPropertyDescriptor,wx=function(t){if(!Cx)return by[t];var e=Px(by,t);return e&&e.value},ZE=function(){this.head=null,this.tail=null};ZE.prototype={add:function(t){var e={item:t,next:null},r=this.tail;r?r.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t){var e=this.head=t.next;return e===null&&(this.tail=null),t.item}}};var eO=ZE,Rx=ha,Ex=/ipad|iphone|ipod/i.test(Rx)&&typeof Pebble<"u",Ox=ha,_x=/web0s(?!.*chrome)/i.test(Ox),En=he,Ax=wx,Cy=Qr,Xp=XE.set,Ix=eO,Tx=QE,Mx=Ex,Dx=_x,Zp=zh,Py=En.MutationObserver||En.WebKitMutationObserver,wy=En.document,Ry=En.process,fc=En.Promise,Lv=Ax("queueMicrotask"),pn,ef,tf,lc,Ey;if(!Lv){var vc=new Ix,hc=function(){var t,e;for(Zp&&(t=Ry.domain)&&t.exit();e=vc.get();)try{e()}catch(r){throw vc.head&&pn(),r}t&&t.enter()};!Tx&&!Zp&&!Dx&&Py&&wy?(ef=!0,tf=wy.createTextNode(""),new Py(hc).observe(tf,{characterData:!0}),pn=function(){tf.data=ef=!ef}):!Mx&&fc&&fc.resolve?(lc=fc.resolve(void 0),lc.constructor=fc,Ey=Cy(lc.then,lc),pn=function(){Ey(hc)}):Zp?pn=function(){Ry.nextTick(hc)}:(Xp=Cy(Xp,En),pn=function(){Xp(hc)}),Lv=function(t){vc.head||pn(),vc.add(t)}}var $x=Lv,kx=function(t,e){try{arguments.length===1?console.error(t):console.error(t,e)}catch{}},Ca=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}},xx=he,zn=xx.Promise,jx=he,Xs=zn,zx=Ie,Nx=gE,Lx=UE,Bx=Ce,Oy=qE,rf=ku,_y=Xs&&Xs.prototype,qx=Bx("species"),Bv=!1,tO=zx(jx.PromiseRejectionEvent),Fx=Nx("Promise",function(){var t=Lx(Xs),e=t!==String(Xs);if(!e&&rf===66||!(_y.catch&&_y.finally))return!0;if(!rf||rf<51||!/native code/.test(t)){var r=new Xs(function(l){l(1)}),n=function(l){l(function(){},function(){})},i=r.constructor={};if(i[qx]=n,Bv=r.then(function(){})instanceof n,!Bv)return!0}return!e&&(Oy==="BROWSER"||Oy==="DENO")&&!tO}),Pa={CONSTRUCTOR:Fx,REJECTION_EVENT:tO,SUBCLASSING:Bv},Xt={},Ay=vt,Ux=TypeError,Vx=function(t){var e,r;this.promise=new t(function(n,i){if(e!==void 0||r!==void 0)throw new Ux("Bad Promise constructor");e=n,r=i}),this.resolve=Ay(e),this.reject=Ay(r)};Xt.f=function(t){return new Vx(t)};var Wx=Y,hu=zh,pr=he,wa=Ue,Hx=jn,Kx=dr,Gx=FE,Jx=vt,qv=Ie,Qx=Ee,Yx=Fu,Xx=JE,rO=XE.set,qh=$x,Zx=kx,ej=Ca,tj=eO,nO=hr,Fv=zn,Fh=Pa,iO=Xt,Vu="Promise",oO=Fh.CONSTRUCTOR,rj=Fh.REJECTION_EVENT;Fh.SUBCLASSING;var nf=nO.getterFor(Vu),nj=nO.set,ij=Fv&&Fv.prototype,mn=Fv,of=ij,sO=pr.TypeError,Uv=pr.document,Uh=pr.process,Vv=iO.f,oj=Vv,sj=!!(Uv&&Uv.createEvent&&pr.dispatchEvent),aO="unhandledrejection",aj="rejectionhandled",Iy=0,cO=1,cj=2,Vh=1,uO=2,dc,Ty,uj,pO=function(t){var e;return Qx(t)&&qv(e=t.then)?e:!1},fO=function(t,e){var r=e.value,n=e.state===cO,i=n?t.ok:t.fail,l=t.resolve,f=t.reject,c=t.domain,o,s,a;try{i?(n||(e.rejection===uO&&fj(e),e.rejection=Vh),i===!0?o=r:(c&&c.enter(),o=i(r),c&&(c.exit(),a=!0)),o===t.promise?f(new sO("Promise-chain cycle")):(s=pO(o))?wa(s,o,l,f):l(o)):f(r)}catch(u){c&&!a&&c.exit(),f(u)}},lO=function(t,e){t.notified||(t.notified=!0,qh(function(){for(var r=t.reactions,n;n=r.get();)fO(n,t);t.notified=!1,e&&!t.rejection&&pj(t)}))},vO=function(t,e,r){var n,i;sj?(n=Uv.createEvent("Event"),n.promise=e,n.reason=r,n.initEvent(t,!1,!0),pr.dispatchEvent(n)):n={promise:e,reason:r},!rj&&(i=pr["on"+t])?i(n):t===aO&&Zx("Unhandled promise rejection",r)},pj=function(t){wa(rO,pr,function(){var e=t.facade,r=t.value,n=My(t),i;if(n&&(i=ej(function(){hu?Uh.emit("unhandledRejection",r,e):vO(aO,e,r)}),t.rejection=hu||My(t)?uO:Vh,i.error))throw i.value})},My=function(t){return t.rejection!==Vh&&!t.parent},fj=function(t){wa(rO,pr,function(){var e=t.facade;hu?Uh.emit("rejectionHandled",e):vO(aj,e,t.value)})},Sn=function(t,e,r){return function(n){t(e,n,r)}},Pn=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=cj,lO(t,!0))},Wv=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw new sO("Promise can't be resolved itself");var n=pO(e);n?qh(function(){var i={done:!1};try{wa(n,e,Sn(Wv,i,t),Sn(Pn,i,t))}catch(l){Pn(i,l,t)}}):(t.value=e,t.state=cO,lO(t,!1))}catch(i){Pn({done:!1},i,t)}}};oO&&(mn=function(e){Yx(this,of),Jx(e),wa(dc,this);var r=nf(this);try{e(Sn(Wv,r),Sn(Pn,r))}catch(n){Pn(r,n)}},of=mn.prototype,dc=function(e){nj(this,{type:Vu,done:!1,notified:!1,parent:!1,reactions:new tj,rejection:!1,state:Iy,value:null})},dc.prototype=Hx(of,"then",function(e,r){var n=nf(this),i=Vv(Xx(this,mn));return n.parent=!0,i.ok=qv(e)?e:!0,i.fail=qv(r)&&r,i.domain=hu?Uh.domain:void 0,n.state===Iy?n.reactions.add(i):qh(function(){fO(i,n)}),i.promise}),Ty=function(){var t=new dc,e=nf(t);this.promise=t,this.resolve=Sn(Wv,e),this.reject=Sn(Pn,e)},iO.f=Vv=function(t){return t===mn||t===uj?new Ty(t):oj(t)});Wx({global:!0,constructor:!0,wrap:!0,forced:oO},{Promise:mn});Kx(mn,Vu,!1,!0);Gx(Vu);var lj=Ce,hO=lj("iterator"),dO=!1;try{var vj=0,Dy={next:function(){return{done:!!vj++}},return:function(){dO=!0}};Dy[hO]=function(){return this},Array.from(Dy,function(){throw 2})}catch{}var gO=function(t,e){try{if(!e&&!dO)return!1}catch{return!1}var r=!1;try{var n={};n[hO]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch{}return r},hj=zn,dj=gO,gj=Pa.CONSTRUCTOR,Wu=gj||!dj(function(t){hj.all(t).then(void 0,function(){})}),yj=Y,mj=Ue,Sj=vt,bj=Xt,Cj=Ca,Pj=Yt,wj=Wu;yj({target:"Promise",stat:!0,forced:wj},{all:function(e){var r=this,n=bj.f(r),i=n.resolve,l=n.reject,f=Cj(function(){var c=Sj(r.resolve),o=[],s=0,a=1;Pj(e,function(u){var p=s++,v=!1;a++,mj(c,r,u).then(function(g){v||(v=!0,o[p]=g,--a||i(o))},l)}),--a||i(o)});return f.error&&l(f.value),n.promise}});var Rj=Y,Ej=Pa.CONSTRUCTOR,$y=zn;$y&&$y.prototype;Rj({target:"Promise",proto:!0,forced:Ej,real:!0},{catch:function(t){return this.then(void 0,t)}});var Oj=Y,_j=Ue,Aj=vt,Ij=Xt,Tj=Ca,Mj=Yt,Dj=Wu;Oj({target:"Promise",stat:!0,forced:Dj},{race:function(e){var r=this,n=Ij.f(r),i=n.reject,l=Tj(function(){var f=Aj(r.resolve);Mj(e,function(c){_j(f,r,c).then(n.resolve,i)})});return l.error&&i(l.value),n.promise}});var $j=Y,kj=Xt,xj=Pa.CONSTRUCTOR;$j({target:"Promise",stat:!0,forced:xj},{reject:function(e){var r=kj.f(this),n=r.reject;return n(e),r.promise}});var jj=ct,zj=Ee,Nj=Xt,yO=function(t,e){if(jj(t),zj(e)&&e.constructor===t)return e;var r=Nj.f(t),n=r.resolve;return n(e),r.promise},Lj=Y,Bj=Ve,qj=hE,Fj=zn,Uj=Pa.CONSTRUCTOR,Vj=yO,Wj=Bj("Promise"),Hj=!Uj;Lj({target:"Promise",stat:!0,forced:qj},{resolve:function(e){return Vj(Hj&&this===Wj?Fj:this,e)}});var Kj=Y,Gj=Ue,Jj=vt,Qj=Xt,Yj=Ca,Xj=Yt,Zj=Wu;Kj({target:"Promise",stat:!0,forced:Zj},{allSettled:function(e){var r=this,n=Qj.f(r),i=n.resolve,l=n.reject,f=Yj(function(){var c=Jj(r.resolve),o=[],s=0,a=1;Xj(e,function(u){var p=s++,v=!1;a++,Gj(c,r,u).then(function(g){v||(v=!0,o[p]={status:"fulfilled",value:g},--a||i(o))},function(g){v||(v=!0,o[p]={status:"rejected",reason:g},--a||i(o))})}),--a||i(o)});return f.error&&l(f.value),n.promise}});var ez=Y,tz=Ue,rz=vt,nz=Ve,iz=Xt,oz=Ca,sz=Yt,az=Wu,ky="No one promise resolved";ez({target:"Promise",stat:!0,forced:az},{any:function(e){var r=this,n=nz("AggregateError"),i=iz.f(r),l=i.resolve,f=i.reject,c=oz(function(){var o=rz(r.resolve),s=[],a=0,u=1,p=!1;sz(e,function(v){var g=a++,h=!1;u++,tz(o,r,v).then(function(d){h||p||(p=!0,l(d))},function(d){h||p||(h=!0,s[g]=d,--u||f(new n(s,ky)))})}),--u||f(new n(s,ky))});return c.error&&f(c.value),i.promise}});var cz=Y,uz=Xt;cz({target:"Promise",stat:!0},{withResolvers:function(){var e=uz.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var pz=Y,Hv=zn,fz=ce,lz=Ve,vz=Ie,hz=JE,xy=yO,dz=Hv&&Hv.prototype,gz=!!Hv&&fz(function(){dz.finally.call({then:function(){}},function(){})});pz({target:"Promise",proto:!0,real:!0,forced:gz},{finally:function(t){var e=hz(this,lz("Promise")),r=vz(t);return this.then(r?function(n){return xy(e,t()).then(function(){return n})}:t,r?function(n){return xy(e,t()).then(function(){throw n})}:t)}});var Wh=ue,yz=Th,mz=xn,Sz=va,bz=Wh("".charAt),jy=Wh("".charCodeAt),Cz=Wh("".slice),zy=function(t){return function(e,r){var n=mz(Sz(e)),i=yz(r),l=n.length,f,c;return i<0||i>=l?t?"":void 0:(f=jy(n,i),f<55296||f>56319||i+1===l||(c=jy(n,i+1))<56320||c>57343?t?bz(n,i):f:t?Cz(n,i,i+2):(f-55296<<10)+(c-56320)+65536)}},Pz={codeAt:zy(!1),charAt:zy(!0)},wz=Pz.charAt,Rz=xn,mO=hr,Ez=xh,Ny=jh,SO="String Iterator",Oz=mO.set,_z=mO.getterFor(SO);Ez(String,"String",function(t){Oz(this,{type:SO,string:Rz(t),index:0})},function(){var e=_z(this),r=e.string,n=e.index,i;return n>=r.length?Ny(void 0,!0):(i=wz(r,n),e.index+=i.length,Ny(i,!1))});var Az=Te,Iz=Az.Promise,Tz={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Mz=Tz,Dz=he,$z=dr,Ly=kn;for(var sf in Mz)$z(Dz[sf],sf),Ly[sf]=Ly.Array;var kz=Iz,xz=kz,jz=xz;const zz=ne(jz);function Nz(){var t={};return t.promise=new zz(function(e,r){t.resolve=e,t.reject=r}),t}var du=Nz;const Lz=Object.freeze(Object.defineProperty({__proto__:null,default:du},Symbol.toStringTag,{value:"Module"}));var Bz=Y,qz=Le,Fz=Yr;Bz({target:"Object",stat:!0,sham:!qz},{create:Fz});var Uz=Te,Vz=Uz.Object,Wz=function(e,r){return Vz.create(e,r)},Hz=Wz,bO=Hz,Kz=bO;const gu=ne(Kz);var Gz=fr,Ra=Array.isArray||function(e){return Gz(e)==="Array"},Jz=Y,Qz=Ra;Jz({target:"Array",stat:!0},{isArray:Qz});var Yz=Te,Xz=Yz.Array.isArray,Zz=Xz,CO=Zz,eN=CO,tN=eN,rN=tN,nN=rN,iN=nN;const oN=ne(iN);var sN=TypeError,aN=9007199254740991,cN=function(t){if(t>aN)throw sN("Maximum allowed index exceeded");return t},uN=Le,pN=Ze,fN=Kr,Hh=function(t,e,r){uN?pN.f(t,e,fN(0,r)):t[e]=r},By=Ra,lN=Uu,vN=Ee,hN=Ce,dN=hN("species"),qy=Array,gN=function(t){var e;return By(t)&&(e=t.constructor,lN(e)&&(e===qy||By(e.prototype))?e=void 0:vN(e)&&(e=e[dN],e===null&&(e=void 0))),e===void 0?qy:e},yN=gN,PO=function(t,e){return new(yN(t))(e===0?0:e)},mN=ce,SN=Ce,bN=ku,CN=SN("species"),wO=function(t){return bN>=51||!mN(function(){var e=[],r=e.constructor={};return r[CN]=function(){return{foo:1}},e[t](Boolean).foo!==1})},PN=Y,wN=ce,RN=Ra,EN=Ee,ON=lr,_N=$n,Fy=cN,Uy=Hh,AN=PO,IN=wO,TN=Ce,MN=ku,RO=TN("isConcatSpreadable"),DN=MN>=51||!wN(function(){var t=[];return t[RO]=!1,t.concat()[0]!==t}),$N=function(t){if(!EN(t))return!1;var e=t[RO];return e!==void 0?!!e:RN(t)},kN=!DN||!IN("concat");PN({target:"Array",proto:!0,arity:1,forced:kN},{concat:function(e){var r=ON(this),n=AN(r,0),i=0,l,f,c,o,s;for(l=-1,c=arguments.length;l<c;l++)if(s=l===-1?r:arguments[l],$N(s))for(o=_N(s),Fy(i+o),f=0;f<o;f++,i++)f in s&&Uy(n,i,s[f]);else Fy(i+1),Uy(n,i++,s);return n.length=i,n}});var Hu={},xN=fr,jN=Qt,EO=ma.f,zN=ba,OO=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],NN=function(t){try{return EO(t)}catch{return zN(OO)}};Hu.f=function(e){return OO&&xN(e)==="Window"?NN(e):EO(jN(e))};var Nn={},LN=Ce;Nn.f=LN;var Vy=Te,BN=Be,qN=Nn,FN=Ze.f,ye=function(t){var e=Vy.Symbol||(Vy.Symbol={});BN(e,t)||FN(e,t,{value:qN.f(t)})},UN=Ue,VN=Ve,WN=Ce,HN=jn,_O=function(){var t=VN("Symbol"),e=t&&t.prototype,r=e&&e.valueOf,n=WN("toPrimitive");e&&!e[n]&&HN(e,n,function(i){return UN(r,this)},{arity:1})},KN=Qr,GN=ue,JN=pE,QN=lr,YN=$n,XN=PO,Wy=GN([].push),sr=function(t){var e=t===1,r=t===2,n=t===3,i=t===4,l=t===6,f=t===7,c=t===5||l;return function(o,s,a,u){for(var p=QN(o),v=JN(p),g=YN(v),h=KN(s,a),d=0,y=u||XN,m=e?y(o,g):r||f?y(o,0):void 0,S,b;g>d;d++)if((c||d in v)&&(S=v[d],b=h(S,d,p),t))if(e)m[d]=b;else if(b)switch(t){case 3:return!0;case 5:return S;case 6:return d;case 2:Wy(m,S)}else switch(t){case 4:return!1;case 7:Wy(m,S)}return l?-1:n||i?i:m}},Kh={forEach:sr(0),map:sr(1),filter:sr(2),some:sr(3),every:sr(4),find:sr(5),findIndex:sr(6),filterReject:sr(7)},Ku=Y,Ea=he,Gh=Ue,ZN=ue,On=Le,_n=Mn,e2=ce,ze=Be,t2=Jr,Kv=ct,Gu=Qt,Jh=Ah,r2=xn,Gv=Kr,An=Yr,AO=Dh,n2=ma,IO=Hu,i2=Nu,TO=la,MO=Ze,o2=Lu,DO=Eh,Hy=jn,s2=Nh,Qh=Dn,a2=ju,$O=Sa,Ky=xu,c2=Ce,u2=Nn,p2=ye,f2=_O,l2=dr,kO=hr,Ju=Kh.forEach,Qe=a2("hidden"),Qu="Symbol",oa="prototype",v2=kO.set,Gy=kO.getterFor(Qu),Pt=Object[oa],Br=Ea.Symbol,Us=Br&&Br[oa],h2=Ea.RangeError,d2=Ea.TypeError,af=Ea.QObject,xO=TO.f,qr=MO.f,jO=IO.f,g2=DO.f,zO=ZN([].push),Kt=Qh("symbols"),Oa=Qh("op-symbols"),y2=Qh("wks"),Jv=!af||!af[oa]||!af[oa].findChild,NO=function(t,e,r){var n=xO(Pt,e);n&&delete Pt[e],qr(t,e,r),n&&t!==Pt&&qr(Pt,e,n)},Qv=On&&e2(function(){return An(qr({},"a",{get:function(){return qr(this,"a",{value:7}).a}})).a!==7})?NO:qr,cf=function(t,e){var r=Kt[t]=An(Us);return v2(r,{type:Qu,tag:t,description:e}),On||(r.description=e),r},Yu=function(e,r,n){e===Pt&&Yu(Oa,r,n),Kv(e);var i=Jh(r);return Kv(n),ze(Kt,i)?(n.enumerable?(ze(e,Qe)&&e[Qe][i]&&(e[Qe][i]=!1),n=An(n,{enumerable:Gv(0,!1)})):(ze(e,Qe)||qr(e,Qe,Gv(1,An(null))),e[Qe][i]=!0),Qv(e,i,n)):qr(e,i,n)},Yh=function(e,r){Kv(e);var n=Gu(r),i=AO(n).concat(FO(n));return Ju(i,function(l){(!On||Gh(LO,n,l))&&Yu(e,l,n[l])}),e},m2=function(e,r){return r===void 0?An(e):Yh(An(e),r)},LO=function(e){var r=Jh(e),n=Gh(g2,this,r);return this===Pt&&ze(Kt,r)&&!ze(Oa,r)?!1:n||!ze(this,r)||!ze(Kt,r)||ze(this,Qe)&&this[Qe][r]?n:!0},BO=function(e,r){var n=Gu(e),i=Jh(r);if(!(n===Pt&&ze(Kt,i)&&!ze(Oa,i))){var l=xO(n,i);return l&&ze(Kt,i)&&!(ze(n,Qe)&&n[Qe][i])&&(l.enumerable=!0),l}},qO=function(e){var r=jO(Gu(e)),n=[];return Ju(r,function(i){!ze(Kt,i)&&!ze($O,i)&&zO(n,i)}),n},FO=function(t){var e=t===Pt,r=jO(e?Oa:Gu(t)),n=[];return Ju(r,function(i){ze(Kt,i)&&(!e||ze(Pt,i))&&zO(n,Kt[i])}),n};_n||(Br=function(){if(t2(Us,this))throw new d2("Symbol is not a constructor");var e=!arguments.length||arguments[0]===void 0?void 0:r2(arguments[0]),r=Ky(e),n=function(i){var l=this===void 0?Ea:this;l===Pt&&Gh(n,Oa,i),ze(l,Qe)&&ze(l[Qe],r)&&(l[Qe][r]=!1);var f=Gv(1,i);try{Qv(l,r,f)}catch(c){if(!(c instanceof h2))throw c;NO(l,r,f)}};return On&&Jv&&Qv(Pt,r,{configurable:!0,set:n}),cf(r,e)},Us=Br[oa],Hy(Us,"toString",function(){return Gy(this).tag}),Hy(Br,"withoutSetter",function(t){return cf(Ky(t),t)}),DO.f=LO,MO.f=Yu,o2.f=Yh,TO.f=BO,n2.f=IO.f=qO,i2.f=FO,u2.f=function(t){return cf(c2(t),t)},On&&s2(Us,"description",{configurable:!0,get:function(){return Gy(this).description}}));Ku({global:!0,constructor:!0,wrap:!0,forced:!_n,sham:!_n},{Symbol:Br});Ju(AO(y2),function(t){p2(t)});Ku({target:Qu,stat:!0,forced:!_n},{useSetter:function(){Jv=!0},useSimple:function(){Jv=!1}});Ku({target:"Object",stat:!0,forced:!_n,sham:!On},{create:m2,defineProperty:Yu,defineProperties:Yh,getOwnPropertyDescriptor:BO});Ku({target:"Object",stat:!0,forced:!_n},{getOwnPropertyNames:qO});f2();l2(Br,Qu);$O[Qe]=!0;var S2=Mn,UO=S2&&!!Symbol.for&&!!Symbol.keyFor,b2=Y,C2=Ve,P2=Be,w2=xn,VO=Dn,R2=UO,uf=VO("string-to-symbol-registry"),E2=VO("symbol-to-string-registry");b2({target:"Symbol",stat:!0,forced:!R2},{for:function(t){var e=w2(t);if(P2(uf,e))return uf[e];var r=C2("Symbol")(e);return uf[e]=r,E2[r]=e,r}});var O2=Y,_2=Be,A2=da,I2=ga,T2=Dn,M2=UO,Jy=T2("symbol-to-string-registry");O2({target:"Symbol",stat:!0,forced:!M2},{keyFor:function(e){if(!A2(e))throw new TypeError(I2(e)+" is not a symbol");if(_2(Jy,e))return Jy[e]}});var D2=ue,Qy=Ra,$2=Ie,Yy=fr,k2=xn,Xy=D2([].push),x2=function(t){if($2(t))return t;if(Qy(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?Xy(r,i):(typeof i=="number"||Yy(i)==="Number"||Yy(i)==="String")&&Xy(r,k2(i))}var l=r.length,f=!0;return function(c,o){if(f)return f=!1,o;if(Qy(this))return o;for(var s=0;s<l;s++)if(r[s]===c)return o}}},j2=Y,WO=Ve,HO=$u,z2=Ue,_a=ue,KO=ce,Zy=Ie,em=da,GO=ba,N2=x2,L2=Mn,B2=String,ur=WO("JSON","stringify"),gc=_a(/./.exec),tm=_a("".charAt),q2=_a("".charCodeAt),F2=_a("".replace),U2=_a(1 .toString),V2=/[\uD800-\uDFFF]/g,rm=/^[\uD800-\uDBFF]$/,nm=/^[\uDC00-\uDFFF]$/,im=!L2||KO(function(){var t=WO("Symbol")("stringify detection");return ur([t])!=="[null]"||ur({a:t})!=="{}"||ur(Object(t))!=="{}"}),om=KO(function(){return ur("\uDF06\uD834")!=='"\\udf06\\ud834"'||ur("\uDEAD")!=='"\\udead"'}),W2=function(t,e){var r=GO(arguments),n=N2(e);if(!(!Zy(n)&&(t===void 0||em(t))))return r[1]=function(i,l){if(Zy(n)&&(l=z2(n,this,B2(i),l)),!em(l))return l},HO(ur,null,r)},H2=function(t,e,r){var n=tm(r,e-1),i=tm(r,e+1);return gc(rm,t)&&!gc(nm,i)||gc(nm,t)&&!gc(rm,n)?"\\u"+U2(q2(t,0),16):t};ur&&j2({target:"JSON",stat:!0,arity:3,forced:im||om},{stringify:function(e,r,n){var i=GO(arguments),l=HO(im?W2:ur,null,i);return om&&typeof l=="string"?F2(l,V2,H2):l}});var K2=Y,G2=Mn,J2=ce,JO=Nu,Q2=lr,Y2=!G2||J2(function(){JO.f(1)});K2({target:"Object",stat:!0,forced:Y2},{getOwnPropertySymbols:function(e){var r=JO.f;return r?r(Q2(e)):[]}});var X2=ye;X2("asyncIterator");var Z2=ye;Z2("hasInstance");var eL=ye;eL("isConcatSpreadable");var tL=ye;tL("iterator");var rL=ye;rL("match");var nL=ye;nL("matchAll");var iL=ye;iL("replace");var oL=ye;oL("search");var sL=ye;sL("species");var aL=ye;aL("split");var cL=ye,uL=_O;cL("toPrimitive");uL();var pL=Ve,fL=ye,lL=dr;fL("toStringTag");lL(pL("Symbol"),"Symbol");var vL=ye;vL("unscopables");var hL=he,dL=dr;dL(hL.JSON,"JSON",!0);var gL=Te,yL=gL.Symbol,mL=yL,QO=mL,SL=Ce,bL=Ze.f,sm=SL("metadata"),am=Function.prototype;am[sm]===void 0&&bL(am,sm,{value:null});var CL=ye;CL("asyncDispose");var PL=ye;PL("dispose");var wL=ye;wL("metadata");var RL=QO,EL=RL,OL=Ve,_L=ue,Xh=OL("Symbol"),AL=Xh.keyFor,IL=_L(Xh.prototype.valueOf),YO=Xh.isRegisteredSymbol||function(e){try{return AL(IL(e))!==void 0}catch{return!1}},TL=Y,ML=YO;TL({target:"Symbol",stat:!0},{isRegisteredSymbol:ML});var DL=Dn,XO=Ve,$L=ue,kL=da,xL=Ce,yu=XO("Symbol"),cm=yu.isWellKnownSymbol,ZO=XO("Object","getOwnPropertyNames"),jL=$L(yu.prototype.valueOf),um=DL("wks");for(var pf=0,pm=ZO(yu),zL=pm.length;pf<zL;pf++)try{var fm=pm[pf];kL(yu[fm])&&xL(fm)}catch{}var e_=function(e){if(cm&&cm(e))return!0;try{for(var r=jL(e),n=0,i=ZO(um),l=i.length;n<l;n++)if(um[i[n]]==r)return!0}catch{}return!1},NL=Y,LL=e_;NL({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:LL});var BL=ye;BL("customMatcher");var qL=ye;qL("observable");var FL=Y,UL=YO;FL({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:UL});var VL=Y,WL=e_;VL({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:WL});var HL=ye;HL("matcher");var KL=ye;KL("metadataKey");var GL=ye;GL("patternMatch");var JL=ye;JL("replaceAll");var QL=EL,YL=QL,XL=YL;const Vs=ne(XL);var ZL=qu,eB=ZL,tB=eB,rB=tB,nB=rB,iB=nB,oB=iB,sB=oB,aB=sB;const cB=ne(aB);var uB=he,pB=Te,t_=function(t,e){var r=pB[t+"Prototype"],n=r&&r[e];if(n)return n;var i=uB[t],l=i&&i.prototype;return l&&l[e]},fB=Y,lm=Ra,lB=Uu,vB=Ee,vm=bE,hB=$n,dB=Qt,gB=Hh,yB=Ce,mB=wO,SB=ba,bB=mB("slice"),CB=yB("species"),ff=Array,PB=Math.max;fB({target:"Array",proto:!0,forced:!bB},{slice:function(e,r){var n=dB(this),i=hB(n),l=vm(e,i),f=vm(r===void 0?i:r,i),c,o,s;if(lm(n)&&(c=n.constructor,lB(c)&&(c===ff||lm(c.prototype))?c=void 0:vB(c)&&(c=c[CB],c===null&&(c=void 0)),c===ff||c===void 0))return SB(n,l,f);for(o=new(c===void 0?ff:c)(PB(f-l,0)),s=0;l<f;l++,s++)l in n&&gB(o,s,n[l]);return o.length=s,o}});var wB=t_,RB=wB("Array","slice"),EB=Jr,OB=RB,lf=Array.prototype,_B=function(t){var e=t.slice;return t===lf||EB(lf,t)&&e===lf.slice?OB:e},AB=_B,IB=AB,TB=IB,MB=TB,DB=MB,$B=DB,kB=$B;const xB=ne(kB);var jB=ct,zB=TE,NB=function(t,e,r,n){try{return n?e(jB(r)[0],r[1]):e(r)}catch(i){zB(t,"throw",i)}},LB=Qr,BB=Ue,qB=lr,FB=NB,UB=_E,VB=Uu,WB=$n,hm=Hh,HB=IE,KB=qu,dm=Array,GB=function(e){var r=qB(e),n=VB(this),i=arguments.length,l=i>1?arguments[1]:void 0,f=l!==void 0;f&&(l=LB(l,i>2?arguments[2]:void 0));var c=KB(r),o=0,s,a,u,p,v,g;if(c&&!(this===dm&&UB(c)))for(a=n?new this:[],p=HB(r,c),v=p.next;!(u=BB(v,p)).done;o++)g=f?FB(p,l,[u.value,o],!0):u.value,hm(a,o,g);else for(s=WB(r),a=n?new this(s):dm(s);s>o;o++)g=f?l(r[o],o):r[o],hm(a,o,g);return a.length=o,a},JB=Y,QB=GB,YB=gO,XB=!YB(function(t){Array.from(t)});JB({target:"Array",stat:!0,forced:XB},{from:QB});var ZB=Te,eq=ZB.Array.from,tq=eq,rq=tq,nq=rq,iq=nq,oq=iq,sq=oq,aq=sq;const cq=ne(aq);function gm(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function uq(t,e){if(t){var r;if(typeof t=="string")return gm(t,e);var n=xB(r={}.toString.call(t)).call(r,8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?cq(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gm(t,e):void 0}}var r_={exports:{}},pq=Y,fq=Le,ym=Ze.f;pq({target:"Object",stat:!0,forced:Object.defineProperty!==ym,sham:!fq},{defineProperty:ym});var lq=Te,n_=lq.Object,vq=r_.exports=function(e,r,n){return n_.defineProperty(e,r,n)};n_.defineProperty.sham&&(vq.sham=!0);var hq=r_.exports,dq=hq,i_=dq,gq=i_,yq=gq,mq=yq,Sq=mq,bq=Sq;const Zh=ne(bq);var Cq=Nn,Pq=Cq.f("iterator"),wq=Pq,Rq=wq,Eq=Rq,Oq=Eq,_q=Oq,Aq=_q,Iq=Aq;const Tq=ne(Iq);function lt(t){"@babel/helpers - typeof";return lt=typeof Vs=="function"&&typeof Tq=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Vs=="function"&&e.constructor===Vs&&e!==Vs.prototype?"symbol":typeof e},lt(t)}var Mq=Nn,Dq=Mq.f("toPrimitive"),$q=Dq,kq=$q,xq=kq,jq=xq,zq=jq,Nq=zq,Lq=Nq;const Bq=ne(Lq);function qq(t,e){if(lt(t)!="object"||!t)return t;var r=t[Bq];if(r!==void 0){var n=r.call(t,e||"default");if(lt(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fq(t){var e=qq(t,"string");return lt(e)=="symbol"?e:e+""}var Uq=Y,Vq=ue,o_=Date,Wq=Vq(o_.prototype.getTime);Uq({target:"Date",stat:!0},{now:function(){return Wq(new o_)}});var Hq=Te,Kq=Hq.Date.now,Gq=Kq,Jq=Gq,Qq=Jq;const Yq=ne(Qq);var Xq=Y,Zq=lr,s_=Dh,eF=ce,tF=eF(function(){s_(1)});Xq({target:"Object",stat:!0,forced:tF},{keys:function(e){return s_(Zq(e))}});var rF=Te,nF=rF.Object.keys,iF=nF,oF=iF,sF=oF;const mm=ne(sF);var a_={exports:{}},aF=Y,cF=ce,uF=Qt,c_=la.f,u_=Le,pF=!u_||cF(function(){c_(1)});aF({target:"Object",stat:!0,forced:pF,sham:!u_},{getOwnPropertyDescriptor:function(e,r){return c_(uF(e),r)}});var fF=Te,p_=fF.Object,lF=a_.exports=function(e,r){return p_.getOwnPropertyDescriptor(e,r)};p_.getOwnPropertyDescriptor.sham&&(lF.sham=!0);var vF=a_.exports,hF=vF,dF=hF,gF=dF;const f_=ne(gF);var l_={exports:{}},yF=Y,mF=Le,Sm=Lu.f;yF({target:"Object",stat:!0,forced:Object.defineProperties!==Sm,sham:!mF},{defineProperties:Sm});var SF=Te,v_=SF.Object,bF=l_.exports=function(e,r){return v_.defineProperties(e,r)};v_.defineProperties.sham&&(bF.sham=!0);var CF=l_.exports,PF=CF,wF=PF,RF=wF;const h_=ne(RF);var EF=i_;const Mt=ne(EF);var OF=CO;const _F=ne(OF);var d_={exports:{}},AF=ce,IF=AF(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),TF=ce,MF=Ee,DF=fr,bm=IF,Xc=Object.isExtensible,$F=TF(function(){Xc(1)}),kF=$F||bm?function(e){return!MF(e)||bm&&DF(e)==="ArrayBuffer"?!1:Xc?Xc(e):!0}:Xc,xF=ce,g_=!xF(function(){return Object.isExtensible(Object.preventExtensions({}))}),jF=Y,zF=ue,NF=Sa,LF=Ee,ed=Be,BF=Ze.f,Cm=ma,qF=Hu,td=kF,FF=xu,UF=g_,y_=!1,Gt=FF("meta"),VF=0,rd=function(t){BF(t,Gt,{value:{objectID:"O"+VF++,weakData:{}}})},WF=function(t,e){if(!LF(t))return typeof t=="symbol"?t:(typeof t=="string"?"S":"P")+t;if(!ed(t,Gt)){if(!td(t))return"F";if(!e)return"E";rd(t)}return t[Gt].objectID},HF=function(t,e){if(!ed(t,Gt)){if(!td(t))return!0;if(!e)return!1;rd(t)}return t[Gt].weakData},KF=function(t){return UF&&y_&&td(t)&&!ed(t,Gt)&&rd(t),t},GF=function(){JF.enable=function(){},y_=!0;var t=Cm.f,e=zF([].splice),r={};r[Gt]=1,t(r).length&&(Cm.f=function(n){for(var i=t(n),l=0,f=i.length;l<f;l++)if(i[l]===Gt){e(i,l,1);break}return i},jF({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:qF.f}))},JF=d_.exports={enable:GF,fastKey:WF,getWeakData:HF,onFreeze:KF};NF[Gt]=!0;var Xu=d_.exports,QF=Y,YF=he,XF=Xu,ZF=ce,e3=vr,t3=Yt,r3=Fu,n3=Ie,i3=Ee,o3=Gr,s3=dr,a3=Ze.f,c3=Kh.forEach,u3=Le,m_=hr,p3=m_.set,f3=m_.getterFor,S_=function(t,e,r){var n=t.indexOf("Map")!==-1,i=t.indexOf("Weak")!==-1,l=n?"set":"add",f=YF[t],c=f&&f.prototype,o={},s;if(!u3||!n3(f)||!(i||c.forEach&&!ZF(function(){new f().entries().next()})))s=r.getConstructor(e,t,n,l),XF.enable();else{s=e(function(p,v){p3(r3(p,a),{type:t,collection:new f}),o3(v)||t3(v,p[l],{that:p,AS_ENTRIES:n})});var a=s.prototype,u=f3(t);c3(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(p){var v=p==="add"||p==="set";p in c&&!(i&&p==="clear")&&e3(a,p,function(g,h){var d=u(this).collection;if(!v&&i&&!i3(g))return p==="get"?void 0:!1;var y=d[p](g===0?0:g,h);return v?this:y})}),i||a3(a,"size",{configurable:!0,get:function(){return u(this).collection.size}})}return s3(s,t,!1,!0),o[t]=s,QF({global:!0,forced:!0},o),i||r.setStrong(s,t,n),s},l3=jn,nd=function(t,e,r){for(var n in e)r&&r.unsafe&&t[n]?t[n]=e[n]:l3(t,n,e[n],r);return t},Pm=Yr,v3=Nh,wm=nd,h3=Qr,d3=Fu,g3=Gr,y3=Yt,m3=xh,yc=jh,S3=FE,ti=Le,Rm=Xu.fastKey,b_=hr,Em=b_.set,vf=b_.getterFor,b3={getConstructor:function(t,e,r,n){var i=t(function(s,a){d3(s,l),Em(s,{type:e,index:Pm(null),first:null,last:null,size:0}),ti||(s.size=0),g3(a)||y3(a,s[n],{that:s,AS_ENTRIES:r})}),l=i.prototype,f=vf(e),c=function(s,a,u){var p=f(s),v=o(s,a),g,h;return v?v.value=u:(p.last=v={index:h=Rm(a,!0),key:a,value:u,previous:g=p.last,next:null,removed:!1},p.first||(p.first=v),g&&(g.next=v),ti?p.size++:s.size++,h!=="F"&&(p.index[h]=v)),s},o=function(s,a){var u=f(s),p=Rm(a),v;if(p!=="F")return u.index[p];for(v=u.first;v;v=v.next)if(v.key===a)return v};return wm(l,{clear:function(){for(var a=this,u=f(a),p=u.first;p;)p.removed=!0,p.previous&&(p.previous=p.previous.next=null),p=p.next;u.first=u.last=null,u.index=Pm(null),ti?u.size=0:a.size=0},delete:function(s){var a=this,u=f(a),p=o(a,s);if(p){var v=p.next,g=p.previous;delete u.index[p.index],p.removed=!0,g&&(g.next=v),v&&(v.previous=g),u.first===p&&(u.first=v),u.last===p&&(u.last=g),ti?u.size--:a.size--}return!!p},forEach:function(a){for(var u=f(this),p=h3(a,arguments.length>1?arguments[1]:void 0),v;v=v?v.next:u.first;)for(p(v.value,v.key,this);v&&v.removed;)v=v.previous},has:function(a){return!!o(this,a)}}),wm(l,r?{get:function(a){var u=o(this,a);return u&&u.value},set:function(a,u){return c(this,a===0?0:a,u)}}:{add:function(a){return c(this,a=a===0?0:a,a)}}),ti&&v3(l,"size",{configurable:!0,get:function(){return f(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=vf(e),l=vf(n);m3(t,e,function(f,c){Em(this,{type:n,target:f,state:i(f),kind:c,last:null})},function(){for(var f=l(this),c=f.kind,o=f.last;o&&o.removed;)o=o.previous;return!f.target||!(f.last=o=o?o.next:f.state.first)?(f.target=null,yc(void 0,!0)):yc(c==="keys"?o.key:c==="values"?o.value:[o.key,o.value],!1)},r?"entries":"values",!r,!0),S3(e)}},C3=function(t,e){return e===1?function(r,n){return r[t](n)}:function(r,n,i){return r[t](n,i)}},P3=bO,w3=P3,R3=w3,E3=R3,O3=E3;const _3=ne(O3);var A3=Y,I3=ce,T3=lr,C_=zu,M3=mE,D3=I3(function(){C_(1)});A3({target:"Object",stat:!0,forced:D3,sham:!M3},{getPrototypeOf:function(e){return C_(T3(e))}});var $3=Te,k3=$3.Object.getPrototypeOf,x3=k3,P_=x3,j3=P_,z3=j3,N3=z3,L3=N3,B3=L3;const Om=ne(B3);var q3=Y,F3=SE;q3({target:"Object",stat:!0},{setPrototypeOf:F3});var U3=Te,V3=U3.Object.setPrototypeOf,W3=V3,w_=W3,H3=w_,K3=H3,G3=K3,J3=G3,Q3=J3;const Yv=ne(Q3),Zs={},Y3=Object.freeze(Object.defineProperty({__proto__:null,default:Zs},Symbol.toStringTag,{value:"Module"})),Dt=rE(Y3);function X3(t,e){var r=typeof Vs<"u"&&cB(t)||t["@@iterator"];if(!r){if(oN(t)||(r=uq(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(s){throw s},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l,f=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var s=r.next();return f=s.done,s},e:function(s){c=!0,l=s},f:function(){try{f||r.return==null||r.return()}finally{if(c)throw l}}}}var Z3=Y,e4=ce,t4=Hu.f,r4=e4(function(){return!Object.getOwnPropertyNames(1)});Z3({target:"Object",stat:!0,forced:r4},{getOwnPropertyNames:t4});var n4=Te,i4=n4.Object,o4=function(e){return i4.getOwnPropertyNames(e)},s4=o4,a4=s4,c4=a4;const u4=ne(c4);var p4=P_;const Xv=ne(p4);var ri=function(t){return t&&t.Math===Math&&t},ht=ri(typeof globalThis=="object"&&globalThis)||ri(typeof window=="object"&&window)||ri(typeof self=="object"&&self)||ri(typeof w=="object"&&w)||ri(typeof w=="object"&&w)||function(){return this}()||Function("return this")(),id={},dt=function(t){try{return!!t()}catch{return!0}},f4=dt,gt=!f4(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),l4=dt,od=!l4(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),v4=od,mc=Function.prototype.call,Zt=v4?mc.bind(mc):function(){return mc.apply(mc,arguments)},sd={},R_={}.propertyIsEnumerable,E_=Object.getOwnPropertyDescriptor,h4=E_&&!R_.call({1:2},1);sd.f=h4?function(e){var r=E_(this,e);return!!r&&r.enumerable}:R_;var ad=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},O_=od,__=Function.prototype,Zv=__.call,d4=O_&&__.bind.bind(Zv,Zv),et=O_?d4:function(t){return function(){return Zv.apply(t,arguments)}},A_=et,g4=A_({}.toString),y4=A_("".slice),cd=function(t){return y4(g4(t),8,-1)},m4=et,S4=dt,b4=cd,hf=Object,C4=m4("".split),P4=S4(function(){return!hf("z").propertyIsEnumerable(0)})?function(t){return b4(t)==="String"?C4(t,""):hf(t)}:hf,Zu=function(t){return t==null},w4=Zu,R4=TypeError,ep=function(t){if(w4(t))throw new R4("Can't call method on "+t);return t},E4=P4,O4=ep,Ln=function(t){return E4(O4(t))},df=typeof document=="object"&&document.all,We=typeof df>"u"&&df!==void 0?function(t){return typeof t=="function"||t===df}:function(t){return typeof t=="function"},_4=We,er=function(t){return typeof t=="object"?t!==null:_4(t)},gf=ht,A4=We,I4=function(t){return A4(t)?t:void 0},Xr=function(t,e){return arguments.length<2?I4(gf[t]):gf[t]&&gf[t][e]},T4=et,ud=T4({}.isPrototypeOf),M4=typeof navigator<"u"&&String(navigator.userAgent)||"",I_=ht,yf=M4,_m=I_.process,Am=I_.Deno,Im=_m&&_m.versions||Am&&Am.version,Tm=Im&&Im.v8,Ct,mu;Tm&&(Ct=Tm.split("."),mu=Ct[0]>0&&Ct[0]<4?1:+(Ct[0]+Ct[1]));!mu&&yf&&(Ct=yf.match(/Edge\/(\d+)/),(!Ct||Ct[1]>=74)&&(Ct=yf.match(/Chrome\/(\d+)/),Ct&&(mu=+Ct[1])));var D4=mu,Mm=D4,$4=dt,k4=ht,x4=k4.String,T_=!!Object.getOwnPropertySymbols&&!$4(function(){var t=Symbol("symbol detection");return!x4(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Mm&&Mm<41}),j4=T_,M_=j4&&!Symbol.sham&&typeof Symbol.iterator=="symbol",z4=Xr,N4=We,L4=ud,B4=M_,q4=Object,D_=B4?function(t){return typeof t=="symbol"}:function(t){var e=z4("Symbol");return N4(e)&&L4(e.prototype,q4(t))},F4=String,pd=function(t){try{return F4(t)}catch{return"Object"}},U4=We,V4=pd,W4=TypeError,Aa=function(t){if(U4(t))return t;throw new W4(V4(t)+" is not a function")},H4=Aa,K4=Zu,Ia=function(t,e){var r=t[e];return K4(r)?void 0:H4(r)},mf=Zt,Sf=We,bf=er,G4=TypeError,J4=function(t,e){var r,n;if(e==="string"&&Sf(r=t.toString)&&!bf(n=mf(r,t))||Sf(r=t.valueOf)&&!bf(n=mf(r,t))||e!=="string"&&Sf(r=t.toString)&&!bf(n=mf(r,t)))return n;throw new G4("Can't convert object to primitive value")},$_={exports:{}},Dm=ht,Q4=Object.defineProperty,fd=function(t,e){try{Q4(Dm,t,{value:e,configurable:!0,writable:!0})}catch{Dm[t]=e}return e},Y4=ht,X4=fd,$m="__core-js_shared__",km=$_.exports=Y4[$m]||X4($m,{});(km.versions||(km.versions=[])).push({version:"3.37.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.0/LICENSE",source:"https://github.com/zloirock/core-js"});var ld=$_.exports,xm=ld,k_=function(t,e){return xm[t]||(xm[t]=e||{})},Z4=ep,e6=Object,x_=function(t){return e6(Z4(t))},t6=et,r6=x_,n6=t6({}.hasOwnProperty),jt=Object.hasOwn||function(e,r){return n6(r6(e),r)},i6=et,o6=0,s6=Math.random(),a6=i6(1 .toString),j_=function(t){return"Symbol("+(t===void 0?"":t)+")_"+a6(++o6+s6,36)},c6=ht,u6=k_,jm=jt,p6=j_,f6=T_,l6=M_,bn=c6.Symbol,Cf=u6("wks"),v6=l6?bn.for||bn:bn&&bn.withoutSetter||p6,tt=function(t){return jm(Cf,t)||(Cf[t]=f6&&jm(bn,t)?bn[t]:v6("Symbol."+t)),Cf[t]},h6=Zt,zm=er,Nm=D_,d6=Ia,g6=J4,y6=tt,m6=TypeError,S6=y6("toPrimitive"),b6=function(t,e){if(!zm(t)||Nm(t))return t;var r=d6(t,S6),n;if(r){if(e===void 0&&(e="default"),n=h6(r,t,e),!zm(n)||Nm(n))return n;throw new m6("Can't convert object to primitive value")}return e===void 0&&(e="number"),g6(t,e)},C6=b6,P6=D_,z_=function(t){var e=C6(t,"string");return P6(e)?e:e+""},w6=ht,Lm=er,eh=w6.document,R6=Lm(eh)&&Lm(eh.createElement),vd=function(t){return R6?eh.createElement(t):{}},E6=gt,O6=dt,_6=vd,N_=!E6&&!O6(function(){return Object.defineProperty(_6("div"),"a",{get:function(){return 7}}).a!==7}),A6=gt,I6=Zt,T6=sd,M6=ad,D6=Ln,$6=z_,k6=jt,x6=N_,Bm=Object.getOwnPropertyDescriptor;id.f=A6?Bm:function(e,r){if(e=D6(e),r=$6(r),x6)try{return Bm(e,r)}catch{}if(k6(e,r))return M6(!I6(T6.f,e,r),e[r])};var zt={},j6=gt,z6=dt,L_=j6&&z6(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),N6=er,L6=String,B6=TypeError,tr=function(t){if(N6(t))return t;throw new B6(L6(t)+" is not an object")},q6=gt,F6=N_,U6=L_,Sc=tr,qm=z_,V6=TypeError,Pf=Object.defineProperty,W6=Object.getOwnPropertyDescriptor,wf="enumerable",Rf="configurable",Ef="writable";zt.f=q6?U6?function(e,r,n){if(Sc(e),r=qm(r),Sc(n),typeof e=="function"&&r==="prototype"&&"value"in n&&Ef in n&&!n[Ef]){var i=W6(e,r);i&&i[Ef]&&(e[r]=n.value,n={configurable:Rf in n?n[Rf]:i[Rf],enumerable:wf in n?n[wf]:i[wf],writable:!1})}return Pf(e,r,n)}:Pf:function(e,r,n){if(Sc(e),r=qm(r),Sc(n),F6)try{return Pf(e,r,n)}catch{}if("get"in n||"set"in n)throw new V6("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var H6=gt,K6=zt,G6=ad,tp=H6?function(t,e,r){return K6.f(t,e,G6(1,r))}:function(t,e,r){return t[e]=r,t},B_={exports:{}},th=gt,J6=jt,q_=Function.prototype,Q6=th&&Object.getOwnPropertyDescriptor,hd=J6(q_,"name"),Y6=hd&&(function(){}).name==="something",X6=hd&&(!th||th&&Q6(q_,"name").configurable),F_={EXISTS:hd,PROPER:Y6,CONFIGURABLE:X6},Z6=et,eU=We,rh=ld,tU=Z6(Function.toString);eU(rh.inspectSource)||(rh.inspectSource=function(t){return tU(t)});var U_=rh.inspectSource,rU=ht,nU=We,Fm=rU.WeakMap,iU=nU(Fm)&&/native code/.test(String(Fm)),oU=k_,sU=j_,Um=oU("keys"),dd=function(t){return Um[t]||(Um[t]=sU(t))},gd={},aU=iU,V_=ht,cU=er,uU=tp,Of=jt,_f=ld,pU=dd,fU=gd,Vm="Object already initialized",nh=V_.TypeError,lU=V_.WeakMap,Su,sa,bu,vU=function(t){return bu(t)?sa(t):Su(t,{})},hU=function(t){return function(e){var r;if(!cU(e)||(r=sa(e)).type!==t)throw new nh("Incompatible receiver, "+t+" required");return r}};if(aU||_f.state){var Tt=_f.state||(_f.state=new lU);Tt.get=Tt.get,Tt.has=Tt.has,Tt.set=Tt.set,Su=function(t,e){if(Tt.has(t))throw new nh(Vm);return e.facade=t,Tt.set(t,e),e},sa=function(t){return Tt.get(t)||{}},bu=function(t){return Tt.has(t)}}else{var fn=pU("state");fU[fn]=!0,Su=function(t,e){if(Of(t,fn))throw new nh(Vm);return e.facade=t,uU(t,fn,e),e},sa=function(t){return Of(t,fn)?t[fn]:{}},bu=function(t){return Of(t,fn)}}var rp={set:Su,get:sa,has:bu,enforce:vU,getterFor:hU},yd=et,dU=dt,gU=We,bc=jt,ih=gt,yU=F_.CONFIGURABLE,mU=U_,W_=rp,SU=W_.enforce,bU=W_.get,Wm=String,Zc=Object.defineProperty,CU=yd("".slice),PU=yd("".replace),wU=yd([].join),RU=ih&&!dU(function(){return Zc(function(){},"length",{value:8}).length!==8}),EU=String(String).split("String"),OU=B_.exports=function(t,e,r){CU(Wm(e),0,7)==="Symbol("&&(e="["+PU(Wm(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!bc(t,"name")||yU&&t.name!==e)&&(ih?Zc(t,"name",{value:e,configurable:!0}):t.name=e),RU&&r&&bc(r,"arity")&&t.length!==r.arity&&Zc(t,"length",{value:r.arity});try{r&&bc(r,"constructor")&&r.constructor?ih&&Zc(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=SU(t);return bc(n,"source")||(n.source=wU(EU,typeof e=="string"?e:"")),t};Function.prototype.toString=OU(function(){return gU(this)&&bU(this).source||mU(this)},"toString");var H_=B_.exports,_U=We,AU=zt,IU=H_,TU=fd,Bn=function(t,e,r,n){n||(n={});var i=n.enumerable,l=n.name!==void 0?n.name:e;if(_U(r)&&IU(r,l,n),n.global)i?t[e]=r:TU(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:AU.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},K_={},MU=Math.ceil,DU=Math.floor,$U=Math.trunc||function(e){var r=+e;return(r>0?DU:MU)(r)},kU=$U,md=function(t){var e=+t;return e!==e||e===0?0:kU(e)},xU=md,jU=Math.max,zU=Math.min,NU=function(t,e){var r=xU(t);return r<0?jU(r+e,0):zU(r,e)},LU=md,BU=Math.min,qU=function(t){var e=LU(t);return e>0?BU(e,9007199254740991):0},FU=qU,G_=function(t){return FU(t.length)},UU=Ln,VU=NU,WU=G_,Hm=function(t){return function(e,r,n){var i=UU(e),l=WU(i);if(l===0)return!t&&-1;var f=VU(n,l),c;if(t&&r!==r){for(;l>f;)if(c=i[f++],c!==c)return!0}else for(;l>f;f++)if((t||f in i)&&i[f]===r)return t||f||0;return!t&&-1}},HU={includes:Hm(!0),indexOf:Hm(!1)},KU=et,Af=jt,GU=Ln,JU=HU.indexOf,QU=gd,Km=KU([].push),J_=function(t,e){var r=GU(t),n=0,i=[],l;for(l in r)!Af(QU,l)&&Af(r,l)&&Km(i,l);for(;e.length>n;)Af(r,l=e[n++])&&(~JU(i,l)||Km(i,l));return i},Sd=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],YU=J_,XU=Sd,ZU=XU.concat("length","prototype");K_.f=Object.getOwnPropertyNames||function(e){return YU(e,ZU)};var Q_={};Q_.f=Object.getOwnPropertySymbols;var eV=Xr,tV=et,rV=K_,nV=Q_,iV=tr,oV=tV([].concat),sV=eV("Reflect","ownKeys")||function(e){var r=rV.f(iV(e)),n=nV.f;return n?oV(r,n(e)):r},Gm=jt,aV=sV,cV=id,uV=zt,pV=function(t,e,r){for(var n=aV(e),i=uV.f,l=cV.f,f=0;f<n.length;f++){var c=n[f];!Gm(t,c)&&!(r&&Gm(r,c))&&i(t,c,l(e,c))}},fV=dt,lV=We,vV=/#|\.prototype\./,Ta=function(t,e){var r=dV[hV(t)];return r===yV?!0:r===gV?!1:lV(e)?fV(e):!!e},hV=Ta.normalize=function(t){return String(t).replace(vV,".").toLowerCase()},dV=Ta.data={},gV=Ta.NATIVE="N",yV=Ta.POLYFILL="P",mV=Ta,Cc=ht,SV=id.f,bV=tp,CV=Bn,PV=fd,wV=pV,RV=mV,Ma=function(t,e){var r=t.target,n=t.global,i=t.stat,l,f,c,o,s,a;if(n?f=Cc:i?f=Cc[r]||PV(r,{}):f=Cc[r]&&Cc[r].prototype,f)for(c in e){if(s=e[c],t.dontCallGetSet?(a=SV(f,c),o=a&&a.value):o=f[c],l=RV(n?c:r+(i?".":"#")+c,t.forced),!l&&o!==void 0){if(typeof s==typeof o)continue;wV(s,o)}(t.sham||o&&o.sham)&&bV(s,"sham",!0),CV(f,c,s,t)}},EV=dt,OV=!EV(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),_V=jt,AV=We,IV=x_,TV=dd,MV=OV,Jm=TV("IE_PROTO"),oh=Object,DV=oh.prototype,bd=MV?oh.getPrototypeOf:function(t){var e=IV(t);if(_V(e,Jm))return e[Jm];var r=e.constructor;return AV(r)&&e instanceof r?r.prototype:e instanceof oh?DV:null},$V=J_,kV=Sd,Y_=Object.keys||function(e){return $V(e,kV)},X_=gt,xV=dt,Z_=et,jV=bd,zV=Y_,NV=Ln,LV=sd.f,eA=Z_(LV),BV=Z_([].push),qV=X_&&xV(function(){var t=Object.create(null);return t[2]=2,!eA(t,2)}),Qm=function(t){return function(e){for(var r=NV(e),n=zV(r),i=qV&&jV(r)===null,l=n.length,f=0,c=[],o;l>f;)o=n[f++],(!X_||(i?o in r:eA(r,o)))&&BV(c,t?[o,r[o]]:r[o]);return c}},FV={entries:Qm(!0),values:Qm(!1)},UV=Ma,VV=FV.entries;UV({target:"Object",stat:!0},{entries:function(e){return VV(e)}});var WV=ht,Cd=WV,HV=Cd;HV.Object.entries;var sh={exports:{}},Ym=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(Ym){var Xm=new Uint8Array(16);sh.exports=function(){return Ym(Xm),Xm}}else{var Zm=new Array(16);sh.exports=function(){for(var e=0,r;e<16;e++)e&3||(r=Math.random()*4294967296),Zm[e]=r>>>((e&3)<<3)&255;return Zm}}var tA=sh.exports,rA=[];for(var Pc=0;Pc<256;++Pc)rA[Pc]=(Pc+256).toString(16).substr(1);function KV(t,e){var r=e||0,n=rA;return[n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]]].join("")}var nA=KV,GV=tA,JV=nA,eS,If,Tf=0,Mf=0;function QV(t,e,r){var n=e&&r||0,i=e||[];t=t||{};var l=t.node||eS,f=t.clockseq!==void 0?t.clockseq:If;if(l==null||f==null){var c=GV();l==null&&(l=eS=[c[0]|1,c[1],c[2],c[3],c[4],c[5]]),f==null&&(f=If=(c[6]<<8|c[7])&16383)}var o=t.msecs!==void 0?t.msecs:new Date().getTime(),s=t.nsecs!==void 0?t.nsecs:Mf+1,a=o-Tf+(s-Mf)/1e4;if(a<0&&t.clockseq===void 0&&(f=f+1&16383),(a<0||o>Tf)&&t.nsecs===void 0&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Tf=o,Mf=s,If=f,o+=122192928e5;var u=((o&268435455)*1e4+s)%4294967296;i[n++]=u>>>24&255,i[n++]=u>>>16&255,i[n++]=u>>>8&255,i[n++]=u&255;var p=o/4294967296*1e4&268435455;i[n++]=p>>>8&255,i[n++]=p&255,i[n++]=p>>>24&15|16,i[n++]=p>>>16&255,i[n++]=f>>>8|128,i[n++]=f&255;for(var v=0;v<6;++v)i[n+v]=l[v];return e||JV(i)}var YV=QV,XV=tA,ZV=nA;function eW(t,e,r){var n=e&&r||0;typeof t=="string"&&(e=t==="binary"?new Array(16):null,t=null),t=t||{};var i=t.random||(t.rng||XV)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e)for(var l=0;l<16;++l)e[n+l]=i[l];return e||ZV(i)}var tW=eW,rW=YV,iA=tW,Pd=iA;Pd.v1=rW;Pd.v4=iA;var oA=Pd;const ah=()=>oA.v4(),ge=()=>ah().replace(new RegExp("-","g"),"").toUpperCase();var ae;(function(t){t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warning=2]="Warning",t[t.Error=3]="Error"})(ae||(ae={}));let gr=class{constructor(e,r){this.privName=e,this.privEventId=ge(),this.privEventTime=new Date().toISOString(),this.privEventType=r,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}};class Da extends gr{constructor(e,r,n=ae.Info){super(e,n),this.privAudioSourceId=r}get audioSourceId(){return this.privAudioSourceId}}class np extends Da{constructor(e){super("AudioSourceInitializingEvent",e)}}class aa extends Da{constructor(e){super("AudioSourceReadyEvent",e)}}class sA extends Da{constructor(e){super("AudioSourceOffEvent",e)}}class Cu extends Da{constructor(e,r){super("AudioSourceErrorEvent",e,ae.Error),this.privError=r}get error(){return this.privError}}class ip extends Da{constructor(e,r,n){super(e,r),this.privAudioNodeId=n}get audioNodeId(){return this.privAudioNodeId}}class $a extends ip{constructor(e,r){super("AudioStreamNodeAttachingEvent",e,r)}}class ka extends ip{constructor(e,r){super("AudioStreamNodeAttachedEvent",e,r)}}class Jt extends ip{constructor(e,r){super("AudioStreamNodeDetachedEvent",e,r)}}class wd extends ip{constructor(e,r,n){super("AudioStreamNodeErrorEvent",e,r),this.privError=n}get error(){return this.privError}}class Rd extends gr{constructor(e,r,n=ae.Info){super(e,n),this.privJsonResult=r}get jsonString(){return this.privJsonResult}}class Zr extends gr{constructor(e,r,n=ae.Info){super(e,n),this.privConnectionId=r}get connectionId(){return this.privConnectionId}}class aA extends Zr{constructor(e,r,n){super("ConnectionStartEvent",e),this.privUri=r,this.privHeaders=n}get uri(){return this.privUri}get headers(){return this.privHeaders}}class cA extends Zr{constructor(e,r){super("ConnectionEstablishedEvent",e)}}class nW extends Zr{constructor(e,r,n){super("ConnectionClosedEvent",e,ae.Debug),this.privReason=n,this.privStatusCode=r}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class iW extends Zr{constructor(e,r,n){super("ConnectionErrorEvent",e,ae.Debug),this.privMessage=r,this.privType=n}get message(){return this.privMessage}get type(){return this.privType}}class oW extends Zr{constructor(e,r,n){super("ConnectionEstablishErrorEvent",e,ae.Error),this.privStatusCode=r,this.privReason=n}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class ch extends Zr{constructor(e,r,n){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=r,this.privMessage=n}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}class sW extends Zr{constructor(e,r,n){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=r,this.privMessage=n}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}class Ne extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}}class Ye extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}}class Ed extends Error{constructor(e,r){super(r),this.name=e+"ObjectDisposed",this.message=r}}var ee;(function(t){t[t.Text=0]="Text",t[t.Binary=1]="Binary"})(ee||(ee={}));let uh=class{constructor(e,r,n,i){if(this.privBody=null,e===ee.Text&&r&&typeof r!="string")throw new Ye("Payload must be a string");if(e===ee.Binary&&r&&!(r instanceof ArrayBuffer))throw new Ye("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=r,this.privHeaders=n||{},this.privId=i||ge(),this.messageType){case ee.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case ee.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===ee.Binary)throw new Ye("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===ee.Text)throw new Ye("Not supported for text message");return this.privBody}get id(){return this.privId}},Df=class{constructor(e,r){this.privStatusCode=e,this.privReason=r}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};class aW extends gr{constructor(e,r=ae.Info){super(e,r)}}class cW extends aW{constructor(e){super("SendingAgentContextMessageEvent"),this.privAgentConfig=e}get agentConfig(){return this.privAgentConfig}}let Et=class{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.onEvent=r=>{if(this.isDisposed())throw new Ed("EventSource");if(this.metadata)for(const n in this.metadata)n&&r.metadata&&(r.metadata[n]||(r.metadata[n]=this.metadata[n]));for(const n in this.privEventListeners)n&&this.privEventListeners[n]&&this.privEventListeners[n](r)},this.attach=r=>{const n=ge();return this.privEventListeners[n]=r,{detach:()=>(delete this.privEventListeners[n],Promise.resolve())}},this.attachListener=r=>this.attach(r.onEvent),this.isDisposed=()=>this.privIsDisposed,this.dispose=()=>{this.privEventListeners=null,this.privIsDisposed=!0},this.privMetadata=e}get metadata(){return this.privMetadata}},xe=class uA{static get instance(){return uA.privInstance}};xe.privInstance=new Et;xe.setEventSource=t=>{if(!t)throw new Ne("eventSource");xe.privInstance=t};var $e;(function(t){t[t.None=0]="None",t[t.Connected=1]="Connected",t[t.Connecting=2]="Connecting",t[t.Disconnected=3]="Disconnected"})($e||($e={}));let $f=class jr{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.get=r=>(this.throwIfDisposed(),this.privList[r]),this.first=()=>this.get(0),this.last=()=>this.get(this.length()-1),this.add=r=>{this.throwIfDisposed(),this.insertAt(this.privList.length,r)},this.insertAt=(r,n)=>{this.throwIfDisposed(),r===0?this.privList.unshift(n):r===this.privList.length?this.privList.push(n):this.privList.splice(r,0,n),this.triggerSubscriptions(this.privAddSubscriptions)},this.removeFirst=()=>(this.throwIfDisposed(),this.removeAt(0)),this.removeLast=()=>(this.throwIfDisposed(),this.removeAt(this.length()-1)),this.removeAt=r=>(this.throwIfDisposed(),this.remove(r,1)[0]),this.remove=(r,n)=>{this.throwIfDisposed();const i=this.privList.splice(r,n);return this.triggerSubscriptions(this.privRemoveSubscriptions),i},this.clear=()=>{this.throwIfDisposed(),this.remove(0,this.length())},this.length=()=>(this.throwIfDisposed(),this.privList.length),this.onAdded=r=>{this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[n]=r,{detach:()=>(delete this.privAddSubscriptions[n],Promise.resolve())}},this.onRemoved=r=>{this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[n]=r,{detach:()=>(delete this.privRemoveSubscriptions[n],Promise.resolve())}},this.onDisposed=r=>{this.throwIfDisposed();const n=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[n]=r,{detach:()=>(delete this.privDisposedSubscriptions[n],Promise.resolve())}},this.join=r=>(this.throwIfDisposed(),this.privList.join(r)),this.toArray=()=>{const r=Array();return this.privList.forEach(n=>{r.push(n)}),r},this.any=r=>(this.throwIfDisposed(),r?this.where(r).length()>0:this.length()>0),this.all=r=>(this.throwIfDisposed(),this.where(r).length()===this.length()),this.forEach=r=>{this.throwIfDisposed();for(let n=0;n<this.length();n++)r(this.privList[n],n)},this.select=r=>{this.throwIfDisposed();const n=[];for(let i=0;i<this.privList.length;i++)n.push(r(this.privList[i],i));return new jr(n)},this.where=r=>{this.throwIfDisposed();const n=new jr;for(let i=0;i<this.privList.length;i++)r(this.privList[i],i)&&n.add(this.privList[i]);return n},this.orderBy=r=>{this.throwIfDisposed();const i=this.toArray().sort(r);return new jr(i)},this.orderByDesc=r=>(this.throwIfDisposed(),this.orderBy((n,i)=>r(i,n))),this.clone=()=>(this.throwIfDisposed(),new jr(this.toArray())),this.concat=r=>(this.throwIfDisposed(),new jr(this.privList.concat(r.toArray()))),this.concatArray=r=>(this.throwIfDisposed(),new jr(this.privList.concat(r))),this.isDisposed=()=>this.privList==null,this.dispose=r=>{this.isDisposed()||(this.privDisposeReason=r,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))},this.throwIfDisposed=()=>{if(this.isDisposed())throw new Ed("List",this.privDisposeReason)},this.triggerSubscriptions=r=>{if(r)for(const n in r)n&&r[n]()},this.privList=[],e)for(const r of e)this.privList.push(r)}};var tS;(function(t){t[t.None=0]="None",t[t.Resolved=1]="Resolved",t[t.Rejected=2]="Rejected"})(tS||(tS={}));class Ae{constructor(){this.resolve=e=>(this.privResolve(e),this),this.reject=e=>(this.privReject(e),this),this.privPromise=new Promise((e,r)=>{this.privResolve=e,this.privReject=r})}get promise(){return this.privPromise}}function dn(t,e,r){t.then(n=>{try{e&&e(n)}catch(i){if(r)try{if(i instanceof Error){const l=i;r(l.name+": "+l.message)}else r(i)}catch{}}},n=>{if(r)try{if(n instanceof Error){const i=n;r(i.name+": "+i.message)}else r(n)}catch{}})}var rS=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})},ea;(function(t){t[t.Dequeue=0]="Dequeue",t[t.Peek=1]="Peek"})(ea||(ea={}));let Pu=class{constructor(e){this.privPromiseStore=new $f,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.enqueue=r=>{this.throwIfDispose(),this.enqueueFromPromise(new Promise((n,i)=>{n(r)}))},this.enqueueFromPromise=r=>{this.throwIfDispose(),r.then(n=>{this.privList.add(n)},n=>{})},this.dequeue=()=>{this.throwIfDispose();const r=new Ae;return this.privSubscribers&&(this.privSubscribers.add({deferral:r,type:ea.Dequeue}),this.drain()),r.promise},this.peek=()=>{this.throwIfDispose();const r=new Ae;return this.privSubscribers&&(this.privSubscribers.add({deferral:r,type:ea.Peek}),this.drain()),r.promise},this.length=()=>(this.throwIfDispose(),this.privList.length()),this.isDisposed=()=>this.privSubscribers==null,this.drain=()=>{if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const r=this.privSubscribers,n=this.privList;if(r&&n){for(;n.length()>0&&r.length()>0&&!this.privIsDisposing;){const i=r.removeFirst();if(i.type===ea.Peek)i.deferral.resolve(n.first());else{const l=n.removeFirst();i.deferral.resolve(l)}}this.privSubscribers===r&&(this.privSubscribers=r),this.privList===n&&(this.privList=n)}this.privIsDrainInProgress=!1}},this.throwIfDispose=()=>{if(this.isDisposed())throw this.privDisposeReason?new Ye(this.privDisposeReason):new Ed("Queue");if(this.privIsDisposing)throw new Ye("Queue disposing")},this.privList=e||new $f,this.privDetachables=[],this.privSubscribers=new $f,this.privDetachables.push(this.privList.onAdded(this.drain))}drainAndDispose(e,r){return rS(this,void 0,void 0,function*(){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=r,this.privIsDisposing=!0;const n=this.privSubscribers;if(n){for(;n.length()>0;)n.removeFirst().deferral.resolve(void 0);this.privSubscribers===n&&(this.privSubscribers=n)}for(const i of this.privDetachables)yield i.detach();if(this.privPromiseStore.length()>0&&e){const i=[];return this.privPromiseStore.toArray().forEach(l=>{i.push(l)}),Promise.all(i).finally(()=>{this.privSubscribers=null,this.privList.forEach((l,f)=>{e(l)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}})}dispose(e){return rS(this,void 0,void 0,function*(){yield this.drainAndDispose(null,e)})}},wu=class{constructor(e,r,n){if(this.privPayload=null,!r)throw new Ne("payload");if(e===ee.Binary&&r.__proto__.constructor.name!=="ArrayBuffer")throw new Ye("Payload must be ArrayBuffer");if(e===ee.Text&&typeof r!="string")throw new Ye("Payload must be a string");this.privMessageType=e,this.privPayload=r,this.privId=n||ge()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===ee.Binary)throw new Ye("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===ee.Text)throw new Ye("Not supported for text message");return this.privPayload}get id(){return this.privId}},uW=class{constructor(e,r){this.encode=n=>{const i=this.downSampleAudioFrame(n,this.privActualSampleRate,this.privDesiredSampleRate);if(!i)return null;const l=i.length*2,f=new ArrayBuffer(l),c=new DataView(f);return this.floatTo16BitPCM(c,0,i),f},this.setString=(n,i,l)=>{for(let f=0;f<l.length;f++)n.setUint8(i+f,l.charCodeAt(f))},this.floatTo16BitPCM=(n,i,l)=>{for(let f=0;f<l.length;f++,i+=2){const c=Math.max(-1,Math.min(1,l[f]));n.setInt16(i,c<0?c*32768:c*32767,!0)}},this.downSampleAudioFrame=(n,i,l)=>{if(l===i||l>i)return n;const f=i/l,c=Math.round(n.length/f),o=new Float32Array(c);let s=0,a=0;for(;a<c;){const u=Math.round((a+1)*f);let p=0,v=0;for(;s<u&&s<n.length;)p+=n[s++],v++;o[a++]=p/v}return o},this.privActualSampleRate=e,this.privDesiredSampleRate=r}};var pW=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let pA=class{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.read=()=>{if(this.privIsReadEnded)throw new Ye("Stream read has already finished");return this.privReaderQueue.dequeue().then(r=>pW(this,void 0,void 0,function*(){return(r===void 0||r.isEnd)&&(yield this.privReaderQueue.dispose("End of stream reached")),r}))},this.readEnded=()=>{this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new Pu)},this.throwIfClosed=()=>{if(this.privIsWriteEnded)throw new Ye("Stream closed")},this.privId=e||ge(),this.privReaderQueue=new Pu}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch{}}},Od=class extends pA{constructor(e,r){super(r),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||this.privNextBufferReadyBytes===0&&e.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(e);return}let r=0;for(;r<e.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);const n=Math.min(e.buffer.byteLength-r,this.privTargetChunkSize-this.privNextBufferReadyBytes),i=new Uint8Array(this.privNextBufferToWrite),l=new Uint8Array(e.buffer.slice(r,n+r));i.set(l,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=n,r+=n,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}},_e=class{};_e.workerTimers=null;_e.clearTimeout=t=>_e.timers().clearTimeout(t);_e.setTimeout=(t,e)=>_e.timers().setTimeout(t,e);_e.load=t=>{const e=new Map([[0,()=>{}]]),r=new Map,n=new Worker(t);return n.addEventListener("message",({data:f})=>{if(_e.isCallNotification(f)){const{params:{timerId:c}}=f,o=e.get(c);if(typeof o=="number"){const s=r.get(o);if(s===void 0||s!==c)throw new Error("The timer is in an undefined state.")}else if(typeof o<"u")o(),e.delete(c);else throw new Error("The timer is in an undefined state.")}else if(_e.isClearResponse(f)){const{id:c}=f,o=r.get(c);if(o===void 0)throw new Error("The timer is in an undefined state.");r.delete(c),e.delete(o)}else{const{error:{message:c}}=f;throw new Error(c)}}),{clearTimeout:f=>{const c=Math.random();r.set(c,f),e.set(f,c),n.postMessage({id:c,method:"clear",params:{timerId:f}})},setTimeout:(f,c)=>{const o=Math.random();return e.set(o,f),n.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:o}}),o}}};_e.loadWorkerTimers=()=>{const t=`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`;return()=>{if(_e.workerTimers!==null)return _e.workerTimers;const e=new Blob([t],{type:"application/javascript; charset=utf-8"}),r=URL.createObjectURL(e);return _e.workerTimers=_e.load(r),_e.workerTimers.setTimeout(()=>URL.revokeObjectURL(r),0),_e.workerTimers}};_e.timers=_e.loadWorkerTimers();_e.isCallNotification=t=>t.method!==void 0&&t.method==="call";_e.isClearResponse=t=>t.error===null&&typeof t.id=="number";class Ke extends gr{constructor(e,r,n){super(e,r),this.privSignature=n}}class fW extends Ke{constructor(e){super("OCSPMemoryCacheHitEvent",ae.Debug,e)}}class lW extends Ke{constructor(e){super("OCSPCacheMissEvent",ae.Debug,e)}}class vW extends Ke{constructor(e){super("OCSPDiskCacheHitEvent",ae.Debug,e)}}class hW extends Ke{constructor(e){super("OCSPCacheUpdateNeededEvent",ae.Debug,e)}}class dW extends Ke{constructor(e){super("OCSPMemoryCacheStoreEvent",ae.Debug,e)}}class gW extends Ke{constructor(e){super("OCSPDiskCacheStoreEvent",ae.Debug,e)}}class yW extends Ke{constructor(e){super("OCSPCacheUpdatehCompleteEvent",ae.Debug,e)}}class mW extends Ke{constructor(){super("OCSPStapleReceivedEvent",ae.Debug,"")}}class SW extends Ke{constructor(e,r){super("OCSPCacheEntryExpiredEvent",ae.Debug,e),this.privExpireTime=r}}class bW extends Ke{constructor(e,r,n){super("OCSPCacheEntryNeedsRefreshEvent",ae.Debug,e),this.privExpireTime=n,this.privStartTime=r}}class CW extends Ke{constructor(e,r,n){super("OCSPCacheHitEvent",ae.Debug,e),this.privExpireTime=n,this.privExpireTimeString=new Date(n).toLocaleDateString(),this.privStartTime=r,this.privStartTimeString=new Date(r).toLocaleTimeString()}}class PW extends Ke{constructor(e,r){super("OCSPVerificationFailedEvent",ae.Debug,e),this.privError=r}}class wW extends Ke{constructor(e,r){super("OCSPCacheFetchErrorEvent",ae.Debug,e),this.privError=r}}class RW extends Ke{constructor(e){super("OCSPResponseRetrievedEvent",ae.Debug,e)}}class EW extends Ke{constructor(e,r){super("OCSPCacheUpdateErrorEvent",ae.Debug,e),this.privError=r}}class Fr extends gr{constructor(e){super("BackgroundEvent",ae.Error),this.privError=e}get error(){return this.privError}}let be=class{};be.AuthKey="Ocp-Apim-Subscription-Key";be.ConnectionId="X-ConnectionId";be.ContentType="Content-Type";be.CustomCommandsAppId="X-CommandsAppId";be.Path="Path";be.RequestId="X-RequestId";be.RequestStreamId="X-StreamId";be.RequestTimestamp="X-Timestamp";class ph{constructor(e,r){this.privHeaderName=e,this.privToken=r}get headerName(){return this.privHeaderName}get token(){return this.privToken}}let OW=class{constructor(e){if(this.fetch=r=>Promise.resolve(this.privAuthInfo),this.fetchOnExpiry=r=>Promise.resolve(this.privAuthInfo),!e)throw new Ne("subscriptionKey");this.privAuthInfo=new ph(be.AuthKey,e)}};const nS="Authorization";let _W=class{constructor(e,r){if(this.fetch=n=>this.privFetchCallback(n).then(i=>new ph(nS,i)),this.fetchOnExpiry=n=>this.privFetchOnExpiryCallback(n).then(i=>new ph(nS,i)),!e)throw new Ne("fetchCallback");if(!r)throw new Ne("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=r}},se=class Ws{static throwIfNullOrUndefined(e,r){if(e==null)throw new Error("throwIfNullOrUndefined:"+r)}static throwIfNull(e,r){if(e===null)throw new Error("throwIfNull:"+r)}static throwIfNullOrWhitespace(e,r){if(Ws.throwIfNullOrUndefined(e,r),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+r)}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,r){if(Ws.throwIfNullOrUndefined(e,r),e.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+r);for(const n of e)Ws.throwIfNullOrWhitespace(n,r)}static throwIfFileDoesNotExist(e,r){Ws.throwIfNullOrWhitespace(e,r)}static throwIfNotUndefined(e,r){if(e!==void 0)throw new Error("throwIfNotUndefined:"+r)}},AW=class{constructor(e){this.id=()=>this.privId,se.throwIfNullOrUndefined(void 0,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=(void 0)(e,"w")}set format(e){se.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let r=0;this.privAudioFormat.hasHeader&&(r=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=(void 0)("",{fd:this.privFd,start:r,autoClose:!1}))}write(e){se.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),(void 0)(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),(void 0)(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}};var J;(function(t){t[t.PCM=1]="PCM",t[t.MuLaw=2]="MuLaw",t[t.Siren=3]="Siren",t[t.MP3=4]="MP3",t[t.SILKSkype=5]="SILKSkype",t[t.OGG_OPUS=6]="OGG_OPUS",t[t.WEBM_OPUS=7]="WEBM_OPUS",t[t.ALaw=8]="ALaw"})(J||(J={}));let op=class{static getDefaultInputFormat(){return Vr.getDefaultInputFormat()}static getWaveFormatPCM(e,r,n){return new Vr(e,r,n)}};class Vr extends op{constructor(e=16e3,r=16,n=1,i=J.PCM){switch(super(),this.setString=(f,c,o)=>{for(let s=0;s<o.length;s++)f.setUint8(c+s,o.charCodeAt(s))},i){case J.PCM:this.formatTag=1;break;case J.ALaw:this.formatTag=6;break;case J.MuLaw:this.formatTag=7;break}this.bitsPerSample=r,this.samplesPerSec=e,this.channels=n,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),this.privHeader=new ArrayBuffer(44);const l=new DataView(this.privHeader);this.setString(l,0,"RIFF"),l.setUint32(4,0,!0),this.setString(l,8,"WAVEfmt "),l.setUint32(16,16,!0),l.setUint16(20,this.formatTag,!0),l.setUint16(22,this.channels,!0),l.setUint32(24,this.samplesPerSec,!0),l.setUint32(28,this.avgBytesPerSec,!0),l.setUint16(32,this.channels*(this.bitsPerSample/8),!0),l.setUint16(34,this.bitsPerSample,!0),this.setString(l,36,"data"),l.setUint32(40,0,!0)}static getDefaultInputFormat(){return new Vr}static getAudioContext(e){const r=window.AudioContext||window.webkitAudioContext||!1;if(r)return e!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new r({sampleRate:e}):new r;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}}var fh=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let _d=class{constructor(){}static createPushStream(e){return fA.create(e)}static createPullStream(e,r){return lA.create(e,r)}};class fA extends _d{static create(e){return new IW(e)}}class IW extends fA{constructor(e){super(),this.onEvent=r=>{this.privEvents.onEvent(r),xe.instance.onEvent(r)},e===void 0?this.privFormat=Vr.getDefaultInputFormat():this.privFormat=e,this.privEvents=new Et,this.privId=ge(),this.privStream=new Od(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}get blob(){return this.attach("id").then(e=>{const r=[];let n=Buffer.from("");const i=()=>e.read().then(l=>!l||l.isEnd?typeof XMLHttpRequest<"u"&&typeof Blob<"u"?Promise.resolve(new Blob(r)):Promise.resolve(Buffer.from(n)):(typeof Blob<"u"?r.push(l.buffer):n=Buffer.concat([n,this.toBuffer(l.buffer)]),i()));return i()})}turnOn(){this.onEvent(new np(this.privId)),this.onEvent(new aa(this.privId))}attach(e){return fh(this,void 0,void 0,function*(){this.onEvent(new $a(this.privId,e)),yield this.turnOn();const r=this.privStream;return this.onEvent(new ka(this.privId,e)),{detach:()=>fh(this,void 0,void 0,function*(){return r.readEnded(),this.onEvent(new Jt(this.privId,e)),this.turnOff()}),id:()=>e,read:()=>r.read()}})}detach(e){this.onEvent(new Jt(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:Tn.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:Wr.Stream})}toBuffer(e){const r=Buffer.alloc(e.byteLength),n=new Uint8Array(e);for(let i=0;i<r.length;++i)r[i]=n[i];return r}}class lA extends _d{constructor(){super()}static create(e,r){return new vA(e,r)}}class vA extends lA{constructor(e,r){super(),this.onEvent=n=>{this.privEvents.onEvent(n),xe.instance.onEvent(n)},r===void 0?this.privFormat=op.getDefaultInputFormat():this.privFormat=r,this.privEvents=new Et,this.privId=ge(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}get blob(){return Promise.reject("Not implemented")}turnOn(){this.onEvent(new np(this.privId)),this.onEvent(new aa(this.privId))}attach(e){return fh(this,void 0,void 0,function*(){return this.onEvent(new $a(this.privId,e)),yield this.turnOn(),this.onEvent(new ka(this.privId,e)),{detach:()=>(this.privCallback.close(),this.onEvent(new Jt(this.privId,e)),this.turnOff()),id:()=>e,read:()=>{let r=0,n;for(;r<this.privBufferSize;){const i=new ArrayBuffer(this.privBufferSize-r),l=this.privCallback.read(i);if(n===void 0?n=i:new Int8Array(n).set(new Int8Array(i),r),l===0)break;r+=l}return Promise.resolve({buffer:n.slice(0,r),isEnd:this.privIsClosed||r===0,timeReceived:Date.now()})}}})}detach(e){this.onEvent(new Jt(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:Tn.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:Wr.Stream})}}var re;(function(t){t[t.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",t[t.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",t[t.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",t[t.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",t[t.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",t[t.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",t[t.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",t[t.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",t[t.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",t[t.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",t[t.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",t[t.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",t[t.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",t[t.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",t[t.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",t[t.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",t[t.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",t[t.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",t[t.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",t[t.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",t[t.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",t[t.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",t[t.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",t[t.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",t[t.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",t[t.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",t[t.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",t[t.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",t[t.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw"})(re||(re={}));class X extends Vr{constructor(e,r,n,i,l,f,c,o,s){super(n,f,r,e),this.formatTag=e,this.avgBytesPerSec=i,this.blockAlign=l,this.priAudioFormatString=c,this.priRequestAudioFormatString=o,this.priHasHeader=s}static fromSpeechSynthesisOutputFormat(e){return e===void 0?X.getDefaultOutputFormat():X.fromSpeechSynthesisOutputFormatString(X.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new X(J.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new X(J.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new X(J.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new X(J.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new X(J.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new X(J.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new X(J.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new X(J.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new X(J.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new X(J.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new X(J.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new X(J.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new X(J.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new X(J.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new X(J.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new X(J.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new X(J.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new X(J.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new X(J.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new X(J.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new X(J.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new X(J.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new X(J.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new X(J.WEBM_OPUS,1,16e3,8e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new X(J.WEBM_OPUS,1,24e3,8e3,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new X(J.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new X(J.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new X(J.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"riff-16khz-16bit-mono-pcm":default:return new X(J.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return X.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){this.priHasHeader&&new DataView(this.privHeader).setUint32(40,e,!0)}get requestAudioFormatString(){return this.priRequestAudioFormatString}}X.SpeechSynthesisOutputFormatToString={[re.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[re.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[re.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[re.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[re.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[re.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[re.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[re.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[re.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[re.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[re.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[re.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[re.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[re.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[re.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[re.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[re.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[re.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[re.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[re.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[re.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[re.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[re.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[re.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[re.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[re.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[re.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[re.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[re.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw"};var TW=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let Ad=class{constructor(){}static createPullStream(){return Id.create()}};class Id extends Ad{static create(){return new Td}}class Td extends Id{constructor(){super(),this.privId=ge(),this.privStream=new pA}set format(e){e==null&&(this.privFormat=X.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(e){return TW(this,void 0,void 0,function*(){const r=new Int8Array(e);let n=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>e.byteLength)return r.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);r.set(this.privLastChunkView),n=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;n<e.byteLength&&!this.privStream.isReadEnded;){const i=yield this.privStream.read();if(i!==void 0&&!i.isEnd){let l;i.buffer.byteLength>e.byteLength-n?(l=i.buffer.slice(0,e.byteLength-n),this.privLastChunkView=new Int8Array(i.buffer.slice(e.byteLength-n))):l=i.buffer,r.set(new Int8Array(l),n),n+=l.byteLength}else yield this.privStream.readEnded()}return n})}write(e){se.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}class hA extends Ad{constructor(){super()}static create(e){return new dA(e)}}class dA extends hA{constructor(e){super(),this.privId=ge(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}let ca=class gA{static fromDefaultMicrophoneInput(){const e=new Nf;return new ln(new eu(e))}static fromMicrophoneInput(e){const r=new Nf;return new ln(new eu(r,e))}static fromWavFileInput(e,r="unnamedBuffer.wav"){return new ln(new yH(e,r))}static fromStreamInput(e){if(e instanceof MW)return new ln(new vA(e));if(e instanceof _d)return new ln(e);if(typeof MediaStream<"u"&&e instanceof MediaStream){const r=new Nf;return new ln(new eu(r,null,null,e))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new vn(new sS)}static fromSpeakerOutput(e){if(e===void 0)return gA.fromDefaultSpeakerOutput();if(e instanceof sS)return new vn(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new vn(new AW(e))}static fromStreamOutput(e){if(e instanceof DW)return new vn(new dA(e));if(e instanceof hA)return new vn(e);if(e instanceof Id)return new vn(e);throw new Error("Not Supported Type")}};class ln extends ca{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(e,r){this.privSource.turnOff().then(()=>{e&&e()},n=>{r&&r(n)})}id(){return this.privSource.id()}get blob(){return this.privSource.blob}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,r){if(se.throwIfNull(r,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(e,r);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(e,r){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(e,r);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}class vn extends ca{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(e,r){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(e,r){throw new Error("This AudioConfig instance does not support getting properties.")}}var Fe;(function(t){t[t.Error=0]="Error",t[t.EndOfStream=1]="EndOfStream"})(Fe||(Fe={}));let MW=class{},DW=class{},ua=class{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}},In=class extends ua{constructor(e,r){super(r),this.privOffset=e}get offset(){return this.privOffset}};var Ur;(function(t){t[t.Simple=0]="Simple",t[t.Detailed=1]="Detailed"})(Ur||(Ur={}));let $W=class{constructor(e,r,n,i,l,f,c,o,s,a){this.privResultId=e,this.privReason=r,this.privText=n,this.privDuration=i,this.privOffset=l,this.privLanguage=f,this.privLanguageDetectionConfidence=c,this.privErrorDetails=o,this.privJson=s,this.privProperties=a}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}},wc=class extends $W{constructor(e,r,n,i,l,f,c,o,s,a,u){super(e,r,n,i,l,f,c,s,a,u),this.privSpeakerId=o}get speakerId(){return this.privSpeakerId}},kf=class extends In{constructor(e,r,n){super(r,n),this.privResult=e}get result(){return this.privResult}},kW=class extends In{constructor(e,r,n,i,l){super(i,l),this.privReason=e,this.privErrorDetails=r,this.privErrorCode=n}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}},xW=class extends kW{};var Xe;(function(t){t[t.NoMatch=0]="NoMatch",t[t.Canceled=1]="Canceled",t[t.RecognizingSpeech=2]="RecognizingSpeech",t[t.RecognizedSpeech=3]="RecognizedSpeech",t[t.RecognizedKeyword=4]="RecognizedKeyword",t[t.RecognizingIntent=5]="RecognizingIntent",t[t.RecognizedIntent=6]="RecognizedIntent",t[t.TranslatingSpeech=7]="TranslatingSpeech",t[t.TranslatedSpeech=8]="TranslatedSpeech",t[t.SynthesizingAudio=9]="SynthesizingAudio",t[t.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",t[t.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",t[t.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",t[t.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",t[t.RecognizedSpeakers=14]="RecognizedSpeakers",t[t.RecognizedSpeaker=15]="RecognizedSpeaker",t[t.ResetVoiceProfile=16]="ResetVoiceProfile",t[t.DeletedVoiceProfile=17]="DeletedVoiceProfile"})(Xe||(Xe={}));let jW=class{constructor(){}static fromSubscription(e,r){se.throwIfNullOrWhitespace(e,"subscriptionKey"),se.throwIfNullOrWhitespace(r,"region");const n=new Nr;return n.setProperty(j.SpeechServiceConnection_Region,r),n.setProperty(j.SpeechServiceConnection_IntentRegion,r),n.setProperty(j.SpeechServiceConnection_Key,e),n}static fromEndpoint(e,r){se.throwIfNull(e,"endpoint");const n=new Nr;return n.setProperty(j.SpeechServiceConnection_Endpoint,e.href),r!==void 0&&n.setProperty(j.SpeechServiceConnection_Key,r),n}static fromHost(e,r){se.throwIfNull(e,"hostName");const n=new Nr;return n.setProperty(j.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(e.port===""?"":":"+e.port)),r!==void 0&&n.setProperty(j.SpeechServiceConnection_Key,r),n}static fromAuthorizationToken(e,r){se.throwIfNull(e,"authorizationToken"),se.throwIfNullOrWhitespace(r,"region");const n=new Nr;return n.setProperty(j.SpeechServiceConnection_Region,r),n.setProperty(j.SpeechServiceConnection_IntentRegion,r),n.authorizationToken=e,n}close(){}};class Nr extends jW{constructor(){super(),this.privProperties=new Ru,this.speechRecognitionLanguage="en-US",this.outputFormat=Ur.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(j.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(j.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(j.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(j.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(j.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(j.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(j.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(j.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(j.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return Ur[this.privProperties.getProperty(hh,void 0)]}set outputFormat(e){this.privProperties.setProperty(hh,Ur[e])}get endpointId(){return this.privProperties.getProperty(j.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(j.SpeechServiceConnection_EndpointId,e)}setProperty(e,r){se.throwIfNull(r,"value"),this.privProperties.setProperty(e,r)}getProperty(e,r){return this.privProperties.getProperty(e,r)}setProxy(e,r,n,i){this.setProperty(j[j.SpeechServiceConnection_ProxyHostName],e),this.setProperty(j[j.SpeechServiceConnection_ProxyPort],r),this.setProperty(j[j.SpeechServiceConnection_ProxyUserName],n),this.setProperty(j[j.SpeechServiceConnection_ProxyPassword],i)}setServiceProperty(e,r,n){const i=JSON.parse(this.privProperties.getProperty(dh,"{}"));i[e]=r,this.privProperties.setProperty(dh,JSON.stringify(i))}setProfanity(e){this.privProperties.setProperty(j.SpeechServiceResponse_ProfanityOption,lh[e])}enableAudioLogging(){this.privProperties.setProperty(j.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(j.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(dH,"true")}clone(){const e=new Nr;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(j.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(j.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(j.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(j.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return re[this.privProperties.getProperty(j.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(j.SpeechServiceConnection_SynthOutputFormat,re[e])}}let Ru=class yA{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,r){let n;typeof e=="string"?n=e:n=j[e];for(let i=0;i<this.privKeys.length;i++)if(this.privKeys[i]===n)return this.privValues[i];return r}setProperty(e,r){let n;typeof e=="string"?n=e:n=j[e];for(let i=0;i<this.privKeys.length;i++)if(this.privKeys[i]===n){this.privValues[i]=r;return}this.privKeys.push(n),this.privValues.push(r)}clone(){const e=new yA;for(let r=0;r<this.privKeys.length;r++)e.privKeys.push(this.privKeys[r]),e.privValues.push(this.privValues[r]);return e}mergeTo(e){this.privKeys.forEach(r=>{if(e.getProperty(r,void 0)===void 0){const n=this.getProperty(r);e.setProperty(r,n)}})}};var j;(function(t){t[t.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",t[t.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",t[t.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",t[t.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",t[t.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",t[t.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",t[t.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",t[t.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",t[t.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",t[t.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",t[t.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",t[t.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",t[t.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",t[t.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",t[t.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",t[t.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",t[t.Speech_SessionId=16]="Speech_SessionId",t[t.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",t[t.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",t[t.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",t[t.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",t[t.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",t[t.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",t[t.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",t[t.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",t[t.CancellationDetails_Reason=25]="CancellationDetails_Reason",t[t.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",t[t.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",t[t.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",t[t.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",t[t.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",t[t.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",t[t.SpeechServiceConnection_EnableAudioLogging=32]="SpeechServiceConnection_EnableAudioLogging",t[t.SpeechServiceResponse_ProfanityOption=33]="SpeechServiceResponse_ProfanityOption",t[t.SpeechServiceResponse_PostProcessingOption=34]="SpeechServiceResponse_PostProcessingOption",t[t.SpeechServiceResponse_RequestWordLevelTimestamps=35]="SpeechServiceResponse_RequestWordLevelTimestamps",t[t.SpeechServiceResponse_StablePartialResultThreshold=36]="SpeechServiceResponse_StablePartialResultThreshold",t[t.SpeechServiceResponse_OutputFormatOption=37]="SpeechServiceResponse_OutputFormatOption",t[t.SpeechServiceResponse_TranslationRequestStablePartialResult=38]="SpeechServiceResponse_TranslationRequestStablePartialResult",t[t.Conversation_ApplicationId=39]="Conversation_ApplicationId",t[t.Conversation_DialogType=40]="Conversation_DialogType",t[t.Conversation_Initial_Silence_Timeout=41]="Conversation_Initial_Silence_Timeout",t[t.Conversation_From_Id=42]="Conversation_From_Id",t[t.Conversation_Conversation_Id=43]="Conversation_Conversation_Id",t[t.Conversation_Custom_Voice_Deployment_Ids=44]="Conversation_Custom_Voice_Deployment_Ids",t[t.Conversation_Speech_Activity_Template=45]="Conversation_Speech_Activity_Template",t[t.Conversation_Request_Bot_Status_Messages=46]="Conversation_Request_Bot_Status_Messages",t[t.Conversation_Agent_Connection_Id=47]="Conversation_Agent_Connection_Id",t[t.SpeechServiceConnection_Host=48]="SpeechServiceConnection_Host",t[t.ConversationTranslator_Host=49]="ConversationTranslator_Host",t[t.ConversationTranslator_Name=50]="ConversationTranslator_Name",t[t.ConversationTranslator_CorrelationId=51]="ConversationTranslator_CorrelationId",t[t.ConversationTranslator_Token=52]="ConversationTranslator_Token",t[t.PronunciationAssessment_ReferenceText=53]="PronunciationAssessment_ReferenceText",t[t.PronunciationAssessment_GradingSystem=54]="PronunciationAssessment_GradingSystem",t[t.PronunciationAssessment_Granularity=55]="PronunciationAssessment_Granularity",t[t.PronunciationAssessment_EnableMiscue=56]="PronunciationAssessment_EnableMiscue",t[t.PronunciationAssessment_Json=57]="PronunciationAssessment_Json",t[t.PronunciationAssessment_Params=58]="PronunciationAssessment_Params"})(j||(j={}));var ni=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let zW=class mA{constructor(e,r,n){this.audioConfig=e!==void 0?e:ca.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=r.clone(),this.privConnectionFactory=n,this.implCommonRecognizerSetup()}close(e,r){se.throwIfDisposed(this.privDisposed),dn(this.dispose(!0),e,r)}get internalData(){return this.privReco}dispose(e){return ni(this,void 0,void 0,function*(){this.privDisposed||(this.privDisposed=!0,e&&this.privReco&&(yield this.privReco.audioSource.turnOff(),yield this.privReco.dispose()))})}static get telemetryEnabled(){return Eu.telemetryDataEnabled}static enableTelemetry(e){Eu.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e=typeof window<"u"?"Browser":"Node",r="unknown",n="unknown";typeof navigator<"u"&&(e=e+"/"+navigator.platform,r=navigator.userAgent,n=navigator.appVersion);const i=this.createRecognizerConfig(new CA(new PA(new QW(e,r,n))));this.privReco=this.createServiceRecognizer(mA.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,i)}recognizeOnceAsyncImpl(e){return ni(this,void 0,void 0,function*(){se.throwIfDisposed(this.privDisposed);const r=new Ae;yield this.implRecognizerStop(),yield this.privReco.recognize(e,r.resolve,r.reject);const n=yield r.promise;return yield this.implRecognizerStop(),n})}startContinuousRecognitionAsyncImpl(e){return ni(this,void 0,void 0,function*(){se.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop(),yield this.privReco.recognize(e,void 0,void 0)})}stopContinuousRecognitionAsyncImpl(){return ni(this,void 0,void 0,function*(){se.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop()})}implRecognizerStop(){return ni(this,void 0,void 0,function*(){this.privReco&&(yield this.privReco.stopRecognizing())})}static getAuthFromProperties(e){const r=e.getProperty(j.SpeechServiceConnection_Key,void 0);return r&&r!==""?new OW(r):new _W(i=>{const l=e.getProperty(j.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)},i=>{const l=e.getProperty(j.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)})}};var Re;(function(t){t[t.NoError=0]="NoError",t[t.AuthenticationFailure=1]="AuthenticationFailure",t[t.BadRequestParameters=2]="BadRequestParameters",t[t.TooManyRequests=3]="TooManyRequests",t[t.ConnectionFailure=4]="ConnectionFailure",t[t.ServiceTimeout=5]="ServiceTimeout",t[t.ServiceError=6]="ServiceError",t[t.RuntimeError=7]="RuntimeError"})(Re||(Re={}));var Rc;let wt=class{constructor(){}set applicationId(e){}};wt.DialogTypes=(Rc=class{},Rc.BotFramework="bot_framework",Rc.CustomCommands="custom_commands",Rc);class ii extends wt{constructor(){super(),this.privSpeechConfig=new Nr}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){se.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(e){this.privSpeechConfig.outputFormat=e}setProperty(e,r){this.privSpeechConfig.setProperty(e,r)}getProperty(e,r){return this.privSpeechConfig.getProperty(e)}setProxy(e,r,n,i){this.setProperty(j.SpeechServiceConnection_ProxyHostName,e),this.setProperty(j.SpeechServiceConnection_ProxyPort,`${r}`),n&&this.setProperty(j.SpeechServiceConnection_ProxyUserName,n),i&&this.setProperty(j.SpeechServiceConnection_ProxyPassword,i)}setServiceProperty(e,r,n){this.privSpeechConfig.setServiceProperty(e,r,n)}close(){}}let Ec=class extends ii{constructor(){super()}static fromSubscription(e,r,n){se.throwIfNullOrWhitespace(e,"subscription"),se.throwIfNullOrWhitespace(r,"region");const i=new ii;return i.setProperty(j.Conversation_DialogType,wt.DialogTypes.BotFramework),i.setProperty(j.SpeechServiceConnection_Key,e),i.setProperty(j.SpeechServiceConnection_Region,r),n&&i.setProperty(j.Conversation_ApplicationId,n),i}static fromAuthorizationToken(e,r,n){se.throwIfNullOrWhitespace(e,"authorizationToken"),se.throwIfNullOrWhitespace(r,"region");const i=new ii;return i.setProperty(j.Conversation_DialogType,wt.DialogTypes.BotFramework),i.setProperty(j.SpeechServiceAuthorization_Token,e),i.setProperty(j.SpeechServiceConnection_Region,r),n&&i.setProperty(j.Conversation_ApplicationId,n),i}static fromHost(e,r,n){se.throwIfNullOrUndefined(e,"host");const i=e instanceof URL?e:new URL(`wss://${e}.convai.speech.azure.us`);se.throwIfNullOrUndefined(i,"resolvedHost");const l=new ii;return l.setProperty(j.Conversation_DialogType,wt.DialogTypes.BotFramework),l.setProperty(j.SpeechServiceConnection_Host,i.toString()),r!==void 0&&l.setProperty(j.SpeechServiceConnection_Key,r),l}static fromEndpoint(e,r){se.throwIfNull(e,"endpoint");const n=new ii;return n.setProperty(j.Conversation_DialogType,wt.DialogTypes.BotFramework),n.setProperty(j.SpeechServiceConnection_Endpoint,e.toString()),r!==void 0&&n.setProperty(j.SpeechServiceConnection_Key,r),n}},le=class{};le.BotId="botid";le.CustomSpeechDeploymentId="cid";le.CustomVoiceDeploymentId="deploymentId";le.EnableAudioLogging="storeAudio";le.EnableLanguageId="lidEnabled";le.EnableWordLevelTimestamps="wordLevelTimestamps";le.EndSilenceTimeoutMs="endSilenceTimeoutMs";le.Format="format";le.InitialSilenceTimeoutMs="initialSilenceTimeoutMs";le.Language="language";le.Profanity="profanity";le.RequestBotStatusMessages="enableBotMessageStatus";le.StableIntermediateThreshold="stableIntermediateThreshold";le.StableTranslation="stableTranslation";le.TestHooks="testhooks";let NW=class{setCommonUrlParams(e,r,n){this.setUrlParameter(j.SpeechServiceConnection_EnableAudioLogging,le.EnableAudioLogging,e,r,n),this.setUrlParameter(j.SpeechServiceResponse_RequestWordLevelTimestamps,le.EnableWordLevelTimestamps,e,r,n),this.setUrlParameter(j.SpeechServiceResponse_ProfanityOption,le.Profanity,e,r,n),this.setUrlParameter(j.SpeechServiceConnection_InitialSilenceTimeoutMs,le.InitialSilenceTimeoutMs,e,r,n),this.setUrlParameter(j.SpeechServiceConnection_EndSilenceTimeoutMs,le.EndSilenceTimeoutMs,e,r,n),this.setUrlParameter(j.SpeechServiceResponse_StablePartialResultThreshold,le.StableIntermediateThreshold,e,r,n);const i=JSON.parse(e.parameters.getProperty(dh,"{}"));Object.keys(i).forEach((l,f,c)=>{r[l]=i[l]})}setUrlParameter(e,r,n,i,l){const f=n.parameters.getProperty(e,void 0);f&&(!l||l.search(r)===-1)&&(i[r]=f.toLocaleLowerCase())}};var Oc;class pa extends NW{constructor(){super(...arguments),this.create=(e,r,n)=>{const i=e.parameters.getProperty(j.Conversation_ApplicationId,""),l=e.parameters.getProperty(j.Conversation_DialogType),f=e.parameters.getProperty(j.SpeechServiceConnection_Region),c=e.parameters.getProperty(j.SpeechServiceConnection_RecoLanguage,"en-US"),o=e.parameters.getProperty(j.Conversation_Request_Bot_Status_Messages,"true"),s={};s[be.ConnectionId]=n,s[le.Format]=e.parameters.getProperty(hh,Ur[Ur.Simple]).toLowerCase(),s[le.Language]=c,s[le.RequestBotStatusMessages]=o,i&&(s[le.BotId]=i,l===wt.DialogTypes.CustomCommands&&(s[be.CustomCommandsAppId]=i));const a=l===wt.DialogTypes.CustomCommands?"commands/":"",u=l===wt.DialogTypes.CustomCommands?"v1":l===wt.DialogTypes.BotFramework?"v3":"v0",p={};r.token!=null&&r.token!==""&&(p[r.headerName]=r.token);let v=e.parameters.getProperty(j.SpeechServiceConnection_Endpoint,"");if(!v){const h=f&&f.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",d=e.parameters.getProperty(j.SpeechServiceConnection_Host,`wss://${f}.${pa.Constants.BaseUrl}${h}`);v=`${d.endsWith("/")?d:d+"/"}${a}${pa.Constants.ApiKey}/${u}`}this.setCommonUrlParams(e,s,v);const g=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new DH(v,s,p,new YW,kH.fromRecognizerConfig(e),g,n)}}}pa.Constants=(Oc=class{},Oc.ApiKey="api",Oc.BaseUrl="convai.speech",Oc);var iS=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let LW=class extends zW{constructor(e,r){const n=e;se.throwIfNull(e,"dialogConfig"),super(r,n.properties,new pa),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=n.properties.clone();const i=this.buildAgentConfig();this.privReco.agentConfig.set(i)}connect(e,r){dn(this.privReco.connect(),e,r)}disconnect(e,r){dn(this.privReco.disconnect(),e,r)}get authorizationToken(){return this.properties.getProperty(j.SpeechServiceAuthorization_Token)}set authorizationToken(e){se.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(j.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(j.Conversation_Speech_Activity_Template)}set speechActivityTemplate(e){this.properties.setProperty(j.Conversation_Speech_Activity_Template,e)}listenOnceAsync(e,r){if(this.isTurnComplete){se.throwIfDisposed(this.privIsDisposed);const i=iS(this,void 0,void 0,function*(){yield this.privReco.connect(),yield this.implRecognizerStop(),this.isTurnComplete=!1;const l=new Ae;yield this.privReco.recognize(Lr.Conversation,l.resolve,l.reject);const f=yield l.promise;return yield this.implRecognizerStop(),f});i.catch(()=>{this.dispose(!0).catch(()=>{})}),dn(i.finally(()=>{this.isTurnComplete=!0}),e,r)}}sendActivityAsync(e,r,n){dn(this.privReco.sendMessage(e),r,n)}close(e,r){se.throwIfDisposed(this.privIsDisposed),dn(this.dispose(!0),e,r)}dispose(e){const r=Object.create(null,{dispose:{get:()=>super.dispose}});return iS(this,void 0,void 0,function*(){this.privIsDisposed||e&&(this.privIsDisposed=!0,yield this.implRecognizerStop(),yield r.dispose.call(this,e))})}createRecognizerConfig(e){return new GW(e,this.privProperties)}createServiceRecognizer(e,r,n,i){const l=n;return new cH(e,r,l,i,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(j.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(j.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(j.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(j.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}},BW=class{constructor(e,r){this.privActivity=e,this.privAudioStream=r}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};class Md{constructor(e){this.privMessageStatusResponse=JSON.parse(e)}static fromJSON(e){return new Md(e)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}let qW=class{constructor(e){this.privTurnStatus=Md.fromJSON(e)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};var lh;(function(t){t[t.Masked=0]="Masked",t[t.Removed=1]="Removed",t[t.Raw=2]="Raw"})(lh||(lh={}));let _c=class{constructor(e,r,n,i,l){this.privResultId=e,this.privReason=r,this.privAudioData=n,this.privErrorDetails=i,this.privProperties=l}get resultId(){return this.privResultId}get reason(){return this.privReason}get audioData(){return this.privAudioData}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}},Ac=class{constructor(e){this.privResult=e}get result(){return this.privResult}},FW=class{constructor(e,r,n,i){this.privAudioOffset=e,this.privText=r,this.privWordLength=n,this.privTextOffset=i}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}},UW=class{constructor(e,r){this.privAudioOffset=e,this.privText=r}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}},VW=class{constructor(e,r,n){this.privAudioOffset=e,this.privVisemeId=r,this.privAnimation=n}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};var xf=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};const WW=60*30,oS={[J.PCM]:"audio/wav",[J.MuLaw]:"audio/x-wav",[J.MP3]:"audio/mpeg",[J.OGG_OPUS]:"audio/ogg",[J.WEBM_OPUS]:"audio/webm; codecs=opus",[J.ALaw]:"audio/x-wav"};let sS=class{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||ge(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,r,n){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then(()=>{r&&r()},i=>{n&&n(i)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,r){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{e&&e()},n=>{r&&r(n)});else if(this.privAudioOutputStream!==void 0)if((this.privFormat.formatTag===J.PCM||this.privFormat.formatTag===J.MuLaw||this.privFormat.formatTag===J.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let n=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(n).then(i=>{n=$d.addHeader(n,this.privFormat);const l=new Blob([n],{type:oS[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(l),this.notifyPlayback().then(()=>{e&&e()},f=>{r&&r(f)})},i=>{r&&r(i)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if(typeof AudioContext<"u"||typeof window.webkitAudioContext<"u"){this.privFormat=e;const r=oS[this.privFormat.formatTag];r===void 0?console.warn(`Unknown mimeType for format ${J[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(r)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=n=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=WW,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(r),this.privSourceBuffer.onupdate=i=>{this.updateSourceBuffer().catch(l=>{xe.instance.onEvent(new Fr(l))})},this.privSourceBuffer.onupdateend=i=>{this.handleSourceBufferUpdateEnd().catch(l=>{xe.instance.onEvent(new Fr(l))})},this.privSourceBuffer.onupdatestart=i=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(n=>{xe.instance.onEvent(new Fr(n))})):(console.warn(`Format ${J[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new Td,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,r){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{e&&e()},n=>{r&&r(n)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){return xf(this,void 0,void 0,function*(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch{this.privAudioBuffer.unshift(e),console.log("buffer filled, pausing addition of binaries until space is made");return}yield this.notifyPlayback()}else this.canEndStream()&&(yield this.handleSourceBufferUpdateEnd())})}handleSourceBufferUpdateEnd(){return xf(this,void 0,void 0,function*(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),yield this.notifyPlayback())})}notifyPlayback(){return xf(this,void 0,void 0,function*(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||(yield this.privAudio.play()))})}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}},sp=class extends gr{constructor(e,r,n,i=ae.Info){super(e,i),this.privRequestId=r,this.privSessionId=n}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}};class SA extends sp{constructor(e,r,n,i){super("RecognitionTriggeredEvent",e,r),this.privAudioSourceId=n,this.privAudioNodeId=i}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class HW extends sp{constructor(e,r,n,i){super("ListeningStartedEvent",e,r),this.privAudioSourceId=n,this.privAudioNodeId=i}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class bA extends sp{constructor(e,r,n){super("ConnectingToServiceEvent",e,n),this.privAuthFetchEventid=r}get authFetchEventid(){return this.privAuthFetchEventid}}class KW extends sp{constructor(e,r,n,i,l){super("RecognitionStartedEvent",e,l),this.privAudioSourceId=r,this.privAudioNodeId=n,this.privAuthFetchEventId=i}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}var aS;(function(t){t[t.Success=0]="Success",t[t.AudioSourceError=1]="AudioSourceError",t[t.AudioSourceTimeout=2]="AudioSourceTimeout",t[t.AuthTokenFetchError=3]="AuthTokenFetchError",t[t.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",t[t.UnAuthorized=5]="UnAuthorized",t[t.ConnectTimeout=6]="ConnectTimeout",t[t.ConnectError=7]="ConnectError",t[t.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",t[t.UnknownError=9]="UnknownError"})(aS||(aS={}));class ke extends uh{constructor(e,r,n,i,l,f,c,o){if(!r)throw new Ne("path");if(!n)throw new Ne("requestId");const s={};if(s[be.Path]=r,s[be.RequestId]=n,s[be.RequestTimestamp]=new Date().toISOString(),i&&(s[be.ContentType]=i),f&&(s[be.RequestStreamId]=f),c)for(const a in c)a&&(s[a]=c[a]);o?super(e,l,s,o):super(e,l,s),this.privPath=r,this.privRequestId=n,this.privContentType=i,this.privStreamId=f,this.privAdditionalHeaders=c}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}}ke.fromConnectionMessage=t=>{let e=null,r=null,n=null,i=null;const l={};if(t.headers)for(const f in t.headers)f&&(f.toLowerCase()===be.Path.toLowerCase()?e=t.headers[f]:f.toLowerCase()===be.RequestId.toLowerCase()?r=t.headers[f]:f.toLowerCase()===be.RequestTimestamp.toLowerCase()?t.headers[f]:f.toLowerCase()===be.ContentType.toLowerCase()?n=t.headers[f]:f.toLowerCase()===be.RequestStreamId.toLowerCase()?i=t.headers[f]:l[f]=t.headers[f]);return new ke(t.messageType,e,r,n,t.body,i,l,t.id)};var Me=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let Eu=class Hs{constructor(e,r,n,i,l){if(this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendSpeechContext=f=>{const c=this.speechContext.toJSON();if(c)return f.send(new ke(ee.Text,"speech.context",this.privRequestSession.requestId,"application/json",c))},this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.sendSpeechServiceConfig=(f,c,o)=>{if(Hs.telemetryDataEnabled!==!0){const a={context:{system:JSON.parse(o).context.system}};o=JSON.stringify(a)}if(this.privRecognizerConfig.parameters.getProperty("TranscriptionService_SingleChannel","false").toLowerCase()==="true"){const s=JSON.parse(o);s.context.DisableReferenceChannel="True",s.context.MicSpec="1_0_0",o=JSON.stringify(s)}if(o)return f.send(new ke(ee.Text,"speech.config",c.requestId,"application/json",o))},!e)throw new Ne("authentication");if(!r)throw new Ne("connectionFactory");if(!n)throw new Ne("audioSource");if(!i)throw new Ne("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=r,this.privAudioSource=n,this.privRecognizerConfig=i,this.privIsDisposed=!1,this.privRecognizer=l,this.privRequestSession=new nH(this.privAudioSource.id()),this.privConnectionEvents=new Et,this.privServiceEvents=new Et,this.privDynamicGrammar=new oH,this.privSpeechContext=new iH(this.privDynamicGrammar),this.privAgentConfig=new _A,typeof Blob<"u"&&typeof Worker<"u"&&(this.privSetTimeout=_e.setTimeout),this.connectionEvents.attach(f=>Me(this,void 0,void 0,function*(){if(f.name==="ConnectionClosedEvent"){const c=f;(c.statusCode===1003||c.statusCode===1007||c.statusCode===1002||c.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&(yield this.cancelRecognitionLocal(Fe.Error,c.statusCode===1007?Re.BadRequestParameters:Re.ConnectionFailure,c.reason+" websocket error code: "+c.statusCode))}}))}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(j.ConversationTranslator_Token,e)}set authentication(e){this.privAuthentication=this.authentication}isDisposed(){return this.privIsDisposed}dispose(e){return Me(this,void 0,void 0,function*(){if(this.privIsDisposed=!0,this.privConnectionConfigurationPromise)try{yield(yield this.privConnectionConfigurationPromise).dispose(e)}catch{return}})}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,r,n){return Me(this,void 0,void 0,function*(){if(this.recognizeOverride!==void 0)return this.recognizeOverride(e,r,n);this.privConnectionConfigurationPromise=null,this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=r,this.privErrorCallback=n,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const i=this.connectImpl();let l;try{const o=yield this.audioSource.attach(this.privRequestSession.audioNodeId),s=yield this.audioSource.format,a=yield this.audioSource.deviceInfo;this.privIsLiveAudio=a.type&&a.type===Wr.Microphones,l=new LA(o,s.avgBytesPerSec),yield this.privRequestSession.onAudioSourceAttachCompleted(l,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:a}}catch(o){throw yield this.privRequestSession.onStopRecognizing(),o}try{yield i}catch(o){yield this.cancelRecognitionLocal(Fe.Error,Re.ConnectionFailure,o);return}const f=new ua(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,f),this.receiveMessage(),this.sendAudio(l).catch(o=>Me(this,void 0,void 0,function*(){yield this.cancelRecognitionLocal(Fe.Error,Re.RuntimeError,o)}))})}stopRecognizing(){return Me(this,void 0,void 0,function*(){if(this.privRequestSession.isRecognizing)try{yield this.audioSource.turnOff(),yield this.sendFinalAudio(),yield this.privRequestSession.onStopRecognizing(),yield this.privRequestSession.turnCompletionPromise}finally{yield this.privRequestSession.dispose()}})}connect(){return Me(this,void 0,void 0,function*(){return yield this.connectImpl(),Promise.resolve()})}connectAsync(e,r){this.connectImpl().then(n=>{try{e&&e()}catch(i){r&&r(i)}},n=>{try{r&&r(n)}catch{}})}disconnect(){return Me(this,void 0,void 0,function*(){yield this.cancelRecognitionLocal(Fe.Error,Re.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&(yield this.disconnectOverride());try{yield(yield this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=null})}sendMessage(e){}sendNetworkMessage(e,r){return Me(this,void 0,void 0,function*(){const n=typeof r=="string"?ee.Text:ee.Binary,i=typeof r=="string"?"application/json":"";return(yield this.fetchConnection()).send(new ke(n,e,this.privRequestSession.requestId,i,r))})}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}sendTelemetryData(){return Me(this,void 0,void 0,function*(){const e=this.privRequestSession.getTelemetry();if(Hs.telemetryDataEnabled!==!0||this.privIsDisposed||e===null)return;if(Hs.telemetryData)try{Hs.telemetryData(e)}catch{}yield(yield this.fetchConnection()).send(new ke(ee.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))})}cancelRecognitionLocal(e,r,n){return Me(this,void 0,void 0,function*(){this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,r,n))})}receiveMessage(){return Me(this,void 0,void 0,function*(){try{if(this.privIsDisposed)return;let e=yield this.fetchConnection();const r=yield e.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!r)return this.privRequestSession.isRecognizing?this.receiveMessage():void 0;this.privServiceHasSentMessage=!0;const n=ke.fromConnectionMessage(r);if(n.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(n.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const i=Ou.fromJSON(n.textBody),l=new In(i.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,l);break;case"speech.enddetected":let f;n.textBody.length>0?f=n.textBody:f="{ Offset: 0 }";const c=Ou.fromJSON(f);this.privRecognizerConfig.isContinuousRecognition&&this.privRequestSession.onServiceRecognized(c.Offset+this.privRequestSession.currentTurnAudioOffset);const o=new In(c.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,o);break;case"turn.end":yield this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,yield this.cancelRecognitionLocal(Fe.EndOfStream,Re.NoError,void 0));const s=new ua(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,s);return}else e=yield this.fetchConnection(),yield this.sendPrePayloadJSON(e);break;default:(yield this.processTypeSpecificMessages(n))||this.privServiceEvents&&this.serviceEvents.onEvent(new Rd(n.path.toLowerCase(),n.textBody))}return this.receiveMessage()}catch{return null}})}sendPrePayloadJSON(e){return Me(this,void 0,void 0,function*(){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(e);yield this.sendSpeechContext(e),yield this.sendWaveHeader(e)})}sendWaveHeader(e){return Me(this,void 0,void 0,function*(){const r=yield this.audioSource.format;return e.send(new ke(ee.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",r.header))})}connectImpl(){return this.privConnectionPromise?this.privConnectionPromise.then(e=>e.state()===$e.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,e=>(this.privConnectionId=null,this.privConnectionPromise=null,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}fetchConnection(){return Me(this,void 0,void 0,function*(){return this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then(e=>e.state()===$e.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=null,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,e=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=null,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)})}sendAudio(e){return Me(this,void 0,void 0,function*(){const r=yield this.audioSource.format;let n=Date.now();const i=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),l=r.avgBytesPerSec/1e3*parseInt(i,10),f=this.privRequestSession.recogNumber,c=()=>Me(this,void 0,void 0,function*(){if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===f){const o=yield this.fetchConnection(),s=yield e.read();if(this.privRequestSession.isSpeechEnded)return;let a,u;if(!s||s.isEnd?(a=null,u=0):(a=s.buffer,this.privRequestSession.onAudioSent(a.byteLength),l>=this.privRequestSession.bytesSent?u=0:u=Math.max(0,n-Date.now())),u!==0&&(yield this.delay(u)),a!==null&&(n=Date.now()+a.byteLength*1e3/(r.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===f)if(o.send(new ke(ee.Binary,"audio",this.privRequestSession.requestId,null,a)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),s!=null&&s.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return c()}});return c()})}retryableConnect(){return Me(this,void 0,void 0,function*(){let e=!1;this.privAuthFetchEventId=ge();const r=this.privRequestSession.sessionId;this.privConnectionId=r!==void 0?r:ge(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let n=0,i="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const f=yield e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);yield this.privRequestSession.onAuthCompleted(!1);const c=this.privConnectionFactory.create(this.privRecognizerConfig,f,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(c.events),c.events.attach(s=>{this.connectionEvents.onEvent(s)});const o=yield c.open();if(o.statusCode===200)return yield this.privRequestSession.onConnectionEstablishCompleted(o.statusCode),Promise.resolve(c);o.statusCode===1006&&(e=!0),n=o.statusCode,i=o.reason,this.privRequestSession.onRetryConnection()}return yield this.privRequestSession.onConnectionEstablishCompleted(n,i),Promise.reject(`Unable to contact server. StatusCode: ${n}, ${this.privRecognizerConfig.parameters.getProperty(j.SpeechServiceConnection_Endpoint)} Reason: ${i}`)})}delay(e){return new Promise((r,n)=>{this.privSetTimeout(r,e)})}writeBufferToConsole(e){let r="Buffer Size: ";if(e===null)r+="null";else{const n=new Uint8Array(e);r+=e.byteLength+`\r
`;for(let i=0;i<e.byteLength;i++)r+=n[i].toString(16).padStart(2,"0")+" "}console.info(r)}sendFinalAudio(){return Me(this,void 0,void 0,function*(){yield(yield this.fetchConnection()).send(new ke(ee.Binary,"audio",this.privRequestSession.requestId,null,null))})}configureConnection(){return Me(this,void 0,void 0,function*(){const e=yield this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendPrePayloadJSON(e),e)})}};Eu.telemetryDataEnabled=!0;var Lr;(function(t){t[t.Interactive=0]="Interactive",t[t.Conversation=1]="Conversation",t[t.Dictation=2]="Dictation"})(Lr||(Lr={}));var cS;(function(t){t[t.Simple=0]="Simple",t[t.Detailed=1]="Detailed"})(cS||(cS={}));let GW=class{constructor(e,r){this.privRecognitionMode=Lr.Interactive,this.privSpeechServiceConfig=e||new CA(new PA(null)),this.privParameters=r,this.privMaxRetryCount=parseInt(r.getProperty("SPEECH-Error-MaxRetryCount","4"),10)}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===Lr.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=Lr[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==Lr.Interactive}get autoDetectSourceLanguages(){return this.parameters.getProperty(j.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get maxRetryCount(){return this.privMaxRetryCount}};class CA{constructor(e){this.serialize=()=>JSON.stringify(this,(r,n)=>{if(n&&typeof n=="object"){const i={};for(const l in n)Object.hasOwnProperty.call(n,l)&&(i[l&&l.charAt(0).toLowerCase()+l.substring(1)]=n[l]);return i}return n}),this.context=e}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}}class PA{constructor(e){this.system=new JW,this.os=e}}class JW{constructor(){const e="1.17.0";this.name="SpeechSDK",this.version=e,this.build="JavaScript",this.lang="JavaScript"}}class QW{constructor(e,r,n){this.platform=e,this.name=r,this.version=n}}var Tn;(function(t){t.Bluetooth="Bluetooth",t.Wired="Wired",t.WiFi="WiFi",t.Cellular="Cellular",t.InBuilt="InBuilt",t.Unknown="Unknown"})(Tn||(Tn={}));var Wr;(function(t){t.Phone="Phone",t.Speaker="Speaker",t.Car="Car",t.Headset="Headset",t.Thermostat="Thermostat",t.Microphones="Microphones",t.Deskphone="Deskphone",t.RemoteControl="RemoteControl",t.Unknown="Unknown",t.File="File",t.Stream="Stream"})(Wr||(Wr={}));const uS=`\r
`;let YW=class{constructor(){this.toConnectionMessage=e=>{const r=new Ae;try{if(e.messageType===ee.Text){const n=e.textContent;let i={},l=null;if(n){const f=n.split(`\r
\r
`);f&&f.length>0&&(i=this.parseHeaders(f[0]),f.length>1&&(l=f[1]))}r.resolve(new uh(e.messageType,l,i,e.id))}else if(e.messageType===ee.Binary){const n=e.binaryContent;let i={},l=null;if(!n||n.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const f=new DataView(n),c=f.getInt16(0);if(n.byteLength<c+2)throw new Error("Invalid binary message format. Header content missing.");let o="";for(let s=0;s<c;s++)o+=String.fromCharCode(f.getInt8(s+2));i=this.parseHeaders(o),n.byteLength>c+2&&(l=n.slice(2+c)),r.resolve(new uh(e.messageType,l,i,e.id))}}catch(n){r.reject(`Error formatting the message. Error: ${n}`)}return r.promise},this.fromConnectionMessage=e=>{const r=new Ae;try{if(e.messageType===ee.Text){const n=`${this.makeHeaders(e)}${uS}${e.textBody?e.textBody:""}`;r.resolve(new wu(ee.Text,n,e.id))}else if(e.messageType===ee.Binary){const n=this.makeHeaders(e),i=e.binaryBody,l=this.stringToArrayBuffer(n),f=new Int8Array(l),c=f.byteLength,o=new Int8Array(2+c+(i?i.byteLength:0));if(o[0]=c>>8&255,o[1]=c&255,o.set(f,2),i){const a=new Int8Array(i);o.set(a,2+c)}const s=o.buffer;r.resolve(new wu(ee.Binary,s,e.id))}}catch(n){r.reject(`Error formatting the message. ${n}`)}return r.promise},this.makeHeaders=e=>{let r="";if(e.headers)for(const n in e.headers)n&&(r+=`${n}: ${e.headers[n]}${uS}`);return r},this.parseHeaders=e=>{const r={};if(e){const n=e.match(/[^\r\n]+/g);if(r){for(const i of n)if(i){const l=i.indexOf(":"),f=l>0?i.substr(0,l).trim().toLowerCase():i,c=l>0&&i.length>l+1?i.substr(l+1).trim():"";r[f]=c}}}return r},this.stringToArrayBuffer=e=>{const r=new ArrayBuffer(e.length),n=new DataView(r);for(let i=0;i<e.length;i++)n.setUint8(i,e.charCodeAt(i));return r}}},XW=class{static implTranslateRecognitionResult(e){let r=Xe.Canceled;switch(e){case De.Success:r=Xe.RecognizedSpeech;break;case De.NoMatch:case De.InitialSilenceTimeout:case De.BabbleTimeout:case De.EndOfDictation:r=Xe.NoMatch;break;case De.Error:default:r=Xe.Canceled;break}return r}static implTranslateCancelResult(e){let r=Fe.EndOfStream;switch(e){case De.Success:case De.EndOfDictation:case De.NoMatch:r=Fe.EndOfStream;break;case De.InitialSilenceTimeout:case De.BabbleTimeout:case De.Error:default:r=Fe.Error;break}return r}static implTranslateCancelErrorCode(e){let r=Re.NoError;switch(e){case De.Error:r=Re.ServiceError;break;case De.TooManyRequests:r=Re.TooManyRequests;break;default:r=Re.NoError;break}return r}};var pS;(function(t){t[t.Success=0]="Success",t[t.SynthesisEnd=1]="SynthesisEnd",t[t.Error=2]="Error"})(pS||(pS={}));var De;(function(t){t[t.Success=0]="Success",t[t.NoMatch=1]="NoMatch",t[t.InitialSilenceTimeout=2]="InitialSilenceTimeout",t[t.BabbleTimeout=3]="BabbleTimeout",t[t.Error=4]="Error",t[t.EndOfDictation=5]="EndOfDictation",t[t.TooManyRequests=6]="TooManyRequests"})(De||(De={}));let Ou=class wA{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new wA(e)}get Offset(){return this.privSpeechStartDetected.Offset}},ZW=class RA{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new RA(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}},eH=class EA{constructor(e){this.privSpeechKeyword=JSON.parse(e)}static fromJSON(e){return new EA(e)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}},tH=class OA{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=De[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new OA(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}};class rH{constructor(e,r,n){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.onEvent=i=>{this.privIsDisposed||(i instanceof SA&&i.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:i.eventTime,Name:"ListeningTrigger",Start:i.eventTime}),i instanceof $a&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof ka&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof Cu&&i.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof wd&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof Jt&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Name:"Microphone",Start:this.privMicStartTime})),i instanceof bA&&i.requestId===this.privRequestId&&(this.privConnectionId=i.sessionId),i instanceof aA&&i.connectionId===this.privConnectionId&&(this.privConnectionStartTime=i.eventTime),i instanceof cA&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof oW&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Error:this.getConnectionError(i.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof ch&&i.connectionId===this.privConnectionId&&i.message&&i.message.headers&&i.message.headers.path&&(this.privReceivedMessages[i.message.headers.path]||(this.privReceivedMessages[i.message.headers.path]=new Array),this.privReceivedMessages[i.message.headers.path].push(i.networkReceivedTime)))},this.getTelemetry=()=>{const i=new Array;this.privListeningTriggerMetric&&i.push(this.privListeningTriggerMetric),this.privMicMetric&&i.push(this.privMicMetric),this.privConnectionEstablishMetric&&i.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&i.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&i.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const l={Metrics:i,ReceivedMessages:this.privReceivedMessages},f=JSON.stringify(l);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],f},this.dispose=()=>{this.privIsDisposed=!0},this.getConnectionError=i=>{switch(i){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+i.toString()}},this.privRequestId=e,this.privAudioSourceId=r,this.privAudioNodeId=n,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}}var ar=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let nH=class{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.onPreConnectionStart=(r,n)=>{this.privAuthFetchEventId=r,this.privSessionId=n,this.onEvent(new bA(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))},this.onServiceTurnStartResponse=()=>{this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Ae},this.getTelemetry=()=>this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null,this.onEvent=r=>{this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(r),xe.instance.onEvent(r)},this.privAudioSourceId=e,this.privRequestId=ge(),this.privAudioNodeId=ge(),this.privTurnDeferral=new Ae,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRequestId=ge(),this.privRecogNumber++,this.privServiceTelemetryListener=new rH(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new SA(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onAudioSourceAttachCompleted(e,r,n){return ar(this,void 0,void 0,function*(){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,r?yield this.onComplete():this.onEvent(new HW(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))})}onAuthCompleted(e,r){return ar(this,void 0,void 0,function*(){e&&(yield this.onComplete())})}onConnectionEstablishCompleted(e,r){return ar(this,void 0,void 0,function*(){if(e===200){this.onEvent(new KW(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else e===403&&(yield this.onComplete())})}onServiceTurnEndResponse(e){return ar(this,void 0,void 0,function*(){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(yield this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privRequestId=ge(),this.privAudioNode.replay())})}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}dispose(e){return ar(this,void 0,void 0,function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const r of this.privDetachables)yield r.detach();this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}})}onStopRecognizing(){return ar(this,void 0,void 0,function*(){yield this.onComplete()})}onSpeechEnded(){this.privIsSpeechEnded=!0}onComplete(){return ar(this,void 0,void 0,function*(){this.privIsRecognizing&&(this.privIsRecognizing=!1,yield this.detachAudioNode())})}detachAudioNode(){return ar(this,void 0,void 0,function*(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&(yield this.privAudioNode.detach()))})}},iH=class{constructor(e){this.privContext={},this.privDynamicGrammar=e}setSection(e,r){this.privContext[e]=r}setPronunciationAssessmentParams(e){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e),this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.format="Detailed",this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")===-1&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}toJSON(){const e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)}},oH=class{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const e={};if(e.ReferenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const r=[];this.privPhrases.forEach((n,i,l)=>{r.push({Text:n})}),e.Groups=[{Type:"Generic",Items:r}]}return e}};class Dd{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new Dd(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}var vh;(function(t){t[t.None=0]="None",t[t.TextToSpeechAudio=1]="TextToSpeechAudio"})(vh||(vh={}));let sH=class{constructor(e,r){this.privRequestId=r,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,r){return e.messageDataStreamType===vh.TextToSpeechAudio&&(this.privAudioStream=Ad.createPullStream(),this.privAudioStream.format=r!==void 0?r:X.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}},aH=class{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new Ye("Service error: There is already a turn with id:"+e);const r=new sH(this,e);return this.privTurnMap.set(e,r),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new Ye("Service error: Received turn end for an unknown turn id:"+e);const r=this.privTurnMap.get(e);return r.complete(),this.privTurnMap.delete(e),r}};var mt=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let cH=class extends Eu{constructor(e,r,n,i,l){super(e,r,n,i,l),this.sendAgentConfig=f=>{if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(j.Conversation_DialogType)===wt.DialogTypes.CustomCommands){const o=this.agentConfig.get();o.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(j.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(o)}this.onEvent(new cW(this.agentConfig));const c=this.agentConfig.toJsonString();return this.agentConfigSent=!0,f.send(new ke(ee.Text,"agent.config",this.privRequestSession.requestId,"application/json",c))}},this.sendAgentContext=f=>{const c=ah(),o=this.privDialogServiceConnector.properties.getProperty(j.Conversation_Speech_Activity_Template),a=JSON.stringify({channelData:"",context:{interactionId:c},messagePayload:typeof o===void 0?void 0:o,version:.5});return f.send(new ke(ee.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",a))},this.handleResponseMessage=f=>{const c=JSON.parse(f.textBody);switch(c.messageType.toLowerCase()){case"message":const o=f.requestId.toUpperCase(),s=Dd.fromJSON(f.textBody),a=this.privTurnStateManager.GetTurn(o);if(s.conversationId){const v=this.agentConfig.get();v.botInfo.conversationId=s.conversationId,this.agentConfig.set(v)}const u=a.processActivityPayload(s,X.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(j.SpeechServiceConnection_SynthOutputFormat,void 0))),p=new BW(s.messagePayload,u);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,p)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new qW(f.textBody))}catch{}break;default:xe.instance.onEvent(new Fr(`Unexpected response of type ${c.messageType}. Ignoring.`));break}},this.privEvents=new Et,this.privDialogServiceConnector=l,this.receiveMessageOverride=this.receiveDialogMessageOverride,this.privTurnStateManager=new aH,this.recognizeOverride=this.listenOnce,this.postConnectImplOverride=this.dialogConnectImpl,this.configConnectionOverride=this.configConnection,this.disconnectOverride=this.privDisconnect,this.privDialogAudioSource=n,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(f=>mt(this,void 0,void 0,function*(){f.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)}))}sendMessage(e){return mt(this,void 0,void 0,function*(){const r=ah(),n=ge(),i={context:{interactionId:r},messagePayload:JSON.parse(e),version:.5},l=JSON.stringify(i);yield(yield this.fetchConnection()).send(new ke(ee.Text,"agent",n,"application/json",l))})}privDisconnect(){return mt(this,void 0,void 0,function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Fe.Error,Re.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1})}processTypeSpecificMessages(e){return mt(this,void 0,void 0,function*(){const r=new Ru;e.messageType===ee.Text&&r.setProperty(j.SpeechServiceResponse_JsonResult,e.textBody);let n,i;switch(e.path.toLowerCase()){case"speech.phrase":const l=tH.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+l.Offset+l.Duration),l.RecognitionStatus!==De.TooManyRequests&&l.RecognitionStatus!==De.Error){const u=this.fireEventForResult(l,r);if(this.privLastResult=u.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,u)}catch{}}i=!0;break;case"speech.hypothesis":const f=ZW.fromJSON(e.textBody),c=f.Offset+this.privRequestSession.currentTurnAudioOffset;n=new wc(this.privRequestSession.requestId,Xe.RecognizingSpeech,f.Text,f.Duration,c,f.Language,f.LanguageDetectionConfidence,void 0,void 0,e.textBody,r),this.privRequestSession.onHypothesis(c);const o=new kf(n,f.Duration,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,o)}catch{}i=!0;break;case"speech.keyword":const s=eH.fromJSON(e.textBody);n=new wc(this.privRequestSession.requestId,s.Status==="Accepted"?Xe.RecognizedKeyword:Xe.NoMatch,s.Text,s.Duration,s.Offset,void 0,void 0,void 0,void 0,e.textBody,r),s.Status!=="Accepted"&&(this.privLastResult=n);const a=new kf(n,n.duration,n.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,a)}catch{}i=!0;break;case"audio":{const u=e.requestId.toUpperCase(),p=this.privTurnStateManager.GetTurn(u);try{e.binaryBody?p.audioStream.write(e.binaryBody):p.endAudioStream()}catch{}}i=!0;break;case"response":this.handleResponseMessage(e),i=!0;break}return i})}cancelRecognition(e,r,n,i,l){return mt(this,void 0,void 0,function*(){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing()),this.privDialogServiceConnector.canceled){const f=new Ru;f.setProperty(TA,Re[i]);const c=new xW(n,l,i,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,c)}catch{}if(this.privSuccessCallback){const o=new wc(void 0,Xe.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,l,void 0,f);try{this.privSuccessCallback(o),this.privSuccessCallback=void 0}catch{}}}})}listenOnce(e,r,n){return mt(this,void 0,void 0,function*(){this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=r,this.privErrorCallback=n,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(j.Speech_SessionId,this.privRequestSession.sessionId);const i=this.connectImpl(),l=this.sendPreAudioMessages(),f=yield this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),c=yield this.privDialogAudioSource.format,o=yield this.privDialogAudioSource.deviceInfo,s=new LA(f,c.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(s,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:o};try{yield i,yield l}catch(p){return yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Fe.Error,Re.ConnectionFailure,p),Promise.resolve()}const a=new ua(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,a),this.sendAudio(s).then(()=>{},p=>mt(this,void 0,void 0,function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Fe.Error,Re.RuntimeError,p)}))})}dialogConnectImpl(e){return this.privConnectionLoop=this.startMessageLoop(),e}receiveDialogMessageOverride(){const e=new Ae,r=()=>mt(this,void 0,void 0,function*(){try{const n=this.isDisposed(),i=!this.isDisposed()&&this.terminateMessageLoop;if(n||i){e.resolve(void 0);return}const f=yield(yield this.fetchConnection()).read();if(!f)return r();const c=ke.fromConnectionMessage(f);switch(c.path.toLowerCase()){case"turn.start":{const g=c.requestId.toUpperCase(),h=this.privRequestSession.requestId.toUpperCase();g!==h?this.privTurnStateManager.StartTurn(g):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const s=Ou.fromJSON(c.textBody),a=new In(s.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,a);break;case"speech.enddetected":let u;c.textBody.length>0?u=c.textBody:u="{ Offset: 0 }";const p=Ou.fromJSON(u);this.privRequestSession.onServiceRecognized(p.Offset+this.privRequestSession.currentTurnAudioOffset);const v=new In(p.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,v);break;case"turn.end":{const g=c.requestId.toUpperCase(),h=this.privRequestSession.requestId.toUpperCase();if(g!==h)this.privTurnStateManager.CompleteTurn(g);else{const d=new ua(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,d),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(y){this.privErrorCallback&&this.privErrorCallback(y)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:this.processTypeSpecificMessages(c)||this.serviceEvents&&this.serviceEvents.onEvent(new Rd(c.path.toLowerCase(),c.textBody))}return r()}catch{this.terminateMessageLoop=!0,e.resolve()}});return r().catch(n=>{xe.instance.onEvent(new Fr(n))}),e.promise}startMessageLoop(){return mt(this,void 0,void 0,function*(){this.terminateMessageLoop=!1;try{yield this.receiveDialogMessageOverride()}catch(e){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Fe.Error,Re.RuntimeError,e)}return Promise.resolve()})}configConnection(e){return mt(this,void 0,void 0,function*(){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendAgentConfig(e),e)})}sendPreAudioMessages(){return mt(this,void 0,void 0,function*(){const e=yield this.fetchConnection();this.addKeywordContextData(),yield this.sendSpeechContext(e),yield this.sendAgentContext(e),yield this.sendWaveHeader(e)})}fireEventForResult(e,r){const n=XW.implTranslateRecognitionResult(e.RecognitionStatus),i=e.Offset+this.privRequestSession.currentTurnAudioOffset,l=new wc(this.privRequestSession.requestId,n,e.DisplayText,e.Duration,i,e.Language,e.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(e),r);return new kf(l,i,this.privRequestSession.sessionId)}onEvent(e){this.privEvents.onEvent(e),xe.instance.onEvent(e)}addKeywordContextData(){const e=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(e===void 0)return;const r=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),n=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),i=e.split(";"),l=r===void 0?[]:r.split(";"),f=n===void 0?[]:n.split(";"),c=[];for(let o=0;o<i.length;o++){const s={};s.text=i[o],o<l.length&&(s.offset=Number(l[o])),o<f.length&&(s.duration=Number(f[o])),c.push(s)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:c,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}},_A=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}};var ta;(function(t){t.WordBoundary="WordBoundary",t.Bookmark="Bookmark",t.Viseme="Viseme"})(ta||(ta={}));let uH=class AA{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new AA(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}};var qt=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let $d=class IA{constructor(e,r,n,i,l){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.sendSynthesisContext=f=>{const c=this.synthesisContext.toJSON();if(c)return f.send(new ke(ee.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",c))},this.sendSpeechServiceConfig=(f,c)=>{if(c)return f.send(new ke(ee.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",c))},this.sendSsmlMessage=(f,c,o)=>f.send(new ke(ee.Text,"ssml",o,"application/ssml+xml",c)),!e)throw new Ne("authentication");if(!r)throw new Ne("connectionFactory");if(!n)throw new Ne("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=r,this.privSynthesizerConfig=n,this.privIsDisposed=!1,this.privSpeechSynthesizer=i,this.privSessionAudioDestination=l,this.privSynthesisTurn=new vH,this.privConnectionEvents=new Et,this.privServiceEvents=new Et,this.privSynthesisContext=new hH(this.privSpeechSynthesizer),this.privAgentConfig=new _A,this.connectionEvents.attach(f=>{if(f.name==="ConnectionClosedEvent"){const c=f;c.statusCode!==1e3&&this.cancelSynthesisLocal(Fe.Error,c.statusCode===1007?Re.BadRequestParameters:Re.ConnectionFailure,c.reason+" websocket error code: "+c.statusCode)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=e),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=e)}static addHeader(e,r){if(!r.hasHeader)return e;r.updateHeader(e.byteLength);const n=new Uint8Array(e.byteLength+r.header.byteLength);return n.set(new Uint8Array(r.header),0),n.set(new Uint8Array(e),r.header.byteLength),n.buffer}isDisposed(){return this.privIsDisposed}dispose(e){return qt(this,void 0,void 0,function*(){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise&&(yield(yield this.privConnectionConfigurationPromise).dispose(e))})}connect(){return qt(this,void 0,void 0,function*(){yield this.connectImpl()})}sendNetworkMessage(e,r){return qt(this,void 0,void 0,function*(){const n=typeof r=="string"?ee.Text:ee.Binary,i=typeof r=="string"?"application/json":"";return(yield this.fetchConnection()).send(new ke(n,e,this.privSynthesisTurn.requestId,i,r))})}Speak(e,r,n,i,l,f){return qt(this,void 0,void 0,function*(){let c;if(r?c=e:c=this.privSpeechSynthesizer.buildSsml(e),this.speakOverride!==void 0)return this.speakOverride(c,n,i,l);this.privSuccessCallback=i,this.privErrorCallback=l,this.privSynthesisTurn.startNewSynthesis(n,e,r,f);try{yield this.connectImpl();const o=yield this.fetchConnection();yield this.sendSynthesisContext(o),yield this.sendSsmlMessage(o,c,n);const s=new Ac(new _c(n,Xe.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,s);const a=this.receiveMessage()}catch(o){return this.cancelSynthesisLocal(Fe.Error,Re.ConnectionFailure,o),Promise.reject(o)}})}cancelSynthesis(e,r,n,i){const l=new Ru;l.setProperty(TA,Re[n]);const f=new _c(e,Xe.Canceled,void 0,i,l);if(this.privSpeechSynthesizer.SynthesisCanceled){const c=new Ac(f);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,c)}catch{}}if(this.privSuccessCallback)try{this.privSuccessCallback(f)}catch{}}cancelSynthesisLocal(e,r,n){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,r,n))}processTypeSpecificMessages(e,r,n){return!0}receiveMessage(){return qt(this,void 0,void 0,function*(){try{const r=yield(yield this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!r)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;this.privServiceHasSentMessage=!0;const n=ke.fromConnectionMessage(r);if(n.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(n.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse();break;case"response":this.privSynthesisTurn.onServiceResponseMessage(n.textBody);break;case"audio":if(this.privSynthesisTurn.streamId.toLowerCase()===n.streamId.toLowerCase()&&n.binaryBody){if(this.privSynthesisTurn.onAudioChunkReceived(n.binaryBody),this.privSpeechSynthesizer.synthesizing)try{const f=IA.addHeader(n.binaryBody,this.privSynthesisTurn.audioOutputFormat),c=new Ac(new _c(this.privSynthesisTurn.requestId,Xe.SynthesizingAudio,f));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,c)}catch{}this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(n.binaryBody)}break;case"audio.metadata":const i=uH.fromJSON(n.textBody).Metadata;for(const f of i)switch(f.Type){case ta.WordBoundary:this.privSynthesisTurn.onWordBoundaryEvent(f.Data.text.Text);const c=new FW(f.Data.Offset,f.Data.text.Text,f.Data.text.Length,this.privSynthesisTurn.currentTextOffset);if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,c)}catch{}break;case ta.Bookmark:const o=new UW(f.Data.Offset,f.Data.Bookmark);if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,o)}catch{}break;case ta.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(f),f.Data.IsLastAnimation){const s=new VW(f.Data.Offset,f.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,s)}catch{}}break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let l;try{const f=yield this.privSynthesisTurn.getAllReceivedAudioWithHeader();l=new _c(this.privSynthesisTurn.requestId,Xe.SynthesizingAudioCompleted,f),this.privSuccessCallback&&this.privSuccessCallback(l)}catch(f){this.privErrorCallback&&this.privErrorCallback(f)}if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new Ac(l))}catch{}break;default:this.processTypeSpecificMessages(n)||this.privServiceEvents&&this.serviceEvents.onEvent(new Rd(n.path.toLowerCase(),n.textBody))}return this.receiveMessage()}catch{}})}connectImpl(e=!1){if(this.privConnectionPromise)return this.privConnectionPromise.then(n=>n.state()===$e.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,n=>(this.privConnectionId=null,this.privConnectionPromise=null,this.privServiceHasSentMessage=!1,this.connectImpl()));this.privAuthFetchEventId=ge(),this.privConnectionId=ge(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);const r=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=r.then(n=>qt(this,void 0,void 0,function*(){yield this.privSynthesisTurn.onAuthCompleted(!1);const i=this.privConnectionFactory.create(this.privSynthesizerConfig,n,this.privConnectionId);i.events.attach(f=>{this.connectionEvents.onEvent(f)});const l=yield i.open();return l.statusCode===200?(yield this.privSynthesisTurn.onConnectionEstablishCompleted(l.statusCode),Promise.resolve(i)):l.statusCode===403&&!e?this.connectImpl(!0):(yield this.privSynthesisTurn.onConnectionEstablishCompleted(l.statusCode,l.reason),Promise.reject(`Unable to contact server. StatusCode: ${l.statusCode}, ${this.privSynthesizerConfig.parameters.getProperty(j.SpeechServiceConnection_Endpoint)} Reason: ${l.reason}`))}),n=>qt(this,void 0,void 0,function*(){throw yield this.privSynthesisTurn.onAuthCompleted(!0,n),new Error(n)})),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}fetchConnection(){return qt(this,void 0,void 0,function*(){return this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then(e=>e.state()===$e.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=null,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,e=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=null,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)})}configureConnection(){return qt(this,void 0,void 0,function*(){const e=yield this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),e)})}};$d.telemetryDataEnabled=!0;class kd extends gr{constructor(e,r,n=ae.Info){super(e,n),this.privRequestId=r}get requestId(){return this.privRequestId}}class pH extends kd{constructor(e,r,n){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=r,this.privTurnAudioDestinationId=n}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}class fH extends kd{constructor(e,r){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=r}get authFetchEventId(){return this.privAuthFetchEventId}}class lH extends kd{constructor(e,r){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=r}get authFetchEventId(){return this.privAuthFetchEventId}}var jf=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let vH=class{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.onPreConnectionStart=(e,r)=>{this.privAuthFetchEventId=e,this.onEvent(new fH(this.privRequestId,this.privAuthFetchEventId))},this.onAuthCompleted=(e,r)=>{e&&this.onComplete()},this.onConnectionEstablishCompleted=(e,r)=>{if(e===200){this.onEvent(new lH(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else e===403&&this.onComplete()},this.onServiceResponseMessage=e=>{const r=JSON.parse(e);this.streamId=r.audio.streamId},this.onServiceTurnEndResponse=()=>{this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()},this.onServiceTurnStartResponse=()=>{this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Ae},this.dispose=e=>{this.privIsDisposed||(this.privIsDisposed=!0)},this.onEvent=e=>{xe.instance.onEvent(e)},this.onComplete=()=>{this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))},this.privRequestId=ge(),this.privTurnDeferral=new Ae,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get bytesReceived(){return this.privBytesReceived}getAllReceivedAudio(){return jf(this,void 0,void 0,function*(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(yield this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null})}getAllReceivedAudioWithHeader(){return jf(this,void 0,void 0,function*(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const e=yield this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=$d.addHeader(e,this.audioOutputFormat),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()})}startNewSynthesis(e,r,n,i){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=r,this.privIsSSML=n,this.privAudioOutputStream=new Td,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privPartialVisemeAnimation="",i!==void 0&&(this.privTurnAudioDestination=i,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new pH(this.requestId,void 0,i===void 0?void 0:i.id()))}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(e))}onWordBoundaryEvent(e){this.updateTextOffset(e)}onVisemeMetadataReceived(e){e.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}updateTextOffset(e){this.privTextOffset>=0&&(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length),this.privIsSSML&&this.privRawText.indexOf("<",this.privTextOffset+1)>this.privRawText.indexOf(">",this.privTextOffset+1)&&this.updateTextOffset(e))}readAllAudioFromStream(){return jf(this,void 0,void 0,function*(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{yield this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}})}},hH=class{constructor(e){this.privContext={},this.privSpeechSynthesizer=e}setSection(e,r){this.privContext[e]=r}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){const e=this.buildSynthesisContext();return this.setSection("synthesis",e),JSON.stringify(this.privContext)}buildSynthesisContext(){return{audio:{metadataOptions:{bookmarkEnabled:!!this.privSpeechSynthesizer.bookmarkReached,sentenceBoundaryEnabled:!1,visemeEnabled:!!this.privSpeechSynthesizer.visemeReceived,wordBoundaryEnabled:!!this.privSpeechSynthesizer.wordBoundary},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:this.privSpeechSynthesizer.autoDetectSourceLanguage}}}};const hh="OutputFormat",TA="CancellationErrorCode",dh="ServiceProperties",dH="ForceDictation";var Ic=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};const gH="MICROPHONE-WorkletSourceUrl";let eu=class zr{constructor(e,r,n,i){this.privRecorder=e,this.deviceId=r,this.privStreams={},this.turnOn=()=>{if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new Ae;try{this.createAudioContext()}catch(c){if(c instanceof Error){const o=c;this.privInitializeDeferral.reject(o.name+": "+o.message)}else this.privInitializeDeferral.reject(c);return this.privInitializeDeferral.promise}const l=window.navigator;let f=l.getUserMedia||l.webkitGetUserMedia||l.mozGetUserMedia||l.msGetUserMedia;if(l.mediaDevices&&(f=(c,o,s)=>{l.mediaDevices.getUserMedia(c).then(o).catch(s)}),f){const c=()=>{this.onEvent(new np(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new aa(this.privId)),this.privInitializeDeferral.resolve()):f({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},o=>{this.privMediaStream=o,this.onEvent(new aa(this.privId)),this.privInitializeDeferral.resolve()},o=>{const s=`Error occurred during microphone initialization: ${o}`;this.privInitializeDeferral.reject(s),this.onEvent(new Cu(this.privId,s))})};this.privContext.state==="suspended"?this.privContext.resume().then(c).catch(o=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${o}`)}):c()}else{const c="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(c),this.onEvent(new Cu(c,""))}return this.privInitializeDeferral.promise},this.id=()=>this.privId,this.attach=l=>(this.onEvent(new $a(this.privId,l)),this.listen(l).then(f=>(this.onEvent(new ka(this.privId,l)),{detach:()=>Ic(this,void 0,void 0,function*(){return f.readEnded(),delete this.privStreams[l],this.onEvent(new Jt(this.privId,l)),this.turnOff()}),id:()=>l,read:()=>f.read()}))),this.detach=l=>{l&&this.privStreams[l]&&(this.privStreams[l].close(),delete this.privStreams[l],this.onEvent(new Jt(this.privId,l)))},this.listen=l=>Ic(this,void 0,void 0,function*(){yield this.turnOn();const f=new Od(this.privOutputChunkSize,l);this.privStreams[l]=f;try{this.privRecorder.record(this.privContext,this.privMediaStream,f)}catch(o){throw this.onEvent(new wd(this.privId,l,o)),o}return f}),this.onEvent=l=>{this.privEvents.onEvent(l),xe.instance.onEvent(l)},this.createAudioContext=()=>{this.privContext||(this.privContext=Vr.getAudioContext(zr.AUDIOFORMAT.samplesPerSec))},this.privOutputChunkSize=zr.AUDIOFORMAT.avgBytesPerSec/10,this.privId=n||ge(),this.privEvents=new Et,this.privMediaStream=i||null}get format(){return Promise.resolve(zr.AUDIOFORMAT)}get blob(){return Promise.reject("Not implemented for Mic input")}turnOff(){return Ic(this,void 0,void 0,function*(){for(const e in this.privStreams)if(e){const r=this.privStreams[e];r&&r.close()}this.onEvent(new sA(this.privId)),this.privInitializeDeferral&&(yield this.privInitializeDeferral,this.privInitializeDeferral=null),yield this.destroyAudioContext()})}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(e=>({bitspersample:zr.AUDIOFORMAT.bitsPerSample,channelcount:zr.AUDIOFORMAT.channels,connectivity:Tn.Unknown,manufacturer:"Speech SDK",model:e,samplerate:zr.AUDIOFORMAT.samplesPerSec,type:Wr.Microphones}))}setProperty(e,r){if(e===gH)this.privRecorder.setWorkletUrl(r);else throw new Error("Property '"+e+"' is not supported on Microphone.")}getMicrophoneLabel(){const e="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(e);this.privMicrophoneLabel=e;const r=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(r===void 0)return Promise.resolve(this.privMicrophoneLabel);const n=new Ae;return navigator.mediaDevices.enumerateDevices().then(i=>{for(const l of i)if(l.deviceId===r){this.privMicrophoneLabel=l.label;break}n.resolve(this.privMicrophoneLabel)},()=>n.resolve(this.privMicrophoneLabel)),n.promise}destroyAudioContext(){return Ic(this,void 0,void 0,function*(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?(yield this.privContext.close(),this.privContext=null):this.privContext!==null&&this.privContext.state==="running"&&(yield this.privContext.suspend())})}};eu.AUDIOFORMAT=op.getDefaultInputFormat();var zf=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let yH=class{constructor(e,r,n){this.privStreams={},this.privHeaderEnd=44,this.turnOn=()=>{if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const i=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new Cu(i,"")),Promise.reject(i)}this.onEvent(new np(this.privId)),this.onEvent(new aa(this.privId))},this.id=()=>this.privId,this.attach=i=>zf(this,void 0,void 0,function*(){this.onEvent(new $a(this.privId,i));const l=yield this.upload(i);return this.onEvent(new ka(this.privId,i)),Promise.resolve({detach:()=>zf(this,void 0,void 0,function*(){l.readEnded(),delete this.privStreams[i],this.onEvent(new Jt(this.privId,i)),yield this.turnOff()}),id:()=>i,read:()=>l.read()})}),this.detach=i=>{i&&this.privStreams[i]&&(this.privStreams[i].close(),delete this.privStreams[i],this.onEvent(new Jt(this.privId,i)))},this.turnOff=()=>{for(const i in this.privStreams)if(i){const l=this.privStreams[i];l&&!l.isClosed&&l.close()}return this.onEvent(new sA(this.privId)),Promise.resolve()},this.onEvent=i=>{this.privEvents.onEvent(i),xe.instance.onEvent(i)},this.privId=n||ge(),this.privEvents=new Et,this.privSource=e,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=e.name:this.privFilename=r||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}get blob(){return Promise.resolve(this.privSource)}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(e=>Promise.resolve({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:Tn.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:Wr.File}))}readHeader(){const r=this.privSource.slice(0,512),n=new Ae,i=l=>{const f=new DataView(l),c=v=>String.fromCharCode(f.getUint8(v),f.getUint8(v+1),f.getUint8(v+2),f.getUint8(v+3));if(c(0)!=="RIFF"){n.reject("Invalid WAV header in file, RIFF was not found");return}if(c(8)!=="WAVE"||c(12)!=="fmt "){n.reject("Invalid WAV header in file, WAVEfmt was not found");return}const o=f.getInt32(16,!0),s=f.getUint16(22,!0),a=f.getUint32(24,!0),u=f.getUint16(34,!0);let p=36+Math.max(o-16,0);for(;c(p)!=="data";p+=2)if(p>504){n.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=p+8,n.resolve(op.getWaveFormatPCM(a,u,s))};if(typeof window<"u"&&typeof Blob<"u"&&r instanceof Blob){const l=new FileReader;l.onload=f=>{const c=f.target.result;i(c)},l.readAsArrayBuffer(r)}else{const l=r;i(l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength))}return n.promise}upload(e){return zf(this,void 0,void 0,function*(){const r=n=>{const i=`Error occurred while processing '${this.privFilename}'. ${n}`;throw this.onEvent(new wd(this.privId,e,i)),new Error(i)};try{yield this.turnOn();const n=yield this.privAudioFormatPromise,i=new Od(n.avgBytesPerSec/10,e);this.privStreams[e]=i;const l=this.privSource.slice(this.privHeaderEnd),f=c=>{i.isClosed||(i.writeStreamChunk({buffer:c,isEnd:!1,timeReceived:Date.now()}),i.close())};if(typeof window<"u"&&typeof Blob<"u"&&l instanceof Blob){const c=new FileReader;c.onerror=o=>{r(o.toString())},c.onload=o=>{const s=o.target.result;f(s)},c.readAsArrayBuffer(l)}else{const c=l;f(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength))}return i}catch(n){r(n)}})}};class Nf{constructor(){this.record=(e,r,n)=>{const l=(()=>{let o=0;try{return e.createScriptProcessor(o,1,1)}catch{o=2048;let a=e.sampleRate;for(;o<16384&&a>=32e3;)o<<=1,a>>=1;return e.createScriptProcessor(o,1,1)}})(),f=new uW(e.sampleRate,16e3);l.onaudioprocess=o=>{const s=o.inputBuffer.getChannelData(0);if(n&&!n.isClosed){const a=f.encode(s);a&&n.writeStreamChunk({buffer:a,isEnd:!1,timeReceived:Date.now()})}};const c=e.createMediaStreamSource(r);this.privSpeechProcessorScript&&e.audioWorklet?e.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const o=new AudioWorkletNode(e,"speech-processor");o.port.onmessage=s=>{const a=s.data;if(n&&!n.isClosed){const u=f.encode(a);u&&n.writeStreamChunk({buffer:u,isEnd:!1,timeReceived:Date.now()})}},c.connect(o),o.connect(e.destination),this.privMediaResources={scriptProcessorNode:o,source:c,stream:r}}).catch(()=>{c.connect(l),l.connect(e.destination),this.privMediaResources={scriptProcessorNode:l,source:c,stream:r}}):(c.connect(l),l.connect(e.destination),this.privMediaResources={scriptProcessorNode:l,source:c,stream:r})},this.releaseMediaResources=e=>{this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privMediaResources.stream.getTracks().forEach(r=>r.stop()),this.privMediaResources.source=null))}}setWorkletUrl(e){this.privSpeechProcessorScript=e}}var mH=function(e,r){if(r=r.split(":")[0],e=+e,!e)return!1;switch(r){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0},xd={},SH=Object.prototype.hasOwnProperty,bH;function fS(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch{return null}}function lS(t){try{return encodeURIComponent(t)}catch{return null}}function CH(t){for(var e=/([^=?#&]+)=?([^&]*)/g,r={},n;n=e.exec(t);){var i=fS(n[1]),l=fS(n[2]);i===null||l===null||i in r||(r[i]=l)}return r}function PH(t,e){e=e||"";var r=[],n,i;typeof e!="string"&&(e="?");for(i in t)if(SH.call(t,i)){if(n=t[i],!n&&(n===null||n===bH||isNaN(n))&&(n=""),i=lS(i),n=lS(n),i===null||n===null)continue;r.push(i+"="+n)}return r.length?e+r.join("&"):""}xd.stringify=PH;xd.parse=CH;var MA=mH,ap=xd,wH=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,DA=/[\n\r\t]/g,RH=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,$A=/:\d+$/,EH=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,OH=/^[a-zA-Z]:/;function jd(t){return(t||"").toString().replace(wH,"")}var gh=[["#","hash"],["?","query"],function(e,r){return kt(r.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],vS={hash:1,query:1};function kA(t){var e;typeof window<"u"?e=window:typeof w<"u"?e=w:typeof self<"u"?e=self:e={};var r=e.location||{};t=t||r;var n={},i=typeof t,l;if(t.protocol==="blob:")n=new xt(unescape(t.pathname),{});else if(i==="string"){n=new xt(t,{});for(l in vS)delete n[l]}else if(i==="object"){for(l in t)l in vS||(n[l]=t[l]);n.slashes===void 0&&(n.slashes=RH.test(t.href))}return n}function kt(t){return t==="file:"||t==="ftp:"||t==="http:"||t==="https:"||t==="ws:"||t==="wss:"}function xA(t,e){t=jd(t),t=t.replace(DA,""),e=e||{};var r=EH.exec(t),n=r[1]?r[1].toLowerCase():"",i=!!r[2],l=!!r[3],f=0,c;return i?l?(c=r[2]+r[3]+r[4],f=r[2].length+r[3].length):(c=r[2]+r[4],f=r[2].length):l?(c=r[3]+r[4],f=r[3].length):c=r[4],n==="file:"?f>=2&&(c=c.slice(2)):kt(n)?c=r[4]:n?i&&(c=c.slice(2)):f>=2&&kt(e.protocol)&&(c=r[4]),{protocol:n,slashes:i||kt(n),slashesCount:f,rest:c}}function _H(t,e){if(t==="")return e;for(var r=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=r.length,i=r[n-1],l=!1,f=0;n--;)r[n]==="."?r.splice(n,1):r[n]===".."?(r.splice(n,1),f++):f&&(n===0&&(l=!0),r.splice(n,1),f--);return l&&r.unshift(""),(i==="."||i==="..")&&r.push(""),r.join("/")}function xt(t,e,r){if(t=jd(t),t=t.replace(DA,""),!(this instanceof xt))return new xt(t,e,r);var n,i,l,f,c,o,s=gh.slice(),a=typeof e,u=this,p=0;for(a!=="object"&&a!=="string"&&(r=e,e=null),r&&typeof r!="function"&&(r=ap.parse),e=kA(e),i=xA(t||"",e),n=!i.protocol&&!i.slashes,u.slashes=i.slashes||n&&e.slashes,u.protocol=i.protocol||e.protocol||"",t=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||OH.test(t))||!i.slashes&&(i.protocol||i.slashesCount<2||!kt(u.protocol)))&&(s[3]=[/(.*)/,"pathname"]);p<s.length;p++){if(f=s[p],typeof f=="function"){t=f(t,u);continue}l=f[0],o=f[1],l!==l?u[o]=t:typeof l=="string"?(c=l==="@"?t.lastIndexOf(l):t.indexOf(l),~c&&(typeof f[2]=="number"?(u[o]=t.slice(0,c),t=t.slice(c+f[2])):(u[o]=t.slice(c),t=t.slice(0,c)))):(c=l.exec(t))&&(u[o]=c[1],t=t.slice(0,c.index)),u[o]=u[o]||n&&f[3]&&e[o]||"",f[4]&&(u[o]=u[o].toLowerCase())}r&&(u.query=r(u.query)),n&&e.slashes&&u.pathname.charAt(0)!=="/"&&(u.pathname!==""||e.pathname!=="")&&(u.pathname=_H(u.pathname,e.pathname)),u.pathname.charAt(0)!=="/"&&kt(u.protocol)&&(u.pathname="/"+u.pathname),MA(u.port,u.protocol)||(u.host=u.hostname,u.port=""),u.username=u.password="",u.auth&&(c=u.auth.indexOf(":"),~c?(u.username=u.auth.slice(0,c),u.username=encodeURIComponent(decodeURIComponent(u.username)),u.password=u.auth.slice(c+1),u.password=encodeURIComponent(decodeURIComponent(u.password))):u.username=encodeURIComponent(decodeURIComponent(u.auth)),u.auth=u.password?u.username+":"+u.password:u.username),u.origin=u.protocol!=="file:"&&kt(u.protocol)&&u.host?u.protocol+"//"+u.host:"null",u.href=u.toString()}function AH(t,e,r){var n=this;switch(t){case"query":typeof e=="string"&&e.length&&(e=(r||ap.parse)(e)),n[t]=e;break;case"port":n[t]=e,MA(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[t]="");break;case"hostname":n[t]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[t]=e,$A.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(e){var i=t==="pathname"?"/":"#";n[t]=e.charAt(0)!==i?i+e:e}else n[t]=e;break;case"username":case"password":n[t]=encodeURIComponent(e);break;case"auth":var l=e.indexOf(":");~l?(n.username=e.slice(0,l),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(l+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var f=0;f<gh.length;f++){var c=gh[f];c[4]&&(n[c[1]]=n[c[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&kt(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function IH(t){(!t||typeof t!="function")&&(t=ap.stringify);var e,r=this,n=r.host,i=r.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var l=i+(r.protocol&&r.slashes||kt(r.protocol)?"//":"");return r.username?(l+=r.username,r.password&&(l+=":"+r.password),l+="@"):r.password?(l+=":"+r.password,l+="@"):r.protocol!=="file:"&&kt(r.protocol)&&!n&&r.pathname!=="/"&&(l+="@"),(n[n.length-1]===":"||$A.test(r.hostname)&&!r.port)&&(n+=":"),l+=n+r.pathname,e=typeof r.query=="object"?t(r.query):r.query,e&&(l+=e.charAt(0)!=="?"?"?"+e:e),r.hash&&(l+=r.hash),l}xt.prototype={set:AH,toString:IH};xt.extractProtocol=xA;xt.location=kA;xt.trimLeft=jd;xt.qs=ap;var jA=xt;const TH=ne(jA);var Tc={},oi=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,[])).next())})};class Se{constructor(e){e&&(this.privProxyInfo=e),Se.privDiskCache||(Se.privDiskCache=new Zs("microsoft-cognitiveservices-speech-sdk-cache",{supportBuffer:!0,location:typeof process<"u"&&Tc.SPEECH_OCSP_CACHE_ROOT?Tc.SPEECH_OCSP_CACHE_ROOT:void 0}))}static forceReinitDiskCache(){Se.privDiskCache=void 0,Se.privMemCache={}}GetAgent(e){const r=new Zs.Agent(this.CreateConnection);if(this.privProxyInfo!==void 0&&this.privProxyInfo.HostName!==void 0&&this.privProxyInfo.Port>0){const n="privProxyInfo";r[n]=this.privProxyInfo}return r}static GetProxyAgent(e){const r={host:e.HostName,port:e.Port};return e.UserName?r.headers={"Proxy-Authentication":"Basic "+new Buffer(e.UserName+":"+(e.Password===void 0)?"":e.Password).toString("base64")}:r.headers={},r.headers.requestOCSP="true",new Zs(r)}static OCSPCheck(e,r){return oi(this,void 0,void 0,function*(){let n,i,l=!1;const f=yield e;f.cork();const c=f;return new Promise((o,s)=>{f.on("OCSPResponse",a=>{a&&(this.onEvent(new mW),i=a)}),f.on("error",a=>{l||(l=!0,f.destroy(),s(a))}),c.on("secure",()=>oi(this,void 0,void 0,function*(){const a=c.getPeerCertificate(!0);try{const u=yield this.GetIssuer(a);n=(void 0).generate(a.raw,u.raw);const p=n.id.toString("hex");i||(i=yield Se.GetResponseFromCache(p,n,r)),yield this.VerifyOCSPResponse(i,n,r),f.uncork(),l=!0,o(f)}catch(u){f.destroy(),l=!0,s(u)}}))})})}static GetIssuer(e){return e.issuerCertificate?Promise.resolve(e.issuerCertificate):new Promise((r,n)=>{new(void 0)({}).fetchIssuer(e,null,(l,f)=>{if(l){n(l);return}r(f)})})}static GetResponseFromCache(e,r,n){return oi(this,void 0,void 0,function*(){let i=Se.privMemCache[e];if(i&&this.onEvent(new fW(e)),!i)try{const l=yield Se.privDiskCache.get(e);l.isCached&&(Se.onEvent(new vW(e)),Se.StoreMemoryCacheEntry(e,l.value),i=l.value)}catch{i=null}if(!i)return i;try{const f=(void 0).parseResponse(i).value.tbsResponseData;f.responses.length<1;const c=f.responses[0].thisUpdate,o=f.responses[0].nextUpdate;if(o<Date.now()+this.testTimeOffset-6e4)this.onEvent(new SW(e,o)),i=null;else{const s=Math.min(864e5,(o-c)/2);o-(Date.now()+this.testTimeOffset)<s?(this.onEvent(new bW(e,c,o)),this.UpdateCache(r,n).catch(a=>{this.onEvent(new EW(e,a.toString()))})):this.onEvent(new CW(e,c,o))}}catch(l){this.onEvent(new wW(e,l)),i=null}return i||this.onEvent(new lW(e)),i})}static VerifyOCSPResponse(e,r,n){return oi(this,void 0,void 0,function*(){let i=e;return r.certID.toString("hex"),i||(i=yield Se.GetOCSPResponse(r,n)),new Promise((l,f)=>{(void 0)({request:r,response:i},(c,o)=>{c?(Se.onEvent(new PW(r.id.toString("hex"),c)),e?this.VerifyOCSPResponse(null,r,n).then(()=>{l()},s=>{f(s)}):f(c)):(e||Se.StoreCacheEntry(r.id.toString("hex"),i),l())})})})}static UpdateCache(e,r){return oi(this,void 0,void 0,function*(){const n=e.id.toString("hex");this.onEvent(new hW(n));const i=yield this.GetOCSPResponse(e,r);this.StoreCacheEntry(n,i),this.onEvent(new yW(e.id.toString("hex")))})}static StoreCacheEntry(e,r){this.StoreMemoryCacheEntry(e,r),this.StoreDiskCacheEntry(e,r)}static StoreMemoryCacheEntry(e,r){this.privMemCache[e]=r,this.onEvent(new dW(e))}static StoreDiskCacheEntry(e,r){this.privDiskCache.set(e,r).then(()=>{this.onEvent(new gW(e))})}static GetOCSPResponse(e,r){const n="1.3.6.1.5.5.7.48.1";let i={};if(r){const l=Se.GetProxyAgent(r);i.agent=l}return new Promise((l,f)=>{(void 0).getAuthorityInfo(e.cert,n,(c,o)=>{if(c){f(c);return}const s=TH(o);s.path=s.pathname,i=Object.assign(Object.assign({},i),s),(void 0).getResponse(i,e.data,(a,u)=>{if(a){f(a);return}this.onEvent(new RW(e.certID.toString("hex"))),l(u)})})})}CreateConnection(e,r){const n=typeof process<"u"&&Tc.NODE_TLS_REJECT_UNAUTHORIZED!=="0"&&Tc.SPEECH_CONDUCT_OCSP_CHECK!=="0"&&r.secureEndpoint;let i;if(r=Object.assign(Object.assign({},r),{requestOCSP:!Se.forceDisableOCSPStapling,servername:r.host}),this.privProxyInfo){const f=Se.GetProxyAgent(this.privProxyInfo);i=new Promise((c,o)=>{f.callback(e,r,(s,a)=>{s?o(s):c(a)})})}else r.secureEndpoint,i=Promise.resolve((void 0)(r));return n?Se.OCSPCheck(i,this.privProxyInfo):i}}Se.testTimeOffset=0;Se.forceDisableOCSPStapling=!1;Se.privMemCache={};Se.onEvent=t=>{xe.instance.onEvent(t)};var hS=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let zA=class NA{constructor(e,r,n,i,l,f){if(this.open=()=>{if(this.privConnectionState===$e.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new Ae,this.privCertificateValidatedDeferral=new Ae,this.privConnectionState=$e.Connecting;try{if(typeof WebSocket<"u"&&!NA.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{const c={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve();const o=new Se(this.proxyInfo);c.agent=o.GetAgent(),this.privWebsocketClient=new Zs(this.privUri,c)}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new Pu,this.privDisconnectDeferral=new Ae,this.privSendMessageQueue=new Pu,this.processSendQueue().catch(c=>{xe.instance.onEvent(new Fr(c))})}catch(c){return this.privConnectionEstablishDeferral.resolve(new Df(500,c)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new aA(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=c=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=$e.Connected,this.onEvent(new cA(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new Df(200,""))},o=>{this.privConnectionEstablishDeferral.reject(o)})},this.privWebsocketClient.onerror=c=>{this.onEvent(new iW(this.privConnectionId,c.message,c.type)),this.privLastErrorReceived=c.message},this.privWebsocketClient.onclose=c=>{this.privConnectionState===$e.Connecting?(this.privConnectionState=$e.Disconnected,this.privConnectionEstablishDeferral.resolve(new Df(c.code,c.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=$e.Disconnected,this.privWebsocketClient=null,this.onEvent(new nW(this.privConnectionId,c.code,c.reason))),this.onClose(c.code,c.reason).catch(o=>{xe.instance.onEvent(new Fr(o))})},this.privWebsocketClient.onmessage=c=>{const o=new Date().toISOString();if(this.privConnectionState===$e.Connected){const s=new Ae;if(this.privReceivingMessageQueue.enqueueFromPromise(s.promise),c.data instanceof ArrayBuffer){const a=new wu(ee.Binary,c.data);this.privMessageFormatter.toConnectionMessage(a).then(u=>{this.onEvent(new ch(this.privConnectionId,o,u)),s.resolve(u)},u=>{s.reject(`Invalid binary message format. Error: ${u}`)})}else{const a=new wu(ee.Text,c.data);this.privMessageFormatter.toConnectionMessage(a).then(u=>{this.onEvent(new ch(this.privConnectionId,o,u)),s.resolve(u)},u=>{s.reject(`Invalid text message format. Error: ${u}`)})}}},this.privConnectionEstablishDeferral.promise},this.send=c=>{if(this.privConnectionState!==$e.Connected)return Promise.reject(`Cannot send on connection that is in ${$e[this.privConnectionState]} state`);const o=new Ae,s=new Ae;return this.privSendMessageQueue.enqueueFromPromise(s.promise),this.privMessageFormatter.fromConnectionMessage(c).then(a=>{s.resolve({Message:c,RawWebsocketMessage:a,sendStatusDeferral:o})},a=>{s.reject(`Error formatting the message. ${a}`)}),o.promise},this.read=()=>this.privConnectionState!==$e.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue(),this.close=c=>{if(this.privWebsocketClient)this.privConnectionState!==$e.Disconnected&&this.privWebsocketClient.close(1e3,c||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise},this.sendRawMessage=c=>{try{if(!c)return Promise.resolve();if(this.onEvent(new sW(this.privConnectionId,new Date().toISOString(),c.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(c.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+c.Message.id+" "+new Error().stack);return Promise.resolve()}catch(o){return Promise.reject(`websocket send error: ${o}`)}},this.onEvent=c=>{this.privConnectionEvents.onEvent(c),xe.instance.onEvent(c)},!e)throw new Ne("uri");if(!n)throw new Ne("messageFormatter");this.proxyInfo=i,this.privConnectionEvents=new Et,this.privConnectionId=r,this.privMessageFormatter=n,this.privConnectionState=$e.None,this.privUri=e,this.privHeaders=l,this.privEnableCompression=f,this.privHeaders[be.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}get events(){return this.privConnectionEvents}onClose(e,r){return hS(this,void 0,void 0,function*(){const n=`Connection closed. ${e}: ${r}`;this.privConnectionState=$e.Disconnected,this.privDisconnectDeferral.resolve(),yield this.privReceivingMessageQueue.drainAndDispose(i=>{},n),yield this.privSendMessageQueue.drainAndDispose(i=>{i.sendStatusDeferral.reject(n)},n)})}processSendQueue(){return hS(this,void 0,void 0,function*(){for(;;){const r=yield this.privSendMessageQueue.dequeue();if(!r)return;try{yield this.sendRawMessage(r),r.sendStatusDeferral.resolve()}catch(n){r.sendStatusDeferral.reject(n)}}})}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};zA.forceNpmWebSocket=!1;var MH=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function c(a){try{s(n.next(a))}catch(u){f(u)}}function o(a){try{s(n.throw(a))}catch(u){f(u)}}function s(a){a.done?l(a.value):i(a.value).then(c,o)}s((n=n.apply(t,e||[])).next())})};let DH=class{constructor(e,r,n,i,l,f=!1,c){if(this.privIsDisposed=!1,this.isDisposed=()=>this.privIsDisposed,this.state=()=>this.privConnectionMessageAdapter.state,this.open=()=>this.privConnectionMessageAdapter.open(),this.send=a=>this.privConnectionMessageAdapter.send(a),this.read=()=>this.privConnectionMessageAdapter.read(),!e)throw new Ne("uri");if(!i)throw new Ne("messageFormatter");this.privMessageFormatter=i;let o="",s=0;if(r){for(const a in r)if(a){o+=s===0&&e.indexOf("?")===-1?"?":"&";const u=encodeURIComponent(r[a]);o+=`${a}=${u}`,s++}}if(n){for(const a in n)if(a){o+=s===0&&e.indexOf("?")===-1?"?":"&";const u=encodeURIComponent(n[a]);o+=`${a}=${u}`,s++}}this.privUri=e+o,this.privId=c||ge(),this.privConnectionMessageAdapter=new zA(this.privUri,this.id,this.privMessageFormatter,l,n,f)}dispose(){return MH(this,void 0,void 0,function*(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&(yield this.privConnectionMessageAdapter.close())})}get id(){return this.privId}get events(){return this.privConnectionMessageAdapter.events}},LA=class{constructor(e,r){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.id=()=>this.privAudioNode.id(),this.privAudioNode=e,this.privBytesPerSecond=r}read(){if(this.privReplay&&this.privBuffers.length!==0){const e=this.privReplayOffset-this.privBufferStartOffset;let r=Math.round(e*this.privBytesPerSecond*1e-7);r%2!==0&&r++;let n=0;for(;n<this.privBuffers.length&&r>=this.privBuffers[n].chunk.buffer.byteLength;)r-=this.privBuffers[n++].chunk.buffer.byteLength;if(n<this.privBuffers.length){const i=this.privBuffers[n].chunk.buffer.slice(r);return this.privReplayOffset+=i.byteLength/this.privBytesPerSecond*1e7,n===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:i,isEnd:!1,timeReceived:this.privBuffers[n].chunk.timeReceived})}}return this.privAudioNode.read().then(e=>(e&&e.buffer&&(this.privBuffers.push(new $H(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=e;const r=e-this.privBufferStartOffset;let n=Math.round(r*this.privBytesPerSecond*1e-7),i=0;for(;i<this.privBuffers.length&&n>=this.privBuffers[i].chunk.buffer.byteLength;)n-=this.privBuffers[i++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-n/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(i)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const r of this.privBuffers){const n=r.byteOffset/this.privBytesPerSecond*1e7,i=n+r.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=n&&e<=i)return r.chunk.timeReceived}return 0}};class $H{constructor(e,r,n){this.chunk=e,this.serial=r,this.byteOffset=n}}let kH=class BA{constructor(e,r,n,i){this.privProxyHostName=e,this.privProxyPort=r,this.privProxyUserName=n,this.privProxyPassword=i}static fromParameters(e){return new BA(e.getProperty(j.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(j.SpeechServiceConnection_ProxyPort),10),e.getProperty(j.SpeechServiceConnection_ProxyUserName),e.getProperty(j.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};var qA=ue,xH=vt,jH=Ee,zH=Be,dS=ba,NH=fa,FA=Function,LH=qA([].concat),BH=qA([].join),Lf={},qH=function(t,e,r){if(!zH(Lf,e)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";Lf[e]=FA("C,a","return new C("+BH(n,",")+")")}return Lf[e](t,r)},UA=NH?FA.bind:function(e){var r=xH(this),n=r.prototype,i=dS(arguments,1),l=function(){var c=LH(i,dS(arguments));return this instanceof l?qH(r,c.length,c):r.apply(e,c)};return jH(n)&&(l.prototype=n),l},FH=Y,UH=Ve,Bf=$u,VH=UA,gS=GE,WH=ct,yS=Ee,HH=Yr,VA=ce,zd=UH("Reflect","construct"),KH=Object.prototype,GH=[].push,WA=VA(function(){function t(){}return!(zd(function(){},[],t)instanceof t)}),HA=!VA(function(){zd(function(){})}),mS=WA||HA;FH({target:"Reflect",stat:!0,forced:mS,sham:mS},{construct:function(e,r){gS(e),WH(r);var n=arguments.length<3?e:gS(arguments[2]);if(HA&&!WA)return zd(e,r,n);if(e===n){switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3])}var i=[null];return Bf(GH,i,r),new(Bf(VH,e,i))}var l=n.prototype,f=HH(yS(l)?l:KH),c=Bf(e,f,r);return yS(c)?c:f}});var JH=Te,QH=JH.Reflect.construct,YH=QH,KA=YH,XH=KA;const ZH=ne(XH);function GA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eK(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Zh(t,Fq(n.key),n)}}function JA(t,e,r){return e&&eK(t.prototype,e),Zh(t,"prototype",{writable:!1}),t}function tK(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rK(t,e){if(e&&(lt(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tK(t)}var nK=KA,iK=nK,oK=iK,sK=oK,aK=sK;const cK=ne(aK);function QA(){try{var t=!Boolean.prototype.valueOf.call(cK(Boolean,[],function(){}))}catch{}return(QA=function(){return!!t})()}var uK=Y,SS=UA;uK({target:"Function",proto:!0,forced:Function.bind!==SS},{bind:SS});var pK=t_,fK=pK("Function","bind"),lK=Jr,vK=fK,qf=Function.prototype,hK=function(t){var e=t.bind;return t===qf||lK(qf,t)&&e===qf.bind?vK:e},dK=hK,gK=dK,yK=gK,mK=yK,SK=mK,bK=SK,CK=bK;const YA=ne(CK);function _u(t){var e;return _u=Yv?YA(e=Om).call(e):function(r){return r.__proto__||Om(r)},_u(t)}function yh(t,e){var r;return yh=Yv?YA(r=Yv).call(r):function(n,i){return n.__proto__=i,n},yh(t,e)}function PK(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=_3(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Zh(t,"prototype",{writable:!1}),e&&yh(t,e)}var wK=ue,bS=nd,Mc=Xu.getWeakData,RK=Fu,EK=ct,OK=Gr,Ff=Ee,_K=Yt,XA=Kh,CS=Be,ZA=hr,AK=ZA.set,IK=ZA.getterFor,TK=XA.find,MK=XA.findIndex,DK=wK([].splice),$K=0,Dc=function(t){return t.frozen||(t.frozen=new eI)},eI=function(){this.entries=[]},Uf=function(t,e){return TK(t.entries,function(r){return r[0]===e})};eI.prototype={get:function(t){var e=Uf(this,t);if(e)return e[1]},has:function(t){return!!Uf(this,t)},set:function(t,e){var r=Uf(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=MK(this.entries,function(r){return r[0]===t});return~e&&DK(this.entries,e,1),!!~e}};var kK={getConstructor:function(t,e,r,n){var i=t(function(o,s){RK(o,l),AK(o,{type:e,id:$K++,frozen:null}),OK(s)||_K(s,o[n],{that:o,AS_ENTRIES:r})}),l=i.prototype,f=IK(e),c=function(o,s,a){var u=f(o),p=Mc(EK(s),!0);return p===!0?Dc(u).set(s,a):p[u.id]=a,o};return bS(l,{delete:function(o){var s=f(this);if(!Ff(o))return!1;var a=Mc(o);return a===!0?Dc(s).delete(o):a&&CS(a,s.id)&&delete a[s.id]},has:function(s){var a=f(this);if(!Ff(s))return!1;var u=Mc(s);return u===!0?Dc(a).has(s):u&&CS(u,a.id)}}),bS(l,r?{get:function(s){var a=f(this);if(Ff(s)){var u=Mc(s);if(u===!0)return Dc(a).get(s);if(u)return u[a.id]}},set:function(s,a){return c(this,s,a)}}:{add:function(s){return c(this,s,!0)}}),i}},xK=g_,PS=he,tu=ue,wS=nd,jK=Xu,zK=S_,tI=kK,$c=Ee,kc=hr.enforce,NK=ce,LK=DE,xa=Object,BK=Array.isArray,xc=xa.isExtensible,rI=xa.isFrozen,qK=xa.isSealed,nI=xa.freeze,FK=xa.seal,UK=!PS.ActiveXObject&&"ActiveXObject"in PS,si,iI=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},oI=zK("WeakMap",iI,tI),gn=oI.prototype,ru=tu(gn.set),VK=function(){return xK&&NK(function(){var t=nI([]);return ru(new oI,t,1),!rI(t)})};if(LK)if(UK){si=tI.getConstructor(iI,"WeakMap",!0),jK.enable();var RS=tu(gn.delete),jc=tu(gn.has),ES=tu(gn.get);wS(gn,{delete:function(t){if($c(t)&&!xc(t)){var e=kc(this);return e.frozen||(e.frozen=new si),RS(this,t)||e.frozen.delete(t)}return RS(this,t)},has:function(e){if($c(e)&&!xc(e)){var r=kc(this);return r.frozen||(r.frozen=new si),jc(this,e)||r.frozen.has(e)}return jc(this,e)},get:function(e){if($c(e)&&!xc(e)){var r=kc(this);return r.frozen||(r.frozen=new si),jc(this,e)?ES(this,e):r.frozen.get(e)}return ES(this,e)},set:function(e,r){if($c(e)&&!xc(e)){var n=kc(this);n.frozen||(n.frozen=new si),jc(this,e)?ru(this,e,r):n.frozen.set(e,r)}else ru(this,e,r);return this}})}else VK()&&wS(gn,{set:function(e,r){var n;return BK(e)&&(rI(e)?n=nI:qK(e)&&(n=FK)),ru(this,e,r),n&&n(e),this}});var WK=Te,HK=WK.WeakMap,KK=HK,GK=KK,JK=GK;const ra=ne(JK);var QK=w_;const OS=ne(QK);var YK=S_,XK=b3;YK("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},XK);var ZK=Ve,zc=C3,_S=ZK("Map"),e8={Map:_S,set:zc("set",2),get:zc("get",1),has:zc("has",1),remove:zc("delete",1),proto:_S.prototype},t8=Y,r8=ue,n8=vt,i8=va,o8=Yt,cp=e8,s8=hE,a8=cp.Map,c8=cp.has,u8=cp.get,p8=cp.set,f8=r8([].push);t8({target:"Map",stat:!0,forced:s8},{groupBy:function(e,r){i8(e),n8(r);var n=new a8,i=0;return o8(e,function(l){var f=r(l,i++);c8(n,f)?f8(u8(n,f),l):p8(n,f,[l])}),n}});var l8=Te,v8=l8.Map,h8=v8,d8=h8,g8=d8;const y8=ne(g8);var m8=QO;const sI=ne(m8);var S8=Nn,b8=S8.f("toStringTag"),C8=b8,P8=C8,w8=P8;const Au=ne(w8);function R8(t,e,r){return e=_u(e),rK(t,QA()?ZH(e,[],_u(t).constructor):e.apply(t,r))}var E8=gu,aI=Mt,O8=f_,cI=u4,_8=Xv,A8=Object.prototype.hasOwnProperty,I8=function(e,r){return function(){return r||(0,e[cI(e)[0]])((r={exports:{}}).exports,r),r.exports}},T8=function(e,r,n,i){if(r&&lt(r)==="object"||typeof r=="function"){var l=X3(cI(r)),f;try{var c=function(){var s=f.value;!A8.call(e,s)&&s!==n&&aI(e,s,{get:function(){return r[s]},enumerable:!(i=O8(r,s))||i.enumerable})};for(l.s();!(f=l.n()).done;)c()}catch(o){l.e(o)}finally{l.f()}}return e},M8=function(e,r,n){return n=e!=null?E8(_8(e)):{},T8(aI(n,"default",{value:e,enumerable:!0}),e)},D8=I8({"../abort-controller/node_modules/event-target-shim/dist/event-target-shim.js":function(e,r){Mt(e,"__esModule",{value:!0});var n=new ra,i=new ra;function l(E){var T=n.get(E);return console.assert(T!=null,"'this' is expected an Event object, but got",E),T}function f(E){if(E.passiveListener!=null){typeof console<"u"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",E.passiveListener);return}E.event.cancelable&&(E.canceled=!0,typeof E.event.preventDefault=="function"&&E.event.preventDefault())}function c(E,T){n.set(this,{eventTarget:E,event:T,eventPhase:2,currentTarget:E,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:T.timeStamp||Yq()}),Mt(this,"isTrusted",{value:!1,enumerable:!0});for(var A=mm(T),_=0;_<A.length;++_){var $=A[_];$ in this||Mt(this,$,o($))}}c.prototype={get type(){return l(this).event.type},get target(){return l(this).eventTarget},get currentTarget(){return l(this).currentTarget},composedPath:function(){var T=l(this).currentTarget;return T==null?[]:[T]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return l(this).eventPhase},stopPropagation:function(){var T=l(this);T.stopped=!0,typeof T.event.stopPropagation=="function"&&T.event.stopPropagation()},stopImmediatePropagation:function(){var T=l(this);T.stopped=!0,T.immediateStopped=!0,typeof T.event.stopImmediatePropagation=="function"&&T.event.stopImmediatePropagation()},get bubbles(){return!!l(this).event.bubbles},get cancelable(){return!!l(this).event.cancelable},preventDefault:function(){f(l(this))},get defaultPrevented(){return l(this).canceled},get composed(){return!!l(this).event.composed},get timeStamp(){return l(this).timeStamp},get srcElement(){return l(this).eventTarget},get cancelBubble(){return l(this).stopped},set cancelBubble(E){if(E){var T=l(this);T.stopped=!0,typeof T.event.cancelBubble=="boolean"&&(T.event.cancelBubble=!0)}},get returnValue(){return!l(this).canceled},set returnValue(E){E||f(l(this))},initEvent:function(){}},Mt(c.prototype,"constructor",{value:c,configurable:!0,writable:!0}),typeof window<"u"&&typeof window.Event<"u"&&(OS(c.prototype,window.Event.prototype),i.set(window.Event.prototype,c));function o(E){return{get:function(){return l(this).event[E]},set:function(A){l(this).event[E]=A},configurable:!0,enumerable:!0}}function s(E){return{value:function(){var A=l(this).event;return A[E].apply(A,arguments)},configurable:!0,enumerable:!0}}function a(E,T){var A=mm(T);if(A.length===0)return E;function _(N,W){E.call(this,N,W)}_.prototype=gu(E.prototype,{constructor:{value:_,configurable:!0,writable:!0}});for(var $=0;$<A.length;++$){var x=A[$];if(!(x in E.prototype)){var B=f_(T,x),U=typeof B.value=="function";Mt(_.prototype,x,U?s(x):o(x))}}return _}function u(E){if(E==null||E===Object.prototype)return c;var T=i.get(E);return T==null&&(T=a(u(Xv(E)),E),i.set(E,T)),T}function p(E,T){var A=u(Xv(T));return new A(E,T)}function v(E){return l(E).immediateStopped}function g(E,T){l(E).eventPhase=T}function h(E,T){l(E).currentTarget=T}function d(E,T){l(E).passiveListener=T}var y=new ra,m=1,S=2,b=3;function P(E){return E!==null&&lt(E)==="object"}function C(E){var T=y.get(E);if(T==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return T}function R(E){return{get:function(){for(var A=C(this),_=A.get(E);_!=null;){if(_.listenerType===b)return _.listener;_=_.next}return null},set:function(A){typeof A!="function"&&!P(A)&&(A=null);for(var _=C(this),$=null,x=_.get(E);x!=null;)x.listenerType===b?$!==null?$.next=x.next:x.next!==null?_.set(E,x.next):_.delete(E):$=x,x=x.next;if(A!==null){var B={listener:A,listenerType:b,passive:!1,once:!1,next:null};$===null?_.set(E,B):$.next=B}},configurable:!0,enumerable:!0}}function O(E,T){Mt(E,"on".concat(T),R(T))}function z(E){function T(){L.call(this)}T.prototype=gu(L.prototype,{constructor:{value:T,configurable:!0,writable:!0}});for(var A=0;A<E.length;++A)O(T.prototype,E[A]);return T}function L(){if(this instanceof L){y.set(this,new y8);return}if(arguments.length===1&&_F(arguments[0]))return z(arguments[0]);if(arguments.length>0){for(var E=new Array(arguments.length),T=0;T<arguments.length;++T)E[T]=arguments[T];return z(E)}throw new TypeError("Cannot call a class as a function")}L.prototype={addEventListener:function(T,A,_){if(A!=null){if(typeof A!="function"&&!P(A))throw new TypeError("'listener' should be a function or an object.");var $=C(this),x=P(_),B=x?!!_.capture:!!_,U=B?m:S,N={listener:A,listenerType:U,passive:x&&!!_.passive,once:x&&!!_.once,next:null},W=$.get(T);if(W===void 0){$.set(T,N);return}for(var oe=null;W!=null;){if(W.listener===A&&W.listenerType===U)return;oe=W,W=W.next}oe.next=N}},removeEventListener:function(T,A,_){if(A!=null)for(var $=C(this),x=P(_)?!!_.capture:!!_,B=x?m:S,U=null,N=$.get(T);N!=null;){if(N.listener===A&&N.listenerType===B){U!==null?U.next=N.next:N.next!==null?$.set(T,N.next):$.delete(T);return}U=N,N=N.next}},dispatchEvent:function(T){if(T==null||typeof T.type!="string")throw new TypeError('"event.type" should be a string.');var A=C(this),_=T.type,$=A.get(_);if($==null)return!0;for(var x=p(this,T),B=null;$!=null;){if($.once?B!==null?B.next=$.next:$.next!==null?A.set(_,$.next):A.delete(_):B=$,d(x,$.passive?$.listener:null),typeof $.listener=="function")try{$.listener.call(this,x)}catch(U){typeof console<"u"&&typeof console.error=="function"&&console.error(U)}else $.listenerType!==b&&typeof $.listener.handleEvent=="function"&&$.listener.handleEvent(x);if(v(x))break;$=$.next}return d(x,null),g(x,0),h(x,null),!x.defaultPrevented}},Mt(L.prototype,"constructor",{value:L,configurable:!0,writable:!0}),typeof window<"u"&&typeof window.EventTarget<"u"&&OS(L.prototype,window.EventTarget.prototype),e.defineEventAttribute=O,e.EventTarget=L,e.default=L,r.exports=L,r.exports.EventTarget=r.exports.default=L,r.exports.defineEventAttribute=O}}),Nd=M8(D8()),up=function(t){function e(){throw GA(this,e),R8(this,e),new TypeError("AbortSignal cannot be constructed directly")}return PK(e,t),JA(e,[{key:"aborted",get:function(){var n=Iu.get(this);if(typeof n!="boolean")throw new TypeError("Expected 'this' to be an 'AbortSignal' object, but got ".concat(this===null?"null":lt(this)));return n}}])}(Nd.EventTarget);(0,Nd.defineEventAttribute)(up.prototype,"abort");function $8(){var t=gu(up.prototype);return Nd.EventTarget.call(t),Iu.set(t,!1),t}function k8(t){Iu.get(t)===!1&&(Iu.set(t,!0),t.dispatchEvent({type:"abort"}))}var Iu=new ra;h_(up.prototype,{aborted:{enumerable:!0}});typeof sI=="function"&&lt(Au)==="symbol"&&Mt(up.prototype,Au,{configurable:!0,value:"AbortSignal"});var Ld=function(){function t(){GA(this,t),uI.set(this,$8())}return JA(t,[{key:"signal",get:function(){return AS(this)}},{key:"abort",value:function(){k8(AS(this))}}])}(),uI=new ra;function AS(t){var e=uI.get(t);if(e==null)throw new TypeError("Expected 'this' to be an 'AbortController' object, but got ".concat(t===null?"null":lt(t)));return e}h_(Ld.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}});typeof sI=="function"&&lt(Au)==="symbol"&&Mt(Ld.prototype,Au,{configurable:!0,value:"AbortController"});var x8=Ld,j8=(typeof window>"u"?{}:window).AbortController,z8=j8||x8,pI={},fI={exports:{}};(function(t){function e(r){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(fI);var pp=fI.exports,ja={},lI={exports:{}};(function(t){function e(r){return r&&r.__esModule?r:{default:r}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(lI);var qn=lI.exports,Vf={exports:{}},IS;function N8(){return IS||(IS=1,function(t){var e=pp.default;function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var n={},i=Object.prototype,l=i.hasOwnProperty,f=typeof Symbol=="function"?Symbol:{},c=f.iterator||"@@iterator",o=f.asyncIterator||"@@asyncIterator",s=f.toStringTag||"@@toStringTag";function a(A,_,$){return Object.defineProperty(A,_,{value:$,enumerable:!0,configurable:!0,writable:!0}),A[_]}try{a({},"")}catch{a=function($,x,B){return $[x]=B}}function u(A,_,$,x){var B=_&&_.prototype instanceof g?_:g,U=Object.create(B.prototype),N=new L(x||[]);return U._invoke=function(W,oe,G){var pe="suspendedStart";return function(je,Bt){if(pe==="executing")throw new Error("Generator is already running");if(pe==="completed"){if(je==="throw")throw Bt;return T()}for(G.method=je,G.arg=Bt;;){var Ge=G.delegate;if(Ge){var ut=R(Ge,G);if(ut){if(ut===v)continue;return ut}}if(G.method==="next")G.sent=G._sent=G.arg;else if(G.method==="throw"){if(pe==="suspendedStart")throw pe="completed",G.arg;G.dispatchException(G.arg)}else G.method==="return"&&G.abrupt("return",G.arg);pe="executing";var pt=p(W,oe,G);if(pt.type==="normal"){if(pe=G.done?"completed":"suspendedYield",pt.arg===v)continue;return{value:pt.arg,done:G.done}}pt.type==="throw"&&(pe="completed",G.method="throw",G.arg=pt.arg)}}}(A,$,N),U}function p(A,_,$){try{return{type:"normal",arg:A.call(_,$)}}catch(x){return{type:"throw",arg:x}}}n.wrap=u;var v={};function g(){}function h(){}function d(){}var y={};a(y,c,function(){return this});var m=Object.getPrototypeOf,S=m&&m(m(E([])));S&&S!==i&&l.call(S,c)&&(y=S);var b=d.prototype=g.prototype=Object.create(y);function P(A){["next","throw","return"].forEach(function(_){a(A,_,function($){return this._invoke(_,$)})})}function C(A,_){function $(B,U,N,W){var oe=p(A[B],A,U);if(oe.type!=="throw"){var G=oe.arg,pe=G.value;return pe&&e(pe)=="object"&&l.call(pe,"__await")?_.resolve(pe.__await).then(function(je){$("next",je,N,W)},function(je){$("throw",je,N,W)}):_.resolve(pe).then(function(je){G.value=je,N(G)},function(je){return $("throw",je,N,W)})}W(oe.arg)}var x;this._invoke=function(B,U){function N(){return new _(function(W,oe){$(B,U,W,oe)})}return x=x?x.then(N,N):N()}}function R(A,_){var $=A.iterator[_.method];if($===void 0){if(_.delegate=null,_.method==="throw"){if(A.iterator.return&&(_.method="return",_.arg=void 0,R(A,_),_.method==="throw"))return v;_.method="throw",_.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var x=p($,A.iterator,_.arg);if(x.type==="throw")return _.method="throw",_.arg=x.arg,_.delegate=null,v;var B=x.arg;return B?B.done?(_[A.resultName]=B.value,_.next=A.nextLoc,_.method!=="return"&&(_.method="next",_.arg=void 0),_.delegate=null,v):B:(_.method="throw",_.arg=new TypeError("iterator result is not an object"),_.delegate=null,v)}function O(A){var _={tryLoc:A[0]};1 in A&&(_.catchLoc=A[1]),2 in A&&(_.finallyLoc=A[2],_.afterLoc=A[3]),this.tryEntries.push(_)}function z(A){var _=A.completion||{};_.type="normal",delete _.arg,A.completion=_}function L(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(O,this),this.reset(!0)}function E(A){if(A){var _=A[c];if(_)return _.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var $=-1,x=function B(){for(;++$<A.length;)if(l.call(A,$))return B.value=A[$],B.done=!1,B;return B.value=void 0,B.done=!0,B};return x.next=x}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,a(b,"constructor",d),a(d,"constructor",h),h.displayName=a(d,s,"GeneratorFunction"),n.isGeneratorFunction=function(A){var _=typeof A=="function"&&A.constructor;return!!_&&(_===h||(_.displayName||_.name)==="GeneratorFunction")},n.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,d):(A.__proto__=d,a(A,s,"GeneratorFunction")),A.prototype=Object.create(b),A},n.awrap=function(A){return{__await:A}},P(C.prototype),a(C.prototype,o,function(){return this}),n.AsyncIterator=C,n.async=function(A,_,$,x,B){B===void 0&&(B=Promise);var U=new C(u(A,_,$,x),B);return n.isGeneratorFunction(_)?U:U.next().then(function(N){return N.done?N.value:U.next()})},P(b),a(b,s,"Generator"),a(b,c,function(){return this}),a(b,"toString",function(){return"[object Generator]"}),n.keys=function(A){var _=[];for(var $ in A)_.push($);return _.reverse(),function x(){for(;_.length;){var B=_.pop();if(B in A)return x.value=B,x.done=!1,x}return x.done=!0,x}},n.values=E,L.prototype={constructor:L,reset:function(_){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(z),!_)for(var $ in this)$.charAt(0)==="t"&&l.call(this,$)&&!isNaN(+$.slice(1))&&(this[$]=void 0)},stop:function(){this.done=!0;var _=this.tryEntries[0].completion;if(_.type==="throw")throw _.arg;return this.rval},dispatchException:function(_){if(this.done)throw _;var $=this;function x(G,pe){return N.type="throw",N.arg=_,$.next=G,pe&&($.method="next",$.arg=void 0),!!pe}for(var B=this.tryEntries.length-1;B>=0;--B){var U=this.tryEntries[B],N=U.completion;if(U.tryLoc==="root")return x("end");if(U.tryLoc<=this.prev){var W=l.call(U,"catchLoc"),oe=l.call(U,"finallyLoc");if(W&&oe){if(this.prev<U.catchLoc)return x(U.catchLoc,!0);if(this.prev<U.finallyLoc)return x(U.finallyLoc)}else if(W){if(this.prev<U.catchLoc)return x(U.catchLoc,!0)}else{if(!oe)throw new Error("try statement without catch or finally");if(this.prev<U.finallyLoc)return x(U.finallyLoc)}}}},abrupt:function(_,$){for(var x=this.tryEntries.length-1;x>=0;--x){var B=this.tryEntries[x];if(B.tryLoc<=this.prev&&l.call(B,"finallyLoc")&&this.prev<B.finallyLoc){var U=B;break}}U&&(_==="break"||_==="continue")&&U.tryLoc<=$&&$<=U.finallyLoc&&(U=null);var N=U?U.completion:{};return N.type=_,N.arg=$,U?(this.method="next",this.next=U.finallyLoc,v):this.complete(N)},complete:function(_,$){if(_.type==="throw")throw _.arg;return _.type==="break"||_.type==="continue"?this.next=_.arg:_.type==="return"?(this.rval=this.arg=_.arg,this.method="return",this.next="end"):_.type==="normal"&&$&&(this.next=$),v},finish:function(_){for(var $=this.tryEntries.length-1;$>=0;--$){var x=this.tryEntries[$];if(x.finallyLoc===_)return this.complete(x.completion,x.afterLoc),z(x),v}},catch:function(_){for(var $=this.tryEntries.length-1;$>=0;--$){var x=this.tryEntries[$];if(x.tryLoc===_){var B=x.completion;if(B.type==="throw"){var U=B.arg;z(x)}return U}}throw new Error("illegal catch attempt")},delegateYield:function(_,$,x){return this.delegate={iterator:E(_),resultName:$,nextLoc:x},this.method==="next"&&(this.arg=void 0),v}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Vf)),Vf.exports}var Wf,TS;function vI(){if(TS)return Wf;TS=1;var t=N8()();Wf=t;try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}return Wf}var Hf={exports:{}},Kf={exports:{}},Gf={exports:{}},MS;function hI(){return MS||(MS=1,function(t){function e(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,l=new Array(n);i<n;i++)l[i]=r[i];return l}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Gf)),Gf.exports}var DS;function L8(){return DS||(DS=1,function(t){var e=hI();function r(n){if(Array.isArray(n))return e(n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Kf)),Kf.exports}var Jf={exports:{}},$S;function B8(){return $S||($S=1,function(t){function e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Jf)),Jf.exports}var Qf={exports:{}},kS;function q8(){return kS||(kS=1,function(t){var e=hI();function r(n,i){if(n){if(typeof n=="string")return e(n,i);var l=Object.prototype.toString.call(n).slice(8,-1);if(l==="Object"&&n.constructor&&(l=n.constructor.name),l==="Map"||l==="Set")return Array.from(n);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return e(n,i)}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Qf)),Qf.exports}var Yf={exports:{}},xS;function F8(){return xS||(xS=1,function(t){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Yf)),Yf.exports}var jS;function dI(){return jS||(jS=1,function(t){var e=L8(),r=B8(),n=q8(),i=F8();function l(f){return e(f)||r(f)||n(f)||i()}t.exports=l,t.exports.__esModule=!0,t.exports.default=t.exports}(Hf)),Hf.exports}var Xf={exports:{}},zS;function za(){return zS||(zS=1,function(t){function e(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Xf)),Xf.exports}var Zf={exports:{}},NS;function gI(){return NS||(NS=1,function(t){function e(n,i,l,f,c,o,s){try{var a=n[o](s),u=a.value}catch(p){l(p);return}a.done?i(u):Promise.resolve(u).then(f,c)}function r(n){return function(){var i=this,l=arguments;return new Promise(function(f,c){var o=n.apply(i,l);function s(u){e(o,f,c,s,a,"next",u)}function a(u){e(o,f,c,s,a,"throw",u)}s(void 0)})}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(Zf)),Zf.exports}var el={exports:{}},LS;function Bd(){return LS||(LS=1,function(t){function e(n,i){for(var l=0;l<i.length;l++){var f=i[l];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function r(n,i,l){return i&&e(n.prototype,i),l&&e(n,l),Object.defineProperty(n,"prototype",{writable:!1}),n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(el)),el.exports}var tl={exports:{}},BS;function qd(){return BS||(BS=1,function(t){function e(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(tl)),tl.exports}var rl={exports:{}},nl={exports:{}},qS;function Fd(){return qS||(qS=1,function(t){function e(r,n){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,f){return l.__proto__=f,l},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(nl)),nl.exports}var FS;function yI(){return FS||(FS=1,function(t){var e=Fd();function r(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),i&&e(n,i)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(rl)),rl.exports}var il={exports:{}},ol={exports:{}},US;function mI(){return US||(US=1,function(t){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ol)),ol.exports}var VS;function SI(){return VS||(VS=1,function(t){var e=pp.default,r=mI();function n(i,l){if(l&&(e(l)==="object"||typeof l=="function"))return l;if(l!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(i)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(il)),il.exports}var sl={exports:{}},WS;function fp(){return WS||(WS=1,function(t){function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(sl)),sl.exports}var ft={},al={exports:{}},cl={exports:{}},HS;function bI(){return HS||(HS=1,function(t){var e=fp();function r(n,i){for(;!Object.prototype.hasOwnProperty.call(n,i)&&(n=e(n),n!==null););return n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(cl)),cl.exports}var KS;function U8(){return KS||(KS=1,function(t){var e=bI(),r=za();function n(l,f,c,o){return typeof Reflect<"u"&&Reflect.set?n=Reflect.set:n=function(a,u,p,v){var g=e(a,u),h;if(g){if(h=Object.getOwnPropertyDescriptor(g,u),h.set)return h.set.call(v,p),!0;if(!h.writable)return!1}if(h=Object.getOwnPropertyDescriptor(v,u),h){if(!h.writable)return!1;h.value=p,Object.defineProperty(v,u,h)}else r(v,u,p);return!0},n(l,f,c,o)}function i(l,f,c,o,s){var a=n(l,f,c,o||l);if(!a&&s)throw new Error("failed to set property");return c}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(al)),al.exports}var ul={exports:{}},GS;function V8(){return GS||(GS=1,function(t){var e=bI();function r(){return typeof Reflect<"u"&&Reflect.get?(t.exports=r=Reflect.get.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=r=function(i,l,f){var c=e(i,l);if(c){var o=Object.getOwnPropertyDescriptor(c,l);return o.get?o.get.call(arguments.length<3?i:f):o.value}},t.exports.__esModule=!0,t.exports.default=t.exports),r.apply(this,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(ul)),ul.exports}var pl={exports:{}},fl={exports:{}},JS;function W8(){return JS||(JS=1,function(t){function e(r){return Function.toString.call(r).indexOf("[native code]")!==-1}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(fl)),fl.exports}var ll={exports:{}},vl={exports:{}},QS;function H8(){return QS||(QS=1,function(t){function e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(vl)),vl.exports}var YS;function K8(){return YS||(YS=1,function(t){var e=Fd(),r=H8();function n(i,l,f){return r()?(t.exports=n=Reflect.construct.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=n=function(o,s,a){var u=[null];u.push.apply(u,s);var p=Function.bind.apply(o,u),v=new p;return a&&e(v,a.prototype),v},t.exports.__esModule=!0,t.exports.default=t.exports),n.apply(null,arguments)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(ll)),ll.exports}var XS;function G8(){return XS||(XS=1,function(t){var e=fp(),r=Fd(),n=W8(),i=K8();function l(f){var c=typeof Map=="function"?new Map:void 0;return t.exports=l=function(s){if(s===null||!n(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof c<"u"){if(c.has(s))return c.get(s);c.set(s,a)}function a(){return i(s,arguments,e(this).constructor)}return a.prototype=Object.create(s.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),r(a,s)},t.exports.__esModule=!0,t.exports.default=t.exports,l(f)}t.exports=l,t.exports.__esModule=!0,t.exports.default=t.exports}(pl)),pl.exports}var ZS;function J8(){if(ZS)return ft;ZS=1,Object.defineProperty(ft,"__esModule",{value:!0});var t=dI(),e=U8(),r=V8(),n=mI(),i=yI(),l=SI(),f=fp(),c=G8(),o=za(),s=qd(),a=Bd(),u=pp;function p(I){return I&&typeof I=="object"&&"default"in I?I:{default:I}}var v=p(t),g=p(e),h=p(r),d=p(n),y=p(i),m=p(l),S=p(f),b=p(c),P=p(o),C=p(s),R=p(a),O=p(u);function z(I){var D=L();return function(){var k=S.default(I),q;if(D){var V=S.default(this).constructor;q=Reflect.construct(k,arguments,V)}else q=k.apply(this,arguments);return m.default(this,q)}}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function E(I,D){var M=Object.keys(I);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(I);D&&(k=k.filter(function(q){return Object.getOwnPropertyDescriptor(I,q).enumerable})),M.push.apply(M,k)}return M}function T(I){for(var D=1;D<arguments.length;D++){var M=arguments[D]!=null?arguments[D]:{};D%2?E(Object(M),!0).forEach(function(k){P.default(I,k,M[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(M)):E(Object(M)).forEach(function(k){Object.defineProperty(I,k,Object.getOwnPropertyDescriptor(M,k))})}return I}function A(I,D){if(!I){for(var M=arguments.length,k=new Array(M>2?M-2:0),q=2;q<M;q++)k[q-2]=arguments[q];throw new TypeError(_(D,k))}}function _(I,D){var M=0;return I.replace(/%[os]/g,function(){return $(D[M++])})}function $(I){return O.default(I)!=="object"||I===null?String(I):Object.prototype.toString.call(I)}var x;function B(I){A(typeof I=="function"||I===void 0,"The error handler must be a function or undefined, but got %o.",I),x=I}function U(I){try{var D=I instanceof Error?I:new Error($(I));if(x){x(D);return}if(typeof dispatchEvent=="function"&&typeof ErrorEvent=="function")dispatchEvent(new ErrorEvent("error",{error:D,message:D.message}));else if(typeof process<"u"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)}catch{}}var N=typeof window<"u"?window:typeof self<"u"?self:typeof w<"u"?w:typeof globalThis<"u"?globalThis:void 0,W;function oe(I){A(typeof I=="function"||I===void 0,"The warning handler must be a function or undefined, but got %o.",I),W=I}var G=function(){function I(D,M){C.default(this,I),this.code=D,this.message=M}return R.default(I,[{key:"warn",value:function(){var M;try{for(var k,q=arguments.length,V=new Array(q),Q=0;Q<q;Q++)V[Q]=arguments[Q];if(W){W(T(T({},this),{},{args:V}));return}var fe=((M=new Error().stack)!==null&&M!==void 0?M:"").replace(/^(?:(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+?\n){2}/g,`
`);(k=console).warn.apply(k,[this.message].concat(V,[fe]))}catch{}}}]),I}(),pe=new G("W01","Unable to initialize event under dispatching."),je=new G("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),Bt=new G("W03","Assigning any truthy value to 'returnValue' property has no effect."),Ge=new G("W04","Unable to preventDefault on non-cancelable events."),ut=new G("W05","Unable to preventDefault inside passive event listener invocation."),pt=new G("W06","An event listener wasn't added because it has been added already: %o, %o"),_t=new G("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),nr=new G("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o"),ir=new G("W09","Event attribute handler must be a function: %o"),nt=function(){R.default(I,null,[{key:"NONE",get:function(){return ie}},{key:"CAPTURING_PHASE",get:function(){return yr}},{key:"AT_TARGET",get:function(){return Fa}},{key:"BUBBLING_PHASE",get:function(){return Ua}}]);function I(D,M){C.default(this,I),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});var k=M??{};Wn.set(this,{type:String(D),bubbles:!!k.bubbles,cancelable:!!k.cancelable,composed:!!k.composed,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}return R.default(I,[{key:"composedPath",value:function(){var M=me(this).currentTarget;return M?[M]:[]}},{key:"stopPropagation",value:function(){me(this).stopPropagationFlag=!0}},{key:"stopImmediatePropagation",value:function(){var M=me(this);M.stopPropagationFlag=M.stopImmediatePropagationFlag=!0}},{key:"preventDefault",value:function(){Va(me(this))}},{key:"initEvent",value:function(M){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,V=me(this);if(V.dispatchFlag){pe.warn();return}Wn.set(this,T(T({},V),{},{type:String(M),bubbles:!!k,cancelable:!!q,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1}))}},{key:"type",get:function(){return me(this).type}},{key:"target",get:function(){return me(this).target}},{key:"srcElement",get:function(){return me(this).target}},{key:"currentTarget",get:function(){return me(this).currentTarget}},{key:"NONE",get:function(){return ie}},{key:"CAPTURING_PHASE",get:function(){return yr}},{key:"AT_TARGET",get:function(){return Fa}},{key:"BUBBLING_PHASE",get:function(){return Ua}},{key:"eventPhase",get:function(){return me(this).dispatchFlag?2:0}},{key:"cancelBubble",get:function(){return me(this).stopPropagationFlag},set:function(M){M?me(this).stopPropagationFlag=!0:je.warn()}},{key:"bubbles",get:function(){return me(this).bubbles}},{key:"cancelable",get:function(){return me(this).cancelable}},{key:"returnValue",get:function(){return!me(this).canceledFlag},set:function(M){M?Bt.warn():Va(me(this))}},{key:"defaultPrevented",get:function(){return me(this).canceledFlag}},{key:"composed",get:function(){return me(this).composed}},{key:"isTrusted",get:function(){return!1}},{key:"timeStamp",get:function(){return me(this).timeStamp}}]),I}(),ie=0,yr=1,Fa=2,Ua=3,Wn=new WeakMap;function me(I){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"this",M=Wn.get(I);return A(M!=null,"'%s' must be an object that Event constructor created, but got another one: %o",D,I),M}function Va(I){if(I.inPassiveListenerFlag){ut.warn();return}if(!I.cancelable){Ge.warn();return}I.canceledFlag=!0}Object.defineProperty(nt,"NONE",{enumerable:!0}),Object.defineProperty(nt,"CAPTURING_PHASE",{enumerable:!0}),Object.defineProperty(nt,"AT_TARGET",{enumerable:!0}),Object.defineProperty(nt,"BUBBLING_PHASE",{enumerable:!0});for(var Hn=Object.getOwnPropertyNames(nt.prototype),mr=0;mr<Hn.length;++mr)Hn[mr]!=="constructor"&&Object.defineProperty(nt.prototype,Hn[mr],{enumerable:!0});typeof N<"u"&&typeof N.Event<"u"&&Object.setPrototypeOf(nt.prototype,N.Event.prototype);function Wa(I){return N.DOMException?new N.DOMException(I,"InvalidStateError"):(or==null&&(or=function(D){y.default(k,D);var M=z(k);function k(q){var V;return C.default(this,k),V=M.call(this,q),Error.captureStackTrace&&Error.captureStackTrace(d.default(V),k),V}return R.default(k,[{key:"code",get:function(){return 11}},{key:"name",get:function(){return"InvalidStateError"}}]),k}(b.default(Error)),Object.defineProperties(or.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),Ka(or),Ka(or.prototype)),new or(I))}var or,Ha={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function Ka(I){for(var D=Object.keys(Ha),M=function(V){var Q=D[V],fe=Ha[Q];Object.defineProperty(I,Q,{get:function(){return fe},configurable:!0,enumerable:!0})},k=0;k<D.length;++k)M(k)}var rn=function(I){y.default(M,I);var D=z(M);R.default(M,null,[{key:"wrap",value:function(q){return new(Ja(q))(q)}}]);function M(k){var q,V,Q;C.default(this,M),Q=D.call(this,k.type,{bubbles:k.bubbles,cancelable:k.cancelable,composed:k.composed}),k.cancelBubble&&h.default((q=d.default(Q),S.default(M.prototype)),"stopPropagation",q).call(q),k.defaultPrevented&&h.default((V=d.default(Q),S.default(M.prototype)),"preventDefault",V).call(V),Ga.set(d.default(Q),{original:k});for(var fe=Object.keys(k),qe=0;qe<fe.length;++qe){var it=fe[qe];it in d.default(Q)||Object.defineProperty(d.default(Q),it,Je(k,it))}return Q}return R.default(M,[{key:"stopPropagation",value:function(){h.default(S.default(M.prototype),"stopPropagation",this).call(this);var q=At(this),V=q.original;"stopPropagation"in V&&V.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){h.default(S.default(M.prototype),"stopImmediatePropagation",this).call(this);var q=At(this),V=q.original;"stopImmediatePropagation"in V&&V.stopImmediatePropagation()}},{key:"preventDefault",value:function(){h.default(S.default(M.prototype),"preventDefault",this).call(this);var q=At(this),V=q.original;"preventDefault"in V&&V.preventDefault()}},{key:"cancelBubble",get:function(){return h.default(S.default(M.prototype),"cancelBubble",this)},set:function(q){g.default(S.default(M.prototype),"cancelBubble",q,this,!0);var V=At(this),Q=V.original;"cancelBubble"in Q&&(Q.cancelBubble=q)}},{key:"returnValue",get:function(){return h.default(S.default(M.prototype),"returnValue",this)},set:function(q){g.default(S.default(M.prototype),"returnValue",q,this,!0);var V=At(this),Q=V.original;"returnValue"in Q&&(Q.returnValue=q)}},{key:"timeStamp",get:function(){var q=At(this),V=q.original;return"timeStamp"in V?V.timeStamp:h.default(S.default(M.prototype),"timeStamp",this)}}]),M}(nt),Ga=new WeakMap;function At(I){var D=Ga.get(I);return A(D!=null,"'this' is expected an Event object, but got",I),D}var nn=new WeakMap;nn.set(Object.prototype,rn),typeof N<"u"&&typeof N.Event<"u"&&nn.set(N.Event.prototype,rn);function Ja(I){var D=Object.getPrototypeOf(I);if(D==null)return rn;var M=nn.get(D);return M==null&&(M=Kn(Ja(D),D),nn.set(D,M)),M}function Kn(I,D){for(var M=function(V){y.default(fe,V);var Q=z(fe);function fe(){return C.default(this,fe),Q.apply(this,arguments)}return fe}(I),k=Object.keys(D),q=0;q<k.length;++q)Object.defineProperty(M.prototype,k[q],Je(D,k[q]));return M}function Je(I,D){var M=Object.getOwnPropertyDescriptor(I,D);return{get:function(){var q=At(this).original,V=q[D];return typeof V=="function"?V.bind(q):V},set:function(q){var V=At(this).original;V[D]=q},configurable:M.configurable,enumerable:M.enumerable}}function yp(I,D,M,k,q,V){return{callback:I,flags:(D?1:0)|(M?2:0)|(k?4:0),signal:q,signalListener:V}}function mp(I){I.flags|=8}function Qa(I){return(I.flags&1)===1}function Ya(I){return(I.flags&2)===2}function Xa(I){return(I.flags&4)===4}function Sp(I){return(I.flags&8)===8}function bp(I,D,M){var k=I.callback;try{typeof k=="function"?k.call(D,M):typeof k.handleEvent=="function"&&k.handleEvent(M)}catch(q){U(q)}}function Za(I,D,M){for(var k=I.listeners,q=0;q<k.length;++q)if(k[q].callback===D&&Qa(k[q])===M)return q;return-1}function ec(I,D,M,k,q,V){var Q;V&&(Q=Gn.bind(null,I,D,M),V.addEventListener("abort",Q));var fe=yp(D,M,k,q,V,Q);return I.cow?(I.cow=!1,I.listeners=[].concat(v.default(I.listeners),[fe])):I.listeners.push(fe),fe}function Gn(I,D,M){var k=Za(I,D,M);return k!==-1?tc(I,k):!1}function tc(I,D){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,k=I.listeners[D];return mp(k),k.signal&&k.signal.removeEventListener("abort",k.signalListener),I.cow&&!M?(I.cow=!1,I.listeners=I.listeners.filter(function(q,V){return V!==D}),!1):(I.listeners.splice(D,1),!0)}function Cp(){return Object.create(null)}function rc(I,D){var M;return(M=I[D])!==null&&M!==void 0?M:I[D]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}var on=function(){function I(){C.default(this,I),lg.set(this,Cp())}return R.default(I,[{key:"addEventListener",value:function(M,k,q){var V=sn(this),Q=Q0(M,k,q),fe=Q.callback,qe=Q.capture,it=Q.once,Jn=Q.passive,Qn=Q.signal,nT=Q.type;if(!(fe==null||Qn!=null&&Qn.aborted)){var wp=rc(V,nT),yg=Za(wp,fe,qe);if(yg!==-1){X0(wp.listeners[yg],Jn,it,Qn);return}ec(wp,fe,qe,Jn,it,Qn)}}},{key:"removeEventListener",value:function(M,k,q){var V=sn(this),Q=Y0(M,k,q),fe=Q.callback,qe=Q.capture,it=Q.type,Jn=V[it];fe!=null&&Jn&&Gn(Jn,fe,qe)}},{key:"dispatchEvent",value:function(M){var k=sn(this)[String(M.type)];if(k==null)return!0;var q=M instanceof nt?M:rn.wrap(M),V=me(q,"event");if(V.dispatchFlag)throw Wa("This event has been in dispatching.");if(V.dispatchFlag=!0,V.target=V.currentTarget=this,!V.stopPropagationFlag){var Q=k.cow,fe=k.listeners;k.cow=!0;for(var qe=0;qe<fe.length;++qe){var it=fe[qe];if(!Sp(it)&&(Xa(it)&&tc(k,qe,!Q)&&(qe-=1),V.inPassiveListenerFlag=Ya(it),bp(it,this,q),V.inPassiveListenerFlag=!1,V.stopImmediatePropagationFlag))break}Q||(k.cow=!1)}return V.target=null,V.currentTarget=null,V.stopImmediatePropagationFlag=!1,V.stopPropagationFlag=!1,V.dispatchFlag=!1,!V.canceledFlag}}]),I}(),lg=new WeakMap;function sn(I){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"this",M=lg.get(I);return A(M!=null,"'%s' must be an object that EventTarget constructor created, but got another one: %o",D,I),M}function Q0(I,D,M){var k;return vg(D),O.default(M)==="object"&&M!==null?{type:String(I),callback:D??void 0,capture:!!M.capture,passive:!!M.passive,once:!!M.once,signal:(k=M.signal)!==null&&k!==void 0?k:void 0}:{type:String(I),callback:D??void 0,capture:!!M,passive:!1,once:!1,signal:void 0}}function Y0(I,D,M){return vg(D),O.default(M)==="object"&&M!==null?{type:String(I),callback:D??void 0,capture:!!M.capture}:{type:String(I),callback:D??void 0,capture:!!M}}function vg(I){if(!(typeof I=="function"||O.default(I)==="object"&&I!==null&&typeof I.handleEvent=="function")){if(I==null||O.default(I)==="object"){nr.warn(I);return}throw new TypeError(_(nr.message,[I]))}}function X0(I,D,M,k){pt.warn(Qa(I)?"capture":"bubble",I.callback),Ya(I)!==D&&_t.warn("passive"),Xa(I)!==M&&_t.warn("once"),I.signal!==k&&_t.warn("signal")}for(var Pp=Object.getOwnPropertyNames(on.prototype),nc=0;nc<Pp.length;++nc)Pp[nc]!=="constructor"&&Object.defineProperty(on.prototype,Pp[nc],{enumerable:!0});typeof N<"u"&&typeof N.EventTarget<"u"&&Object.setPrototypeOf(on.prototype,N.EventTarget.prototype);function hg(I,D){var M,k,q=sn(I,"target");return(k=(M=q[D])===null||M===void 0?void 0:M.attrCallback)!==null&&k!==void 0?k:null}function dg(I,D,M){M!=null&&typeof M!="function"&&ir.warn(M),typeof M=="function"||O.default(M)==="object"&&M!==null?Z0(I,D,M):eT(I,D)}function Z0(I,D,M){var k=rc(sn(I,"target"),String(D));k.attrCallback=M,k.attrListener==null&&(k.attrListener=ec(k,tT(k),!1,!1,!1,void 0))}function eT(I,D){var M=sn(I,"target"),k=M[String(D)];k&&k.attrListener&&(Gn(k,k.attrListener.callback,!1),k.attrCallback=k.attrListener=void 0)}function tT(I){return function(D){var M=I.attrCallback;typeof M=="function"&&M.call(this,D)}}function rT(){for(var I=function(M){y.default(q,M);var k=z(q);function q(){return C.default(this,q),k.apply(this,arguments)}return q}(on),D=0;D<arguments.length;++D)gg(I.prototype,D<0||arguments.length<=D?void 0:arguments[D]);return I}function gg(I,D,M){Object.defineProperty(I,"on".concat(D),{get:function(){return hg(this,D)},set:function(q){dg(this,D,q)},configurable:!0,enumerable:!0})}return ft.Event=nt,ft.EventTarget=on,ft.default=on,ft.defineCustomEventTarget=rT,ft.defineEventAttribute=gg,ft.getEventAttributeValue=hg,ft.setErrorHandler=B,ft.setEventAttributeValue=dg,ft.setWarningHandler=oe,ft}var Nc={},Lc={},eb;function Q8(){if(eb)return Lc;eb=1;var t=qn;Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.default=i;var e=t(za());function r(l,f){var c=Object.keys(l);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(l);f&&(o=o.filter(function(s){return Object.getOwnPropertyDescriptor(l,s).enumerable})),c.push.apply(c,o)}return c}function n(l){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?r(Object(c),!0).forEach(function(o){(0,e.default)(l,o,c[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(c)):r(Object(c)).forEach(function(o){Object.defineProperty(l,o,Object.getOwnPropertyDescriptor(c,o))})}return l}function i(l,f){var c=n(n(n({},[].reduce.call(l,function(o,s,a){return o[a]=s,o},{})),f),{},(0,e.default)({length:l.length},Symbol.iterator,function(){return[].slice.call(c)[Symbol.iterator]()}));return c}return Lc}var ai={},hl={},dl={},ci={},gl={},de={},yl={},br={},tb;function en(){if(tb)return br;tb=1,Object.defineProperty(br,"__esModule",{value:!0}),br.createNoDashGuid=br.createGuid=void 0;var t=oA,e=function(){return t.v4()};br.createGuid=e;var r=function(){return e().replace(new RegExp("-","g"),"").toUpperCase()};return br.createNoDashGuid=r,br}var rb;function Na(){return rb||(rb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformEvent=t.EventType=void 0;var e=en();(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error"})(t.EventType||(t.EventType={}));var r=function(){function n(i,l){this.privName=i,this.privEventId=e.createNoDashGuid(),this.privEventTime=new Date().toISOString(),this.privEventType=l,this.privMetadata={}}return Object.defineProperty(n.prototype,"name",{get:function(){return this.privName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"eventId",{get:function(){return this.privEventId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"eventTime",{get:function(){return this.privEventTime},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"eventType",{get:function(){return this.privEventType},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metadata",{get:function(){return this.privMetadata},enumerable:!1,configurable:!0}),n}();t.PlatformEvent=r}(yl)),yl}var nb;function Y8(){if(nb)return de;nb=1;var t=w&&w.__extends||function(){var p=function(v,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var y in d)d.hasOwnProperty(y)&&(h[y]=d[y])},p(v,g)};return function(v,g){p(v,g);function h(){this.constructor=v}v.prototype=g===null?Object.create(g):(h.prototype=g.prototype,new h)}}();Object.defineProperty(de,"__esModule",{value:!0}),de.AudioStreamNodeErrorEvent=de.AudioStreamNodeDetachedEvent=de.AudioStreamNodeAttachedEvent=de.AudioStreamNodeAttachingEvent=de.AudioStreamNodeEvent=de.AudioSourceErrorEvent=de.AudioSourceOffEvent=de.AudioSourceReadyEvent=de.AudioSourceInitializingEvent=de.AudioSourceEvent=void 0;var e=Na(),r=function(p){t(v,p);function v(g,h,d){d===void 0&&(d=e.EventType.Info);var y=p.call(this,g,d)||this;return y.privAudioSourceId=h,y}return Object.defineProperty(v.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!1,configurable:!0}),v}(e.PlatformEvent);de.AudioSourceEvent=r;var n=function(p){t(v,p);function v(g){return p.call(this,"AudioSourceInitializingEvent",g)||this}return v}(r);de.AudioSourceInitializingEvent=n;var i=function(p){t(v,p);function v(g){return p.call(this,"AudioSourceReadyEvent",g)||this}return v}(r);de.AudioSourceReadyEvent=i;var l=function(p){t(v,p);function v(g){return p.call(this,"AudioSourceOffEvent",g)||this}return v}(r);de.AudioSourceOffEvent=l;var f=function(p){t(v,p);function v(g,h){var d=p.call(this,"AudioSourceErrorEvent",g,e.EventType.Error)||this;return d.privError=h,d}return Object.defineProperty(v.prototype,"error",{get:function(){return this.privError},enumerable:!1,configurable:!0}),v}(r);de.AudioSourceErrorEvent=f;var c=function(p){t(v,p);function v(g,h,d){var y=p.call(this,g,h)||this;return y.privAudioNodeId=d,y}return Object.defineProperty(v.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!1,configurable:!0}),v}(r);de.AudioStreamNodeEvent=c;var o=function(p){t(v,p);function v(g,h){return p.call(this,"AudioStreamNodeAttachingEvent",g,h)||this}return v}(c);de.AudioStreamNodeAttachingEvent=o;var s=function(p){t(v,p);function v(g,h){return p.call(this,"AudioStreamNodeAttachedEvent",g,h)||this}return v}(c);de.AudioStreamNodeAttachedEvent=s;var a=function(p){t(v,p);function v(g,h){return p.call(this,"AudioStreamNodeDetachedEvent",g,h)||this}return v}(c);de.AudioStreamNodeDetachedEvent=a;var u=function(p){t(v,p);function v(g,h,d){var y=p.call(this,"AudioStreamNodeErrorEvent",g,h)||this;return y.privError=d,y}return Object.defineProperty(v.prototype,"error",{get:function(){return this.privError},enumerable:!1,configurable:!0}),v}(c);return de.AudioStreamNodeErrorEvent=u,de}var Pe={},ib;function X8(){if(ib)return Pe;ib=1;var t=w&&w.__extends||function(){var u=function(p,v){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,h){g.__proto__=h}||function(g,h){for(var d in h)h.hasOwnProperty(d)&&(g[d]=h[d])},u(p,v)};return function(p,v){u(p,v);function g(){this.constructor=p}p.prototype=v===null?Object.create(v):(g.prototype=v.prototype,new g)}}();Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.ConnectionMessageSentEvent=Pe.ConnectionMessageReceivedEvent=Pe.ConnectionEstablishErrorEvent=Pe.ConnectionErrorEvent=Pe.ConnectionClosedEvent=Pe.ConnectionEstablishedEvent=Pe.ConnectionStartEvent=Pe.ConnectionEvent=Pe.ServiceEvent=void 0;var e=Na(),r=function(u){t(p,u);function p(v,g,h){h===void 0&&(h=e.EventType.Info);var d=u.call(this,v,h)||this;return d.privJsonResult=g,d}return Object.defineProperty(p.prototype,"jsonString",{get:function(){return this.privJsonResult},enumerable:!1,configurable:!0}),p}(e.PlatformEvent);Pe.ServiceEvent=r;var n=function(u){t(p,u);function p(v,g,h){h===void 0&&(h=e.EventType.Info);var d=u.call(this,v,h)||this;return d.privConnectionId=g,d}return Object.defineProperty(p.prototype,"connectionId",{get:function(){return this.privConnectionId},enumerable:!1,configurable:!0}),p}(e.PlatformEvent);Pe.ConnectionEvent=n;var i=function(u){t(p,u);function p(v,g,h){var d=u.call(this,"ConnectionStartEvent",v)||this;return d.privUri=g,d.privHeaders=h,d}return Object.defineProperty(p.prototype,"uri",{get:function(){return this.privUri},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"headers",{get:function(){return this.privHeaders},enumerable:!1,configurable:!0}),p}(n);Pe.ConnectionStartEvent=i;var l=function(u){t(p,u);function p(v,g){return u.call(this,"ConnectionEstablishedEvent",v)||this}return p}(n);Pe.ConnectionEstablishedEvent=l;var f=function(u){t(p,u);function p(v,g,h){var d=u.call(this,"ConnectionClosedEvent",v,e.EventType.Debug)||this;return d.privReason=h,d.privStatusCode=g,d}return Object.defineProperty(p.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!1,configurable:!0}),p}(n);Pe.ConnectionClosedEvent=f;var c=function(u){t(p,u);function p(v,g,h){var d=u.call(this,"ConnectionErrorEvent",v,e.EventType.Debug)||this;return d.privMessage=g,d.privType=h,d}return Object.defineProperty(p.prototype,"message",{get:function(){return this.privMessage},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"type",{get:function(){return this.privType},enumerable:!1,configurable:!0}),p}(n);Pe.ConnectionErrorEvent=c;var o=function(u){t(p,u);function p(v,g,h){var d=u.call(this,"ConnectionEstablishErrorEvent",v,e.EventType.Error)||this;return d.privStatusCode=g,d.privReason=h,d}return Object.defineProperty(p.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!1,configurable:!0}),p}(n);Pe.ConnectionEstablishErrorEvent=o;var s=function(u){t(p,u);function p(v,g,h){var d=u.call(this,"ConnectionMessageReceivedEvent",v)||this;return d.privNetworkReceivedTime=g,d.privMessage=h,d}return Object.defineProperty(p.prototype,"networkReceivedTime",{get:function(){return this.privNetworkReceivedTime},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"message",{get:function(){return this.privMessage},enumerable:!1,configurable:!0}),p}(n);Pe.ConnectionMessageReceivedEvent=s;var a=function(u){t(p,u);function p(v,g,h){var d=u.call(this,"ConnectionMessageSentEvent",v)||this;return d.privNetworkSentTime=g,d.privMessage=h,d}return Object.defineProperty(p.prototype,"networkSentTime",{get:function(){return this.privNetworkSentTime},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"message",{get:function(){return this.privMessage},enumerable:!1,configurable:!0}),p}(n);return Pe.ConnectionMessageSentEvent=a,Pe}var ml={},Ft={},ob;function Nt(){if(ob)return Ft;ob=1;var t=w&&w.__extends||function(){var i=function(l,f){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,o){c.__proto__=o}||function(c,o){for(var s in o)o.hasOwnProperty(s)&&(c[s]=o[s])},i(l,f)};return function(l,f){i(l,f);function c(){this.constructor=l}l.prototype=f===null?Object.create(f):(c.prototype=f.prototype,new c)}}();Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.ObjectDisposedError=Ft.InvalidOperationError=Ft.ArgumentNullError=void 0;var e=function(i){t(l,i);function l(f){var c=i.call(this,f)||this;return c.name="ArgumentNull",c.message=f,c}return l}(Error);Ft.ArgumentNullError=e;var r=function(i){t(l,i);function l(f){var c=i.call(this,f)||this;return c.name="InvalidOperation",c.message=f,c}return l}(Error);Ft.InvalidOperationError=r;var n=function(i){t(l,i);function l(f,c){var o=i.call(this,c)||this;return o.name=f+"ObjectDisposed",o.message=c,o}return l}(Error);return Ft.ObjectDisposedError=n,Ft}var sb;function CI(){return sb||(sb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionMessage=t.MessageType=void 0;var e=Nt(),r=en(),n;(function(l){l[l.Text=0]="Text",l[l.Binary=1]="Binary"})(n=t.MessageType||(t.MessageType={}));var i=function(){function l(f,c,o,s){if(this.privBody=null,f===n.Text&&c&&typeof c!="string")throw new e.InvalidOperationError("Payload must be a string");if(f===n.Binary&&c&&!(c instanceof ArrayBuffer))throw new e.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=f,this.privBody=c,this.privHeaders=o||{},this.privId=s||r.createNoDashGuid(),this.messageType){case n.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case n.Text:this.privSize=this.textBody.length}}return Object.defineProperty(l.prototype,"messageType",{get:function(){return this.privMessageType},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"headers",{get:function(){return this.privHeaders},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"body",{get:function(){return this.privBody},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"textBody",{get:function(){if(this.privMessageType===n.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privBody},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"binaryBody",{get:function(){if(this.privMessageType===n.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privBody},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"id",{get:function(){return this.privId},enumerable:!1,configurable:!0}),l}();t.ConnectionMessage=i}(ml)),ml}var ui={},ab;function Z8(){if(ab)return ui;ab=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.ConnectionOpenResponse=void 0;var t=function(){function e(r,n){this.privStatusCode=r,this.privReason=n}return Object.defineProperty(e.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),e}();return ui.ConnectionOpenResponse=t,ui}var Cr={},cb;function PI(){if(cb)return Cr;cb=1;var t=w&&w.__extends||function(){var i=function(l,f){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,o){c.__proto__=o}||function(c,o){for(var s in o)o.hasOwnProperty(s)&&(c[s]=o[s])},i(l,f)};return function(l,f){i(l,f);function c(){this.constructor=l}l.prototype=f===null?Object.create(f):(c.prototype=f.prototype,new c)}}();Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.SendingAgentContextMessageEvent=Cr.DialogEvent=void 0;var e=Na(),r=function(i){t(l,i);function l(f,c){return c===void 0&&(c=e.EventType.Info),i.call(this,f,c)||this}return l}(e.PlatformEvent);Cr.DialogEvent=r;var n=function(i){t(l,i);function l(f){var c=i.call(this,"SendingAgentContextMessageEvent")||this;return c.privAgentConfig=f,c}return Object.defineProperty(l.prototype,"agentConfig",{get:function(){return this.privAgentConfig},enumerable:!1,configurable:!0}),l}(r);return Cr.SendingAgentContextMessageEvent=n,Cr}var pi={},fi={},ub;function wI(){if(ub)return fi;ub=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.EventSource=void 0;var t=Nt(),e=en(),r=function(){function n(i){var l=this;this.privEventListeners={},this.privIsDisposed=!1,this.onEvent=function(f){if(l.isDisposed())throw new t.ObjectDisposedError("EventSource");if(l.metadata)for(var c in l.metadata)c&&f.metadata&&(f.metadata[c]||(f.metadata[c]=l.metadata[c]));for(var o in l.privEventListeners)o&&l.privEventListeners[o]&&l.privEventListeners[o](f)},this.attach=function(f){var c=e.createNoDashGuid();return l.privEventListeners[c]=f,{detach:function(){return delete l.privEventListeners[c],Promise.resolve()}}},this.attachListener=function(f){return l.attach(f.onEvent)},this.isDisposed=function(){return l.privIsDisposed},this.dispose=function(){l.privEventListeners=null,l.privIsDisposed=!0},this.privMetadata=i}return Object.defineProperty(n.prototype,"metadata",{get:function(){return this.privMetadata},enumerable:!1,configurable:!0}),n}();return fi.EventSource=r,fi}var pb;function eG(){if(pb)return pi;pb=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Events=void 0;var t=Nt(),e=wI(),r=function(){function n(){}return Object.defineProperty(n,"instance",{get:function(){return n.privInstance},enumerable:!1,configurable:!0}),n.privInstance=new e.EventSource,n.setEventSource=function(i){if(!i)throw new t.ArgumentNullError("eventSource");n.privInstance=i},n}();return pi.Events=r,pi}var Sl={},fb;function tG(){return fb||(fb=1,Object.defineProperty(Sl,"__esModule",{value:!0})),Sl}var bl={},lb;function rG(){return lb||(lb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionState=void 0,function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(t.ConnectionState||(t.ConnectionState={}))}(bl)),bl}var Cl={},vb;function nG(){return vb||(vb=1,Object.defineProperty(Cl,"__esModule",{value:!0})),Cl}var Pl={},hb;function iG(){return hb||(hb=1,Object.defineProperty(Pl,"__esModule",{value:!0})),Pl}var wl={},db;function oG(){return db||(db=1,Object.defineProperty(wl,"__esModule",{value:!0})),wl}var Rl={},gb;function sG(){return gb||(gb=1,Object.defineProperty(Rl,"__esModule",{value:!0})),Rl}var El={},yb;function aG(){return yb||(yb=1,Object.defineProperty(El,"__esModule",{value:!0})),El}var Ol={},mb;function cG(){return mb||(mb=1,Object.defineProperty(Ol,"__esModule",{value:!0})),Ol}var _l={},Sb;function uG(){return Sb||(Sb=1,Object.defineProperty(_l,"__esModule",{value:!0})),_l}var li={},bb;function RI(){if(bb)return li;bb=1,Object.defineProperty(li,"__esModule",{value:!0}),li.List=void 0;var t=Nt(),e=function(){function r(n){var i=this;if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.get=function(o){return i.throwIfDisposed(),i.privList[o]},this.first=function(){return i.get(0)},this.last=function(){return i.get(i.length()-1)},this.add=function(o){i.throwIfDisposed(),i.insertAt(i.privList.length,o)},this.insertAt=function(o,s){i.throwIfDisposed(),o===0?i.privList.unshift(s):o===i.privList.length?i.privList.push(s):i.privList.splice(o,0,s),i.triggerSubscriptions(i.privAddSubscriptions)},this.removeFirst=function(){return i.throwIfDisposed(),i.removeAt(0)},this.removeLast=function(){return i.throwIfDisposed(),i.removeAt(i.length()-1)},this.removeAt=function(o){return i.throwIfDisposed(),i.remove(o,1)[0]},this.remove=function(o,s){i.throwIfDisposed();var a=i.privList.splice(o,s);return i.triggerSubscriptions(i.privRemoveSubscriptions),a},this.clear=function(){i.throwIfDisposed(),i.remove(0,i.length())},this.length=function(){return i.throwIfDisposed(),i.privList.length},this.onAdded=function(o){i.throwIfDisposed();var s=i.privSubscriptionIdCounter++;return i.privAddSubscriptions[s]=o,{detach:function(){return delete i.privAddSubscriptions[s],Promise.resolve()}}},this.onRemoved=function(o){i.throwIfDisposed();var s=i.privSubscriptionIdCounter++;return i.privRemoveSubscriptions[s]=o,{detach:function(){return delete i.privRemoveSubscriptions[s],Promise.resolve()}}},this.onDisposed=function(o){i.throwIfDisposed();var s=i.privSubscriptionIdCounter++;return i.privDisposedSubscriptions[s]=o,{detach:function(){return delete i.privDisposedSubscriptions[s],Promise.resolve()}}},this.join=function(o){return i.throwIfDisposed(),i.privList.join(o)},this.toArray=function(){var o=Array();return i.privList.forEach(function(s){o.push(s)}),o},this.any=function(o){return i.throwIfDisposed(),o?i.where(o).length()>0:i.length()>0},this.all=function(o){return i.throwIfDisposed(),i.where(o).length()===i.length()},this.forEach=function(o){i.throwIfDisposed();for(var s=0;s<i.length();s++)o(i.privList[s],s)},this.select=function(o){i.throwIfDisposed();for(var s=[],a=0;a<i.privList.length;a++)s.push(o(i.privList[a],a));return new r(s)},this.where=function(o){i.throwIfDisposed();for(var s=new r,a=0;a<i.privList.length;a++)o(i.privList[a],a)&&s.add(i.privList[a]);return s},this.orderBy=function(o){i.throwIfDisposed();var s=i.toArray(),a=s.sort(o);return new r(a)},this.orderByDesc=function(o){return i.throwIfDisposed(),i.orderBy(function(s,a){return o(a,s)})},this.clone=function(){return i.throwIfDisposed(),new r(i.toArray())},this.concat=function(o){return i.throwIfDisposed(),new r(i.privList.concat(o.toArray()))},this.concatArray=function(o){return i.throwIfDisposed(),new r(i.privList.concat(o))},this.isDisposed=function(){return i.privList==null},this.dispose=function(o){i.isDisposed()||(i.privDisposeReason=o,i.privList=null,i.privAddSubscriptions=null,i.privRemoveSubscriptions=null,i.triggerSubscriptions(i.privDisposedSubscriptions))},this.throwIfDisposed=function(){if(i.isDisposed())throw new t.ObjectDisposedError("List",i.privDisposeReason)},this.triggerSubscriptions=function(o){if(o)for(var s in o)s&&o[s]()},this.privList=[],n)for(var l=0,f=n;l<f.length;l++){var c=f[l];this.privList.push(c)}}return r}();return li.List=e,li}var Al={},Cb;function Ud(){return Cb||(Cb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.marshalPromiseToCallbacks=t.Sink=t.Deferred=t.PromiseResultEventSource=t.PromiseResult=t.PromiseState=void 0;var e;(function(c){c[c.None=0]="None",c[c.Resolved=1]="Resolved",c[c.Rejected=2]="Rejected"})(e=t.PromiseState||(t.PromiseState={}));var r=function(){function c(o){var s=this;this.throwIfError=function(){if(s.isError)throw s.error},o.on(function(a){s.privIsCompleted||(s.privIsCompleted=!0,s.privIsError=!1,s.privResult=a)},function(a){s.privIsCompleted||(s.privIsCompleted=!0,s.privIsError=!0,s.privError=a)})}return Object.defineProperty(c.prototype,"isCompleted",{get:function(){return this.privIsCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"isError",{get:function(){return this.privIsError},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"error",{get:function(){return this.privError},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"result",{get:function(){return this.privResult},enumerable:!1,configurable:!0}),c}();t.PromiseResult=r;var n=function(){function c(){var o=this;this.setResult=function(s){o.privOnSetResult(s)},this.setError=function(s){o.privOnSetError(s)},this.on=function(s,a){o.privOnSetResult=s,o.privOnSetError=a}}return c}();t.PromiseResultEventSource=n;var i=function(){function c(){var o=this;this.resolve=function(s){return o.privResolve(s),o},this.reject=function(s){return o.privReject(s),o},this.privPromise=new Promise(function(s,a){o.privResolve=s,o.privReject=a})}return Object.defineProperty(c.prototype,"promise",{get:function(){return this.privPromise},enumerable:!1,configurable:!0}),c}();t.Deferred=i;var l=function(){function c(){var o=this;this.privState=e.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.resolve=function(s){if(o.privState!==e.None)throw new Error("'Cannot resolve a completed promise'");o.privState=e.Resolved,o.privPromiseResultEvents.setResult(s);for(var a=0;a<o.privSuccessHandlers.length;a++)o.executeSuccessCallback(s,o.privSuccessHandlers[a],o.privErrorHandlers[a]);o.detachHandlers()},this.reject=function(s){if(o.privState!==e.None)throw new Error("'Cannot reject a completed promise'");o.privState=e.Rejected,o.privPromiseResultEvents.setError(s);for(var a=0,u=o.privErrorHandlers;a<u.length;a++){var p=u[a];o.executeErrorCallback(s,p)}o.detachHandlers()},this.on=function(s,a){s==null&&(s=function(u){}),o.privState===e.None?(o.privSuccessHandlers.push(s),o.privErrorHandlers.push(a)):(o.privState===e.Resolved?o.executeSuccessCallback(o.privPromiseResult.result,s,a):o.privState===e.Rejected&&o.executeErrorCallback(o.privPromiseResult.error,a),o.detachHandlers())},this.executeSuccessCallback=function(s,a,u){try{a(s)}catch(p){o.executeErrorCallback("'Unhandled callback error: "+p+"'",u)}},this.executeErrorCallback=function(s,a){if(a)try{a(s)}catch(u){throw new Error("'Unhandled callback error: "+u+". InnerError: "+s+"'")}else throw new Error("'Unhandled error: "+s+"'")},this.detachHandlers=function(){o.privErrorHandlers=[],o.privSuccessHandlers=[]},this.privPromiseResultEvents=new n,this.privPromiseResult=new r(this.privPromiseResultEvents)}return Object.defineProperty(c.prototype,"state",{get:function(){return this.privState},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"result",{get:function(){return this.privPromiseResult},enumerable:!1,configurable:!0}),c}();t.Sink=l;function f(c,o,s){c.then(function(a){try{o&&o(a)}catch(p){if(s)try{if(p instanceof Error){var u=p;s(u.name+": "+u.message)}else s(p)}catch{}}},function(a){if(s)try{if(a instanceof Error){var u=a;s(u.name+": "+u.message)}else s(a)}catch{}})}t.marshalPromiseToCallbacks=f}(Al)),Al}var vi={},Pb;function EI(){if(Pb)return vi;Pb=1;var t=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},e=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(vi,"__esModule",{value:!0}),vi.Queue=void 0;var r=Nt(),n=RI(),i=Ud(),l;(function(c){c[c.Dequeue=0]="Dequeue",c[c.Peek=1]="Peek"})(l||(l={}));var f=function(){function c(o){var s=this;this.privPromiseStore=new n.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.enqueue=function(a){s.throwIfDispose(),s.enqueueFromPromise(new Promise(function(u,p){u(a)}))},this.enqueueFromPromise=function(a){s.throwIfDispose(),a.then(function(u){s.privList.add(u)},function(u){})},this.dequeue=function(){s.throwIfDispose();var a=new i.Deferred;return s.privSubscribers&&(s.privSubscribers.add({deferral:a,type:l.Dequeue}),s.drain()),a.promise},this.peek=function(){s.throwIfDispose();var a=new i.Deferred,u=s.privSubscribers;return u&&(s.privSubscribers.add({deferral:a,type:l.Peek}),s.drain()),a.promise},this.length=function(){return s.throwIfDispose(),s.privList.length()},this.isDisposed=function(){return s.privSubscribers==null},this.drain=function(){if(!s.privIsDrainInProgress&&!s.privIsDisposing){s.privIsDrainInProgress=!0;var a=s.privSubscribers,u=s.privList;if(a&&u){for(;u.length()>0&&a.length()>0&&!s.privIsDisposing;){var p=a.removeFirst();if(p.type===l.Peek)p.deferral.resolve(u.first());else{var v=u.removeFirst();p.deferral.resolve(v)}}s.privSubscribers===a&&(s.privSubscribers=a),s.privList===u&&(s.privList=u)}s.privIsDrainInProgress=!1}},this.throwIfDispose=function(){if(s.isDisposed())throw s.privDisposeReason?new r.InvalidOperationError(s.privDisposeReason):new r.ObjectDisposedError("Queue");if(s.privIsDisposing)throw new r.InvalidOperationError("Queue disposing")},this.privList=o||new n.List,this.privDetachables=[],this.privSubscribers=new n.List,this.privDetachables.push(this.privList.onAdded(this.drain))}return c.prototype.drainAndDispose=function(o,s){return t(this,void 0,void 0,function(){var a,u,p,v,g,h,d=this;return e(this,function(y){switch(y.label){case 0:if(!(!this.isDisposed()&&!this.privIsDisposing))return[3,5];if(this.privDisposeReason=s,this.privIsDisposing=!0,a=this.privSubscribers,a){for(;a.length()>0;)u=a.removeFirst(),u.deferral.resolve(void 0);this.privSubscribers===a&&(this.privSubscribers=a)}p=0,v=this.privDetachables,y.label=1;case 1:return p<v.length?(g=v[p],[4,g.detach()]):[3,4];case 2:y.sent(),y.label=3;case 3:return p++,[3,1];case 4:if(this.privPromiseStore.length()>0&&o)return h=[],this.privPromiseStore.toArray().forEach(function(m){h.push(m)}),[2,Promise.all(h).finally(function(){d.privSubscribers=null,d.privList.forEach(function(m,S){o(m)}),d.privList=null}).then()];this.privSubscribers=null,this.privList=null,y.label=5;case 5:return[2]}})})},c.prototype.dispose=function(o){return t(this,void 0,void 0,function(){return e(this,function(s){switch(s.label){case 0:return[4,this.drainAndDispose(null,o)];case 1:return s.sent(),[2]}})})},c}();return vi.Queue=f,vi}var hi={},wb;function pG(){if(wb)return hi;wb=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.RawWebsocketMessage=void 0;var t=CI(),e=Nt(),r=en(),n=function(){function i(l,f,c){if(this.privPayload=null,!f)throw new e.ArgumentNullError("payload");if(l===t.MessageType.Binary&&f.__proto__.constructor.name!=="ArrayBuffer")throw new e.InvalidOperationError("Payload must be ArrayBuffer");if(l===t.MessageType.Text&&typeof f!="string")throw new e.InvalidOperationError("Payload must be a string");this.privMessageType=l,this.privPayload=f,this.privId=c||r.createNoDashGuid()}return Object.defineProperty(i.prototype,"messageType",{get:function(){return this.privMessageType},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"payload",{get:function(){return this.privPayload},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textContent",{get:function(){if(this.privMessageType===t.MessageType.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privPayload},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"binaryContent",{get:function(){if(this.privMessageType===t.MessageType.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privPayload},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"id",{get:function(){return this.privId},enumerable:!1,configurable:!0}),i}();return hi.RawWebsocketMessage=n,hi}var di={},Rb;function fG(){if(Rb)return di;Rb=1,Object.defineProperty(di,"__esModule",{value:!0}),di.RiffPcmEncoder=void 0;var t=function(){function e(r,n){var i=this;this.encode=function(l){var f=i.downSampleAudioFrame(l,i.privActualSampleRate,i.privDesiredSampleRate);if(!f)return null;var c=f.length*2,o=new ArrayBuffer(c),s=new DataView(o);return i.floatTo16BitPCM(s,0,f),o},this.setString=function(l,f,c){for(var o=0;o<c.length;o++)l.setUint8(f+o,c.charCodeAt(o))},this.floatTo16BitPCM=function(l,f,c){for(var o=0;o<c.length;o++,f+=2){var s=Math.max(-1,Math.min(1,c[o]));l.setInt16(f,s<0?s*32768:s*32767,!0)}},this.downSampleAudioFrame=function(l,f,c){if(c===f||c>f)return l;for(var o=f/c,s=Math.round(l.length/o),a=new Float32Array(s),u=0,p=0;p<s;){for(var v=Math.round((p+1)*o),g=0,h=0;u<v&&u<l.length;)g+=l[u++],h++;a[p++]=g/h}return a},this.privActualSampleRate=r,this.privDesiredSampleRate=n}return e}();return di.RiffPcmEncoder=t,di}var gi={},Eb;function lG(){if(Eb)return gi;Eb=1;var t=w&&w.__awaiter||function(f,c,o,s){function a(u){return u instanceof o?u:new o(function(p){p(u)})}return new(o||(o=Promise))(function(u,p){function v(d){try{h(s.next(d))}catch(y){p(y)}}function g(d){try{h(s.throw(d))}catch(y){p(y)}}function h(d){d.done?u(d.value):a(d.value).then(v,g)}h((s=s.apply(f,c||[])).next())})},e=w&&w.__generator||function(f,c){var o={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,a,u,p;return p={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function v(h){return function(d){return g([h,d])}}function g(h){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,a&&(u=h[0]&2?a.return:h[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,h[1])).done)return u;switch(a=0,u&&(h=[h[0]&2,u.value]),h[0]){case 0:case 1:u=h;break;case 4:return o.label++,{value:h[1],done:!1};case 5:o.label++,a=h[1],h=[0];continue;case 7:h=o.ops.pop(),o.trys.pop();continue;default:if(u=o.trys,!(u=u.length>0&&u[u.length-1])&&(h[0]===6||h[0]===2)){o=0;continue}if(h[0]===3&&(!u||h[1]>u[0]&&h[1]<u[3])){o.label=h[1];break}if(h[0]===6&&o.label<u[1]){o.label=u[1],u=h;break}if(u&&o.label<u[2]){o.label=u[2],o.ops.push(h);break}u[2]&&o.ops.pop(),o.trys.pop();continue}h=c.call(f,o)}catch(d){h=[6,d],a=0}finally{s=u=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}};Object.defineProperty(gi,"__esModule",{value:!0}),gi.Stream=void 0;var r=Nt(),n=en(),i=EI(),l=function(){function f(c){var o=this;this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.read=function(){if(o.privIsReadEnded)throw new r.InvalidOperationError("Stream read has already finished");return o.privReaderQueue.dequeue().then(function(s){return t(o,void 0,void 0,function(){return e(this,function(a){switch(a.label){case 0:return s===void 0||s.isEnd?[4,this.privReaderQueue.dispose("End of stream reached")]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2,s]}})})})},this.readEnded=function(){o.privIsReadEnded||(o.privIsReadEnded=!0,o.privReaderQueue=new i.Queue)},this.throwIfClosed=function(){if(o.privIsWriteEnded)throw new r.InvalidOperationError("Stream closed")},this.privId=c||n.createNoDashGuid(),this.privReaderQueue=new i.Queue}return Object.defineProperty(f.prototype,"isClosed",{get:function(){return this.privIsWriteEnded},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isReadEnded",{get:function(){return this.privIsReadEnded},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"id",{get:function(){return this.privId},enumerable:!1,configurable:!0}),f.prototype.close=function(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)},f.prototype.writeStreamChunk=function(c){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(c)}catch{}},f}();return gi.Stream=l,gi}var Il={},Ob;function Vd(){return Ob||(Ob=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TranslationStatus=void 0,function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(t.TranslationStatus||(t.TranslationStatus={}))}(Il)),Il}var yi={},_b;function vG(){if(_b)return yi;_b=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(yi,"__esModule",{value:!0}),yi.ChunkedArrayBufferStream=void 0;var e=K(),r=function(n){t(i,n);function i(l,f){var c=n.call(this,f)||this;return c.privTargetChunkSize=l,c.privNextBufferReadyBytes=0,c}return i.prototype.writeStreamChunk=function(l){if(l.isEnd||this.privNextBufferReadyBytes===0&&l.buffer.byteLength===this.privTargetChunkSize){n.prototype.writeStreamChunk.call(this,l);return}for(var f=0;f<l.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=l.timeReceived);var c=Math.min(l.buffer.byteLength-f,this.privTargetChunkSize-this.privNextBufferReadyBytes),o=new Uint8Array(this.privNextBufferToWrite),s=new Uint8Array(l.buffer.slice(f,c+f));o.set(s,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=c,f+=c,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(n.prototype.writeStreamChunk.call(this,{buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}},i.prototype.close=function(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&n.prototype.writeStreamChunk.call(this,{buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),n.prototype.close.call(this)},i}(e.Stream);return yi.ChunkedArrayBufferStream=r,yi}var Tl={},Ab;function hG(){return Ab||(Ab=1,Object.defineProperty(Tl,"__esModule",{value:!0})),Tl}var mi={},Ib;function dG(){if(Ib)return mi;Ib=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Timeout=void 0;var t=function(){function e(){}return e.workerTimers=null,e.clearTimeout=function(r){return e.timers().clearTimeout(r)},e.setTimeout=function(r,n){return e.timers().setTimeout(r,n)},e.load=function(r){var n=new Map([[0,function(){}]]),i=new Map,l=new Worker(r);l.addEventListener("message",function(o){var s=o.data;if(e.isCallNotification(s)){var a=s.params.timerId,u=n.get(a);if(typeof u=="number"){var p=i.get(u);if(p===void 0||p!==a)throw new Error("The timer is in an undefined state.")}else if(typeof u<"u")u(),n.delete(a);else throw new Error("The timer is in an undefined state.")}else if(e.isClearResponse(s)){var v=s.id,p=i.get(v);if(p===void 0)throw new Error("The timer is in an undefined state.");i.delete(v),n.delete(p)}else{var g=s.error.message;throw new Error(g)}});var f=function(o){var s=Math.random();i.set(s,o),n.set(o,s),l.postMessage({id:s,method:"clear",params:{timerId:o}})},c=function(o,s){var a=Math.random();return n.set(a,o),l.postMessage({id:null,method:"set",params:{delay:s,now:performance.now(),timerId:a}}),a};return{clearTimeout:f,setTimeout:c}},e.loadWorkerTimers=function(){var r=`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`;return function(){if(e.workerTimers!==null)return e.workerTimers;var n=new Blob([r],{type:"application/javascript; charset=utf-8"}),i=URL.createObjectURL(n);return e.workerTimers=e.load(i),e.workerTimers.setTimeout(function(){return URL.revokeObjectURL(i)},0),e.workerTimers}},e.timers=e.loadWorkerTimers(),e.isCallNotification=function(r){return r.method!==void 0&&r.method==="call"},e.isClearResponse=function(r){return r.error===null&&typeof r.id=="number"},e}();return mi.Timeout=t,mi}var Z={},Tb;function OI(){if(Tb)return Z;Tb=1;var t=w&&w.__extends||function(){var S=function(b,P){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,R){C.__proto__=R}||function(C,R){for(var O in R)R.hasOwnProperty(O)&&(C[O]=R[O])},S(b,P)};return function(b,P){S(b,P);function C(){this.constructor=b}b.prototype=P===null?Object.create(P):(C.prototype=P.prototype,new C)}}();Object.defineProperty(Z,"__esModule",{value:!0}),Z.OCSPCacheUpdateErrorEvent=Z.OCSPResponseRetrievedEvent=Z.OCSPCacheFetchErrorEvent=Z.OCSPVerificationFailedEvent=Z.OCSPCacheHitEvent=Z.OCSPCacheEntryNeedsRefreshEvent=Z.OCSPCacheEntryExpiredEvent=Z.OCSPWSUpgradeStartedEvent=Z.OCSPStapleReceivedEvent=Z.OCSPCacheUpdatehCompleteEvent=Z.OCSPDiskCacheStoreEvent=Z.OCSPMemoryCacheStoreEvent=Z.OCSPCacheUpdateNeededEvent=Z.OCSPDiskCacheHitEvent=Z.OCSPCacheMissEvent=Z.OCSPMemoryCacheHitEvent=Z.OCSPEvent=void 0;var e=Na(),r=function(S){t(b,S);function b(P,C,R){var O=S.call(this,P,C)||this;return O.privSignature=R,O}return b}(e.PlatformEvent);Z.OCSPEvent=r;var n=function(S){t(b,S);function b(P){return S.call(this,"OCSPMemoryCacheHitEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPMemoryCacheHitEvent=n;var i=function(S){t(b,S);function b(P){return S.call(this,"OCSPCacheMissEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPCacheMissEvent=i;var l=function(S){t(b,S);function b(P){return S.call(this,"OCSPDiskCacheHitEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPDiskCacheHitEvent=l;var f=function(S){t(b,S);function b(P){return S.call(this,"OCSPCacheUpdateNeededEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPCacheUpdateNeededEvent=f;var c=function(S){t(b,S);function b(P){return S.call(this,"OCSPMemoryCacheStoreEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPMemoryCacheStoreEvent=c;var o=function(S){t(b,S);function b(P){return S.call(this,"OCSPDiskCacheStoreEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPDiskCacheStoreEvent=o;var s=function(S){t(b,S);function b(P){return S.call(this,"OCSPCacheUpdatehCompleteEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPCacheUpdatehCompleteEvent=s;var a=function(S){t(b,S);function b(){return S.call(this,"OCSPStapleReceivedEvent",e.EventType.Debug,"")||this}return b}(r);Z.OCSPStapleReceivedEvent=a;var u=function(S){t(b,S);function b(P){return S.call(this,"OCSPWSUpgradeStartedEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPWSUpgradeStartedEvent=u;var p=function(S){t(b,S);function b(P,C){var R=S.call(this,"OCSPCacheEntryExpiredEvent",e.EventType.Debug,P)||this;return R.privExpireTime=C,R}return b}(r);Z.OCSPCacheEntryExpiredEvent=p;var v=function(S){t(b,S);function b(P,C,R){var O=S.call(this,"OCSPCacheEntryNeedsRefreshEvent",e.EventType.Debug,P)||this;return O.privExpireTime=R,O.privStartTime=C,O}return b}(r);Z.OCSPCacheEntryNeedsRefreshEvent=v;var g=function(S){t(b,S);function b(P,C,R){var O=S.call(this,"OCSPCacheHitEvent",e.EventType.Debug,P)||this;return O.privExpireTime=R,O.privExpireTimeString=new Date(R).toLocaleDateString(),O.privStartTime=C,O.privStartTimeString=new Date(C).toLocaleTimeString(),O}return b}(r);Z.OCSPCacheHitEvent=g;var h=function(S){t(b,S);function b(P,C){var R=S.call(this,"OCSPVerificationFailedEvent",e.EventType.Debug,P)||this;return R.privError=C,R}return b}(r);Z.OCSPVerificationFailedEvent=h;var d=function(S){t(b,S);function b(P,C){var R=S.call(this,"OCSPCacheFetchErrorEvent",e.EventType.Debug,P)||this;return R.privError=C,R}return b}(r);Z.OCSPCacheFetchErrorEvent=d;var y=function(S){t(b,S);function b(P){return S.call(this,"OCSPResponseRetrievedEvent",e.EventType.Debug,P)||this}return b}(r);Z.OCSPResponseRetrievedEvent=y;var m=function(S){t(b,S);function b(P,C){var R=S.call(this,"OCSPCacheUpdateErrorEvent",e.EventType.Debug,P)||this;return R.privError=C,R}return b}(r);return Z.OCSPCacheUpdateErrorEvent=m,Z}var Si={},Mb;function gG(){if(Mb)return Si;Mb=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Si,"__esModule",{value:!0}),Si.BackgroundEvent=void 0;var e=K(),r=function(n){t(i,n);function i(l){var f=n.call(this,"BackgroundEvent",e.EventType.Error)||this;return f.privError=l,f}return Object.defineProperty(i.prototype,"error",{get:function(){return this.privError},enumerable:!1,configurable:!0}),i}(e.PlatformEvent);return Si.BackgroundEvent=r,Si}var Db;function K(){return Db||(Db=1,function(t){var e=w&&w.__createBinding||(Object.create?function(i,l,f,c){c===void 0&&(c=f),Object.defineProperty(i,c,{enumerable:!0,get:function(){return l[f]}})}:function(i,l,f,c){c===void 0&&(c=f),i[c]=l[f]}),r=w&&w.__exportStar||function(i,l){for(var f in i)f!=="default"&&!l.hasOwnProperty(f)&&e(l,i,f)};Object.defineProperty(t,"__esModule",{value:!0}),r(Y8(),t),r(X8(),t),r(CI(),t),r(Z8(),t),r(PI(),t),r(Nt(),t),r(eG(),t),r(wI(),t),r(en(),t),r(tG(),t),r(rG(),t),r(nG(),t),r(iG(),t),r(oG(),t),r(sG(),t),r(aG(),t),r(cG(),t),r(uG(),t),r(RI(),t),r(Na(),t),r(Ud(),t),r(EI(),t),r(pG(),t),r(fG(),t),r(lG(),t);var n=Vd();Object.defineProperty(t,"TranslationStatus",{enumerable:!0,get:function(){return n.TranslationStatus}}),r(vG(),t),r(hG(),t),r(dG(),t),r(OI(),t),r(gG(),t)}(gl)),gl}var $b;function yG(){if($b)return ci;$b=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.ConsoleLoggingListener=void 0;var t=K(),e=function(){function r(n){var i=this;n===void 0&&(n=t.EventType.Warning),this.onEvent=function(l){if(l.eventType>=i.privLogLevelFilter){var f=i.toString(l);switch(l.eventType){case t.EventType.Debug:console.debug(f);break;case t.EventType.Info:console.info(f);break;case t.EventType.Warning:console.warn(f);break;case t.EventType.Error:console.error(f);break;default:console.log(f);break}}},this.toString=function(l){var f=[""+l.EventTime,""+l.Name];for(var c in l)if(c&&l.hasOwnProperty(c)&&c!=="eventTime"&&c!=="eventType"&&c!=="eventId"&&c!=="name"&&c!=="constructor"){var o=l[c],s="<NULL>";o!=null&&(typeof o=="number"||typeof o=="string"?s=o.toString():s=JSON.stringify(o)),f.push(c+": "+s)}return f.join(" | ")},this.privLogLevelFilter=n}return r}();return ci.ConsoleLoggingListener=e,ci}var Ml={},kb;function mG(){return kb||(kb=1,Object.defineProperty(Ml,"__esModule",{value:!0})),Ml}var Dl={},$l={},bi={},Ci={},xb;function Lt(){if(xb)return Ci;xb=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.HeaderNames=void 0;var t=function(){function e(){}return e.AuthKey="Ocp-Apim-Subscription-Key",e.ConnectionId="X-ConnectionId",e.ContentType="Content-Type",e.CustomCommandsAppId="X-CommandsAppId",e.Path="Path",e.RequestId="X-RequestId",e.RequestStreamId="X-StreamId",e.RequestTimestamp="X-Timestamp",e}();return Ci.HeaderNames=t,Ci}var Pi={},jb;function Wd(){if(jb)return Pi;jb=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.AuthInfo=void 0;var t=function(){function e(r,n){this.privHeaderName=r,this.privToken=n}return Object.defineProperty(e.prototype,"headerName",{get:function(){return this.privHeaderName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"token",{get:function(){return this.privToken},enumerable:!1,configurable:!0}),e}();return Pi.AuthInfo=t,Pi}var zb;function SG(){if(zb)return bi;zb=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.CognitiveSubscriptionKeyAuthentication=void 0;var t=K(),e=Lt(),r=Wd(),n=function(){function i(l){var f=this;if(this.fetch=function(c){return Promise.resolve(f.privAuthInfo)},this.fetchOnExpiry=function(c){return Promise.resolve(f.privAuthInfo)},!l)throw new t.ArgumentNullError("subscriptionKey");this.privAuthInfo=new r.AuthInfo(e.HeaderNames.AuthKey,l)}return i}();return bi.CognitiveSubscriptionKeyAuthentication=n,bi}var wi={},Nb;function bG(){if(Nb)return wi;Nb=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.CognitiveTokenAuthentication=void 0;var t=K(),e=Wd(),r="Authorization",n=function(){function i(l,f){var c=this;if(this.fetch=function(o){return c.privFetchCallback(o).then(function(s){return new e.AuthInfo(r,s)})},this.fetchOnExpiry=function(o){return c.privFetchOnExpiryCallback(o).then(function(s){return new e.AuthInfo(r,s)})},!l)throw new t.ArgumentNullError("fetchCallback");if(!f)throw new t.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=l,this.privFetchOnExpiryCallback=f}return i}();return wi.CognitiveTokenAuthentication=n,wi}var kl={},Lb;function CG(){return Lb||(Lb=1,Object.defineProperty(kl,"__esModule",{value:!0})),kl}var xl={},Bb;function PG(){return Bb||(Bb=1,Object.defineProperty(xl,"__esModule",{value:!0})),xl}var Ri={},jl={},Ut={},Ei={},qb;function te(){if(qb)return Ei;qb=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.Contracts=void 0;var t=function(){function e(){}return e.throwIfNullOrUndefined=function(r,n){if(r==null)throw new Error("throwIfNullOrUndefined:"+n)},e.throwIfNull=function(r,n){if(r===null)throw new Error("throwIfNull:"+n)},e.throwIfNullOrWhitespace=function(r,n){if(e.throwIfNullOrUndefined(r,n),(""+r).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+n)},e.throwIfDisposed=function(r){if(r)throw new Error("the object is already disposed")},e.throwIfArrayEmptyOrWhitespace=function(r,n){if(e.throwIfNullOrUndefined(r,n),r.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+n);for(var i=0,l=r;i<l.length;i++){var f=l[i];e.throwIfNullOrWhitespace(f,n)}},e.throwIfFileDoesNotExist=function(r,n){e.throwIfNullOrWhitespace(r,n)},e.throwIfNotUndefined=function(r,n){if(r!==void 0)throw new Error("throwIfNotUndefined:"+n)},e}();return Ei.Contracts=t,Ei}var Oi={},Fb;function _I(){if(Fb)return Oi;Fb=1;var t=w&&w.__createBinding||(Object.create?function(f,c,o,s){s===void 0&&(s=o),Object.defineProperty(f,s,{enumerable:!0,get:function(){return c[o]}})}:function(f,c,o,s){s===void 0&&(s=o),f[s]=c[o]}),e=w&&w.__setModuleDefault||(Object.create?function(f,c){Object.defineProperty(f,"default",{enumerable:!0,value:c})}:function(f,c){f.default=c}),r=w&&w.__importStar||function(f){if(f&&f.__esModule)return f;var c={};if(f!=null)for(var o in f)o!=="default"&&Object.hasOwnProperty.call(f,o)&&t(c,f,o);return e(c,f),c};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.AudioFileWriter=void 0;var n=r(Dt),i=te(),l=function(){function f(c){var o=this;this.id=function(){return o.privId},i.Contracts.throwIfNullOrUndefined(n.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=n.openSync(c,"w")}return Object.defineProperty(f.prototype,"format",{set:function(c){i.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=c;var o=0;this.privAudioFormat.hasHeader&&(o=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=n.createWriteStream("",{fd:this.privFd,start:o,autoClose:!1}))},enumerable:!1,configurable:!0}),f.prototype.write=function(c){i.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(c.slice(0)))},f.prototype.close=function(){var c=this;this.privFd!==void 0&&(this.privWriteStream.on("finish",function(){c.privAudioFormat.hasHeader&&(c.privAudioFormat.updateHeader(c.privWriteStream.bytesWritten),n.writeSync(c.privFd,new Int8Array(c.privAudioFormat.header),0,c.privAudioFormat.header.byteLength,0)),n.closeSync(c.privFd),c.privFd=void 0}),this.privWriteStream.end())},f}();return Oi.AudioFileWriter=l,Oi}var ot={},zl={},Ub;function tn(){return Ub||(Ub=1,function(t){var e=w&&w.__extends||function(){var l=function(f,c){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)s.hasOwnProperty(a)&&(o[a]=s[a])},l(f,c)};return function(f,c){l(f,c);function o(){this.constructor=f}f.prototype=c===null?Object.create(c):(o.prototype=c.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.AudioStreamFormatImpl=t.AudioStreamFormat=t.AudioFormatTag=void 0;var r;(function(l){l[l.PCM=1]="PCM",l[l.MuLaw=2]="MuLaw",l[l.Siren=3]="Siren",l[l.MP3=4]="MP3",l[l.SILKSkype=5]="SILKSkype",l[l.OGG_OPUS=6]="OGG_OPUS",l[l.WEBM_OPUS=7]="WEBM_OPUS",l[l.ALaw=8]="ALaw"})(r=t.AudioFormatTag||(t.AudioFormatTag={}));var n=function(){function l(){}return l.getDefaultInputFormat=function(){return i.getDefaultInputFormat()},l.getWaveFormatPCM=function(f,c,o){return new i(f,c,o)},l}();t.AudioStreamFormat=n;var i=function(l){e(f,l);function f(c,o,s,a){c===void 0&&(c=16e3),o===void 0&&(o=16),s===void 0&&(s=1),a===void 0&&(a=r.PCM);var u=l.call(this)||this;switch(u.setString=function(v,g,h){for(var d=0;d<h.length;d++)v.setUint8(g+d,h.charCodeAt(d))},a){case r.PCM:u.formatTag=1;break;case r.ALaw:u.formatTag=6;break;case r.MuLaw:u.formatTag=7;break}u.bitsPerSample=o,u.samplesPerSec=c,u.channels=s,u.avgBytesPerSec=u.samplesPerSec*u.channels*(u.bitsPerSample/8),u.blockAlign=u.channels*Math.max(u.bitsPerSample,8),u.privHeader=new ArrayBuffer(44);var p=new DataView(u.privHeader);return u.setString(p,0,"RIFF"),p.setUint32(4,0,!0),u.setString(p,8,"WAVEfmt "),p.setUint32(16,16,!0),p.setUint16(20,u.formatTag,!0),p.setUint16(22,u.channels,!0),p.setUint32(24,u.samplesPerSec,!0),p.setUint32(28,u.avgBytesPerSec,!0),p.setUint16(32,u.channels*(u.bitsPerSample/8),!0),p.setUint16(34,u.bitsPerSample,!0),u.setString(p,36,"data"),p.setUint32(40,0,!0),u}return f.getDefaultInputFormat=function(){return new f},f.getAudioContext=function(c){var o=window.AudioContext||window.webkitAudioContext||!1;if(o)return c!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new o({sampleRate:c}):new o;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")},f.prototype.close=function(){},Object.defineProperty(f.prototype,"header",{get:function(){return this.privHeader},enumerable:!1,configurable:!0}),f}(n);t.AudioStreamFormatImpl=i}(zl)),zl}var Vb;function AI(){if(Vb)return ot;Vb=1;var t=w&&w.__extends||function(){var v=function(g,h){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,y){d.__proto__=y}||function(d,y){for(var m in y)y.hasOwnProperty(m)&&(d[m]=y[m])},v(g,h)};return function(g,h){v(g,h);function d(){this.constructor=g}g.prototype=h===null?Object.create(h):(d.prototype=h.prototype,new d)}}(),e=w&&w.__awaiter||function(v,g,h,d){function y(m){return m instanceof h?m:new h(function(S){S(m)})}return new(h||(h=Promise))(function(m,S){function b(R){try{C(d.next(R))}catch(O){S(O)}}function P(R){try{C(d.throw(R))}catch(O){S(O)}}function C(R){R.done?m(R.value):y(R.value).then(b,P)}C((d=d.apply(v,g||[])).next())})},r=w&&w.__generator||function(v,g){var h={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},d,y,m,S;return S={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function b(C){return function(R){return P([C,R])}}function P(C){if(d)throw new TypeError("Generator is already executing.");for(;h;)try{if(d=1,y&&(m=C[0]&2?y.return:C[0]?y.throw||((m=y.return)&&m.call(y),0):y.next)&&!(m=m.call(y,C[1])).done)return m;switch(y=0,m&&(C=[C[0]&2,m.value]),C[0]){case 0:case 1:m=C;break;case 4:return h.label++,{value:C[1],done:!1};case 5:h.label++,y=C[1],C=[0];continue;case 7:C=h.ops.pop(),h.trys.pop();continue;default:if(m=h.trys,!(m=m.length>0&&m[m.length-1])&&(C[0]===6||C[0]===2)){h=0;continue}if(C[0]===3&&(!m||C[1]>m[0]&&C[1]<m[3])){h.label=C[1];break}if(C[0]===6&&h.label<m[1]){h.label=m[1],m=C;break}if(m&&h.label<m[2]){h.label=m[2],h.ops.push(C);break}m[2]&&h.ops.pop(),h.trys.pop();continue}C=g.call(v,h)}catch(R){C=[6,R],y=0}finally{d=m=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.PullAudioInputStreamImpl=ot.PullAudioInputStream=ot.PushAudioInputStreamImpl=ot.PushAudioInputStream=ot.AudioInputStream=void 0;var n=H(),i=K(),l=en(),f=F(),c=tn(),o=function(){function v(){}return v.createPushStream=function(g){return s.create(g)},v.createPullStream=function(g,h){return u.create(g,h)},v}();ot.AudioInputStream=o;var s=function(v){t(g,v);function g(){return v!==null&&v.apply(this,arguments)||this}return g.create=function(h){return new a(h)},g}(o);ot.PushAudioInputStream=s;var a=function(v){t(g,v);function g(h){var d=v.call(this)||this;return d.onEvent=function(y){d.privEvents.onEvent(y),i.Events.instance.onEvent(y)},h===void 0?d.privFormat=c.AudioStreamFormatImpl.getDefaultInputFormat():d.privFormat=h,d.privEvents=new i.EventSource,d.privId=l.createNoDashGuid(),d.privStream=new i.ChunkedArrayBufferStream(d.privFormat.avgBytesPerSec/10),d}return Object.defineProperty(g.prototype,"format",{get:function(){return Promise.resolve(this.privFormat)},enumerable:!1,configurable:!0}),g.prototype.write=function(h){this.privStream.writeStreamChunk({buffer:h,isEnd:!1,timeReceived:Date.now()})},g.prototype.close=function(){this.privStream.close()},g.prototype.id=function(){return this.privId},Object.defineProperty(g.prototype,"blob",{get:function(){var h=this;return this.attach("id").then(function(d){var y=[],m=Buffer.from(""),S=function(){return d.read().then(function(b){return!b||b.isEnd?typeof XMLHttpRequest<"u"&&typeof Blob<"u"?Promise.resolve(new Blob(y)):Promise.resolve(Buffer.from(m)):(typeof Blob<"u"?y.push(b.buffer):m=Buffer.concat([m,h.toBuffer(b.buffer)]),S())})};return S()})},enumerable:!1,configurable:!0}),g.prototype.turnOn=function(){this.onEvent(new i.AudioSourceInitializingEvent(this.privId)),this.onEvent(new i.AudioSourceReadyEvent(this.privId))},g.prototype.attach=function(h){return e(this,void 0,void 0,function(){var d,y=this;return r(this,function(m){switch(m.label){case 0:return this.onEvent(new i.AudioStreamNodeAttachingEvent(this.privId,h)),[4,this.turnOn()];case 1:return m.sent(),d=this.privStream,this.onEvent(new i.AudioStreamNodeAttachedEvent(this.privId,h)),[2,{detach:function(){return e(y,void 0,void 0,function(){return r(this,function(S){return d.readEnded(),this.onEvent(new i.AudioStreamNodeDetachedEvent(this.privId,h)),[2,this.turnOff()]})})},id:function(){return h},read:function(){return d.read()}}]}})})},g.prototype.detach=function(h){this.onEvent(new i.AudioStreamNodeDetachedEvent(this.privId,h))},g.prototype.turnOff=function(){},Object.defineProperty(g.prototype,"events",{get:function(){return this.privEvents},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"deviceInfo",{get:function(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:n.type.Stream})},enumerable:!1,configurable:!0}),g.prototype.toBuffer=function(h){for(var d=Buffer.alloc(h.byteLength),y=new Uint8Array(h),m=0;m<d.length;++m)d[m]=y[m];return d},g}(s);ot.PushAudioInputStreamImpl=a;var u=function(v){t(g,v);function g(){return v.call(this)||this}return g.create=function(h,d){return new p(h,d)},g}(o);ot.PullAudioInputStream=u;var p=function(v){t(g,v);function g(h,d){var y=v.call(this)||this;return y.onEvent=function(m){y.privEvents.onEvent(m),i.Events.instance.onEvent(m)},d===void 0?y.privFormat=f.AudioStreamFormat.getDefaultInputFormat():y.privFormat=d,y.privEvents=new i.EventSource,y.privId=l.createNoDashGuid(),y.privCallback=h,y.privIsClosed=!1,y.privBufferSize=y.privFormat.avgBytesPerSec/10,y}return Object.defineProperty(g.prototype,"format",{get:function(){return Promise.resolve(this.privFormat)},enumerable:!1,configurable:!0}),g.prototype.close=function(){this.privIsClosed=!0,this.privCallback.close()},g.prototype.id=function(){return this.privId},Object.defineProperty(g.prototype,"blob",{get:function(){return Promise.reject("Not implemented")},enumerable:!1,configurable:!0}),g.prototype.turnOn=function(){this.onEvent(new i.AudioSourceInitializingEvent(this.privId)),this.onEvent(new i.AudioSourceReadyEvent(this.privId))},g.prototype.attach=function(h){return e(this,void 0,void 0,function(){var d=this;return r(this,function(y){switch(y.label){case 0:return this.onEvent(new i.AudioStreamNodeAttachingEvent(this.privId,h)),[4,this.turnOn()];case 1:return y.sent(),this.onEvent(new i.AudioStreamNodeAttachedEvent(this.privId,h)),[2,{detach:function(){return d.privCallback.close(),d.onEvent(new i.AudioStreamNodeDetachedEvent(d.privId,h)),d.turnOff()},id:function(){return h},read:function(){for(var m=0,S;m<d.privBufferSize;){var b=new ArrayBuffer(d.privBufferSize-m),P=d.privCallback.read(b);if(S===void 0)S=b;else{var C=new Int8Array(S);C.set(new Int8Array(b),m)}if(P===0)break;m+=P}return Promise.resolve({buffer:S.slice(0,m),isEnd:d.privIsClosed||m===0,timeReceived:Date.now()})}}]}})})},g.prototype.detach=function(h){this.onEvent(new i.AudioStreamNodeDetachedEvent(this.privId,h))},g.prototype.turnOff=function(){},Object.defineProperty(g.prototype,"events",{get:function(){return this.privEvents},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"deviceInfo",{get:function(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:n.type.Stream})},enumerable:!1,configurable:!0}),g}(u);return ot.PullAudioInputStreamImpl=p,ot}var st={},_i={},Nl={},Wb;function II(){return Wb||(Wb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechSynthesisOutputFormat=void 0,function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw"}(t.SpeechSynthesisOutputFormat||(t.SpeechSynthesisOutputFormat={}))}(Nl)),Nl}var Hb;function lp(){if(Hb)return _i;Hb=1;var t=w&&w.__extends||function(){var l=function(f,c){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)s.hasOwnProperty(a)&&(o[a]=s[a])},l(f,c)};return function(f,c){l(f,c);function o(){this.constructor=f}f.prototype=c===null?Object.create(c):(o.prototype=c.prototype,new o)}}(),e;Object.defineProperty(_i,"__esModule",{value:!0}),_i.AudioOutputFormatImpl=void 0;var r=II(),n=tn(),i=function(l){t(f,l);function f(c,o,s,a,u,p,v,g,h){var d=l.call(this,s,p,o,c)||this;return d.formatTag=c,d.avgBytesPerSec=a,d.blockAlign=u,d.priAudioFormatString=v,d.priRequestAudioFormatString=g,d.priHasHeader=h,d}return f.fromSpeechSynthesisOutputFormat=function(c){return c===void 0?f.getDefaultOutputFormat():f.fromSpeechSynthesisOutputFormatString(f.SpeechSynthesisOutputFormatToString[c])},f.fromSpeechSynthesisOutputFormatString=function(c){switch(c){case"raw-8khz-8bit-mono-mulaw":return new f(n.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,c,c,!1);case"riff-16khz-16kbps-mono-siren":return new f(n.AudioFormatTag.Siren,1,16e3,2e3,40,0,c,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new f(n.AudioFormatTag.Siren,1,16e3,2e3,40,0,c,c,!1);case"audio-16khz-32kbitrate-mono-mp3":return new f(n.AudioFormatTag.MP3,1,16e3,4096,2,16,c,c,!1);case"audio-16khz-128kbitrate-mono-mp3":return new f(n.AudioFormatTag.MP3,1,16e3,16384,2,16,c,c,!1);case"audio-16khz-64kbitrate-mono-mp3":return new f(n.AudioFormatTag.MP3,1,16e3,8192,2,16,c,c,!1);case"audio-24khz-48kbitrate-mono-mp3":return new f(n.AudioFormatTag.MP3,1,24e3,6144,2,16,c,c,!1);case"audio-24khz-96kbitrate-mono-mp3":return new f(n.AudioFormatTag.MP3,1,24e3,12288,2,16,c,c,!1);case"audio-24khz-160kbitrate-mono-mp3":return new f(n.AudioFormatTag.MP3,1,24e3,20480,2,16,c,c,!1);case"raw-16khz-16bit-mono-truesilk":return new f(n.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,c,c,!1);case"riff-8khz-16bit-mono-pcm":return new f(n.AudioFormatTag.PCM,1,8e3,16e3,2,16,c,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new f(n.AudioFormatTag.PCM,1,24e3,48e3,2,16,c,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new f(n.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,c,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new f(n.AudioFormatTag.PCM,1,16e3,32e3,2,16,c,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new f(n.AudioFormatTag.PCM,1,24e3,48e3,2,16,c,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new f(n.AudioFormatTag.PCM,1,8e3,16e3,2,16,c,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new f(n.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,c,c,!1);case"ogg-24khz-16bit-mono-opus":return new f(n.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,c,c,!1);case"raw-48khz-16bit-mono-pcm":return new f(n.AudioFormatTag.PCM,1,48e3,96e3,2,16,c,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new f(n.AudioFormatTag.PCM,1,48e3,96e3,2,16,c,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new f(n.AudioFormatTag.MP3,1,48e3,12288,2,16,c,c,!1);case"audio-48khz-192kbitrate-mono-mp3":return new f(n.AudioFormatTag.MP3,1,48e3,24576,2,16,c,c,!1);case"ogg-48khz-16bit-mono-opus":return new f(n.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,c,c,!1);case"webm-16khz-16bit-mono-opus":return new f(n.AudioFormatTag.WEBM_OPUS,1,16e3,8e3,2,16,c,c,!1);case"webm-24khz-16bit-mono-opus":return new f(n.AudioFormatTag.WEBM_OPUS,1,24e3,8e3,2,16,c,c,!1);case"raw-24khz-16bit-mono-truesilk":return new f(n.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,c,c,!1);case"raw-8khz-8bit-mono-alaw":return new f(n.AudioFormatTag.ALaw,1,8e3,8e3,1,8,c,c,!1);case"riff-8khz-8bit-mono-alaw":return new f(n.AudioFormatTag.ALaw,1,8e3,8e3,1,8,c,"raw-8khz-8bit-mono-alaw",!0);case"riff-16khz-16bit-mono-pcm":default:return new f(n.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}},f.getDefaultOutputFormat=function(){return f.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")},Object.defineProperty(f.prototype,"hasHeader",{get:function(){return this.priHasHeader},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"header",{get:function(){if(this.hasHeader)return this.privHeader},enumerable:!1,configurable:!0}),f.prototype.updateHeader=function(c){if(this.priHasHeader){var o=new DataView(this.privHeader);o.setUint32(40,c,!0)}},Object.defineProperty(f.prototype,"requestAudioFormatString",{get:function(){return this.priRequestAudioFormatString},enumerable:!1,configurable:!0}),f.SpeechSynthesisOutputFormatToString=(e={},e[r.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]="raw-8khz-8bit-mono-mulaw",e[r.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]="riff-16khz-16kbps-mono-siren",e[r.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]="audio-16khz-16kbps-mono-siren",e[r.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]="audio-16khz-32kbitrate-mono-mp3",e[r.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]="audio-16khz-128kbitrate-mono-mp3",e[r.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]="audio-16khz-64kbitrate-mono-mp3",e[r.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]="audio-24khz-48kbitrate-mono-mp3",e[r.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]="audio-24khz-96kbitrate-mono-mp3",e[r.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]="audio-24khz-160kbitrate-mono-mp3",e[r.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]="raw-16khz-16bit-mono-truesilk",e[r.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]="riff-16khz-16bit-mono-pcm",e[r.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]="riff-8khz-16bit-mono-pcm",e[r.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]="riff-24khz-16bit-mono-pcm",e[r.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]="riff-8khz-8bit-mono-mulaw",e[r.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]="raw-16khz-16bit-mono-pcm",e[r.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]="raw-24khz-16bit-mono-pcm",e[r.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]="raw-8khz-16bit-mono-pcm",e[r.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]="ogg-16khz-16bit-mono-opus",e[r.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]="ogg-24khz-16bit-mono-opus",e[r.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]="raw-48khz-16bit-mono-pcm",e[r.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]="riff-48khz-16bit-mono-pcm",e[r.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]="audio-48khz-96kbitrate-mono-mp3",e[r.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]="audio-48khz-192kbitrate-mono-mp3",e[r.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]="ogg-48khz-16bit-mono-opus",e[r.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]="webm-16khz-16bit-mono-opus",e[r.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]="webm-24khz-16bit-mono-opus",e[r.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]="raw-24khz-16bit-mono-truesilk",e[r.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]="raw-8khz-8bit-mono-alaw",e[r.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]="riff-8khz-8bit-mono-alaw",e),f}(n.AudioStreamFormatImpl);return _i.AudioOutputFormatImpl=i,_i}var Kb;function Fn(){if(Kb)return st;Kb=1;var t=w&&w.__extends||function(){var u=function(p,v){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,h){g.__proto__=h}||function(g,h){for(var d in h)h.hasOwnProperty(d)&&(g[d]=h[d])},u(p,v)};return function(p,v){u(p,v);function g(){this.constructor=p}p.prototype=v===null?Object.create(v):(g.prototype=v.prototype,new g)}}(),e=w&&w.__awaiter||function(u,p,v,g){function h(d){return d instanceof v?d:new v(function(y){y(d)})}return new(v||(v=Promise))(function(d,y){function m(P){try{b(g.next(P))}catch(C){y(C)}}function S(P){try{b(g.throw(P))}catch(C){y(C)}}function b(P){P.done?d(P.value):h(P.value).then(m,S)}b((g=g.apply(u,p||[])).next())})},r=w&&w.__generator||function(u,p){var v={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},g,h,d,y;return y={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function m(b){return function(P){return S([b,P])}}function S(b){if(g)throw new TypeError("Generator is already executing.");for(;v;)try{if(g=1,h&&(d=b[0]&2?h.return:b[0]?h.throw||((d=h.return)&&d.call(h),0):h.next)&&!(d=d.call(h,b[1])).done)return d;switch(h=0,d&&(b=[b[0]&2,d.value]),b[0]){case 0:case 1:d=b;break;case 4:return v.label++,{value:b[1],done:!1};case 5:v.label++,h=b[1],b=[0];continue;case 7:b=v.ops.pop(),v.trys.pop();continue;default:if(d=v.trys,!(d=d.length>0&&d[d.length-1])&&(b[0]===6||b[0]===2)){v=0;continue}if(b[0]===3&&(!d||b[1]>d[0]&&b[1]<d[3])){v.label=b[1];break}if(b[0]===6&&v.label<d[1]){v.label=d[1],d=b;break}if(d&&v.label<d[2]){v.label=d[2],v.ops.push(b);break}d[2]&&v.ops.pop(),v.trys.pop();continue}b=p.call(u,v)}catch(P){b=[6,P],h=0}finally{g=d=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}};Object.defineProperty(st,"__esModule",{value:!0}),st.PushAudioOutputStreamImpl=st.PushAudioOutputStream=st.PullAudioOutputStreamImpl=st.PullAudioOutputStream=st.AudioOutputStream=void 0;var n=K(),i=te(),l=lp(),f=function(){function u(){}return u.createPullStream=function(){return c.create()},u}();st.AudioOutputStream=f;var c=function(u){t(p,u);function p(){return u!==null&&u.apply(this,arguments)||this}return p.create=function(){return new o},p}(f);st.PullAudioOutputStream=c;var o=function(u){t(p,u);function p(){var v=u.call(this)||this;return v.privId=n.createNoDashGuid(),v.privStream=new n.Stream,v}return Object.defineProperty(p.prototype,"format",{get:function(){return this.privFormat},set:function(v){v==null&&(this.privFormat=l.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=v},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isClosed",{get:function(){return this.privStream.isClosed},enumerable:!1,configurable:!0}),p.prototype.id=function(){return this.privId},p.prototype.read=function(v){return e(this,void 0,void 0,function(){var g,h,d,y;return r(this,function(m){switch(m.label){case 0:if(g=new Int8Array(v),h=0,this.privLastChunkView!==void 0){if(this.privLastChunkView.length>v.byteLength)return g.set(this.privLastChunkView.slice(0,v.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(v.byteLength),[2,Promise.resolve(v.byteLength)];g.set(this.privLastChunkView),h=this.privLastChunkView.length,this.privLastChunkView=void 0}m.label=1;case 1:return h<v.byteLength&&!this.privStream.isReadEnded?[4,this.privStream.read()]:[3,6];case 2:return d=m.sent(),d!==void 0&&!d.isEnd?(y=void 0,d.buffer.byteLength>v.byteLength-h?(y=d.buffer.slice(0,v.byteLength-h),this.privLastChunkView=new Int8Array(d.buffer.slice(v.byteLength-h))):y=d.buffer,g.set(new Int8Array(y),h),h+=y.byteLength,[3,5]):[3,3];case 3:return[4,this.privStream.readEnded()];case 4:m.sent(),m.label=5;case 5:return[3,1];case 6:return[2,h]}})})},p.prototype.write=function(v){i.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:v,isEnd:!1,timeReceived:Date.now()})},p.prototype.close=function(){this.privStream.close()},p}(c);st.PullAudioOutputStreamImpl=o;var s=function(u){t(p,u);function p(){return u.call(this)||this}return p.create=function(v){return new a(v)},p}(f);st.PushAudioOutputStream=s;var a=function(u){t(p,u);function p(v){var g=u.call(this)||this;return g.privId=n.createNoDashGuid(),g.privCallback=v,g}return Object.defineProperty(p.prototype,"format",{set:function(v){},enumerable:!1,configurable:!0}),p.prototype.write=function(v){this.privCallback.write&&this.privCallback.write(v)},p.prototype.close=function(){this.privCallback.close&&this.privCallback.close()},p.prototype.id=function(){return this.privId},p}(s);return st.PushAudioOutputStreamImpl=a,st}var Gb;function wG(){if(Gb)return Ut;Gb=1;var t=w&&w.__extends||function(){var a=function(u,p){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var h in g)g.hasOwnProperty(h)&&(v[h]=g[h])},a(u,p)};return function(u,p){a(u,p);function v(){this.constructor=u}u.prototype=p===null?Object.create(p):(v.prototype=p.prototype,new v)}}();Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.AudioOutputConfigImpl=Ut.AudioConfigImpl=Ut.AudioConfig=void 0;var e=yt(),r=te(),n=F(),i=_I(),l=AI(),f=Fn(),c=function(){function a(){}return a.fromDefaultMicrophoneInput=function(){var u=new e.PcmRecorder;return new o(new e.MicAudioSource(u))},a.fromMicrophoneInput=function(u){var p=new e.PcmRecorder;return new o(new e.MicAudioSource(p,u))},a.fromWavFileInput=function(u,p){return p===void 0&&(p="unnamedBuffer.wav"),new o(new e.FileAudioSource(u,p))},a.fromStreamInput=function(u){if(u instanceof n.PullAudioInputStreamCallback)return new o(new l.PullAudioInputStreamImpl(u));if(u instanceof n.AudioInputStream)return new o(u);if(typeof MediaStream<"u"&&u instanceof MediaStream){var p=new e.PcmRecorder;return new o(new e.MicAudioSource(p,null,null,u))}throw new Error("Not Supported Type")},a.fromDefaultSpeakerOutput=function(){return new s(new n.SpeakerAudioDestination)},a.fromSpeakerOutput=function(u){if(u===void 0)return a.fromDefaultSpeakerOutput();if(u instanceof n.SpeakerAudioDestination)return new s(u);throw new Error("Not Supported Type")},a.fromAudioFileOutput=function(u){return new s(new i.AudioFileWriter(u))},a.fromStreamOutput=function(u){if(u instanceof n.PushAudioOutputStreamCallback)return new s(new f.PushAudioOutputStreamImpl(u));if(u instanceof n.PushAudioOutputStream)return new s(u);if(u instanceof n.PullAudioOutputStream)return new s(u);throw new Error("Not Supported Type")},a}();Ut.AudioConfig=c;var o=function(a){t(u,a);function u(p){var v=a.call(this)||this;return v.privSource=p,v}return Object.defineProperty(u.prototype,"format",{get:function(){return this.privSource.format},enumerable:!1,configurable:!0}),u.prototype.close=function(p,v){this.privSource.turnOff().then(function(){p&&p()},function(g){v&&v(g)})},u.prototype.id=function(){return this.privSource.id()},Object.defineProperty(u.prototype,"blob",{get:function(){return this.privSource.blob},enumerable:!1,configurable:!0}),u.prototype.turnOn=function(){return this.privSource.turnOn()},u.prototype.attach=function(p){return this.privSource.attach(p)},u.prototype.detach=function(p){return this.privSource.detach(p)},u.prototype.turnOff=function(){return this.privSource.turnOff()},Object.defineProperty(u.prototype,"events",{get:function(){return this.privSource.events},enumerable:!1,configurable:!0}),u.prototype.setProperty=function(p,v){if(r.Contracts.throwIfNull(v,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(p,v);else throw new Error("This AudioConfig instance does not support setting properties.")},u.prototype.getProperty=function(p,v){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(p,v);throw new Error("This AudioConfig instance does not support getting properties.")},Object.defineProperty(u.prototype,"deviceInfo",{get:function(){return this.privSource.deviceInfo},enumerable:!1,configurable:!0}),u}(c);Ut.AudioConfigImpl=o;var s=function(a){t(u,a);function u(p){var v=a.call(this)||this;return v.privDestination=p,v}return Object.defineProperty(u.prototype,"format",{set:function(p){this.privDestination.format=p},enumerable:!1,configurable:!0}),u.prototype.write=function(p){this.privDestination.write(p)},u.prototype.close=function(){this.privDestination.close()},u.prototype.id=function(){return this.privDestination.id()},u.prototype.setProperty=function(p,v){throw new Error("This AudioConfig instance does not support setting properties.")},u.prototype.getProperty=function(p,v){throw new Error("This AudioConfig instance does not support getting properties.")},u}(c);return Ut.AudioOutputConfigImpl=s,Ut}var Ll={},Jb;function RG(){return Jb||(Jb=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationReason=void 0,function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(t.CancellationReason||(t.CancellationReason={}))}(Ll)),Ll}var Ai={},Qb;function EG(){if(Qb)return Ai;Qb=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.PullAudioInputStreamCallback=void 0;var t=function(){function e(){}return e}();return Ai.PullAudioInputStreamCallback=t,Ai}var Ii={},Yb;function OG(){if(Yb)return Ii;Yb=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.PushAudioOutputStreamCallback=void 0;var t=function(){function e(){}return e}();return Ii.PushAudioOutputStreamCallback=t,Ii}var Ti={},Xb;function _G(){if(Xb)return Ti;Xb=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.KeywordRecognitionModel=void 0;var t=te(),e=function(){function r(){this.privDisposed=!1}return r.fromFile=function(n){throw t.Contracts.throwIfFileDoesNotExist(n,"fileName"),new Error("Not yet implemented.")},r.fromStream=function(n){throw t.Contracts.throwIfNull(n,"file"),new Error("Not yet implemented.")},r.prototype.close=function(){this.privDisposed||(this.privDisposed=!0)},r}();return Ti.KeywordRecognitionModel=e,Ti}var Mi={},Zb;function AG(){if(Zb)return Mi;Zb=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.SessionEventArgs=void 0;var t=function(){function e(r){this.privSessionId=r}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!1,configurable:!0}),e}();return Mi.SessionEventArgs=t,Mi}var Di={},eC;function IG(){if(eC)return Di;eC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Di,"__esModule",{value:!0}),Di.RecognitionEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f){var c=n.call(this,f)||this;return c.privOffset=l,c}return Object.defineProperty(i.prototype,"offset",{get:function(){return this.privOffset},enumerable:!1,configurable:!0}),i}(e.SessionEventArgs);return Di.RecognitionEventArgs=r,Di}var Bl={},tC;function TG(){return tC||(tC=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.OutputFormat=void 0,function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(t.OutputFormat||(t.OutputFormat={}))}(Bl)),Bl}var $i={},rC;function MG(){if(rC)return $i;rC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty($i,"__esModule",{value:!0}),$i.IntentRecognitionEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c){var o=n.call(this,f,c)||this;return o.privResult=l,o}return Object.defineProperty(i.prototype,"result",{get:function(){return this.privResult},enumerable:!1,configurable:!0}),i}(e.RecognitionEventArgs);return $i.IntentRecognitionEventArgs=r,$i}var ki={},nC;function DG(){if(nC)return ki;nC=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.RecognitionResult=void 0;var t=function(){function e(r,n,i,l,f,c,o,s,a,u){this.privResultId=r,this.privReason=n,this.privText=i,this.privDuration=l,this.privOffset=f,this.privLanguage=c,this.privLanguageDetectionConfidence=o,this.privErrorDetails=s,this.privJson=a,this.privProperties=u}return Object.defineProperty(e.prototype,"resultId",{get:function(){return this.privResultId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.privText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.privDuration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return this.privOffset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"language",{get:function(){return this.privLanguage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageDetectionConfidence",{get:function(){return this.privLanguageDetectionConfidence},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"json",{get:function(){return this.privJson},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),e}();return ki.RecognitionResult=t,ki}var xi={},iC;function $G(){if(iC)return xi;iC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(xi,"__esModule",{value:!0}),xi.SpeechRecognitionResult=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c,o,s,a,u,p,v,g,h){var d=n.call(this,l,f,c,o,s,a,u,v,g,h)||this;return d.privSpeakerId=p,d}return Object.defineProperty(i.prototype,"speakerId",{get:function(){return this.privSpeakerId},enumerable:!1,configurable:!0}),i}(e.RecognitionResult);return xi.SpeechRecognitionResult=r,xi}var ji={},oC;function kG(){if(oC)return ji;oC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(ji,"__esModule",{value:!0}),ji.IntentRecognitionResult=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c,o,s,a,u,p,v,g,h){var d=n.call(this,f,c,o,s,a,u,p,void 0,v,g,h)||this;return d.privIntentId=l,d}return Object.defineProperty(i.prototype,"intentId",{get:function(){return this.privIntentId},enumerable:!1,configurable:!0}),i}(e.SpeechRecognitionResult);return ji.IntentRecognitionResult=r,ji}var Pr={},sC;function xG(){if(sC)return Pr;sC=1;var t=w&&w.__extends||function(){var i=function(l,f){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,o){c.__proto__=o}||function(c,o){for(var s in o)o.hasOwnProperty(s)&&(c[s]=o[s])},i(l,f)};return function(l,f){i(l,f);function c(){this.constructor=l}l.prototype=f===null?Object.create(f):(c.prototype=f.prototype,new c)}}();Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.LanguageUnderstandingModelImpl=Pr.LanguageUnderstandingModel=void 0;var e=te(),r=function(){function i(){}return i.fromEndpoint=function(l){e.Contracts.throwIfNull(l,"uri"),e.Contracts.throwIfNullOrWhitespace(l.hostname,"uri");var f=new n,c=l.host.indexOf(".");if(c===-1)throw new Error("Could not determine region from endpoint");f.region=l.host.substr(0,c);var o=l.pathname.lastIndexOf("/")+1;if(o===-1)throw new Error("Could not determine appId from endpoint");if(f.appId=l.pathname.substr(o),f.subscriptionKey=l.searchParams.get("subscription-key"),f.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return f},i.fromAppId=function(l){e.Contracts.throwIfNullOrWhitespace(l,"appId");var f=new n;return f.appId=l,f},i.fromSubscription=function(l,f,c){e.Contracts.throwIfNullOrWhitespace(l,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(f,"appId"),e.Contracts.throwIfNullOrWhitespace(c,"region");var o=new n;return o.appId=f,o.region=c,o.subscriptionKey=l,o},i}();Pr.LanguageUnderstandingModel=r;var n=function(i){t(l,i);function l(){return i!==null&&i.apply(this,arguments)||this}return l}(r);return Pr.LanguageUnderstandingModelImpl=n,Pr}var wr={},aC;function jG(){if(aC)return wr;aC=1;var t=w&&w.__extends||function(){var i=function(l,f){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,o){c.__proto__=o}||function(c,o){for(var s in o)o.hasOwnProperty(s)&&(c[s]=o[s])},i(l,f)};return function(l,f){i(l,f);function c(){this.constructor=l}l.prototype=f===null?Object.create(f):(c.prototype=f.prototype,new c)}}();Object.defineProperty(wr,"__esModule",{value:!0}),wr.ConversationTranscriptionEventArgs=wr.SpeechRecognitionEventArgs=void 0;var e=F(),r=function(i){t(l,i);function l(f,c,o){var s=i.call(this,c,o)||this;return s.privResult=f,s}return Object.defineProperty(l.prototype,"result",{get:function(){return this.privResult},enumerable:!1,configurable:!0}),l}(e.RecognitionEventArgs);wr.SpeechRecognitionEventArgs=r;var n=function(i){t(l,i);function l(){return i!==null&&i.apply(this,arguments)||this}return l}(r);return wr.ConversationTranscriptionEventArgs=n,wr}var zi={},Ni={},cC;function Hd(){if(cC)return Ni;cC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.CancellationEventArgsBase=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c,o,s){var a=n.call(this,o,s)||this;return a.privReason=l,a.privErrorDetails=f,a.privErrorCode=c,a}return Object.defineProperty(i.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),i}(e.RecognitionEventArgs);return Ni.CancellationEventArgsBase=r,Ni}var uC;function zG(){if(uC)return zi;uC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(zi,"__esModule",{value:!0}),zi.SpeechRecognitionCanceledEventArgs=void 0;var e=Hd(),r=function(n){t(i,n);function i(){return n!==null&&n.apply(this,arguments)||this}return i}(e.CancellationEventArgsBase);return zi.SpeechRecognitionCanceledEventArgs=r,zi}var Li={},pC;function NG(){if(pC)return Li;pC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Li,"__esModule",{value:!0}),Li.TranslationRecognitionEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c){var o=n.call(this,f,c)||this;return o.privResult=l,o}return Object.defineProperty(i.prototype,"result",{get:function(){return this.privResult},enumerable:!1,configurable:!0}),i}(e.RecognitionEventArgs);return Li.TranslationRecognitionEventArgs=r,Li}var Bi={},fC;function LG(){if(fC)return Bi;fC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.TranslationSynthesisEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f){var c=n.call(this,f)||this;return c.privResult=l,c}return Object.defineProperty(i.prototype,"result",{get:function(){return this.privResult},enumerable:!1,configurable:!0}),i}(e.SessionEventArgs);return Bi.TranslationSynthesisEventArgs=r,Bi}var qi={},lC;function TI(){if(lC)return qi;lC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(qi,"__esModule",{value:!0}),qi.TranslationRecognitionResult=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c,o,s,a,u,p,v){var g=n.call(this,f,c,o,s,a,void 0,void 0,void 0,u,p,v)||this;return g.privTranslations=l,g}return Object.defineProperty(i.prototype,"translations",{get:function(){return this.privTranslations},enumerable:!1,configurable:!0}),i}(e.SpeechRecognitionResult);return qi.TranslationRecognitionResult=r,qi}var Fi={},vC;function BG(){if(vC)return Fi;vC=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.TranslationSynthesisResult=void 0;var t=function(){function e(r,n){this.privReason=r,this.privAudio=n}return Object.defineProperty(e.prototype,"audio",{get:function(){return this.privAudio},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),e}();return Fi.TranslationSynthesisResult=t,Fi}var ql={},hC;function qG(){return hC||(hC=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ResultReason=void 0,function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.RecognizingIntent=5]="RecognizingIntent",e[e.RecognizedIntent=6]="RecognizedIntent",e[e.TranslatingSpeech=7]="TranslatingSpeech",e[e.TranslatedSpeech=8]="TranslatedSpeech",e[e.SynthesizingAudio=9]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",e[e.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",e[e.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",e[e.RecognizedSpeakers=14]="RecognizedSpeakers",e[e.RecognizedSpeaker=15]="RecognizedSpeaker",e[e.ResetVoiceProfile=16]="ResetVoiceProfile",e[e.DeletedVoiceProfile=17]="DeletedVoiceProfile"}(t.ResultReason||(t.ResultReason={}))}(ql)),ql}var Rr={},dC;function FG(){if(dC)return Rr;dC=1;var t=w&&w.__extends||function(){var f=function(c,o){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var u in a)a.hasOwnProperty(u)&&(s[u]=a[u])},f(c,o)};return function(c,o){f(c,o);function s(){this.constructor=c}c.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}}();Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.SpeechConfigImpl=Rr.SpeechConfig=void 0;var e=H(),r=te(),n=F(),i=function(){function f(){}return f.fromSubscription=function(c,o){r.Contracts.throwIfNullOrWhitespace(c,"subscriptionKey"),r.Contracts.throwIfNullOrWhitespace(o,"region");var s=new l;return s.setProperty(n.PropertyId.SpeechServiceConnection_Region,o),s.setProperty(n.PropertyId.SpeechServiceConnection_IntentRegion,o),s.setProperty(n.PropertyId.SpeechServiceConnection_Key,c),s},f.fromEndpoint=function(c,o){r.Contracts.throwIfNull(c,"endpoint");var s=new l;return s.setProperty(n.PropertyId.SpeechServiceConnection_Endpoint,c.href),o!==void 0&&s.setProperty(n.PropertyId.SpeechServiceConnection_Key,o),s},f.fromHost=function(c,o){r.Contracts.throwIfNull(c,"hostName");var s=new l;return s.setProperty(n.PropertyId.SpeechServiceConnection_Host,c.protocol+"//"+c.hostname+(c.port===""?"":":"+c.port)),o!==void 0&&s.setProperty(n.PropertyId.SpeechServiceConnection_Key,o),s},f.fromAuthorizationToken=function(c,o){r.Contracts.throwIfNull(c,"authorizationToken"),r.Contracts.throwIfNullOrWhitespace(o,"region");var s=new l;return s.setProperty(n.PropertyId.SpeechServiceConnection_Region,o),s.setProperty(n.PropertyId.SpeechServiceConnection_IntentRegion,o),s.authorizationToken=c,s},f.prototype.close=function(){},f}();Rr.SpeechConfig=i;var l=function(f){t(c,f);function c(){var o=f.call(this)||this;return o.privProperties=new n.PropertyCollection,o.speechRecognitionLanguage="en-US",o.outputFormat=n.OutputFormat.Simple,o}return Object.defineProperty(c.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"endPoint",{get:function(){return new URL(this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint))},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"subscriptionKey",{get:function(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_Key)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"region",{get:function(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_Region)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"authorizationToken",{get:function(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)},set:function(o){this.privProperties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"speechRecognitionLanguage",{get:function(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)},set:function(o){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"autoDetectSourceLanguages",{get:function(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)},set:function(o){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"outputFormat",{get:function(){return n.OutputFormat[this.privProperties.getProperty(e.OutputFormatPropertyName,void 0)]},set:function(o){this.privProperties.setProperty(e.OutputFormatPropertyName,n.OutputFormat[o])},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"endpointId",{get:function(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId)},set:function(o){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_EndpointId,o)},enumerable:!1,configurable:!0}),c.prototype.setProperty=function(o,s){r.Contracts.throwIfNull(s,"value"),this.privProperties.setProperty(o,s)},c.prototype.getProperty=function(o,s){return this.privProperties.getProperty(o,s)},c.prototype.setProxy=function(o,s,a,u){this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyHostName],o),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyPort],s),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyUserName],a),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyPassword],u)},c.prototype.setServiceProperty=function(o,s,a){var u=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));u[o]=s,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(u))},c.prototype.setProfanity=function(o){this.privProperties.setProperty(n.PropertyId.SpeechServiceResponse_ProfanityOption,n.ProfanityOption[o])},c.prototype.enableAudioLogging=function(){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")},c.prototype.requestWordLevelTimestamps=function(){this.privProperties.setProperty(n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")},c.prototype.enableDictation=function(){this.privProperties.setProperty(e.ForceDictationPropertyName,"true")},c.prototype.clone=function(){var o=new c;return o.privProperties=this.privProperties.clone(),o},Object.defineProperty(c.prototype,"speechSynthesisLanguage",{get:function(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage)},set:function(o){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"speechSynthesisVoiceName",{get:function(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthVoice)},set:function(o){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthVoice,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"speechSynthesisOutputFormat",{get:function(){return n.SpeechSynthesisOutputFormat[this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]},set:function(o){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,n.SpeechSynthesisOutputFormat[o])},enumerable:!1,configurable:!0}),c}(i);return Rr.SpeechConfigImpl=l,Rr}var Er={},gC;function UG(){if(gC)return Er;gC=1;var t=w&&w.__extends||function(){var f=function(c,o){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var u in a)a.hasOwnProperty(u)&&(s[u]=a[u])},f(c,o)};return function(c,o){f(c,o);function s(){this.constructor=c}c.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}}();Object.defineProperty(Er,"__esModule",{value:!0}),Er.SpeechTranslationConfigImpl=Er.SpeechTranslationConfig=void 0;var e=H(),r=te(),n=F(),i=function(f){t(c,f);function c(){return f.call(this)||this}return c.fromSubscription=function(o,s){r.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),r.Contracts.throwIfNullOrWhitespace(s,"region");var a=new l;return a.properties.setProperty(n.PropertyId.SpeechServiceConnection_Key,o),a.properties.setProperty(n.PropertyId.SpeechServiceConnection_Region,s),a},c.fromAuthorizationToken=function(o,s){r.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),r.Contracts.throwIfNullOrWhitespace(s,"region");var a=new l;return a.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,o),a.properties.setProperty(n.PropertyId.SpeechServiceConnection_Region,s),a},c.fromHost=function(o,s){r.Contracts.throwIfNull(o,"hostName");var a=new l;return a.setProperty(n.PropertyId.SpeechServiceConnection_Host,o.protocol+"//"+o.hostname+(o.port===""?"":":"+o.port)),s!==void 0&&a.setProperty(n.PropertyId.SpeechServiceConnection_Key,s),a},c.fromEndpoint=function(o,s){r.Contracts.throwIfNull(o,"endpoint"),r.Contracts.throwIfNull(s,"subscriptionKey");var a=new l;return a.properties.setProperty(n.PropertyId.SpeechServiceConnection_Endpoint,o.href),a.properties.setProperty(n.PropertyId.SpeechServiceConnection_Key,s),a},c}(n.SpeechConfig);Er.SpeechTranslationConfig=i;var l=function(f){t(c,f);function c(){var o=f.call(this)||this;return o.privSpeechProperties=new n.PropertyCollection,o.outputFormat=n.OutputFormat.Simple,o}return Object.defineProperty(c.prototype,"authorizationToken",{set:function(o){r.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"speechRecognitionLanguage",{get:function(){return this.privSpeechProperties.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage])},set:function(o){r.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"subscriptionKey",{get:function(){return this.privSpeechProperties.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_Key])},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"outputFormat",{get:function(){return n.OutputFormat[this.privSpeechProperties.getProperty(e.OutputFormatPropertyName,void 0)]},set:function(o){this.privSpeechProperties.setProperty(e.OutputFormatPropertyName,n.OutputFormat[o])},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"endpointId",{get:function(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId)},set:function(o){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_EndpointId,o)},enumerable:!1,configurable:!0}),c.prototype.addTargetLanguage=function(o){r.Contracts.throwIfNullOrWhitespace(o,"value");var s=this.targetLanguages;s.push(o),this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages,s.join(","))},Object.defineProperty(c.prototype,"targetLanguages",{get:function(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"voiceName",{get:function(){return this.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_TranslationVoice])},set:function(o){r.Contracts.throwIfNullOrWhitespace(o,"value"),this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_TranslationVoice,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"region",{get:function(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_Region)},enumerable:!1,configurable:!0}),c.prototype.setProxy=function(o,s,a,u){this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyHostName],o),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyPort],s),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyUserName],a),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyPassword],u)},c.prototype.getProperty=function(o,s){return this.privSpeechProperties.getProperty(o,s)},c.prototype.setProperty=function(o,s){this.privSpeechProperties.setProperty(o,s)},Object.defineProperty(c.prototype,"properties",{get:function(){return this.privSpeechProperties},enumerable:!1,configurable:!0}),c.prototype.close=function(){},c.prototype.setServiceProperty=function(o,s,a){var u=JSON.parse(this.privSpeechProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));u[o]=s,this.privSpeechProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(u))},c.prototype.setProfanity=function(o){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceResponse_ProfanityOption,n.ProfanityOption[o])},c.prototype.enableAudioLogging=function(){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")},c.prototype.requestWordLevelTimestamps=function(){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")},c.prototype.enableDictation=function(){this.privSpeechProperties.setProperty(e.ForceDictationPropertyName,"true")},Object.defineProperty(c.prototype,"speechSynthesisLanguage",{get:function(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage)},set:function(o){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"speechSynthesisVoiceName",{get:function(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthVoice)},set:function(o){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthVoice,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"speechSynthesisOutputFormat",{get:function(){return n.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]},set:function(o){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,n.SpeechSynthesisOutputFormat[o])},enumerable:!1,configurable:!0}),c}(i);return Er.SpeechTranslationConfigImpl=l,Er}var Ui={},yC;function MI(){if(yC)return Ui;yC=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.PropertyCollection=void 0;var t=F(),e=function(){function r(){this.privKeys=[],this.privValues=[]}return r.prototype.getProperty=function(n,i){var l;typeof n=="string"?l=n:l=t.PropertyId[n];for(var f=0;f<this.privKeys.length;f++)if(this.privKeys[f]===l)return this.privValues[f];return i},r.prototype.setProperty=function(n,i){var l;typeof n=="string"?l=n:l=t.PropertyId[n];for(var f=0;f<this.privKeys.length;f++)if(this.privKeys[f]===l){this.privValues[f]=i;return}this.privKeys.push(l),this.privValues.push(i)},r.prototype.clone=function(){for(var n=new r,i=0;i<this.privKeys.length;i++)n.privKeys.push(this.privKeys[i]),n.privValues.push(this.privValues[i]);return n},r.prototype.mergeTo=function(n){var i=this;this.privKeys.forEach(function(l){if(n.getProperty(l,void 0)===void 0){var f=i.getProperty(l);n.setProperty(l,f)}})},r}();return Ui.PropertyCollection=e,Ui}var Fl={},mC;function Kd(){return mC||(mC=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PropertyId=void 0,function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.SpeechServiceConnection_EnableAudioLogging=32]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceResponse_ProfanityOption=33]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=34]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=35]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=36]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=37]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=38]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.Conversation_ApplicationId=39]="Conversation_ApplicationId",e[e.Conversation_DialogType=40]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=41]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=42]="Conversation_From_Id",e[e.Conversation_Conversation_Id=43]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=44]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=45]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=46]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=47]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=48]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=49]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=50]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=51]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=52]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=53]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=54]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=55]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=56]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=57]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=58]="PronunciationAssessment_Params"}(t.PropertyId||(t.PropertyId={}))}(Fl)),Fl}var Vi={},SC;function VG(){if(SC)return Vi;SC=1;var t=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},e=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.Recognizer=void 0;var r=H(),n=K(),i=te(),l=F(),f=function(){function c(o,s,a){this.audioConfig=o!==void 0?o:l.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=s.clone(),this.privConnectionFactory=a,this.implCommonRecognizerSetup()}return c.prototype.close=function(o,s){i.Contracts.throwIfDisposed(this.privDisposed),n.marshalPromiseToCallbacks(this.dispose(!0),o,s)},Object.defineProperty(c.prototype,"internalData",{get:function(){return this.privReco},enumerable:!1,configurable:!0}),c.prototype.dispose=function(o){return t(this,void 0,void 0,function(){return e(this,function(s){switch(s.label){case 0:return this.privDisposed?[2]:(this.privDisposed=!0,o?this.privReco?[4,this.privReco.audioSource.turnOff()]:[3,3]:[3,3]);case 1:return s.sent(),[4,this.privReco.dispose()];case 2:s.sent(),s.label=3;case 3:return[2]}})})},Object.defineProperty(c,"telemetryEnabled",{get:function(){return r.ServiceRecognizerBase.telemetryDataEnabled},enumerable:!1,configurable:!0}),c.enableTelemetry=function(o){r.ServiceRecognizerBase.telemetryDataEnabled=o},c.prototype.implCommonRecognizerSetup=function(){var o=typeof window<"u"?"Browser":"Node",s="unknown",a="unknown";typeof navigator<"u"&&(o=o+"/"+navigator.platform,s=navigator.userAgent,a=navigator.appVersion);var u=this.createRecognizerConfig(new r.SpeechServiceConfig(new r.Context(new r.OS(o,s,a))));this.privReco=this.createServiceRecognizer(c.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,u)},c.prototype.recognizeOnceAsyncImpl=function(o){return t(this,void 0,void 0,function(){var s,a;return e(this,function(u){switch(u.label){case 0:return i.Contracts.throwIfDisposed(this.privDisposed),s=new n.Deferred,[4,this.implRecognizerStop()];case 1:return u.sent(),[4,this.privReco.recognize(o,s.resolve,s.reject)];case 2:return u.sent(),[4,s.promise];case 3:return a=u.sent(),[4,this.implRecognizerStop()];case 4:return u.sent(),[2,a]}})})},c.prototype.startContinuousRecognitionAsyncImpl=function(o){return t(this,void 0,void 0,function(){return e(this,function(s){switch(s.label){case 0:return i.Contracts.throwIfDisposed(this.privDisposed),[4,this.implRecognizerStop()];case 1:return s.sent(),[4,this.privReco.recognize(o,void 0,void 0)];case 2:return s.sent(),[2]}})})},c.prototype.stopContinuousRecognitionAsyncImpl=function(){return t(this,void 0,void 0,function(){return e(this,function(o){switch(o.label){case 0:return i.Contracts.throwIfDisposed(this.privDisposed),[4,this.implRecognizerStop()];case 1:return o.sent(),[2]}})})},c.prototype.implRecognizerStop=function(){return t(this,void 0,void 0,function(){return e(this,function(o){switch(o.label){case 0:return this.privReco?[4,this.privReco.stopRecognizing()]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},c.getAuthFromProperties=function(o){var s=o.getProperty(l.PropertyId.SpeechServiceConnection_Key,void 0),a=s&&s!==""?new r.CognitiveSubscriptionKeyAuthentication(s):new r.CognitiveTokenAuthentication(function(u){var p=o.getProperty(l.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(p)},function(u){var p=o.getProperty(l.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(p)});return a},c}();return Vi.Recognizer=f,Vi}var Wi={},bC;function WG(){if(bC)return Wi;bC=1;var t=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}(),e=w&&w.__awaiter||function(o,s,a,u){function p(v){return v instanceof a?v:new a(function(g){g(v)})}return new(a||(a=Promise))(function(v,g){function h(m){try{y(u.next(m))}catch(S){g(S)}}function d(m){try{y(u.throw(m))}catch(S){g(S)}}function y(m){m.done?v(m.value):p(m.value).then(h,d)}y((u=u.apply(o,s||[])).next())})},r=w&&w.__generator||function(o,s){var a={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},u,p,v,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(y){return function(m){return d([y,m])}}function d(y){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,p&&(v=y[0]&2?p.return:y[0]?p.throw||((v=p.return)&&v.call(p),0):p.next)&&!(v=v.call(p,y[1])).done)return v;switch(p=0,v&&(y=[y[0]&2,v.value]),y[0]){case 0:case 1:v=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,p=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(v=a.trys,!(v=v.length>0&&v[v.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!v||y[1]>v[0]&&y[1]<v[3])){a.label=y[1];break}if(y[0]===6&&a.label<v[1]){a.label=v[1],v=y;break}if(v&&a.label<v[2]){a.label=v[2],a.ops.push(y);break}v[2]&&a.ops.pop(),a.trys.pop();continue}y=s.call(o,a)}catch(m){y=[6,m],p=0}finally{u=v=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.SpeechRecognizer=void 0;var n=H(),i=K(),l=te(),f=F(),c=function(o){t(s,o);function s(a,u){var p=this,v=a;return l.Contracts.throwIfNull(v,"speechConfig"),l.Contracts.throwIfNullOrWhitespace(v.properties.getProperty(f.PropertyId.SpeechServiceConnection_RecoLanguage),f.PropertyId[f.PropertyId.SpeechServiceConnection_RecoLanguage]),p=o.call(this,u,v.properties,new n.SpeechConnectionFactory)||this,p.privDisposedRecognizer=!1,p}return s.FromConfig=function(a,u,p){var v=a;u.properties.mergeTo(v.properties);var g=new s(a,p);return g},Object.defineProperty(s.prototype,"endpointId",{get:function(){return l.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(f.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(f.PropertyId.SpeechServiceAuthorization_Token)},set:function(a){l.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(f.PropertyId.SpeechServiceAuthorization_Token,a)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"speechRecognitionLanguage",{get:function(){return l.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(f.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"outputFormat",{get:function(){return l.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.OutputFormatPropertyName,f.OutputFormat[f.OutputFormat.Simple])===f.OutputFormat[f.OutputFormat.Simple]?f.OutputFormat.Simple:f.OutputFormat.Detailed},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),s.prototype.recognizeOnceAsync=function(a,u){i.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(n.RecognitionMode.Interactive),a,u)},s.prototype.startContinuousRecognitionAsync=function(a,u){i.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(n.RecognitionMode.Conversation),a,u)},s.prototype.stopContinuousRecognitionAsync=function(a,u){i.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),a,u)},s.prototype.startKeywordRecognitionAsync=function(a,u,p){l.Contracts.throwIfNull(a,"model"),p&&p("Not yet implemented.")},s.prototype.stopKeywordRecognitionAsync=function(a,u){a&&a()},s.prototype.close=function(a,u){l.Contracts.throwIfDisposed(this.privDisposedRecognizer),i.marshalPromiseToCallbacks(this.dispose(!0),a,u)},s.prototype.dispose=function(a){return e(this,void 0,void 0,function(){return r(this,function(u){switch(u.label){case 0:return this.privDisposedRecognizer?[2]:a?(this.privDisposedRecognizer=!0,[4,this.implRecognizerStop()]):[3,2];case 1:u.sent(),u.label=2;case 2:return[4,o.prototype.dispose.call(this,a)];case 3:return u.sent(),[2]}})})},s.prototype.createRecognizerConfig=function(a){return new n.RecognizerConfig(a,this.properties)},s.prototype.createServiceRecognizer=function(a,u,p,v){var g=p;return new n.SpeechServiceRecognizer(a,u,g,v,this)},s}(f.Recognizer);return Wi.SpeechRecognizer=c,Wi}var Hi={},CC;function HG(){if(CC)return Hi;CC=1;var t=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}(),e=w&&w.__awaiter||function(o,s,a,u){function p(v){return v instanceof a?v:new a(function(g){g(v)})}return new(a||(a=Promise))(function(v,g){function h(m){try{y(u.next(m))}catch(S){g(S)}}function d(m){try{y(u.throw(m))}catch(S){g(S)}}function y(m){m.done?v(m.value):p(m.value).then(h,d)}y((u=u.apply(o,s||[])).next())})},r=w&&w.__generator||function(o,s){var a={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},u,p,v,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(y){return function(m){return d([y,m])}}function d(y){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,p&&(v=y[0]&2?p.return:y[0]?p.throw||((v=p.return)&&v.call(p),0):p.next)&&!(v=v.call(p,y[1])).done)return v;switch(p=0,v&&(y=[y[0]&2,v.value]),y[0]){case 0:case 1:v=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,p=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(v=a.trys,!(v=v.length>0&&v[v.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!v||y[1]>v[0]&&y[1]<v[3])){a.label=y[1];break}if(y[0]===6&&a.label<v[1]){a.label=v[1],v=y;break}if(v&&a.label<v[2]){a.label=v[2],a.ops.push(y);break}v[2]&&a.ops.pop(),a.trys.pop();continue}y=s.call(o,a)}catch(m){y=[6,m],p=0}finally{u=v=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.IntentRecognizer=void 0;var n=H(),i=K(),l=te(),f=F(),c=function(o){t(s,o);function s(a,u){var p=this;l.Contracts.throwIfNullOrUndefined(a,"speechConfig");var v=a;return l.Contracts.throwIfNullOrUndefined(v,"speechConfig"),p=o.call(this,u,v.properties,new n.IntentConnectionFactory)||this,p.privAddedIntents=[],p.privAddedLmIntents={},p.privDisposedIntentRecognizer=!1,p.privProperties=v.properties,l.Contracts.throwIfNullOrWhitespace(p.properties.getProperty(f.PropertyId.SpeechServiceConnection_RecoLanguage),f.PropertyId[f.PropertyId.SpeechServiceConnection_RecoLanguage]),p}return Object.defineProperty(s.prototype,"speechRecognitionLanguage",{get:function(){return l.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(f.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(f.PropertyId.SpeechServiceAuthorization_Token)},set:function(a){this.properties.setProperty(f.PropertyId.SpeechServiceAuthorization_Token,a)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),s.prototype.recognizeOnceAsync=function(a,u){if(l.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){var p=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",p.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(p.ReferenceGrammars);var v=this.privReco;v.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}i.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(n.RecognitionMode.Interactive),a,u)},s.prototype.startContinuousRecognitionAsync=function(a,u){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){var p=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",p.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(p.ReferenceGrammars);var v=this.privReco;v.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}i.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(n.RecognitionMode.Conversation),a,u)},s.prototype.stopContinuousRecognitionAsync=function(a,u){i.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),a,u)},s.prototype.startKeywordRecognitionAsync=function(a,u,p){l.Contracts.throwIfNull(a,"model"),p&&p("Not yet implemented.")},s.prototype.stopKeywordRecognitionAsync=function(a,u){a&&a()},s.prototype.addIntent=function(a,u){l.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),l.Contracts.throwIfNullOrWhitespace(u,"intentId"),l.Contracts.throwIfNullOrWhitespace(a,"simplePhrase"),this.privAddedIntents.push([u,a])},s.prototype.addIntentWithLanguageModel=function(a,u,p){l.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),l.Contracts.throwIfNullOrWhitespace(a,"intentId"),l.Contracts.throwIfNull(u,"model");var v=u;l.Contracts.throwIfNullOrWhitespace(v.appId,"model.appId"),this.privAddedLmIntents[a]=new n.AddedLmIntent(v,p)},s.prototype.addAllIntents=function(a,u){l.Contracts.throwIfNull(a,"model");var p=a;l.Contracts.throwIfNullOrWhitespace(p.appId,"model.appId"),this.privUmbrellaIntent=new n.AddedLmIntent(p,u)},s.prototype.close=function(a,u){l.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),i.marshalPromiseToCallbacks(this.dispose(!0),a,u)},s.prototype.createRecognizerConfig=function(a){return new n.RecognizerConfig(a,this.properties)},s.prototype.createServiceRecognizer=function(a,u,p,v){var g=p;return new n.IntentServiceRecognizer(a,u,g,v,this)},s.prototype.dispose=function(a){return e(this,void 0,void 0,function(){return r(this,function(u){switch(u.label){case 0:return this.privDisposedIntentRecognizer?[2]:a?(this.privDisposedIntentRecognizer=!0,[4,o.prototype.dispose.call(this,a)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}})})},s.prototype.buildSpeechContext=function(){var a,u,p,v=[];this.privUmbrellaIntent!==void 0&&(a=this.privUmbrellaIntent.modelImpl.appId,u=this.privUmbrellaIntent.modelImpl.region,p=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(var g=0,h=Object.keys(this.privAddedLmIntents);g<h.length;g++){var d=h[g],y=this.privAddedLmIntents[d];if(a===void 0)a=y.modelImpl.appId;else if(a!==y.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(u===void 0)u=y.modelImpl.region;else if(u!==y.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(p===void 0)p=y.modelImpl.subscriptionKey;else if(p!==y.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");var m="luis/"+a+"-PRODUCTION#"+d;v.push(m)}return{Intent:{id:a,key:p===void 0?this.privProperties.getProperty(f.PropertyId[f.PropertyId.SpeechServiceConnection_Key]):p,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?v:["luis/"+a+"-PRODUCTION"]}},s}(f.Recognizer);return Hi.IntentRecognizer=c,Hi}var Ul={},PC;function KG(){return PC||(PC=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceProfileType=void 0,function(e){e[e.TextIndependentIdentification=0]="TextIndependentIdentification",e[e.TextDependentVerification=1]="TextDependentVerification",e[e.TextIndependentVerification=2]="TextIndependentVerification"}(t.VoiceProfileType||(t.VoiceProfileType={}))}(Ul)),Ul}var Ki={},wC;function GG(){if(wC)return Ki;wC=1;var t=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}(),e=w&&w.__awaiter||function(o,s,a,u){function p(v){return v instanceof a?v:new a(function(g){g(v)})}return new(a||(a=Promise))(function(v,g){function h(m){try{y(u.next(m))}catch(S){g(S)}}function d(m){try{y(u.throw(m))}catch(S){g(S)}}function y(m){m.done?v(m.value):p(m.value).then(h,d)}y((u=u.apply(o,s||[])).next())})},r=w&&w.__generator||function(o,s){var a={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},u,p,v,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(y){return function(m){return d([y,m])}}function d(y){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,p&&(v=y[0]&2?p.return:y[0]?p.throw||((v=p.return)&&v.call(p),0):p.next)&&!(v=v.call(p,y[1])).done)return v;switch(p=0,v&&(y=[y[0]&2,v.value]),y[0]){case 0:case 1:v=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,p=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(v=a.trys,!(v=v.length>0&&v[v.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!v||y[1]>v[0]&&y[1]<v[3])){a.label=y[1];break}if(y[0]===6&&a.label<v[1]){a.label=v[1],v=y;break}if(v&&a.label<v[2]){a.label=v[2],a.ops.push(y);break}v[2]&&a.ops.pop(),a.trys.pop();continue}y=s.call(o,a)}catch(m){y=[6,m],p=0}finally{u=v=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.TranslationRecognizer=void 0;var n=H(),i=K(),l=te(),f=F(),c=function(o){t(s,o);function s(a,u){var p=this,v=a;return l.Contracts.throwIfNull(v,"speechConfig"),p=o.call(this,u,v.properties,new n.TranslationConnectionFactory)||this,p.privDisposedTranslationRecognizer=!1,p.privProperties=v.properties.clone(),p.properties.getProperty(f.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&l.Contracts.throwIfNullOrWhitespace(p.properties.getProperty(f.PropertyId.SpeechServiceConnection_TranslationVoice),f.PropertyId[f.PropertyId.SpeechServiceConnection_TranslationVoice]),l.Contracts.throwIfNullOrWhitespace(p.properties.getProperty(f.PropertyId.SpeechServiceConnection_TranslationToLanguages),f.PropertyId[f.PropertyId.SpeechServiceConnection_TranslationToLanguages]),l.Contracts.throwIfNullOrWhitespace(p.properties.getProperty(f.PropertyId.SpeechServiceConnection_RecoLanguage),f.PropertyId[f.PropertyId.SpeechServiceConnection_RecoLanguage]),p}return Object.defineProperty(s.prototype,"speechRecognitionLanguage",{get:function(){return l.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(f.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"targetLanguages",{get:function(){return l.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(f.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"voiceName",{get:function(){return l.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(f.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(f.PropertyId.SpeechServiceAuthorization_Token)},set:function(a){this.properties.setProperty(f.PropertyId.SpeechServiceAuthorization_Token,a)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),s.prototype.recognizeOnceAsync=function(a,u){l.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),i.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(n.RecognitionMode.Conversation),a,u)},s.prototype.startContinuousRecognitionAsync=function(a,u){i.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(n.RecognitionMode.Conversation),a,u)},s.prototype.stopContinuousRecognitionAsync=function(a,u){i.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),a,u)},s.prototype.close=function(a,u){l.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),i.marshalPromiseToCallbacks(this.dispose(!0),a,u)},s.prototype.onConnection=function(){},s.prototype.onDisconnection=function(){return e(this,void 0,void 0,function(){return r(this,function(a){return[2]})})},s.prototype.dispose=function(a){return e(this,void 0,void 0,function(){return r(this,function(u){switch(u.label){case 0:return this.privDisposedTranslationRecognizer?[2]:(this.privDisposedTranslationRecognizer=!0,a?[4,this.implRecognizerStop()]:[3,3]);case 1:return u.sent(),[4,o.prototype.dispose.call(this,a)];case 2:u.sent(),u.label=3;case 3:return[2]}})})},s.prototype.createRecognizerConfig=function(a){return new n.RecognizerConfig(a,this.properties)},s.prototype.createServiceRecognizer=function(a,u,p,v){var g=p;return new n.TranslationServiceRecognizer(a,u,g,v,this)},s}(f.Recognizer);return Ki.TranslationRecognizer=c,Ki}var Gi={},RC;function JG(){if(RC)return Gi;RC=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.Translations=void 0;var t=F(),e=function(){function r(){this.privMap=new t.PropertyCollection}return r.prototype.get=function(n,i){return this.privMap.getProperty(n,i)},r.prototype.set=function(n,i){this.privMap.setProperty(n,i)},r}();return Gi.Translations=e,Gi}var Vl={},EC;function QG(){return EC||(EC=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.NoMatchReason=void 0,function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(t.NoMatchReason||(t.NoMatchReason={}))}(Vl)),Vl}var Ji={},OC;function YG(){if(OC)return Ji;OC=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.NoMatchDetails=void 0;var t=H(),e=F(),r=function(){function n(i){this.privReason=i}return n.fromResult=function(i){var l=t.SimpleSpeechPhrase.fromJSON(i.json),f=e.NoMatchReason.NotRecognized;switch(l.RecognitionStatus){case t.RecognitionStatus.BabbleTimeout:f=e.NoMatchReason.InitialBabbleTimeout;break;case t.RecognitionStatus.InitialSilenceTimeout:f=e.NoMatchReason.InitialSilenceTimeout;break;default:f=e.NoMatchReason.NotRecognized;break}return new n(f)},Object.defineProperty(n.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),n}();return Ji.NoMatchDetails=r,Ji}var Qi={},_C;function XG(){if(_C)return Qi;_C=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.TranslationRecognitionCanceledEventArgs=void 0;var t=function(){function e(r,n,i,l,f){this.privCancelReason=n,this.privErrorDetails=i,this.privResult=f,this.privSessionId=r,this.privErrorCode=l}return Object.defineProperty(e.prototype,"result",{get:function(){return this.privResult},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privCancelReason},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),e}();return Qi.TranslationRecognitionCanceledEventArgs=t,Qi}var Yi={},AC;function ZG(){if(AC)return Yi;AC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.IntentRecognitionCanceledEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c,o,s,a){var u=n.call(this,o,s,a)||this;return u.privReason=l,u.privErrorDetails=f,u.privErrorCode=c,u}return Object.defineProperty(i.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),i}(e.IntentRecognitionEventArgs);return Yi.IntentRecognitionCanceledEventArgs=r,Yi}var Xi={},IC;function DI(){if(IC)return Xi;IC=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.CancellationDetailsBase=void 0;var t=function(){function e(r,n,i){this.privReason=r,this.privErrorDetails=n,this.privErrorCode=i}return Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ErrorCode",{get:function(){return this.privErrorCode},enumerable:!1,configurable:!0}),e}();return Xi.CancellationDetailsBase=t,Xi}var Zi={},TC;function e5(){if(TC)return Zi;TC=1;var t=w&&w.__extends||function(){var l=function(f,c){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)s.hasOwnProperty(a)&&(o[a]=s[a])},l(f,c)};return function(f,c){l(f,c);function o(){this.constructor=f}f.prototype=c===null?Object.create(c):(o.prototype=c.prototype,new o)}}();Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.CancellationDetails=void 0;var e=H(),r=DI(),n=F(),i=function(l){t(f,l);function f(c,o,s){return l.call(this,c,o,s)||this}return f.fromResult=function(c){var o=n.CancellationReason.Error,s=n.CancellationErrorCode.NoError;if(c instanceof n.RecognitionResult&&c.json){var a=e.SimpleSpeechPhrase.fromJSON(c.json);o=e.EnumTranslation.implTranslateCancelResult(a.RecognitionStatus)}return c.properties&&(s=n.CancellationErrorCode[c.properties.getProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.NoError])]),new f(o,c.errorDetails,s)},f}(r.CancellationDetailsBase);return Zi.CancellationDetails=i,Zi}var Wl={},MC;function t5(){return MC||(MC=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationErrorCode=void 0,function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError"}(t.CancellationErrorCode||(t.CancellationErrorCode={}))}(Wl)),Wl}var eo={},DC;function r5(){if(DC)return eo;DC=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(eo,"__esModule",{value:!0}),eo.ConnectionEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(){return n!==null&&n.apply(this,arguments)||this}return i}(e.SessionEventArgs);return eo.ConnectionEventArgs=r,eo}var to={},$C;function n5(){if($C)return to;$C=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(to,"__esModule",{value:!0}),to.ServiceEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c){var o=n.call(this,c)||this;return o.privJsonResult=l,o.privEventName=f,o}return Object.defineProperty(i.prototype,"jsonString",{get:function(){return this.privJsonResult},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"eventName",{get:function(){return this.privEventName},enumerable:!1,configurable:!0}),i}(e.SessionEventArgs);return to.ServiceEventArgs=r,to}var ro={},Or={},kC;function $I(){if(kC)return Or;kC=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.ConnectionMessageImpl=Or.ConnectionMessage=void 0;var t=Lt(),e=K(),r=MI(),n=Kd(),i=function(){function f(){}return f}();Or.ConnectionMessage=i;var l=function(){function f(c){var o=this;this.privConnectionMessage=c,this.privProperties=new r.PropertyCollection,this.privConnectionMessage.headers[t.HeaderNames.ConnectionId]&&this.privProperties.setProperty(n.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[t.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(function(s,a,u){o.privProperties.setProperty(s,o.privConnectionMessage.headers[s])})}return Object.defineProperty(f.prototype,"path",{get:function(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(function(c){return c.toLowerCase()==="path".toLowerCase()})]},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isTextMessage",{get:function(){return this.privConnectionMessage.messageType===e.MessageType.Text},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isBinaryMessage",{get:function(){return this.privConnectionMessage.messageType===e.MessageType.Binary},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"TextMessage",{get:function(){return this.privConnectionMessage.textBody},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"binaryMessage",{get:function(){return this.privConnectionMessage.binaryBody},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),f.prototype.toString=function(){return""},f}();return Or.ConnectionMessageImpl=l,Or}var xC;function i5(){if(xC)return ro;xC=1,Object.defineProperty(ro,"__esModule",{value:!0}),ro.Connection=void 0;var t=H(),e=K(),r=$I(),n=te(),i=F(),l=function(){function f(){}return f.fromRecognizer=function(c){var o=c.internalData,s=new f;return s.privInternalData=o,s.setupEvents(),s},f.fromSynthesizer=function(c){var o=c.internalData,s=new f;return s.privInternalData=o,s.setupEvents(),s},f.prototype.openConnection=function(c,o){e.marshalPromiseToCallbacks(this.privInternalData.connect(),c,o)},f.prototype.closeConnection=function(c,o){if(this.privInternalData instanceof t.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");e.marshalPromiseToCallbacks(this.privInternalData.disconnect(),c,o)},f.prototype.setMessageProperty=function(c,o,s){if(n.Contracts.throwIfNullOrWhitespace(o,"propertyName"),this.privInternalData instanceof t.ServiceRecognizerBase){if(c.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(o,s)}else if(this.privInternalData instanceof t.SynthesisAdapterBase){if(c.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(o,s)}},f.prototype.sendMessageAsync=function(c,o,s,a){e.marshalPromiseToCallbacks(this.privInternalData.sendNetworkMessage(c,o),s,a)},f.prototype.close=function(){},f.prototype.setupEvents=function(){var c=this;this.privEventListener=this.privInternalData.connectionEvents.attach(function(o){o.name==="ConnectionEstablishedEvent"?c.connected&&c.connected(new i.ConnectionEventArgs(o.connectionId)):o.name==="ConnectionClosedEvent"?c.disconnected&&c.disconnected(new i.ConnectionEventArgs(o.connectionId)):o.name==="ConnectionMessageSentEvent"?c.messageSent&&c.messageSent(new i.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(o.message))):o.name==="ConnectionMessageReceivedEvent"&&c.messageReceived&&c.messageReceived(new i.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(o.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(function(o){c.receivedServiceMessage&&c.receivedServiceMessage(new i.ServiceEventArgs(o.jsonString,o.name))})},f}();return ro.Connection=l,ro}var no={},jC;function o5(){if(jC)return no;jC=1,Object.defineProperty(no,"__esModule",{value:!0}),no.PhraseListGrammar=void 0;var t=function(){function e(r){this.privGrammerBuilder=r.dynamicGrammar}return e.fromRecognizer=function(r){var n=r.internalData;return new e(n)},e.prototype.addPhrase=function(r){this.privGrammerBuilder.addPhrase(r)},e.prototype.addPhrases=function(r){this.privGrammerBuilder.addPhrase(r)},e.prototype.clear=function(){this.privGrammerBuilder.clearPhrases()},e}();return no.PhraseListGrammar=t,no}var _r={},zC;function Gd(){if(zC)return _r;zC=1;var t=w&&w.__extends||function(){var l=function(f,c){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)s.hasOwnProperty(a)&&(o[a]=s[a])},l(f,c)};return function(f,c){l(f,c);function o(){this.constructor=f}f.prototype=c===null?Object.create(c):(o.prototype=c.prototype,new o)}}();Object.defineProperty(_r,"__esModule",{value:!0}),_r.DialogServiceConfigImpl=_r.DialogServiceConfig=void 0;var e=te(),r=F(),n=function(){function l(){}Object.defineProperty(l.prototype,"applicationId",{set:function(c){},enumerable:!1,configurable:!0});var f;return l.DialogTypes=(f=function(){function c(){}return c}(),f.BotFramework="bot_framework",f.CustomCommands="custom_commands",f),l}();_r.DialogServiceConfig=n;var i=function(l){t(f,l);function f(){var c=l.call(this)||this;return c.privSpeechConfig=new r.SpeechConfigImpl,c}return Object.defineProperty(f.prototype,"properties",{get:function(){return this.privSpeechConfig.properties},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"speechRecognitionLanguage",{get:function(){return this.privSpeechConfig.speechRecognitionLanguage},set:function(c){e.Contracts.throwIfNullOrWhitespace(c,"value"),this.privSpeechConfig.speechRecognitionLanguage=c},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"outputFormat",{get:function(){return this.privSpeechConfig.outputFormat},set:function(c){this.privSpeechConfig.outputFormat=c},enumerable:!1,configurable:!0}),f.prototype.setProperty=function(c,o){this.privSpeechConfig.setProperty(c,o)},f.prototype.getProperty=function(c,o){return this.privSpeechConfig.getProperty(c)},f.prototype.setProxy=function(c,o,s,a){this.setProperty(r.PropertyId.SpeechServiceConnection_ProxyHostName,c),this.setProperty(r.PropertyId.SpeechServiceConnection_ProxyPort,""+o),s&&this.setProperty(r.PropertyId.SpeechServiceConnection_ProxyUserName,s),a&&this.setProperty(r.PropertyId.SpeechServiceConnection_ProxyPassword,a)},f.prototype.setServiceProperty=function(c,o,s){this.privSpeechConfig.setServiceProperty(c,o,s)},f.prototype.close=function(){},f}(n);return _r.DialogServiceConfigImpl=i,_r}var io={},NC;function s5(){if(NC)return io;NC=1;var t=w&&w.__extends||function(){var l=function(f,c){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)s.hasOwnProperty(a)&&(o[a]=s[a])},l(f,c)};return function(f,c){l(f,c);function o(){this.constructor=f}f.prototype=c===null?Object.create(c):(o.prototype=c.prototype,new o)}}();Object.defineProperty(io,"__esModule",{value:!0}),io.BotFrameworkConfig=void 0;var e=te(),r=Gd(),n=F(),i=function(l){t(f,l);function f(){return l.call(this)||this}return f.fromSubscription=function(c,o,s){e.Contracts.throwIfNullOrWhitespace(c,"subscription"),e.Contracts.throwIfNullOrWhitespace(o,"region");var a=new r.DialogServiceConfigImpl;return a.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.BotFramework),a.setProperty(n.PropertyId.SpeechServiceConnection_Key,c),a.setProperty(n.PropertyId.SpeechServiceConnection_Region,o),s&&a.setProperty(n.PropertyId.Conversation_ApplicationId,s),a},f.fromAuthorizationToken=function(c,o,s){e.Contracts.throwIfNullOrWhitespace(c,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(o,"region");var a=new r.DialogServiceConfigImpl;return a.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.BotFramework),a.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,c),a.setProperty(n.PropertyId.SpeechServiceConnection_Region,o),s&&a.setProperty(n.PropertyId.Conversation_ApplicationId,s),a},f.fromHost=function(c,o,s){e.Contracts.throwIfNullOrUndefined(c,"host");var a=c instanceof URL?c:new URL("wss://"+c+".convai.speech.azure.us");e.Contracts.throwIfNullOrUndefined(a,"resolvedHost");var u=new r.DialogServiceConfigImpl;return u.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.BotFramework),u.setProperty(n.PropertyId.SpeechServiceConnection_Host,a.toString()),o!==void 0&&u.setProperty(n.PropertyId.SpeechServiceConnection_Key,o),u},f.fromEndpoint=function(c,o){e.Contracts.throwIfNull(c,"endpoint");var s=new r.DialogServiceConfigImpl;return s.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(n.PropertyId.SpeechServiceConnection_Endpoint,c.toString()),o!==void 0&&s.setProperty(n.PropertyId.SpeechServiceConnection_Key,o),s},f}(r.DialogServiceConfigImpl);return io.BotFrameworkConfig=i,io}var oo={},LC;function a5(){if(LC)return oo;LC=1;var t=w&&w.__extends||function(){var l=function(f,c){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)s.hasOwnProperty(a)&&(o[a]=s[a])},l(f,c)};return function(f,c){l(f,c);function o(){this.constructor=f}f.prototype=c===null?Object.create(c):(o.prototype=c.prototype,new o)}}();Object.defineProperty(oo,"__esModule",{value:!0}),oo.CustomCommandsConfig=void 0;var e=te(),r=Gd(),n=F(),i=function(l){t(f,l);function f(){return l.call(this)||this}return f.fromSubscription=function(c,o,s){e.Contracts.throwIfNullOrWhitespace(c,"applicationId"),e.Contracts.throwIfNullOrWhitespace(o,"subscription"),e.Contracts.throwIfNullOrWhitespace(s,"region");var a=new r.DialogServiceConfigImpl;return a.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.CustomCommands),a.setProperty(n.PropertyId.Conversation_ApplicationId,c),a.setProperty(n.PropertyId.SpeechServiceConnection_Key,o),a.setProperty(n.PropertyId.SpeechServiceConnection_Region,s),a},f.fromAuthorizationToken=function(c,o,s){e.Contracts.throwIfNullOrWhitespace(c,"applicationId"),e.Contracts.throwIfNullOrWhitespace(o,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(s,"region");var a=new r.DialogServiceConfigImpl;return a.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.CustomCommands),a.setProperty(n.PropertyId.Conversation_ApplicationId,c),a.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,o),a.setProperty(n.PropertyId.SpeechServiceConnection_Region,s),a},Object.defineProperty(f.prototype,"applicationId",{get:function(){return this.getProperty(n.PropertyId.Conversation_ApplicationId)},set:function(c){e.Contracts.throwIfNullOrWhitespace(c,"value"),this.setProperty(n.PropertyId.Conversation_ApplicationId,c)},enumerable:!1,configurable:!0}),f}(r.DialogServiceConfigImpl);return oo.CustomCommandsConfig=i,oo}var so={},ao={},co={},uo={},BC;function Un(){if(BC)return uo;BC=1,Object.defineProperty(uo,"__esModule",{value:!0}),uo.QueryParameterNames=void 0;var t=function(){function e(){}return e.BotId="botid",e.CustomSpeechDeploymentId="cid",e.CustomVoiceDeploymentId="deploymentId",e.EnableAudioLogging="storeAudio",e.EnableLanguageId="lidEnabled",e.EnableWordLevelTimestamps="wordLevelTimestamps",e.EndSilenceTimeoutMs="endSilenceTimeoutMs",e.Format="format",e.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",e.Language="language",e.Profanity="profanity",e.RequestBotStatusMessages="enableBotMessageStatus",e.StableIntermediateThreshold="stableIntermediateThreshold",e.StableTranslation="stableTranslation",e.TestHooks="testhooks",e}();return uo.QueryParameterNames=t,uo}var qC;function Vn(){if(qC)return co;qC=1,Object.defineProperty(co,"__esModule",{value:!0}),co.ConnectionFactoryBase=void 0;var t=H(),e=F(),r=Un(),n=function(){function i(){}return i.prototype.setCommonUrlParams=function(l,f,c){this.setUrlParameter(e.PropertyId.SpeechServiceConnection_EnableAudioLogging,r.QueryParameterNames.EnableAudioLogging,l,f,c),this.setUrlParameter(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,r.QueryParameterNames.EnableWordLevelTimestamps,l,f,c),this.setUrlParameter(e.PropertyId.SpeechServiceResponse_ProfanityOption,r.QueryParameterNames.Profanity,l,f,c),this.setUrlParameter(e.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,r.QueryParameterNames.InitialSilenceTimeoutMs,l,f,c),this.setUrlParameter(e.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,r.QueryParameterNames.EndSilenceTimeoutMs,l,f,c),this.setUrlParameter(e.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,r.QueryParameterNames.StableIntermediateThreshold,l,f,c);var o=JSON.parse(l.parameters.getProperty(t.ServicePropertiesPropertyName,"{}"));Object.keys(o).forEach(function(s,a,u){f[s]=o[s]})},i.prototype.setUrlParameter=function(l,f,c,o,s){var a=c.parameters.getProperty(l,void 0);a&&(!s||s.search(f)===-1)&&(o[f]=a.toLocaleLowerCase())},i}();return co.ConnectionFactoryBase=n,co}var FC;function c5(){if(FC)return ao;FC=1;var t=w&&w.__extends||function(){var s=function(a,u){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,v){p.__proto__=v}||function(p,v){for(var g in v)v.hasOwnProperty(g)&&(p[g]=v[g])},s(a,u)};return function(a,u){s(a,u);function p(){this.constructor=a}a.prototype=u===null?Object.create(u):(p.prototype=u.prototype,new p)}}();Object.defineProperty(ao,"__esModule",{value:!0}),ao.DialogConnectionFactory=void 0;var e=yt(),r=H(),n=F(),i=Vn(),l=H(),f=Lt(),c=Un(),o=function(s){t(a,s);function a(){var p=s!==null&&s.apply(this,arguments)||this;return p.create=function(v,g,h){var d=v.parameters.getProperty(n.PropertyId.Conversation_ApplicationId,""),y=v.parameters.getProperty(n.PropertyId.Conversation_DialogType),m=v.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region),S=v.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),b=v.parameters.getProperty(n.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),P={};P[f.HeaderNames.ConnectionId]=h,P[c.QueryParameterNames.Format]=v.parameters.getProperty(r.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple]).toLowerCase(),P[c.QueryParameterNames.Language]=S,P[c.QueryParameterNames.RequestBotStatusMessages]=b,d&&(P[c.QueryParameterNames.BotId]=d,y===n.DialogServiceConfig.DialogTypes.CustomCommands&&(P[f.HeaderNames.CustomCommandsAppId]=d));var C=y===n.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",R=y===n.DialogServiceConfig.DialogTypes.CustomCommands?"v1":y===n.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",O={};g.token!=null&&g.token!==""&&(O[g.headerName]=g.token);var z=v.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,"");if(!z){var L=m&&m.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",E=v.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"wss://"+m+"."+a.Constants.BaseUrl+L),T=E.endsWith("/")?E:E+"/";z=""+T+C+a.Constants.ApiKey+"/"+R}p.setCommonUrlParams(v,P,z);var A=v.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(z,P,O,new l.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(v),A,h)},p}var u;return a.Constants=(u=function(){function p(){}return p}(),u.ApiKey="api",u.BaseUrl="convai.speech",u),a}(i.ConnectionFactoryBase);return ao.DialogConnectionFactory=o,ao}var UC;function u5(){if(UC)return so;UC=1;var t=w&&w.__extends||function(){var a=function(u,p){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var h in g)g.hasOwnProperty(h)&&(v[h]=g[h])},a(u,p)};return function(u,p){a(u,p);function v(){this.constructor=u}u.prototype=p===null?Object.create(p):(v.prototype=p.prototype,new v)}}(),e=w&&w.__awaiter||function(a,u,p,v){function g(h){return h instanceof p?h:new p(function(d){d(h)})}return new(p||(p=Promise))(function(h,d){function y(b){try{S(v.next(b))}catch(P){d(P)}}function m(b){try{S(v.throw(b))}catch(P){d(P)}}function S(b){b.done?h(b.value):g(b.value).then(y,m)}S((v=v.apply(a,u||[])).next())})},r=w&&w.__generator||function(a,u){var p={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},v,g,h,d;return d={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function y(S){return function(b){return m([S,b])}}function m(S){if(v)throw new TypeError("Generator is already executing.");for(;p;)try{if(v=1,g&&(h=S[0]&2?g.return:S[0]?g.throw||((h=g.return)&&h.call(g),0):g.next)&&!(h=h.call(g,S[1])).done)return h;switch(g=0,h&&(S=[S[0]&2,h.value]),S[0]){case 0:case 1:h=S;break;case 4:return p.label++,{value:S[1],done:!1};case 5:p.label++,g=S[1],S=[0];continue;case 7:S=p.ops.pop(),p.trys.pop();continue;default:if(h=p.trys,!(h=h.length>0&&h[h.length-1])&&(S[0]===6||S[0]===2)){p=0;continue}if(S[0]===3&&(!h||S[1]>h[0]&&S[1]<h[3])){p.label=S[1];break}if(S[0]===6&&p.label<h[1]){p.label=h[1],h=S;break}if(h&&p.label<h[2]){p.label=h[2],p.ops.push(S);break}h[2]&&p.ops.pop(),p.trys.pop();continue}S=u.call(a,p)}catch(b){S=[6,b],g=0}finally{v=h=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(so,"__esModule",{value:!0}),so.DialogServiceConnector=void 0;var n=c5(),i=H(),l=K(),f=te(),c=F(),o=Kd(),s=function(a){t(u,a);function u(p,v){var g=this,h=p;f.Contracts.throwIfNull(p,"dialogConfig"),g=a.call(this,v,h.properties,new n.DialogConnectionFactory)||this,g.isTurnComplete=!0,g.privIsDisposed=!1,g.privProperties=h.properties.clone();var d=g.buildAgentConfig();return g.privReco.agentConfig.set(d),g}return u.prototype.connect=function(p,v){l.marshalPromiseToCallbacks(this.privReco.connect(),p,v)},u.prototype.disconnect=function(p,v){l.marshalPromiseToCallbacks(this.privReco.disconnect(),p,v)},Object.defineProperty(u.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)},set:function(p){f.Contracts.throwIfNullOrWhitespace(p,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"speechActivityTemplate",{get:function(){return this.properties.getProperty(o.PropertyId.Conversation_Speech_Activity_Template)},set:function(p){this.properties.setProperty(o.PropertyId.Conversation_Speech_Activity_Template,p)},enumerable:!1,configurable:!0}),u.prototype.listenOnceAsync=function(p,v){var g=this;if(this.isTurnComplete){f.Contracts.throwIfDisposed(this.privIsDisposed);var h=function(){return e(g,void 0,void 0,function(){var y,m;return r(this,function(S){switch(S.label){case 0:return[4,this.privReco.connect()];case 1:return S.sent(),[4,this.implRecognizerStop()];case 2:return S.sent(),this.isTurnComplete=!1,y=new l.Deferred,[4,this.privReco.recognize(i.RecognitionMode.Conversation,y.resolve,y.reject)];case 3:return S.sent(),[4,y.promise];case 4:return m=S.sent(),[4,this.implRecognizerStop()];case 5:return S.sent(),[2,m]}})})},d=h();d.catch(function(){g.dispose(!0).catch(function(){})}),l.marshalPromiseToCallbacks(d.finally(function(){g.isTurnComplete=!0}),p,v)}},u.prototype.sendActivityAsync=function(p,v,g){l.marshalPromiseToCallbacks(this.privReco.sendMessage(p),v,g)},u.prototype.close=function(p,v){f.Contracts.throwIfDisposed(this.privIsDisposed),l.marshalPromiseToCallbacks(this.dispose(!0),p,v)},u.prototype.dispose=function(p){return e(this,void 0,void 0,function(){return r(this,function(v){switch(v.label){case 0:return this.privIsDisposed?[2]:p?(this.privIsDisposed=!0,[4,this.implRecognizerStop()]):[3,3];case 1:return v.sent(),[4,a.prototype.dispose.call(this,p)];case 2:v.sent(),v.label=3;case 3:return[2]}})})},u.prototype.createRecognizerConfig=function(p){return new i.RecognizerConfig(p,this.privProperties)},u.prototype.createServiceRecognizer=function(p,v,g,h){var d=g;return new i.DialogServiceAdapter(p,v,d,h,this)},u.prototype.buildAgentConfig=function(){var p=this.properties.getProperty("Conversation_Communication_Type","Default");return{botInfo:{commType:p,commandsCulture:void 0,connectionId:this.properties.getProperty(o.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(o.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(o.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}},u}(c.Recognizer);return so.DialogServiceConnector=s,so}var po={},VC;function p5(){if(VC)return po;VC=1,Object.defineProperty(po,"__esModule",{value:!0}),po.ActivityReceivedEventArgs=void 0;var t=function(){function e(r,n){this.privActivity=r,this.privAudioStream=n}return Object.defineProperty(e.prototype,"activity",{get:function(){return this.privActivity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audioStream",{get:function(){return this.privAudioStream},enumerable:!1,configurable:!0}),e}();return po.ActivityReceivedEventArgs=t,po}var fo={},lo={},WC;function f5(){if(WC)return lo;WC=1,Object.defineProperty(lo,"__esModule",{value:!0}),lo.TurnStatusResponsePayload=void 0;var t=function(){function e(r){this.privMessageStatusResponse=JSON.parse(r)}return e.fromJSON=function(r){return new e(r)},Object.defineProperty(e.prototype,"interactionId",{get:function(){return this.privMessageStatusResponse.interactionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"conversationId",{get:function(){return this.privMessageStatusResponse.conversationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statusCode",{get:function(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}},enumerable:!1,configurable:!0}),e}();return lo.TurnStatusResponsePayload=t,lo}var HC;function l5(){if(HC)return fo;HC=1,Object.defineProperty(fo,"__esModule",{value:!0}),fo.TurnStatusReceivedEventArgs=void 0;var t=f5(),e=function(){function r(n){this.privTurnStatus=t.TurnStatusResponsePayload.fromJSON(n)}return Object.defineProperty(r.prototype,"interactionId",{get:function(){return this.privTurnStatus.interactionId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"conversationId",{get:function(){return this.privTurnStatus.conversationId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"statusCode",{get:function(){return this.privTurnStatus.statusCode},enumerable:!1,configurable:!0}),r}();return fo.TurnStatusReceivedEventArgs=e,fo}var Hl={},KC;function v5(){return KC||(KC=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ServicePropertyChannel=void 0,function(e){e[e.UriQueryParameter=0]="UriQueryParameter"}(t.ServicePropertyChannel||(t.ServicePropertyChannel={}))}(Hl)),Hl}var Kl={},GC;function h5(){return GC||(GC=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProfanityOption=void 0,function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(t.ProfanityOption||(t.ProfanityOption={}))}(Kl)),Kl}var vo={},JC;function d5(){if(JC)return vo;JC=1;var t=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},e=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(vo,"__esModule",{value:!0}),vo.BaseAudioPlayer=void 0;var r=Nt(),n=Ud(),i=F(),l=tn(),f=function(){function c(o){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,o===void 0&&(o=i.AudioStreamFormat.getDefaultInputFormat()),this.init(o)}return c.prototype.playAudioSample=function(o,s,a){var u=this;n.marshalPromiseToCallbacks(function(){return t(u,void 0,void 0,function(){var p,v;return e(this,function(g){return this.ensureInitializedContext(),p=this.formatAudioData(o),v=new Float32Array(this.samples.length+p.length),v.set(this.samples,0),v.set(p,this.samples.length),this.samples=v,[2]})})}(),s,a)},c.prototype.stopAudio=function(o,s){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(function(){o&&o()},function(a){s&&s(a)}),this.audioContext=null)},c.prototype.init=function(o){this.audioFormat=o,this.samples=new Float32Array},c.prototype.ensureInitializedContext=function(){var o=this;if(this.audioContext===null){this.createAudioContext();var s=200;this.autoUpdateBufferTimer=setInterval(function(){o.updateAudioBuffer()},s)}},c.prototype.createAudioContext=function(){this.audioContext=l.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime},c.prototype.formatAudioData=function(o){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(o),128);case 16:return this.formatArrayBuffer(new Int16Array(o),32768);case 32:return this.formatArrayBuffer(new Int32Array(o),2147483648);default:throw new r.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}},c.prototype.formatArrayBuffer=function(o,s){for(var a=new Float32Array(o.length),u=0;u<o.length;u++)a[u]=o[u]/s;return a},c.prototype.updateAudioBuffer=function(){if(this.samples.length!==0){for(var o=this.audioFormat.channels,s=this.audioContext.createBufferSource(),a=this.samples.length/o,u=this.audioContext.createBuffer(o,a,this.audioFormat.samplesPerSec),p=0;p<o;p++)for(var v=p,g=u.getChannelData(p),h=0;h<this.samples.length;h++,v+=o)g[h]=this.samples[v];this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),s.buffer=u,s.connect(this.gainNode),s.start(this.startTime),this.startTime+=u.duration,this.samples=new Float32Array}},c.prototype.playAudio=function(o){return t(this,void 0,void 0,function(){var s,a;return e(this,function(u){switch(u.label){case 0:return this.audioContext===null&&this.createAudioContext(),s=this.audioContext.createBufferSource(),a=this.audioContext.destination,[4,this.audioContext.decodeAudioData(o,function(p){s.buffer=p,s.connect(a),s.start(0)})];case 1:return u.sent(),[2]}})})},c}();return vo.BaseAudioPlayer=f,vo}var ho={},QC;function g5(){if(QC)return ho;QC=1,Object.defineProperty(ho,"__esModule",{value:!0}),ho.ConnectionMessageEventArgs=void 0;var t=function(){function e(r){this.privConnectionMessage=r}return Object.defineProperty(e.prototype,"message",{get:function(){return this.privConnectionMessage},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"Message: "+this.privConnectionMessage.toString()},e}();return ho.ConnectionMessageEventArgs=t,ho}var go={},YC;function y5(){if(YC)return go;YC=1,Object.defineProperty(go,"__esModule",{value:!0}),go.VoiceProfile=void 0;var t=function(){function e(r,n){this.privId=r,this.privProfileType=n}return Object.defineProperty(e.prototype,"profileId",{get:function(){return this.privId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"profileType",{get:function(){return this.privProfileType},enumerable:!1,configurable:!0}),e}();return go.VoiceProfile=t,go}var Ar={},XC;function m5(){if(XC)return Ar;XC=1;var t=w&&w.__extends||function(){var l=function(f,c){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)s.hasOwnProperty(a)&&(o[a]=s[a])},l(f,c)};return function(f,c){l(f,c);function o(){this.constructor=f}f.prototype=c===null?Object.create(c):(o.prototype=c.prototype,new o)}}();Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.VoiceProfileEnrollmentCancellationDetails=Ar.VoiceProfileEnrollmentResult=void 0;var e=H(),r=F(),n=function(){function l(f,c,o){this.privReason=f,this.privProperties=new r.PropertyCollection,this.privReason!==r.ResultReason.Canceled?c&&(this.privDetails=JSON.parse(c),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=r.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=o,this.privProperties.setProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.ServiceError]))}return l.FromIdentificationProfileList=function(f){for(var c=[],o=0,s=f.profiles;o<s.length;o++){var a=s[o],u=a.enrollmentStatus.toLowerCase()==="enrolling"?r.ResultReason.EnrollingVoiceProfile:a.enrollmentStatus.toLowerCase()==="enrolled"?r.ResultReason.EnrolledVoiceProfile:r.ResultReason.Canceled,p=new l(u,null,null);p.privDetails=this.getIdentificationDetails(a),c.push(p)}return c},l.FromVerificationProfileList=function(f){for(var c=[],o=0,s=f.profiles;o<s.length;o++){var a=s[o],u=a.enrollmentStatus.toLowerCase()==="enrolling"?r.ResultReason.EnrollingVoiceProfile:a.enrollmentStatus.toLowerCase()==="enrolled"?r.ResultReason.EnrolledVoiceProfile:r.ResultReason.Canceled,p=new l(u,null,null);p.privDetails=this.getVerificationDetails(a),c.push(p)}return c},Object.defineProperty(l.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"enrollmentsCount",{get:function(){return this.privDetails.enrollmentsCount},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"enrollmentsLength",{get:function(){return this.privDetails.enrollmentsLength},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"enrollmentResultDetails",{get:function(){return this.privDetails},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),l.getIdentificationDetails=function(f){return{audioSpeechLength:f.speechTime?parseFloat(f.speechTime):0,enrollmentStatus:f.enrollmentStatus,enrollmentsLength:f.enrollmentSpeechTime?parseFloat(f.enrollmentSpeechTime):0,profileId:f.profileId||f.identificationProfileId,remainingEnrollmentSpeechLength:f.remainingEnrollmentSpeechTime?parseFloat(f.remainingEnrollmentSpeechTime):0}},l.getVerificationDetails=function(f){return{enrollmentStatus:f.enrollmentStatus,enrollmentsCount:f.enrollmentsCount,profileId:f.profileId||f.verificationProfileId,remainingEnrollmentSpeechLength:f.remainingEnrollmentSpeechLength?parseFloat(f.remainingEnrollmentSpeechLength):0,remainingEnrollmentsCount:f.remainingEnrollments||f.remainingEnrollmentsCount}},l}();Ar.VoiceProfileEnrollmentResult=n;var i=function(l){t(f,l);function f(c,o,s){return l.call(this,c,o,s)||this}return f.fromResult=function(c){var o=r.CancellationReason.Error,s=r.CancellationErrorCode.NoError;return c.properties&&(s=r.CancellationErrorCode[c.properties.getProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new f(o,c.errorDetails,s)},f}(r.CancellationDetailsBase);return Ar.VoiceProfileEnrollmentCancellationDetails=i,Ar}var Ir={},ZC;function S5(){if(ZC)return Ir;ZC=1;var t=w&&w.__extends||function(){var f=function(c,o){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var u in a)a.hasOwnProperty(u)&&(s[u]=a[u])},f(c,o)};return function(c,o){f(c,o);function s(){this.constructor=c}c.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}}();Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.VoiceProfileCancellationDetails=Ir.VoiceProfileResult=void 0;var e=H(),r=te(),n=F(),i=function(){function f(c,o){this.privReason=c,this.privProperties=new n.PropertyCollection,c===n.ResultReason.Canceled&&(r.Contracts.throwIfNullOrUndefined(o,"statusText"),this.privErrorDetails=o,this.privProperties.setProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.ServiceError]))}return Object.defineProperty(f.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),f}();Ir.VoiceProfileResult=i;var l=function(f){t(c,f);function c(o,s,a){return f.call(this,o,s,a)||this}return c.fromResult=function(o){var s=n.CancellationReason.Error,a=n.CancellationErrorCode.NoError;return o.properties&&(a=n.CancellationErrorCode[o.properties.getProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.NoError])]),new c(s,o.errorDetails,a)},c}(n.CancellationDetailsBase);return Ir.VoiceProfileCancellationDetails=l,Ir}var yo={},eP;function b5(){if(eP)return yo;eP=1;var t=w&&w.__extends||function(){var i=function(l,f){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,o){c.__proto__=o}||function(c,o){for(var s in o)o.hasOwnProperty(s)&&(c[s]=o[s])},i(l,f)};return function(l,f){i(l,f);function c(){this.constructor=l}l.prototype=f===null?Object.create(f):(c.prototype=f.prototype,new c)}}();Object.defineProperty(yo,"__esModule",{value:!0}),yo.VoiceProfileAuthorizationPhraseResult=void 0;var e=te(),r=F(),n=function(i){t(l,i);function l(f,c,o){var s=i.call(this,f,c)||this;s.privPhrases=[],e.Contracts.throwIfNullOrUndefined(o,"phrases array");for(var a=0,u=o;a<u.length;a++){var p=u[a];s.privPhrases.push(p.passPhrase)}return s}return Object.defineProperty(l.prototype,"phrases",{get:function(){return this.privPhrases},enumerable:!1,configurable:!0}),l}(r.VoiceProfileResult);return yo.VoiceProfileAuthorizationPhraseResult=n,yo}var mo={},tP;function C5(){if(tP)return mo;tP=1;var t=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},e=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(mo,"__esModule",{value:!0}),mo.VoiceProfileClient=void 0;var r=H(),n=K(),i=te(),l=F(),f=function(){function c(o){var s=o;i.Contracts.throwIfNull(s,"speechConfig"),this.privProperties=s.properties.clone(),this.implClientSetup()}return Object.defineProperty(c.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(l.PropertyId.SpeechServiceAuthorization_Token)},set:function(o){i.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(l.PropertyId.SpeechServiceAuthorization_Token,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),c.prototype.createProfileAsync=function(o,s,a,u){var p=this;n.marshalPromiseToCallbacks(function(){return t(p,void 0,void 0,function(){var v,g,h;return e(this,function(d){switch(d.label){case 0:return[4,this.privAdapter.createProfile(o,s)];case 1:return v=d.sent(),g=v.json(),h=new l.VoiceProfile(g.profileId,o),[2,h]}})})}(),a,u)},c.prototype.retrieveEnrollmentResultAsync=function(o,s,a){var u=this;n.marshalPromiseToCallbacks(function(){return t(u,void 0,void 0,function(){var p;return e(this,function(v){switch(v.label){case 0:return[4,this.privAdapter.getProfileStatus(o)];case 1:return p=v.sent(),[2,new l.VoiceProfileEnrollmentResult(p.ok?l.ResultReason.EnrolledVoiceProfile:l.ResultReason.Canceled,p.data,p.statusText)]}})})}(),s,a)},c.prototype.getAllProfilesAsync=function(o,s,a){var u=this;n.marshalPromiseToCallbacks(function(){return t(u,void 0,void 0,function(){var p;return e(this,function(v){switch(v.label){case 0:return[4,this.privAdapter.getProfiles(o)];case 1:return p=v.sent(),o===l.VoiceProfileType.TextIndependentIdentification?[2,l.VoiceProfileEnrollmentResult.FromIdentificationProfileList(p.json())]:[2,l.VoiceProfileEnrollmentResult.FromVerificationProfileList(p.json())]}})})}(),s,a)},c.prototype.getAuthorizationPhrasesAsync=function(o,s,a){var u=this;n.marshalPromiseToCallbacks(function(){return t(u,void 0,void 0,function(){var p;return e(this,function(v){switch(v.label){case 0:return[4,this.privAdapter.getAuthorizationPhrases(o)];case 1:return p=v.sent(),[2,new l.VoiceProfileAuthorizationPhraseResult(p.ok?l.ResultReason.EnrollingVoiceProfile:l.ResultReason.Canceled,p.statusText,p.json())]}})})}(),s,a)},c.prototype.enrollProfileAsync=function(o,s,a,u){var p=this,v=s;i.Contracts.throwIfNullOrUndefined(v,"audioConfig"),n.marshalPromiseToCallbacks(function(){return t(p,void 0,void 0,function(){var g;return e(this,function(h){switch(h.label){case 0:return[4,this.privAdapter.createEnrollment(o,v)];case 1:return g=h.sent(),[2,new l.VoiceProfileEnrollmentResult(g.ok?l.ResultReason.EnrolledVoiceProfile:l.ResultReason.Canceled,g.data,g.statusText)]}})})}(),a,u)},c.prototype.deleteProfileAsync=function(o,s,a){var u=this;n.marshalPromiseToCallbacks(function(){return t(u,void 0,void 0,function(){var p;return e(this,function(v){switch(v.label){case 0:return[4,this.privAdapter.deleteProfile(o)];case 1:return p=v.sent(),[2,this.getResult(p,l.ResultReason.DeletedVoiceProfile)]}})})}(),s,a)},c.prototype.resetProfileAsync=function(o,s,a){var u=this;n.marshalPromiseToCallbacks(function(){return t(u,void 0,void 0,function(){var p;return e(this,function(v){switch(v.label){case 0:return[4,this.privAdapter.resetProfile(o)];case 1:return p=v.sent(),[2,this.getResult(p,l.ResultReason.ResetVoiceProfile)]}})})}(),s,a)},c.prototype.close=function(){},c.prototype.implClientSetup=function(){var o=typeof window<"u"?"Browser":"Node",s="unknown",a="unknown";typeof navigator<"u"&&(o=o+"/"+navigator.platform,s=navigator.userAgent,a=navigator.appVersion);var u=new r.SpeakerRecognitionConfig(new r.Context(new r.OS(o,s,a)),this.privProperties);this.privAdapter=new r.SpeakerIdMessageAdapter(u)},c.prototype.getResult=function(o,s,a){var u=new l.VoiceProfileResult(o.ok?s:l.ResultReason.Canceled,o.statusText);return u},c}();return mo.VoiceProfileClient=f,mo}var So={},rP;function P5(){if(rP)return So;rP=1;var t=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},e=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(So,"__esModule",{value:!0}),So.SpeakerRecognizer=void 0;var r=H(),n=K(),i=te(),l=F(),f=function(){function c(o,s){var a=o;i.Contracts.throwIfNull(a,"speechConfig"),this.privAudioConfigImpl=s,i.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privProperties=a.properties.clone(),this.implSRSetup()}return Object.defineProperty(c.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(l.PropertyId.SpeechServiceAuthorization_Token)},set:function(o){i.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(l.PropertyId.SpeechServiceAuthorization_Token,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),c.prototype.recognizeOnceAsync=function(o,s,a){if(o instanceof l.SpeakerIdentificationModel){var u=this.privAdapter.identifySpeaker(o,this.privAudioConfigImpl);n.marshalPromiseToCallbacks(this.getResult(u,l.SpeakerRecognitionResultType.Identify,void 0),s,a)}else if(o instanceof l.SpeakerVerificationModel){var u=this.privAdapter.verifySpeaker(o,this.privAudioConfigImpl);n.marshalPromiseToCallbacks(this.getResult(u,l.SpeakerRecognitionResultType.Verify,o.voiceProfile.profileId),s,a)}else throw new Error("SpeakerRecognizer.recognizeOnce: Unexpected model type")},c.prototype.close=function(){},c.prototype.implSRSetup=function(){var o=typeof window<"u"?"Browser":"Node",s="unknown",a="unknown";typeof navigator<"u"&&(o=o+"/"+navigator.platform,s=navigator.userAgent,a=navigator.appVersion);var u=new r.SpeakerRecognitionConfig(new r.Context(new r.OS(o,s,a)),this.privProperties);this.privAdapter=new r.SpeakerIdMessageAdapter(u)},c.prototype.getResult=function(o,s,a){return t(this,void 0,void 0,function(){var u;return e(this,function(p){switch(p.label){case 0:return[4,o];case 1:return u=p.sent(),[2,new l.SpeakerRecognitionResult(s,u.data,a,u.ok?l.ResultReason.RecognizedSpeaker:l.ResultReason.Canceled)]}})})},c}();return So.SpeakerRecognizer=f,So}var bo={},nP;function w5(){if(nP)return bo;nP=1,Object.defineProperty(bo,"__esModule",{value:!0}),bo.SpeakerIdentificationModel=void 0;var t=te(),e=F(),r=function(){function n(i){var l=this;if(this.privVoiceProfiles=[],t.Contracts.throwIfNullOrUndefined(i,"VoiceProfiles"),i.length===0)throw new Error("Empty Voice Profiles array");i.forEach(function(f){if(f.profileType!==e.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+f.profileId);l.privVoiceProfiles.push(f)})}return n.fromProfiles=function(i){return new n(i)},Object.defineProperty(n.prototype,"voiceProfileIds",{get:function(){return this.privVoiceProfiles.map(function(i){return i.profileId}).join(",")},enumerable:!1,configurable:!0}),n}();return bo.SpeakerIdentificationModel=r,bo}var Co={},iP;function R5(){if(iP)return Co;iP=1,Object.defineProperty(Co,"__esModule",{value:!0}),Co.SpeakerVerificationModel=void 0;var t=te(),e=F(),r=function(){function n(i){if(t.Contracts.throwIfNullOrUndefined(i,"VoiceProfile"),i.profileType===e.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=i}return n.fromProfile=function(i){return new n(i)},Object.defineProperty(n.prototype,"voiceProfile",{get:function(){return this.privVoiceProfile},enumerable:!1,configurable:!0}),n}();return Co.SpeakerVerificationModel=r,Co}var Po={},oP;function E5(){if(oP)return Po;oP=1,Object.defineProperty(Po,"__esModule",{value:!0}),Po.AutoDetectSourceLanguageConfig=void 0;var t=H(),e=te(),r=F(),n=function(){function i(){this.privProperties=new r.PropertyCollection}return i.fromOpenRange=function(){var l=new i;return l.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,t.AutoDetectSourceLanguagesOpenRangeOptionName),l},i.fromLanguages=function(l){e.Contracts.throwIfArrayEmptyOrWhitespace(l,"languages");var f=new i;return f.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,l.join()),f},i.fromSourceLanguageConfigs=function(l){if(l.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");var f=new i,c=[];return l.forEach(function(o){if(c.push(o.language),o.endpointId!==void 0&&o.endpointId!==""){var s=o.language+r.PropertyId.SpeechServiceConnection_EndpointId.toString();f.properties.setProperty(s,o.endpointId)}}),f.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,c.join()),f},Object.defineProperty(i.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),i}();return Po.AutoDetectSourceLanguageConfig=n,Po}var wo={},sP;function O5(){if(sP)return wo;sP=1,Object.defineProperty(wo,"__esModule",{value:!0}),wo.AutoDetectSourceLanguageResult=void 0;var t=te(),e=function(){function r(n,i){t.Contracts.throwIfNullOrUndefined(n,"language"),t.Contracts.throwIfNullOrUndefined(i,"languageDetectionConfidence"),this.privLanguage=n,this.privLanguageDetectionConfidence=i}return r.fromResult=function(n){return new r(n.language,n.languageDetectionConfidence)},Object.defineProperty(r.prototype,"language",{get:function(){return this.privLanguage},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"languageDetectionConfidence",{get:function(){return this.privLanguageDetectionConfidence},enumerable:!1,configurable:!0}),r}();return wo.AutoDetectSourceLanguageResult=e,wo}var Ro={},aP;function _5(){if(aP)return Ro;aP=1,Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.SourceLanguageConfig=void 0;var t=te(),e=function(){function r(n,i){t.Contracts.throwIfNullOrUndefined(n,"language"),this.privLanguage=n,this.privEndpointId=i}return r.fromLanguage=function(n,i){return new r(n,i)},Object.defineProperty(r.prototype,"language",{get:function(){return this.privLanguage},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"endpointId",{get:function(){return this.privEndpointId},enumerable:!1,configurable:!0}),r}();return Ro.SourceLanguageConfig=e,Ro}var Gl={},cP;function A5(){return cP||(cP=1,function(t){var e=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SpeakerRecognitionCancellationDetails=t.SpeakerRecognitionResult=t.SpeakerRecognitionResultType=void 0;var r=H(),n=te(),i=F(),l;(function(o){o[o.Verify=0]="Verify",o[o.Identify=1]="Identify"})(l=t.SpeakerRecognitionResultType||(t.SpeakerRecognitionResultType={}));var f=function(){function o(s,a,u,p){if(p===void 0&&(p=i.ResultReason.RecognizedSpeaker),this.privProperties=new i.PropertyCollection,this.privReason=p,this.privReason!==i.ResultReason.Canceled)if(s===l.Identify){var v=JSON.parse(a);n.Contracts.throwIfNullOrUndefined(v,"JSON"),this.privProfileId=v.identifiedProfile.profileId,this.privScore=v.identifiedProfile.score}else{var v=JSON.parse(a);n.Contracts.throwIfNullOrUndefined(v,"JSON"),this.privScore=v.score,v.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=i.ResultReason.NoMatch),u!==void 0&&u!==""&&(this.privProfileId=u)}else{var v=JSON.parse(a);n.Contracts.throwIfNullOrUndefined(v,"JSON"),this.privErrorDetails=v.statusText,this.privProperties.setProperty(r.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.ServiceError])}this.privProperties.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,a)}return Object.defineProperty(o.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"profileId",{get:function(){return this.privProfileId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"score",{get:function(){return this.privScore},enumerable:!1,configurable:!0}),o}();t.SpeakerRecognitionResult=f;var c=function(o){e(s,o);function s(a,u,p){return o.call(this,a,u,p)||this}return s.fromResult=function(a){var u=i.CancellationReason.Error,p=i.CancellationErrorCode.NoError;return a.properties&&(p=i.CancellationErrorCode[a.properties.getProperty(r.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.NoError])]),new s(u,a.errorDetails,p)},s}(i.CancellationDetailsBase);t.SpeakerRecognitionCancellationDetails=c}(Gl)),Gl}var Jl={},Tr={},uP;function kI(){if(uP)return Tr;uP=1;var t=w&&w.__extends||function(){var a=function(u,p){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var h in g)g.hasOwnProperty(h)&&(v[h]=g[h])},a(u,p)};return function(u,p){a(u,p);function v(){this.constructor=u}u.prototype=p===null?Object.create(p):(v.prototype=p.prototype,new v)}}(),e=w&&w.__awaiter||function(a,u,p,v){function g(h){return h instanceof p?h:new p(function(d){d(h)})}return new(p||(p=Promise))(function(h,d){function y(b){try{S(v.next(b))}catch(P){d(P)}}function m(b){try{S(v.throw(b))}catch(P){d(P)}}function S(b){b.done?h(b.value):g(b.value).then(y,m)}S((v=v.apply(a,u||[])).next())})},r=w&&w.__generator||function(a,u){var p={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},v,g,h,d;return d={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function y(S){return function(b){return m([S,b])}}function m(S){if(v)throw new TypeError("Generator is already executing.");for(;p;)try{if(v=1,g&&(h=S[0]&2?g.return:S[0]?g.throw||((h=g.return)&&h.call(g),0):g.next)&&!(h=h.call(g,S[1])).done)return h;switch(g=0,h&&(S=[S[0]&2,h.value]),S[0]){case 0:case 1:h=S;break;case 4:return p.label++,{value:S[1],done:!1};case 5:p.label++,g=S[1],S=[0];continue;case 7:S=p.ops.pop(),p.trys.pop();continue;default:if(h=p.trys,!(h=h.length>0&&h[h.length-1])&&(S[0]===6||S[0]===2)){p=0;continue}if(S[0]===3&&(!h||S[1]>h[0]&&S[1]<h[3])){p.label=S[1];break}if(S[0]===6&&p.label<h[1]){p.label=h[1],h=S;break}if(h&&p.label<h[2]){p.label=h[2],p.ops.push(S);break}h[2]&&p.ops.pop(),p.trys.pop();continue}S=u.call(a,p)}catch(b){S=[6,b],g=0}finally{v=h=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},n=w&&w.__spreadArrays||function(){for(var a=0,u=0,p=arguments.length;u<p;u++)a+=arguments[u].length;for(var v=Array(a),g=0,u=0;u<p;u++)for(var h=arguments[u],d=0,y=h.length;d<y;d++,g++)v[g]=h[d];return v};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.ConversationImpl=Tr.Conversation=void 0;var i=H(),l=K(),f=te(),c=F(),o=function(){function a(){}return a.createConversationAsync=function(u,p,v,g){var h=this;if(f.Contracts.throwIfNullOrUndefined(u,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),f.Contracts.throwIfNullOrUndefined(u.region,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!u.subscriptionKey&&!u.getProperty(c.PropertyId[c.PropertyId.SpeechServiceAuthorization_Token])&&f.Contracts.throwIfNullOrUndefined(u.subscriptionKey,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key")),typeof p=="string"){var d=new s(u,p);return l.marshalPromiseToCallbacks(function(){return e(h,void 0,void 0,function(){return r(this,function(S){return[2]})})}(),v,g),d}else{var d=new s(u),y=p,m=v;return d.createConversationAsync(function(){y&&y()},function(b){m&&m(b)}),d}},a}();Tr.Conversation=o;var s=function(a){t(u,a);function u(p,v){var g=a.call(this)||this;g.privIsDisposed=!1,g.privIsConnected=!1,g.privErrors=i.ConversationConnectionConfig.restErrors,g.privConversationId="",g.onConnected=function(S){g.privIsConnected=!0;try{g.privConversationTranslator.sessionStarted&&g.privConversationTranslator.sessionStarted(g.privConversationTranslator,S)}catch{}},g.onDisconnected=function(S){return e(g,void 0,void 0,function(){return r(this,function(b){switch(b.label){case 0:return[4,this.close(!1)];case 1:b.sent();try{this.privConversationTranslator.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,S)}catch{}return[2]}})})},g.onCanceled=function(S,b){return e(g,void 0,void 0,function(){return r(this,function(P){switch(P.label){case 0:return[4,this.close(!1)];case 1:P.sent();try{this.privConversationTranslator.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,b)}catch{}return[2]}})})},g.onParticipantUpdateCommandReceived=function(S,b){var P,C;try{var R=g.privParticipants.getParticipant(b.id);if(R!==void 0){switch(b.key){case i.ConversationTranslatorCommandTypes.changeNickname:R.displayName=b.value;break;case i.ConversationTranslatorCommandTypes.setUseTTS:R.useTts=b.value;break;case i.ConversationTranslatorCommandTypes.setProfanityFiltering:R.profanity=b.value;break;case i.ConversationTranslatorCommandTypes.setMute:R.isMuted=b.value;break;case i.ConversationTranslatorCommandTypes.setTranslateToLanguages:R.translateToLanguages=b.value;break}g.privParticipants.addOrUpdateParticipant(R),!((P=g.privConversationTranslator)===null||P===void 0)&&P.participantsChanged&&((C=g.privConversationTranslator)===null||C===void 0||C.participantsChanged(g.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.Updated,[g.toParticipant(R)],b.sessionId)))}}catch{}},g.onLockRoomCommandReceived=function(S,b){},g.onMuteAllCommandReceived=function(S,b){var P,C;try{g.privParticipants.participants.forEach(function(R){return R.isMuted=R.isHost?!1:b.isMuted}),!((P=g.privConversationTranslator)===null||P===void 0)&&P.participantsChanged&&((C=g.privConversationTranslator)===null||C===void 0||C.participantsChanged(g.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.Updated,g.toParticipants(!1),b.sessionId)))}catch{}},g.onParticipantJoinCommandReceived=function(S,b){var P,C;try{var R=g.privParticipants.addOrUpdateParticipant(b.participant);R!==void 0&&!((P=g.privConversationTranslator)===null||P===void 0)&&P.participantsChanged&&((C=g.privConversationTranslator)===null||C===void 0||C.participantsChanged(g.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.JoinedConversation,[g.toParticipant(R)],b.sessionId)))}catch{}},g.onParticipantLeaveCommandReceived=function(S,b){var P,C;try{var R=g.privParticipants.getParticipant(b.participant.id);R!==void 0&&(g.privParticipants.deleteParticipant(b.participant.id),!((P=g.privConversationTranslator)===null||P===void 0)&&P.participantsChanged&&((C=g.privConversationTranslator)===null||C===void 0||C.participantsChanged(g.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.LeftConversation,[g.toParticipant(R)],b.sessionId))))}catch{}},g.onTranslationReceived=function(S,b){var P,C,R,O,z,L;try{switch(b.command){case i.ConversationTranslatorMessageTypes.final:!((P=g.privConversationTranslator)===null||P===void 0)&&P.transcribed&&((C=g.privConversationTranslator)===null||C===void 0||C.transcribed(g.privConversationTranslator,new c.ConversationTranslationEventArgs(b.payload,void 0,b.sessionId)));break;case i.ConversationTranslatorMessageTypes.partial:!((R=g.privConversationTranslator)===null||R===void 0)&&R.transcribing&&((O=g.privConversationTranslator)===null||O===void 0||O.transcribing(g.privConversationTranslator,new c.ConversationTranslationEventArgs(b.payload,void 0,b.sessionId)));break;case i.ConversationTranslatorMessageTypes.instantMessage:!((z=g.privConversationTranslator)===null||z===void 0)&&z.textMessageReceived&&((L=g.privConversationTranslator)===null||L===void 0||L.textMessageReceived(g.privConversationTranslator,new c.ConversationTranslationEventArgs(b.payload,void 0,b.sessionId)));break}}catch{}},g.onParticipantsListReceived=function(S,b){var P,C,R;try{if(b.sessionToken!==void 0&&b.sessionToken!==null&&(g.privRoom.token=b.sessionToken),g.privParticipants.participants=n(b.participants),g.privParticipants.me!==void 0&&(g.privIsReady=!0),!((P=g.privConversationTranslator)===null||P===void 0)&&P.participantsChanged&&((C=g.privConversationTranslator)===null||C===void 0||C.participantsChanged(g.privConversationTranslator,new c.ConversationParticipantsChangedEventArgs(c.ParticipantChangedReason.JoinedConversation,g.toParticipants(!0),b.sessionId))),g.me.isHost){var O=(R=g.privConversationTranslator)===null||R===void 0?void 0:R.properties.getProperty(c.PropertyId.ConversationTranslator_Name);O!==void 0&&O.length>0&&O!==g.me.displayName&&g.changeNicknameAsync(O)}}catch{}},g.onConversationExpiration=function(S,b){var P,C;try{!((P=g.privConversationTranslator)===null||P===void 0)&&P.conversationExpiration&&((C=g.privConversationTranslator)===null||C===void 0||C.conversationExpiration(g.privConversationTranslator,b))}catch{}},g.privProperties=new c.PropertyCollection,g.privManager=new i.ConversationManager;var h=p.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage]);if(h||p.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage],i.ConversationConnectionConfig.defaultLanguageCode),g.privLanguage=p.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage]),v)g.privConversationId=v;else{p.targetLanguages.length===0&&p.addTargetLanguage(g.privLanguage);var d=p.getProperty(c.PropertyId[c.PropertyId.SpeechServiceResponse_ProfanityOption]);d||p.setProfanity(c.ProfanityOption.Masked);var y=p.getProperty(c.PropertyId[c.PropertyId.ConversationTranslator_Name]);(y==null||y.length<=1||y.length>50)&&(y="Host"),p.setProperty(c.PropertyId[c.PropertyId.ConversationTranslator_Name],y)}g.privConfig=p;var m=p;return f.Contracts.throwIfNull(m,"speechConfig"),g.privProperties=m.properties.clone(),g.privIsConnected=!1,g.privParticipants=new i.InternalParticipants,g.privIsReady=!1,g.privTextMessageMaxLength=1e3,g}return Object.defineProperty(u.prototype,"conversationTranslator",{set:function(p){this.privConversationTranslator=p},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"room",{get:function(){return this.privRoom},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"connection",{get:function(){return this.privConversationRecognizer},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"authorizationToken",{get:function(){return this.privToken},set:function(p){f.Contracts.throwIfNullOrWhitespace(p,"authorizationToken"),this.privToken=p},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"config",{get:function(){return this.privConfig},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"conversationId",{get:function(){return this.privRoom?this.privRoom.roomId:this.privConversationId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"speechRecognitionLanguage",{get:function(){return this.privLanguage},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isMutedByHost",{get:function(){var p,v;return!((p=this.privParticipants.me)===null||p===void 0)&&p.isHost?!1:(v=this.privParticipants.me)===null||v===void 0?void 0:v.isMuted},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isConnected",{get:function(){return this.privIsConnected&&this.privIsReady},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"participants",{get:function(){return this.toParticipants(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"me",{get:function(){return this.toParticipant(this.privParticipants.me)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"host",{get:function(){return this.toParticipant(this.privParticipants.host)},enumerable:!1,configurable:!0}),u.prototype.createConversationAsync=function(p,v){var g=this;try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),v),this.privManager.createOrJoin(this.privProperties,void 0,function(h){h||g.handleError(new Error(g.privErrors.permissionDeniedConnect),v),g.privRoom=h,g.handleCallback(p,v)},function(h){g.handleError(h,v)})}catch(h){this.handleError(h,v)}},u.prototype.startConversationAsync=function(p,v){var g=this;try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),v),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=i.ConversationRecognizerFactory.fromConfig(this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,function(){g.handleCallback(p,v)},function(h){g.handleError(h,v)})}catch(h){this.handleError(h,v)}},u.prototype.addParticipantAsync=function(p,v,g){f.Contracts.throwIfNullOrUndefined(p,"Participant"),l.marshalPromiseToCallbacks(this.addParticipantImplAsync(p),v,g)},u.prototype.joinConversationAsync=function(p,v,g,h,d){var y=this;try{f.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","conversationId")),f.Contracts.throwIfNullOrWhitespace(v,this.privErrors.invalidArgs.replace("{arg}","nickname")),f.Contracts.throwIfNullOrWhitespace(g,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,p,function(m){f.Contracts.throwIfNullOrUndefined(m,y.privErrors.permissionDeniedConnect),y.privRoom=m,y.privConfig.authorizationToken=m.cognitiveSpeechAuthToken,h&&h(m.cognitiveSpeechAuthToken)},function(m){y.handleError(m,d)})}catch(m){this.handleError(m,d)}},u.prototype.deleteConversationAsync=function(p,v){l.marshalPromiseToCallbacks(this.deleteConversationImplAsync(),p,v)},u.prototype.deleteConversationImplAsync=function(){return e(this,void 0,void 0,function(){return r(this,function(p){switch(p.label){case 0:return f.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),f.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),[4,this.privManager.leave(this.privProperties,this.privRoom.token)];case 1:return p.sent(),this.dispose(),[2]}})})},u.prototype.endConversationAsync=function(p,v){l.marshalPromiseToCallbacks(this.endConversationImplAsync(),p,v)},u.prototype.endConversationImplAsync=function(){return this.close(!0)},u.prototype.lockConversationAsync=function(p,v){var g=this,h;try{f.Contracts.throwIfDisposed(this.privIsDisposed),f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),v),(h=this.privConversationRecognizer)===null||h===void 0||h.sendRequest(this.getLockCommand(!0),function(){g.handleCallback(p,v)},function(d){g.handleError(d,v)})}catch(d){this.handleError(d,v)}},u.prototype.muteAllParticipantsAsync=function(p,v){var g=this,h;try{f.Contracts.throwIfDisposed(this.privIsDisposed),f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),v),(h=this.privConversationRecognizer)===null||h===void 0||h.sendRequest(this.getMuteAllCommand(!0),function(){g.handleCallback(p,v)},function(d){g.handleError(d,v)})}catch(d){this.handleError(d,v)}},u.prototype.muteParticipantAsync=function(p,v,g){var h=this,d;try{f.Contracts.throwIfDisposed(this.privIsDisposed),f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),g),!this.me.isHost&&this.me.id!==p&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),g);var y=this.privParticipants.getParticipantIndex(p);y===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),g),(d=this.privConversationRecognizer)===null||d===void 0||d.sendRequest(this.getMuteCommand(p,!0),function(){h.handleCallback(v,g)},function(m){h.handleError(m,g)})}catch(m){this.handleError(m,g)}},u.prototype.removeParticipantAsync=function(p,v,g){var h=this,d;try{if(f.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&p.hasOwnProperty("id"))l.marshalPromiseToCallbacks(this.removeParticipantImplAsync(p),v,g);else{f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),g);var y="";if(typeof p=="string")y=p;else if(p.hasOwnProperty("id")){var m=p;y=m.id}else if(p.hasOwnProperty("userId")){var S=p;y=S.userId}f.Contracts.throwIfNullOrWhitespace(y,this.privErrors.invalidArgs.replace("{arg}","userId"));var b=this.participants.findIndex(function(P){return P.id===y});b===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),g),(d=this.privConversationRecognizer)===null||d===void 0||d.sendRequest(this.getEjectCommand(y),function(){h.handleCallback(v,g)},function(P){h.handleError(P,g)})}}catch(P){this.handleError(P,g)}},u.prototype.unlockConversationAsync=function(p,v){var g=this,h;try{f.Contracts.throwIfDisposed(this.privIsDisposed),f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),v),(h=this.privConversationRecognizer)===null||h===void 0||h.sendRequest(this.getLockCommand(!1),function(){g.handleCallback(p,v)},function(d){g.handleError(d,v)})}catch(d){this.handleError(d,v)}},u.prototype.unmuteAllParticipantsAsync=function(p,v){var g=this,h;try{f.Contracts.throwIfDisposed(this.privIsDisposed),f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),v),(h=this.privConversationRecognizer)===null||h===void 0||h.sendRequest(this.getMuteAllCommand(!1),function(){g.handleCallback(p,v)},function(d){g.handleError(d,v)})}catch(d){this.handleError(d,v)}},u.prototype.unmuteParticipantAsync=function(p,v,g){var h=this,d;try{f.Contracts.throwIfDisposed(this.privIsDisposed),f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),g),!this.me.isHost&&this.me.id!==p&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),g);var y=this.privParticipants.getParticipantIndex(p);y===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),g),(d=this.privConversationRecognizer)===null||d===void 0||d.sendRequest(this.getMuteCommand(p,!1),function(){h.handleCallback(v,g)},function(m){h.handleError(m,g)})}catch(m){this.handleError(m,g)}},u.prototype.sendTextMessageAsync=function(p,v,g){var h=this,d;try{f.Contracts.throwIfDisposed(this.privIsDisposed),f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","message")),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),g),p.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),g),(d=this.privConversationRecognizer)===null||d===void 0||d.sendRequest(this.getMessageCommand(p),function(){h.handleCallback(v,g)},function(y){h.handleError(y,g)})}catch(y){this.handleError(y,g)}},u.prototype.changeNicknameAsync=function(p,v,g){var h=this,d;try{f.Contracts.throwIfDisposed(this.privIsDisposed),f.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),f.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","nickname")),f.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),g),(d=this.privConversationRecognizer)===null||d===void 0||d.sendRequest(this.getChangeNicknameCommand(p),function(){h.handleCallback(v,g)},function(y){h.handleError(y,g)})}catch(y){this.handleError(y,g)}},u.prototype.isDisposed=function(){return this.privIsDisposed},u.prototype.dispose=function(p){var v;this.isDisposed||(this.privIsDisposed=!0,(v=this.config)===null||v===void 0||v.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privConversationRecognizer=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)},Object.defineProperty(u.prototype,"transcriberRecognizer",{get:function(){return this.privTranscriberRecognizer},enumerable:!1,configurable:!0}),u.prototype.connectTranscriberRecognizer=function(p){return e(this,void 0,void 0,function(){return r(this,function(v){switch(v.label){case 0:return this.privTranscriberRecognizer?[4,this.privTranscriberRecognizer.close()]:[3,2];case 1:v.sent(),v.label=2;case 2:return this.privTranscriberRecognizer=p,this.privTranscriberRecognizer.conversation=this,[2]}})})},Object.defineProperty(u.prototype,"conversationInfo",{get:function(){for(var p=this.conversationId,v=this.participants.map(function(b){return{id:b.id,preferredLanguage:b.preferredLanguage,voice:b.voice}}),g={},h=0,d=i.ConversationConnectionConfig.transcriptionEventKeys;h<d.length;h++){var y=d[h],m=this.properties.getProperty(y,"");m!==""&&(g[y]=m)}var S={id:p,participants:v,conversationProperties:g};return S},enumerable:!1,configurable:!0}),u.prototype.addParticipantImplAsync=function(p){var v=this.privParticipants.addOrUpdateParticipant(p);if(v!==void 0&&this.privTranscriberRecognizer){var g=this.conversationInfo;return g.participants=[p],this.privTranscriberRecognizer.pushConversationEvent(g,"join")}},u.prototype.removeParticipantImplAsync=function(p){this.privParticipants.deleteParticipant(p.id);var v=this.conversationInfo;return v.participants=[p],this.privTranscriberRecognizer.pushConversationEvent(v,"leave")},u.prototype.close=function(p){var v,g;return e(this,void 0,void 0,function(){return r(this,function(h){switch(h.label){case 0:return h.trys.push([0,3,,4]),this.privIsConnected=!1,[4,this.privConversationRecognizer.close()];case 1:return h.sent(),[4,(v=this.privTranscriberRecognizer)===null||v===void 0?void 0:v.close()];case 2:return h.sent(),this.privConversationRecognizer=void 0,(g=this.privConversationTranslator)===null||g===void 0||g.dispose(),[3,4];case 3:return h.sent(),[3,4];case 4:return p&&this.dispose(),[2]}})})},Object.defineProperty(u.prototype,"canSend",{get:function(){var p;return this.privIsConnected&&!(!((p=this.privParticipants.me)===null||p===void 0)&&p.isMuted)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canSendAsHost",{get:function(){var p;return this.privIsConnected&&((p=this.privParticipants.me)===null||p===void 0?void 0:p.isHost)},enumerable:!1,configurable:!0}),u.prototype.handleCallback=function(p,v){if(p){try{p()}catch(g){v&&v(g)}p=void 0}},u.prototype.handleError=function(p,v){if(v)if(p instanceof Error){var g=p;v(g.name+": "+g.message)}else v(p)},u.prototype.toParticipants=function(p){var v=this,g=this.privParticipants.participants.map(function(h){return v.toParticipant(h)});return p?g:g.filter(function(h){return h.isHost===!1})},u.prototype.toParticipant=function(p){return new c.Participant(p.id,p.avatar,p.displayName,p.isHost,p.isMuted,p.isUsingTts,p.preferredLanguage,p.voice)},u.prototype.getMuteAllCommand=function(p){return f.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:p})},u.prototype.getMuteCommand=function(p,v){return f.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.Contracts.throwIfNullOrWhitespace(p,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setMute,participantId:p,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:v})},u.prototype.getLockCommand=function(p){return f.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:p})},u.prototype.getEjectCommand=function(p){return f.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.Contracts.throwIfNullOrWhitespace(p,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.ejectParticipant,participantId:p,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand})},u.prototype.getChangeNicknameCommand=function(p){return f.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.Contracts.throwIfNullOrWhitespace(p,"nickname"),f.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.changeNickname,nickname:p,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:p})},u.prototype.getMessageCommand=function(p){return f.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),f.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),f.Contracts.throwIfNullOrWhitespace(p,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:p,type:i.ConversationTranslatorMessageTypes.instantMessage})},u}(o);return Tr.ConversationImpl=s,Tr}var Eo={},pP;function I5(){if(pP)return Eo;pP=1,Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.ConversationCommon=void 0;var t=function(){function e(r){this.privAudioConfig=r}return e.prototype.handleCallback=function(r,n){if(r){try{r()}catch(i){n&&n(i)}r=void 0}},e.prototype.handleError=function(r,n){if(n)if(r instanceof Error){var i=r;n(i.name+": "+i.message)}else n(r)},e}();return Eo.ConversationCommon=t,Eo}var Oo={},fP;function T5(){if(fP)return Oo;fP=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.ConversationExpirationEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f){var c=n.call(this,f)||this;return c.privExpirationTime=l,c}return Object.defineProperty(i.prototype,"expirationTime",{get:function(){return this.privExpirationTime},enumerable:!1,configurable:!0}),i}(e.SessionEventArgs);return Oo.ConversationExpirationEventArgs=r,Oo}var _o={},lP;function M5(){if(lP)return _o;lP=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(_o,"__esModule",{value:!0}),_o.ConversationParticipantsChangedEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c){var o=n.call(this,c)||this;return o.privReason=l,o.privParticipant=f,o}return Object.defineProperty(i.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"participants",{get:function(){return this.privParticipant},enumerable:!1,configurable:!0}),i}(e.SessionEventArgs);return _o.ConversationParticipantsChangedEventArgs=r,_o}var Ao={},vP;function D5(){if(vP)return Ao;vP=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Ao,"__esModule",{value:!0}),Ao.ConversationTranslationCanceledEventArgs=void 0;var e=Hd(),r=function(n){t(i,n);function i(){return n!==null&&n.apply(this,arguments)||this}return i}(e.CancellationEventArgsBase);return Ao.ConversationTranslationCanceledEventArgs=r,Ao}var Io={},hP;function $5(){if(hP)return Io;hP=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Io,"__esModule",{value:!0}),Io.ConversationTranslationEventArgs=void 0;var e=F(),r=function(n){t(i,n);function i(l,f,c){var o=n.call(this,f,c)||this;return o.privResult=l,o}return Object.defineProperty(i.prototype,"result",{get:function(){return this.privResult},enumerable:!1,configurable:!0}),i}(e.RecognitionEventArgs);return Io.ConversationTranslationEventArgs=r,Io}var To={},dP;function k5(){if(dP)return To;dP=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(To,"__esModule",{value:!0}),To.ConversationTranslationResult=void 0;var e=TI(),r=function(n){t(i,n);function i(l,f,c,o,s,a,u,p,v,g,h){var d=n.call(this,f,o,s,a,u,p,v,g,h)||this;return d.privId=l,d.privOrigLang=c,d}return Object.defineProperty(i.prototype,"participantId",{get:function(){return this.privId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"originalLang",{get:function(){return this.privOrigLang},enumerable:!1,configurable:!0}),i}(e.TranslationRecognitionResult);return To.ConversationTranslationResult=r,To}var Ql={},gP;function x5(){return gP||(gP=1,function(t){var e=w&&w.__extends||function(){var v=function(g,h){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,y){d.__proto__=y}||function(d,y){for(var m in y)y.hasOwnProperty(m)&&(d[m]=y[m])},v(g,h)};return function(g,h){v(g,h);function d(){this.constructor=g}g.prototype=h===null?Object.create(h):(d.prototype=h.prototype,new d)}}(),r=w&&w.__awaiter||function(v,g,h,d){function y(m){return m instanceof h?m:new h(function(S){S(m)})}return new(h||(h=Promise))(function(m,S){function b(R){try{C(d.next(R))}catch(O){S(O)}}function P(R){try{C(d.throw(R))}catch(O){S(O)}}function C(R){R.done?m(R.value):y(R.value).then(b,P)}C((d=d.apply(v,g||[])).next())})},n=w&&w.__generator||function(v,g){var h={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},d,y,m,S;return S={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function b(C){return function(R){return P([C,R])}}function P(C){if(d)throw new TypeError("Generator is already executing.");for(;h;)try{if(d=1,y&&(m=C[0]&2?y.return:C[0]?y.throw||((m=y.return)&&m.call(y),0):y.next)&&!(m=m.call(y,C[1])).done)return m;switch(y=0,m&&(C=[C[0]&2,m.value]),C[0]){case 0:case 1:m=C;break;case 4:return h.label++,{value:C[1],done:!1};case 5:h.label++,y=C[1],C=[0];continue;case 7:C=h.ops.pop(),h.trys.pop();continue;default:if(m=h.trys,!(m=m.length>0&&m[m.length-1])&&(C[0]===6||C[0]===2)){h=0;continue}if(C[0]===3&&(!m||C[1]>m[0]&&C[1]<m[3])){h.label=C[1];break}if(C[0]===6&&h.label<m[1]){h.label=m[1],m=C;break}if(m&&h.label<m[2]){h.label=m[2],h.ops.push(C);break}m[2]&&h.ops.pop(),h.trys.pop();continue}C=g.call(v,h)}catch(R){C=[6,R],y=0}finally{d=m=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConversationTranslator=t.SpeechState=void 0;var i=H(),l=K(),f=te(),c=F(),o=kI(),s=xI(),a;(function(v){v[v.Inactive=0]="Inactive",v[v.Connecting=1]="Connecting",v[v.Connected=2]="Connected"})(a=t.SpeechState||(t.SpeechState={}));var u=function(v){e(g,v);function g(h,d,y){var m=v.call(this,h,d)||this;return m.privSpeechState=a.Inactive,y&&(m.privTranslator=y,m.sessionStarted=function(){m.privSpeechState=a.Connected},m.sessionStopped=function(){m.privSpeechState=a.Inactive},m.recognized=function(S,b){return r(m,void 0,void 0,function(){var P;return n(this,function(C){switch(C.label){case 0:return!((P=b.result)===null||P===void 0)&&P.errorDetails?[4,this.cancelSpeech()]:[3,2];case 1:C.sent(),this.fireCancelEvent(b.result.errorDetails),C.label=2;case 2:return[2]}})})},m.canceled=function(S,b){return r(m,void 0,void 0,function(){return n(this,function(P){switch(P.label){case 0:if(this.privSpeechState===a.Inactive)return[3,4];P.label=1;case 1:return P.trys.push([1,3,,4]),[4,this.cancelSpeech()];case 2:return P.sent(),[3,4];case 3:return P.sent(),this.privSpeechState=a.Inactive,[3,4];case 4:return[2]}})})}),m}return Object.defineProperty(g.prototype,"state",{get:function(){return this.privSpeechState},set:function(h){this.privSpeechState=h},enumerable:!1,configurable:!0}),g.prototype.onConnection=function(){this.privSpeechState=a.Connected},g.prototype.onDisconnection=function(){return r(this,void 0,void 0,function(){return n(this,function(h){switch(h.label){case 0:return this.privSpeechState=a.Inactive,[4,this.cancelSpeech()];case 1:return h.sent(),[2]}})})},g.prototype.fireCancelEvent=function(h){var d,y,m;try{if(this.privTranslator.canceled){var S=new s.ConversationTranslationCanceledEventArgs((d=h==null?void 0:h.reason)!==null&&d!==void 0?d:c.CancellationReason.Error,(y=h==null?void 0:h.errorDetails)!==null&&y!==void 0?y:h,(m=h==null?void 0:h.errorCode)!==null&&m!==void 0?m:c.CancellationErrorCode.RuntimeError,void 0,h==null?void 0:h.sessionId);this.privTranslator.canceled(this.privTranslator,S)}}catch{}},g.prototype.cancelSpeech=function(){var h;return r(this,void 0,void 0,function(){return n(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),this.stopContinuousRecognitionAsync(),[4,(h=this.privReco)===null||h===void 0?void 0:h.disconnect()];case 1:return d.sent(),this.privSpeechState=a.Inactive,[3,3];case 2:return d.sent(),[3,3];case 3:return[2]}})})},g}(c.TranslationRecognizer),p=function(v){e(g,v);function g(h){var d=v.call(this,h)||this;return d.privIsDisposed=!1,d.privIsSpeaking=!1,d.privErrors=i.ConversationConnectionConfig.restErrors,d.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",d.privPlaceholderRegion="westus",d.privProperties=new c.PropertyCollection,d}return Object.defineProperty(g.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"speechRecognitionLanguage",{get:function(){return this.privSpeechRecognitionLanguage},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"participants",{get:function(){var h;return(h=this.privConversation)===null||h===void 0?void 0:h.participants},enumerable:!1,configurable:!0}),g.prototype.joinConversationAsync=function(h,d,y,m,S){var b=this;try{if(typeof h=="string"){f.Contracts.throwIfNullOrUndefined(h,this.privErrors.invalidArgs.replace("{arg}","conversation id")),f.Contracts.throwIfNullOrWhitespace(d,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),S);var P=y;(P==null||P==="")&&(P=i.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=c.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(c.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(P),this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage],P),this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.ConversationTranslator_Name],d);var C=this.privProperties.getProperty(c.PropertyId.ConversationTranslator_Host);C&&this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.ConversationTranslator_Host],C);var R=this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_Host);R&&this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Host],R),this.privConversation=new o.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(h,d,P,function(O){O||b.handleError(new Error(b.privErrors.permissionDeniedConnect),S),b.privSpeechTranslationConfig.authorizationToken=O,b.privConversation.startConversationAsync(function(){b.handleCallback(m,S)},function(z){b.handleError(z,S)})},function(O){b.handleError(O,S)})}else typeof h=="object"?(f.Contracts.throwIfNullOrUndefined(h,this.privErrors.invalidArgs.replace("{arg}","conversation id")),f.Contracts.throwIfNullOrWhitespace(d,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(c.PropertyId.ConversationTranslator_Name,d),this.privConversation=h,this.privConversation.conversationTranslator=this,f.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),f.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=h.config,this.handleCallback(y,m)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),m)}catch(O){this.handleError(O,typeof y=="string"?S:m)}},g.prototype.leaveConversationAsync=function(h,d){var y=this;l.marshalPromiseToCallbacks(function(){return r(y,void 0,void 0,function(){return n(this,function(m){switch(m.label){case 0:return[4,this.cancelSpeech()];case 1:return m.sent(),[4,this.privConversation.endConversationImplAsync()];case 2:return m.sent(),[4,this.privConversation.deleteConversationImplAsync()];case 3:return m.sent(),this.dispose(),[2]}})})}(),h,d)},g.prototype.sendTextMessageAsync=function(h,d,y){var m;try{f.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),f.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}",h)),(m=this.privConversation)===null||m===void 0||m.sendTextMessageAsync(h,d,y)}catch(S){this.handleError(S,y)}},g.prototype.startTranscribingAsync=function(h,d){var y=this;l.marshalPromiseToCallbacks(function(){return r(y,void 0,void 0,function(){var m;return n(this,function(S){switch(S.label){case 0:return S.trys.push([0,4,,6]),f.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),f.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer!==void 0?[3,2]:[4,this.connectTranslatorRecognizer()];case 1:S.sent(),S.label=2;case 2:return f.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),d),[4,this.startContinuousRecognition()];case 3:return S.sent(),this.privIsSpeaking=!0,[3,6];case 4:return m=S.sent(),this.privIsSpeaking=!1,[4,this.cancelSpeech()];case 5:throw S.sent(),m;case 6:return[2]}})})}(),h,d)},g.prototype.stopTranscribingAsync=function(h,d){var y=this;l.marshalPromiseToCallbacks(function(){return r(y,void 0,void 0,function(){var m=this;return n(this,function(S){switch(S.label){case 0:return S.trys.push([0,4,,6]),this.privIsSpeaking?[3,2]:[4,this.cancelSpeech()];case 1:return S.sent(),[2];case 2:return this.privIsSpeaking=!1,[4,new Promise(function(b,P){var C;(C=m.privCTRecognizer)===null||C===void 0||C.stopContinuousRecognitionAsync(b,P)})];case 3:return S.sent(),[3,6];case 4:return S.sent(),[4,this.cancelSpeech()];case 5:return S.sent(),[3,6];case 6:return[2]}})})}(),h,d)},g.prototype.isDisposed=function(){return this.privIsDisposed},g.prototype.dispose=function(h,d,y){var m=this;l.marshalPromiseToCallbacks(function(){return r(m,void 0,void 0,function(){var S,b;return n(this,function(P){switch(P.label){case 0:return this.isDisposed&&!this.privIsSpeaking?[2]:[4,this.cancelSpeech()];case 1:return P.sent(),this.privIsDisposed=!0,(S=this.privSpeechTranslationConfig)===null||S===void 0||S.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,(b=this.privConversation)===null||b===void 0||b.dispose(),this.privConversation=void 0,[2]}})})}(),d,y)},g.prototype.cancelSpeech=function(){var h;return r(this,void 0,void 0,function(){return n(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),this.privIsSpeaking=!1,[4,(h=this.privCTRecognizer)===null||h===void 0?void 0:h.onDisconnection()];case 1:return d.sent(),this.privCTRecognizer=void 0,[3,3];case 2:return d.sent(),[3,3];case 3:return[2]}})})},g.prototype.connectTranslatorRecognizer=function(){return r(this,void 0,void 0,function(){var h,d,y,m;return n(this,function(S){switch(S.label){case 0:return S.trys.push([0,1,,3]),this.privAudioConfig===void 0&&(this.privAudioConfig=c.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Key],""),h=encodeURIComponent(this.privConversation.room.token),d=this.privSpeechTranslationConfig.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Host],i.ConversationConnectionConfig.speechHost),d=d.replace("{region}",this.privConversation.room.cognitiveSpeechRegion),y="wss://"+d+i.ConversationConnectionConfig.speechPath+"?"+i.ConversationConnectionConfig.configParams.token+"="+h,this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Endpoint],y),this.privCTRecognizer=new u(this.privSpeechTranslationConfig,this.privAudioConfig,this),[3,3];case 1:return m=S.sent(),[4,this.cancelSpeech()];case 2:throw S.sent(),m;case 3:return[2]}})})},g.prototype.startContinuousRecognition=function(){var h=this;return new Promise(function(d,y){h.privCTRecognizer.startContinuousRecognitionAsync(d,y)})},Object.defineProperty(g.prototype,"canSpeak",{get:function(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===a.Connected||this.privCTRecognizer.state===a.Connecting||this.privConversation.isMutedByHost)},enumerable:!1,configurable:!0}),g}(s.ConversationCommon);t.ConversationTranslator=p}(Ql)),Ql}var Mo={},yP;function j5(){if(yP)return Mo;yP=1;var t=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},e=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.ConversationTranscriber=void 0;var r=H(),n=K(),i=te(),l=F(),f=function(){function c(o){this.privAudioConfig=o,this.privProperties=new l.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}return c.prototype.joinConversationAsync=function(o,s,a){var u=o;i.Contracts.throwIfNullOrUndefined(u,"Conversation"),this.privRecognizer=new r.TranscriberRecognizer(o.config,this.privAudioConfig),i.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectCallbacks(this),n.marshalPromiseToCallbacks(u.connectTranscriberRecognizer(this.privRecognizer),s,a)},Object.defineProperty(c.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(l.PropertyId.SpeechServiceAuthorization_Token)},set:function(o){i.Contracts.throwIfNullOrWhitespace(o,"token"),this.properties.setProperty(l.PropertyId.SpeechServiceAuthorization_Token,o)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"speechRecognitionLanguage",{get:function(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(l.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),c.prototype.startTranscribingAsync=function(o,s){this.privRecognizer.startContinuousRecognitionAsync(o,s)},c.prototype.stopTranscribingAsync=function(o,s){this.privRecognizer.stopContinuousRecognitionAsync(o,s)},c.prototype.leaveConversationAsync=function(o,s){var a=this;this.privRecognizer.disconnectCallbacks(),n.marshalPromiseToCallbacks(function(){return t(a,void 0,void 0,function(){return e(this,function(u){return[2]})})}(),o,s)},c.prototype.close=function(o,s){i.Contracts.throwIfDisposed(this.privDisposedRecognizer),n.marshalPromiseToCallbacks(this.dispose(!0),o,s)},c.prototype.dispose=function(o){return t(this,void 0,void 0,function(){return e(this,function(s){return this.privDisposedRecognizer?[2]:(o&&(this.privDisposedRecognizer=!0),[2])})})},c}();return Mo.ConversationTranscriber=f,Mo}var Mr={},mP;function z5(){if(mP)return Mr;mP=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.Participant=Mr.User=void 0;var t=F(),e=function(){function n(i){this.privUserId=i}return Object.defineProperty(n.prototype,"userId",{get:function(){return this.privUserId},enumerable:!1,configurable:!0}),n}();Mr.User=e;var r=function(){function n(i,l,f,c,o,s,a,u){this.privId=i,this.privAvatar=l,this.privDisplayName=f,this.privIsHost=c,this.privIsMuted=o,this.privIsUsingTts=s,this.privPreferredLanguage=a,this.privVoice=u,this.privProperties=new t.PropertyCollection}return n.From=function(i,l,f){return new n(i,"",i,!1,!1,!1,l,f)},Object.defineProperty(n.prototype,"avatar",{get:function(){return this.privAvatar},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"displayName",{get:function(){return this.privDisplayName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.privId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"preferredLanguage",{get:function(){return this.privPreferredLanguage},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isHost",{get:function(){return this.privIsHost},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isMuted",{get:function(){return this.privIsMuted},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isUsingTts",{get:function(){return this.privIsUsingTts},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"voice",{get:function(){return this.privVoice},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),n}();return Mr.Participant=r,Mr}var Yl={},SP;function N5(){return SP||(SP=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ParticipantChangedReason=void 0,function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"}(t.ParticipantChangedReason||(t.ParticipantChangedReason={}))}(Yl)),Yl}var bP;function xI(){return bP||(bP=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=kI();Object.defineProperty(t,"Conversation",{enumerable:!0,get:function(){return e.Conversation}}),Object.defineProperty(t,"ConversationImpl",{enumerable:!0,get:function(){return e.ConversationImpl}});var r=I5();Object.defineProperty(t,"ConversationCommon",{enumerable:!0,get:function(){return r.ConversationCommon}});var n=T5();Object.defineProperty(t,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return n.ConversationExpirationEventArgs}});var i=M5();Object.defineProperty(t,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return i.ConversationParticipantsChangedEventArgs}});var l=D5();Object.defineProperty(t,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return l.ConversationTranslationCanceledEventArgs}});var f=$5();Object.defineProperty(t,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return f.ConversationTranslationEventArgs}});var c=k5();Object.defineProperty(t,"ConversationTranslationResult",{enumerable:!0,get:function(){return c.ConversationTranslationResult}});var o=x5();Object.defineProperty(t,"ConversationTranslator",{enumerable:!0,get:function(){return o.ConversationTranslator}});var s=j5();Object.defineProperty(t,"ConversationTranscriber",{enumerable:!0,get:function(){return s.ConversationTranscriber}});var a=z5();Object.defineProperty(t,"Participant",{enumerable:!0,get:function(){return a.Participant}}),Object.defineProperty(t,"User",{enumerable:!0,get:function(){return a.User}});var u=N5();Object.defineProperty(t,"ParticipantChangedReason",{enumerable:!0,get:function(){return u.ParticipantChangedReason}})}(Jl)),Jl}var Dr={},CP;function L5(){if(CP)return Dr;CP=1;var t=w&&w.__awaiter||function(u,p,v,g){function h(d){return d instanceof v?d:new v(function(y){y(d)})}return new(v||(v=Promise))(function(d,y){function m(P){try{b(g.next(P))}catch(C){y(C)}}function S(P){try{b(g.throw(P))}catch(C){y(C)}}function b(P){P.done?d(P.value):h(P.value).then(m,S)}b((g=g.apply(u,p||[])).next())})},e=w&&w.__generator||function(u,p){var v={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},g,h,d,y;return y={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function m(b){return function(P){return S([b,P])}}function S(b){if(g)throw new TypeError("Generator is already executing.");for(;v;)try{if(g=1,h&&(d=b[0]&2?h.return:b[0]?h.throw||((d=h.return)&&d.call(h),0):h.next)&&!(d=d.call(h,b[1])).done)return d;switch(h=0,d&&(b=[b[0]&2,d.value]),b[0]){case 0:case 1:d=b;break;case 4:return v.label++,{value:b[1],done:!1};case 5:v.label++,h=b[1],b=[0];continue;case 7:b=v.ops.pop(),v.trys.pop();continue;default:if(d=v.trys,!(d=d.length>0&&d[d.length-1])&&(b[0]===6||b[0]===2)){v=0;continue}if(b[0]===3&&(!d||b[1]>d[0]&&b[1]<d[3])){v.label=b[1];break}if(b[0]===6&&v.label<d[1]){v.label=d[1],d=b;break}if(d&&v.label<d[2]){v.label=d[2],v.ops.push(b);break}d[2]&&v.ops.pop(),v.trys.pop();continue}b=p.call(u,v)}catch(P){b=[6,P],h=0}finally{g=d=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}};Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.SynthesisRequest=Dr.SpeechSynthesizer=void 0;var r=H(),n=K(),i=_I(),l=lp(),f=Fn(),c=te(),o=F(),s=function(){function u(p,v){var g=p;c.Contracts.throwIfNull(g,"speechConfig"),v!==null&&(v===void 0?this.audioConfig=typeof window>"u"?void 0:o.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=v),this.privProperties=g.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.privConnectionFactory=new r.SpeechSynthesisConnectionFactory,this.synthesisRequestQueue=new n.Queue,this.implCommonSynthesizeSetup()}return Object.defineProperty(u.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)},set:function(p){c.Contracts.throwIfNullOrWhitespace(p,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"autoDetectSourceLanguage",{get:function(){return this.properties.getProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===r.AutoDetectSourceLanguagesOpenRangeOptionName},enumerable:!1,configurable:!0}),u.FromConfig=function(p,v,g){var h=p;return v.properties.mergeTo(h.properties),new u(p,g)},u.prototype.buildSsml=function(p){var v,g=(v={},v["ar-EG"]="Microsoft Server Speech Text to Speech Voice (ar-EG, Hoda)",v["ar-SA"]="Microsoft Server Speech Text to Speech Voice (ar-SA, Naayf)",v["bg-BG"]="Microsoft Server Speech Text to Speech Voice (bg-BG, Ivan)",v["ca-ES"]="Microsoft Server Speech Text to Speech Voice (ca-ES, HerenaRUS)",v["cs-CZ"]="Microsoft Server Speech Text to Speech Voice (cs-CZ, Jakub)",v["da-DK"]="Microsoft Server Speech Text to Speech Voice (da-DK, HelleRUS)",v["de-AT"]="Microsoft Server Speech Text to Speech Voice (de-AT, Michael)",v["de-CH"]="Microsoft Server Speech Text to Speech Voice (de-CH, Karsten)",v["de-DE"]="Microsoft Server Speech Text to Speech Voice (de-DE, HeddaRUS)",v["el-GR"]="Microsoft Server Speech Text to Speech Voice (el-GR, Stefanos)",v["en-AU"]="Microsoft Server Speech Text to Speech Voice (en-AU, HayleyRUS)",v["en-CA"]="Microsoft Server Speech Text to Speech Voice (en-CA, HeatherRUS)",v["en-GB"]="Microsoft Server Speech Text to Speech Voice (en-GB, HazelRUS)",v["en-IE"]="Microsoft Server Speech Text to Speech Voice (en-IE, Sean)",v["en-IN"]="Microsoft Server Speech Text to Speech Voice (en-IN, PriyaRUS)",v["en-US"]="Microsoft Server Speech Text to Speech Voice (en-US, AriaRUS)",v["es-ES"]="Microsoft Server Speech Text to Speech Voice (es-ES, HelenaRUS)",v["es-MX"]="Microsoft Server Speech Text to Speech Voice (es-MX, HildaRUS)",v["fi-FI"]="Microsoft Server Speech Text to Speech Voice (fi-FI, HeidiRUS)",v["fr-CA"]="Microsoft Server Speech Text to Speech Voice (fr-CA, HarmonieRUS)",v["fr-CH"]="Microsoft Server Speech Text to Speech Voice (fr-CH, Guillaume)",v["fr-FR"]="Microsoft Server Speech Text to Speech Voice (fr-FR, HortenseRUS)",v["he-IL"]="Microsoft Server Speech Text to Speech Voice (he-IL, Asaf)",v["hi-IN"]="Microsoft Server Speech Text to Speech Voice (hi-IN, Kalpana)",v["hr-HR"]="Microsoft Server Speech Text to Speech Voice (hr-HR, Matej)",v["hu-HU"]="Microsoft Server Speech Text to Speech Voice (hu-HU, Szabolcs)",v["id-ID"]="Microsoft Server Speech Text to Speech Voice (id-ID, Andika)",v["it-IT"]="Microsoft Server Speech Text to Speech Voice (it-IT, LuciaRUS)",v["ja-JP"]="Microsoft Server Speech Text to Speech Voice (ja-JP, HarukaRUS)",v["ko-KR"]="Microsoft Server Speech Text to Speech Voice (ko-KR, HeamiRUS)",v["ms-MY"]="Microsoft Server Speech Text to Speech Voice (ms-MY, Rizwan)",v["nb-NO"]="Microsoft Server Speech Text to Speech Voice (nb-NO, HuldaRUS)",v["nl-NL"]="Microsoft Server Speech Text to Speech Voice (nl-NL, HannaRUS)",v["pl-PL"]="Microsoft Server Speech Text to Speech Voice (pl-PL, PaulinaRUS)",v["pt-BR"]="Microsoft Server Speech Text to Speech Voice (pt-BR, HeloisaRUS)",v["pt-PT"]="Microsoft Server Speech Text to Speech Voice (pt-PT, HeliaRUS)",v["ro-RO"]="Microsoft Server Speech Text to Speech Voice (ro-RO, Andrei)",v["ru-RU"]="Microsoft Server Speech Text to Speech Voice (ru-RU, EkaterinaRUS)",v["sk-SK"]="Microsoft Server Speech Text to Speech Voice (sk-SK, Filip)",v["sl-SI"]="Microsoft Server Speech Text to Speech Voice (sl-SI, Lado)",v["sv-SE"]="Microsoft Server Speech Text to Speech Voice (sv-SE, HedvigRUS)",v["ta-IN"]="Microsoft Server Speech Text to Speech Voice (ta-IN, Valluvar)",v["te-IN"]="Microsoft Server Speech Text to Speech Voice (te-IN, Chitra)",v["th-TH"]="Microsoft Server Speech Text to Speech Voice (th-TH, Pattara)",v["tr-TR"]="Microsoft Server Speech Text to Speech Voice (tr-TR, SedaRUS)",v["vi-VN"]="Microsoft Server Speech Text to Speech Voice (vi-VN, An)",v["zh-CN"]="Microsoft Server Speech Text to Speech Voice (zh-CN, HuihuiRUS)",v["zh-HK"]="Microsoft Server Speech Text to Speech Voice (zh-HK, TracyRUS)",v["zh-TW"]="Microsoft Server Speech Text to Speech Voice (zh-TW, HanHanRUS)",v),h=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),d=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthVoice,""),y=u.XMLEncode(p);return this.autoDetectSourceLanguage?h="en-US":d=d||g[h],d&&(y="<voice name='"+d+"'>"+y+"</voice>"),y="<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='"+h+"'>"+y+"</speak>",y},u.prototype.speakTextAsync=function(p,v,g,h){this.speakImpl(p,!1,v,g,h)},u.prototype.speakSsmlAsync=function(p,v,g,h){this.speakImpl(p,!0,v,g,h)},u.prototype.close=function(p,v){c.Contracts.throwIfDisposed(this.privDisposed),n.marshalPromiseToCallbacks(this.dispose(!0),p,v)},Object.defineProperty(u.prototype,"internalData",{get:function(){return this.privAdapter},enumerable:!1,configurable:!0}),u.prototype.dispose=function(p){return t(this,void 0,void 0,function(){return e(this,function(v){switch(v.label){case 0:return this.privDisposed?[2]:p?this.privAdapter?[4,this.privAdapter.dispose()]:[3,2]:[3,2];case 1:v.sent(),v.label=2;case 2:return this.privDisposed=!0,[2]}})})},u.prototype.createSynthesizerConfig=function(p){return new r.SynthesizerConfig(p,this.privProperties)},u.prototype.createSynthesisAdapter=function(p,v,g,h){return new r.SynthesisAdapterBase(p,v,h,this,this.audioConfig)},u.prototype.implCommonSynthesizeSetup=function(){var p=this,v=typeof window<"u"?"Browser":"Node",g="unknown",h="unknown";typeof navigator<"u"&&(v=v+"/"+navigator.platform,g=navigator.userAgent,h=navigator.appVersion);var d=this.createSynthesizerConfig(new r.SpeechServiceConfig(new r.Context(new r.OS(v,g,h)))),y=this.privProperties.getProperty(o.PropertyId.SpeechServiceConnection_Key,void 0),m=y&&y!==""?new r.CognitiveSubscriptionKeyAuthentication(y):new r.CognitiveTokenAuthentication(function(S){var b=p.privProperties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(b)},function(S){var b=p.privProperties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(b)});this.privAdapter=this.createSynthesisAdapter(m,this.privConnectionFactory,this.audioConfig,d),this.privAdapter.audioOutputFormat=l.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(o.SpeechSynthesisOutputFormat[this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])},u.prototype.speakImpl=function(p,v,g,h,d){var y=this;try{c.Contracts.throwIfDisposed(this.privDisposed);var m=n.createNoDashGuid(),S=void 0;d instanceof o.PushAudioOutputStreamCallback?S=new f.PushAudioOutputStreamImpl(d):d instanceof o.PullAudioOutputStream?S=d:d!==void 0?S=new i.AudioFileWriter(d):S=void 0,this.synthesisRequestQueue.enqueue(new a(m,p,v,function(P){if(y.privSynthesizing=!1,g)try{g(P)}catch(C){h&&h(C)}g=void 0,y.adapterSpeak().catch(function(){})},function(P){h&&h(P)},S)),this.adapterSpeak().catch(function(){})}catch(P){if(h)if(P instanceof Error){var b=P;h(b.name+": "+b.message)}else h(P);this.dispose(!0).catch(function(){})}},u.prototype.adapterSpeak=function(){return t(this,void 0,void 0,function(){var p;return e(this,function(v){switch(v.label){case 0:return!this.privDisposed&&!this.privSynthesizing?(this.privSynthesizing=!0,[4,this.synthesisRequestQueue.dequeue()]):[3,2];case 1:return p=v.sent(),[2,this.privAdapter.Speak(p.text,p.isSSML,p.requestId,p.cb,p.err,p.dataStream)];case 2:return[2]}})})},u.XMLEncode=function(p){return p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},u}();Dr.SpeechSynthesizer=s;var a=function(){function u(p,v,g,h,d,y){this.requestId=p,this.text=v,this.isSSML=g,this.cb=h,this.err=d,this.dataStream=y}return u}();return Dr.SynthesisRequest=a,Dr}var Do={},PP;function B5(){if(PP)return Do;PP=1,Object.defineProperty(Do,"__esModule",{value:!0}),Do.SpeechSynthesisResult=void 0;var t=function(){function e(r,n,i,l,f){this.privResultId=r,this.privReason=n,this.privAudioData=i,this.privErrorDetails=l,this.privProperties=f}return Object.defineProperty(e.prototype,"resultId",{get:function(){return this.privResultId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audioData",{get:function(){return this.privAudioData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),e}();return Do.SpeechSynthesisResult=t,Do}var $o={},wP;function q5(){if(wP)return $o;wP=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.SpeechSynthesisEventArgs=void 0;var t=function(){function e(r){this.privResult=r}return Object.defineProperty(e.prototype,"result",{get:function(){return this.privResult},enumerable:!1,configurable:!0}),e}();return $o.SpeechSynthesisEventArgs=t,$o}var ko={},RP;function F5(){if(RP)return ko;RP=1,Object.defineProperty(ko,"__esModule",{value:!0}),ko.SpeechSynthesisWordBoundaryEventArgs=void 0;var t=function(){function e(r,n,i,l){this.privAudioOffset=r,this.privText=n,this.privWordLength=i,this.privTextOffset=l}return Object.defineProperty(e.prototype,"audioOffset",{get:function(){return this.privAudioOffset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.privText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordLength",{get:function(){return this.privWordLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textOffset",{get:function(){return this.privTextOffset},enumerable:!1,configurable:!0}),e}();return ko.SpeechSynthesisWordBoundaryEventArgs=t,ko}var xo={},EP;function U5(){if(EP)return xo;EP=1,Object.defineProperty(xo,"__esModule",{value:!0}),xo.SpeechSynthesisBookmarkEventArgs=void 0;var t=function(){function e(r,n){this.privAudioOffset=r,this.privText=n}return Object.defineProperty(e.prototype,"audioOffset",{get:function(){return this.privAudioOffset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.privText},enumerable:!1,configurable:!0}),e}();return xo.SpeechSynthesisBookmarkEventArgs=t,xo}var jo={},OP;function V5(){if(OP)return jo;OP=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.SpeechSynthesisVisemeEventArgs=void 0;var t=function(){function e(r,n,i){this.privAudioOffset=r,this.privVisemeId=n,this.privAnimation=i}return Object.defineProperty(e.prototype,"audioOffset",{get:function(){return this.privAudioOffset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visemeId",{get:function(){return this.privVisemeId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animation",{get:function(){return this.privAnimation},enumerable:!1,configurable:!0}),e}();return jo.SpeechSynthesisVisemeEventArgs=t,jo}var zo={},_P;function W5(){if(_P)return zo;_P=1;var t=w&&w.__awaiter||function(a,u,p,v){function g(h){return h instanceof p?h:new p(function(d){d(h)})}return new(p||(p=Promise))(function(h,d){function y(b){try{S(v.next(b))}catch(P){d(P)}}function m(b){try{S(v.throw(b))}catch(P){d(P)}}function S(b){b.done?h(b.value):g(b.value).then(y,m)}S((v=v.apply(a,u||[])).next())})},e=w&&w.__generator||function(a,u){var p={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},v,g,h,d;return d={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function y(S){return function(b){return m([S,b])}}function m(S){if(v)throw new TypeError("Generator is already executing.");for(;p;)try{if(v=1,g&&(h=S[0]&2?g.return:S[0]?g.throw||((h=g.return)&&h.call(g),0):g.next)&&!(h=h.call(g,S[1])).done)return h;switch(g=0,h&&(S=[S[0]&2,h.value]),S[0]){case 0:case 1:h=S;break;case 4:return p.label++,{value:S[1],done:!1};case 5:p.label++,g=S[1],S=[0];continue;case 7:S=p.ops.pop(),p.trys.pop();continue;default:if(h=p.trys,!(h=h.length>0&&h[h.length-1])&&(S[0]===6||S[0]===2)){p=0;continue}if(S[0]===3&&(!h||S[1]>h[0]&&S[1]<h[3])){p.label=S[1];break}if(S[0]===6&&p.label<h[1]){p.label=h[1],h=S;break}if(h&&p.label<h[2]){p.label=h[2],p.ops.push(S);break}h[2]&&p.ops.pop(),p.trys.pop();continue}S=u.call(a,p)}catch(b){S=[6,b],g=0}finally{v=h=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},r;Object.defineProperty(zo,"__esModule",{value:!0}),zo.SpeakerAudioDestination=void 0;var n=H(),i=K(),l=Fn(),f=tn(),c=60*30,o=(r={},r[f.AudioFormatTag.PCM]="audio/wav",r[f.AudioFormatTag.MuLaw]="audio/x-wav",r[f.AudioFormatTag.MP3]="audio/mpeg",r[f.AudioFormatTag.OGG_OPUS]="audio/ogg",r[f.AudioFormatTag.WEBM_OPUS]="audio/webm; codecs=opus",r[f.AudioFormatTag.ALaw]="audio/x-wav",r),s=function(){function a(u){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=u||i.createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}return a.prototype.id=function(){return this.privId},a.prototype.write=function(u,p,v){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(u),this.updateSourceBuffer().then(function(){p&&p()},function(g){v&&v(g)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(u),this.privBytesReceived+=u.byteLength)},a.prototype.close=function(u,p){var v=this;if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(function(){u&&u()},function(h){p&&p(h)});else if(this.privAudioOutputStream!==void 0)if((this.privFormat.formatTag===f.AudioFormatTag.PCM||this.privFormat.formatTag===f.AudioFormatTag.MuLaw||this.privFormat.formatTag===f.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{var g=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(g).then(function(h){g=n.SynthesisAdapterBase.addHeader(g,v.privFormat);var d=new Blob([g],{type:o[v.privFormat.formatTag]});v.privAudio.src=window.URL.createObjectURL(d),v.notifyPlayback().then(function(){u&&u()},function(y){p&&p(y)})},function(h){p&&p(h)})}else this.onAudioEnd&&this.onAudioEnd(this)},Object.defineProperty(a.prototype,"format",{set:function(u){var p=this;if(typeof AudioContext<"u"||typeof window.webkitAudioContext<"u"){this.privFormat=u;var v=o[this.privFormat.formatTag];v===void 0?console.warn("Unknown mimeType for format "+f.AudioFormatTag[this.privFormat.formatTag]+"; playback is not supported."):typeof MediaSource<"u"&&MediaSource.isTypeSupported(v)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=function(g){p.privMediaSourceOpened=!0,p.privMediaSource.duration=c,p.privSourceBuffer=p.privMediaSource.addSourceBuffer(v),p.privSourceBuffer.onupdate=function(h){p.updateSourceBuffer().catch(function(d){i.Events.instance.onEvent(new i.BackgroundEvent(d))})},p.privSourceBuffer.onupdateend=function(h){p.handleSourceBufferUpdateEnd().catch(function(d){i.Events.instance.onEvent(new i.BackgroundEvent(d))})},p.privSourceBuffer.onupdatestart=function(h){p.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(function(g){i.Events.instance.onEvent(new i.BackgroundEvent(g))})):(console.warn("Format "+f.AudioFormatTag[this.privFormat.formatTag]+" could not be played by MSE, streaming playback is not enabled."),this.privAudioOutputStream=new l.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isClosed",{get:function(){return this.privIsClosed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"currentTime",{get:function(){return this.privAudio!==void 0?this.privAudio.currentTime:-1},enumerable:!1,configurable:!0}),a.prototype.pause=function(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)},a.prototype.resume=function(u,p){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(function(){u&&u()},function(v){p&&p(v)}),this.privIsPaused=!1)},Object.defineProperty(a.prototype,"internalAudio",{get:function(){return this.privAudio},enumerable:!1,configurable:!0}),a.prototype.updateSourceBuffer=function(){return t(this,void 0,void 0,function(){var u;return e(this,function(p){switch(p.label){case 0:if(!(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()))return[3,2];this.privAppendingToBuffer=!0,u=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(u)}catch{return this.privAudioBuffer.unshift(u),console.log("buffer filled, pausing addition of binaries until space is made"),[2]}return[4,this.notifyPlayback()];case 1:return p.sent(),[3,4];case 2:return this.canEndStream()?[4,this.handleSourceBufferUpdateEnd()]:[3,4];case 3:p.sent(),p.label=4;case 4:return[2]}})})},a.prototype.handleSourceBufferUpdateEnd=function(){return t(this,void 0,void 0,function(){return e(this,function(u){switch(u.label){case 0:return this.canEndStream()&&this.sourceBufferAvailable()?(this.privMediaSource.endOfStream(),[4,this.notifyPlayback()]):[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}})})},a.prototype.notifyPlayback=function(){return t(this,void 0,void 0,function(){var u=this;return e(this,function(p){switch(p.label){case 0:return!this.privPlaybackStarted&&this.privAudio!==void 0?(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=function(){u.onAudioEnd&&u.onAudioEnd(u)},this.privIsPaused?[3,2]:[4,this.privAudio.play()]):[3,2];case 1:p.sent(),p.label=2;case 2:return[2]}})})},a.prototype.canEndStream=function(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"},a.prototype.sourceBufferAvailable=function(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating},a}();return zo.SpeakerAudioDestination=s,zo}var No={},AP;function H5(){if(AP)return No;AP=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(No,"__esModule",{value:!0}),No.ConversationTranscriptionCanceledEventArgs=void 0;var e=Hd(),r=function(n){t(i,n);function i(){return n!==null&&n.apply(this,arguments)||this}return i}(e.CancellationEventArgsBase);return No.ConversationTranscriptionCanceledEventArgs=r,No}var Xl={},IP;function K5(){return IP||(IP=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PronunciationAssessmentGradingSystem=void 0,function(e){e[e.FivePoint=1]="FivePoint",e[e.HundredMark=2]="HundredMark"}(t.PronunciationAssessmentGradingSystem||(t.PronunciationAssessmentGradingSystem={}))}(Xl)),Xl}var Zl={},TP;function G5(){return TP||(TP=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PronunciationAssessmentGranularity=void 0,function(e){e[e.Phoneme=1]="Phoneme",e[e.Word=2]="Word",e[e.FullText=3]="FullText"}(t.PronunciationAssessmentGranularity||(t.PronunciationAssessmentGranularity={}))}(Zl)),Zl}var Lo={},MP;function J5(){if(MP)return Lo;MP=1,Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.PronunciationAssessmentConfig=void 0;var t=te(),e=F(),r=function(){function n(i,l,f,c){l===void 0&&(l=e.PronunciationAssessmentGradingSystem.FivePoint),f===void 0&&(f=e.PronunciationAssessmentGranularity.Phoneme),c===void 0&&(c=!1),t.Contracts.throwIfNullOrUndefined(i,"referenceText"),this.privProperties=new e.PropertyCollection,this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,i),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_GradingSystem,e.PronunciationAssessmentGradingSystem[l]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Granularity,e.PronunciationAssessmentGranularity[f]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,String(c))}return n.fromJSON=function(i){t.Contracts.throwIfNullOrUndefined(i,"json");var l=new n("");return l.privProperties=new e.PropertyCollection,l.properties.setProperty(e.PropertyId.PronunciationAssessment_Json,i),l},n.prototype.toJSON=function(){return this.updateJson(),this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Params)},n.prototype.applyTo=function(i){this.updateJson();var l=i.internalData;l.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(e.PropertyId.PronunciationAssessment_Params))},Object.defineProperty(n.prototype,"referenceText",{get:function(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText)},set:function(i){t.Contracts.throwIfNullOrWhitespace(i,"referenceText"),this.properties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,i)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),n.prototype.updateJson=function(){var i=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Json,"{}"),l=JSON.parse(i),f=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText);f&&(l.referenceText=f);var c=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_GradingSystem);c&&(l.gradingSystem=c);var o=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Granularity);o&&(l.granularity=o),l.dimension="Comprehensive";var s=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue);s==="true"?l.enableMiscue=!0:s==="false"&&(l.enableMiscue=!1),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Params,JSON.stringify(l))},n}();return Lo.PronunciationAssessmentConfig=r,Lo}var Bo={},DP;function Q5(){if(DP)return Bo;DP=1,Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.PronunciationAssessmentResult=void 0;var t=te(),e=F(),r=function(){function n(i){var l=JSON.parse(i);t.Contracts.throwIfNullOrUndefined(l.NBest[0],"NBest"),this.privPronJson=l.NBest[0]}return n.fromResult=function(i){t.Contracts.throwIfNullOrUndefined(i,"result");var l=i.properties.getProperty(e.PropertyId.SpeechServiceResponse_JsonResult);return t.Contracts.throwIfNullOrUndefined(l,"json"),new n(l)},Object.defineProperty(n.prototype,"detailResult",{get:function(){return this.privPronJson},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"accuracyScore",{get:function(){return this.detailResult.PronunciationAssessment.AccuracyScore},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pronunciationScore",{get:function(){return this.detailResult.PronunciationAssessment.PronScore},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"completenessScore",{get:function(){return this.detailResult.PronunciationAssessment.CompletenessScore},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fluencyScore",{get:function(){return this.detailResult.PronunciationAssessment.FluencyScore},enumerable:!1,configurable:!0}),n}();return Bo.PronunciationAssessmentResult=r,Bo}var $P;function F(){return $P||($P=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=wG();Object.defineProperty(t,"AudioConfig",{enumerable:!0,get:function(){return e.AudioConfig}});var r=tn();Object.defineProperty(t,"AudioStreamFormat",{enumerable:!0,get:function(){return r.AudioStreamFormat}});var n=AI();Object.defineProperty(t,"AudioInputStream",{enumerable:!0,get:function(){return n.AudioInputStream}}),Object.defineProperty(t,"PullAudioInputStream",{enumerable:!0,get:function(){return n.PullAudioInputStream}}),Object.defineProperty(t,"PushAudioInputStream",{enumerable:!0,get:function(){return n.PushAudioInputStream}});var i=Fn();Object.defineProperty(t,"AudioOutputStream",{enumerable:!0,get:function(){return i.AudioOutputStream}}),Object.defineProperty(t,"PullAudioOutputStream",{enumerable:!0,get:function(){return i.PullAudioOutputStream}}),Object.defineProperty(t,"PushAudioOutputStream",{enumerable:!0,get:function(){return i.PushAudioOutputStream}});var l=RG();Object.defineProperty(t,"CancellationReason",{enumerable:!0,get:function(){return l.CancellationReason}});var f=EG();Object.defineProperty(t,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return f.PullAudioInputStreamCallback}});var c=OG();Object.defineProperty(t,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return c.PushAudioOutputStreamCallback}});var o=_G();Object.defineProperty(t,"KeywordRecognitionModel",{enumerable:!0,get:function(){return o.KeywordRecognitionModel}});var s=AG();Object.defineProperty(t,"SessionEventArgs",{enumerable:!0,get:function(){return s.SessionEventArgs}});var a=IG();Object.defineProperty(t,"RecognitionEventArgs",{enumerable:!0,get:function(){return a.RecognitionEventArgs}});var u=TG();Object.defineProperty(t,"OutputFormat",{enumerable:!0,get:function(){return u.OutputFormat}});var p=MG();Object.defineProperty(t,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return p.IntentRecognitionEventArgs}});var v=DG();Object.defineProperty(t,"RecognitionResult",{enumerable:!0,get:function(){return v.RecognitionResult}});var g=$G();Object.defineProperty(t,"SpeechRecognitionResult",{enumerable:!0,get:function(){return g.SpeechRecognitionResult}});var h=kG();Object.defineProperty(t,"IntentRecognitionResult",{enumerable:!0,get:function(){return h.IntentRecognitionResult}});var d=xG();Object.defineProperty(t,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return d.LanguageUnderstandingModel}});var y=jG();Object.defineProperty(t,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return y.SpeechRecognitionEventArgs}}),Object.defineProperty(t,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return y.ConversationTranscriptionEventArgs}});var m=zG();Object.defineProperty(t,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return m.SpeechRecognitionCanceledEventArgs}});var S=NG();Object.defineProperty(t,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return S.TranslationRecognitionEventArgs}});var b=LG();Object.defineProperty(t,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return b.TranslationSynthesisEventArgs}});var P=TI();Object.defineProperty(t,"TranslationRecognitionResult",{enumerable:!0,get:function(){return P.TranslationRecognitionResult}});var C=BG();Object.defineProperty(t,"TranslationSynthesisResult",{enumerable:!0,get:function(){return C.TranslationSynthesisResult}});var R=qG();Object.defineProperty(t,"ResultReason",{enumerable:!0,get:function(){return R.ResultReason}});var O=FG();Object.defineProperty(t,"SpeechConfig",{enumerable:!0,get:function(){return O.SpeechConfig}}),Object.defineProperty(t,"SpeechConfigImpl",{enumerable:!0,get:function(){return O.SpeechConfigImpl}});var z=UG();Object.defineProperty(t,"SpeechTranslationConfig",{enumerable:!0,get:function(){return z.SpeechTranslationConfig}}),Object.defineProperty(t,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return z.SpeechTranslationConfigImpl}});var L=MI();Object.defineProperty(t,"PropertyCollection",{enumerable:!0,get:function(){return L.PropertyCollection}});var E=Kd();Object.defineProperty(t,"PropertyId",{enumerable:!0,get:function(){return E.PropertyId}});var T=VG();Object.defineProperty(t,"Recognizer",{enumerable:!0,get:function(){return T.Recognizer}});var A=WG();Object.defineProperty(t,"SpeechRecognizer",{enumerable:!0,get:function(){return A.SpeechRecognizer}});var _=HG();Object.defineProperty(t,"IntentRecognizer",{enumerable:!0,get:function(){return _.IntentRecognizer}});var $=KG();Object.defineProperty(t,"VoiceProfileType",{enumerable:!0,get:function(){return $.VoiceProfileType}});var x=GG();Object.defineProperty(t,"TranslationRecognizer",{enumerable:!0,get:function(){return x.TranslationRecognizer}});var B=JG();Object.defineProperty(t,"Translations",{enumerable:!0,get:function(){return B.Translations}});var U=QG();Object.defineProperty(t,"NoMatchReason",{enumerable:!0,get:function(){return U.NoMatchReason}});var N=YG();Object.defineProperty(t,"NoMatchDetails",{enumerable:!0,get:function(){return N.NoMatchDetails}});var W=XG();Object.defineProperty(t,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return W.TranslationRecognitionCanceledEventArgs}});var oe=ZG();Object.defineProperty(t,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return oe.IntentRecognitionCanceledEventArgs}});var G=DI();Object.defineProperty(t,"CancellationDetailsBase",{enumerable:!0,get:function(){return G.CancellationDetailsBase}});var pe=e5();Object.defineProperty(t,"CancellationDetails",{enumerable:!0,get:function(){return pe.CancellationDetails}});var je=t5();Object.defineProperty(t,"CancellationErrorCode",{enumerable:!0,get:function(){return je.CancellationErrorCode}});var Bt=r5();Object.defineProperty(t,"ConnectionEventArgs",{enumerable:!0,get:function(){return Bt.ConnectionEventArgs}});var Ge=n5();Object.defineProperty(t,"ServiceEventArgs",{enumerable:!0,get:function(){return Ge.ServiceEventArgs}});var ut=i5();Object.defineProperty(t,"Connection",{enumerable:!0,get:function(){return ut.Connection}});var pt=o5();Object.defineProperty(t,"PhraseListGrammar",{enumerable:!0,get:function(){return pt.PhraseListGrammar}});var _t=Gd();Object.defineProperty(t,"DialogServiceConfig",{enumerable:!0,get:function(){return _t.DialogServiceConfig}});var nr=s5();Object.defineProperty(t,"BotFrameworkConfig",{enumerable:!0,get:function(){return nr.BotFrameworkConfig}});var ir=a5();Object.defineProperty(t,"CustomCommandsConfig",{enumerable:!0,get:function(){return ir.CustomCommandsConfig}});var nt=u5();Object.defineProperty(t,"DialogServiceConnector",{enumerable:!0,get:function(){return nt.DialogServiceConnector}});var ie=p5();Object.defineProperty(t,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return ie.ActivityReceivedEventArgs}});var yr=l5();Object.defineProperty(t,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return yr.TurnStatusReceivedEventArgs}});var Fa=v5();Object.defineProperty(t,"ServicePropertyChannel",{enumerable:!0,get:function(){return Fa.ServicePropertyChannel}});var Ua=h5();Object.defineProperty(t,"ProfanityOption",{enumerable:!0,get:function(){return Ua.ProfanityOption}});var Wn=d5();Object.defineProperty(t,"BaseAudioPlayer",{enumerable:!0,get:function(){return Wn.BaseAudioPlayer}});var me=g5();Object.defineProperty(t,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return me.ConnectionMessageEventArgs}});var Va=$I();Object.defineProperty(t,"ConnectionMessage",{enumerable:!0,get:function(){return Va.ConnectionMessage}});var Hn=y5();Object.defineProperty(t,"VoiceProfile",{enumerable:!0,get:function(){return Hn.VoiceProfile}});var mr=m5();Object.defineProperty(t,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return mr.VoiceProfileEnrollmentResult}}),Object.defineProperty(t,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return mr.VoiceProfileEnrollmentCancellationDetails}});var Wa=S5();Object.defineProperty(t,"VoiceProfileResult",{enumerable:!0,get:function(){return Wa.VoiceProfileResult}}),Object.defineProperty(t,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return Wa.VoiceProfileCancellationDetails}});var or=b5();Object.defineProperty(t,"VoiceProfileAuthorizationPhraseResult",{enumerable:!0,get:function(){return or.VoiceProfileAuthorizationPhraseResult}});var Ha=C5();Object.defineProperty(t,"VoiceProfileClient",{enumerable:!0,get:function(){return Ha.VoiceProfileClient}});var Ka=P5();Object.defineProperty(t,"SpeakerRecognizer",{enumerable:!0,get:function(){return Ka.SpeakerRecognizer}});var rn=w5();Object.defineProperty(t,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return rn.SpeakerIdentificationModel}});var Ga=R5();Object.defineProperty(t,"SpeakerVerificationModel",{enumerable:!0,get:function(){return Ga.SpeakerVerificationModel}});var At=E5();Object.defineProperty(t,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return At.AutoDetectSourceLanguageConfig}});var nn=O5();Object.defineProperty(t,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return nn.AutoDetectSourceLanguageResult}});var Ja=_5();Object.defineProperty(t,"SourceLanguageConfig",{enumerable:!0,get:function(){return Ja.SourceLanguageConfig}});var Kn=A5();Object.defineProperty(t,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return Kn.SpeakerRecognitionResult}}),Object.defineProperty(t,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return Kn.SpeakerRecognitionResultType}}),Object.defineProperty(t,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return Kn.SpeakerRecognitionCancellationDetails}});var Je=xI();Object.defineProperty(t,"Conversation",{enumerable:!0,get:function(){return Je.Conversation}}),Object.defineProperty(t,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return Je.ConversationExpirationEventArgs}}),Object.defineProperty(t,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return Je.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(t,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return Je.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(t,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return Je.ConversationTranslationEventArgs}}),Object.defineProperty(t,"ConversationTranslationResult",{enumerable:!0,get:function(){return Je.ConversationTranslationResult}}),Object.defineProperty(t,"ConversationTranslator",{enumerable:!0,get:function(){return Je.ConversationTranslator}}),Object.defineProperty(t,"ConversationTranscriber",{enumerable:!0,get:function(){return Je.ConversationTranscriber}}),Object.defineProperty(t,"Participant",{enumerable:!0,get:function(){return Je.Participant}}),Object.defineProperty(t,"ParticipantChangedReason",{enumerable:!0,get:function(){return Je.ParticipantChangedReason}}),Object.defineProperty(t,"User",{enumerable:!0,get:function(){return Je.User}});var yp=II();Object.defineProperty(t,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return yp.SpeechSynthesisOutputFormat}});var mp=L5();Object.defineProperty(t,"SpeechSynthesizer",{enumerable:!0,get:function(){return mp.SpeechSynthesizer}});var Qa=B5();Object.defineProperty(t,"SpeechSynthesisResult",{enumerable:!0,get:function(){return Qa.SpeechSynthesisResult}});var Ya=q5();Object.defineProperty(t,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return Ya.SpeechSynthesisEventArgs}});var Xa=F5();Object.defineProperty(t,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return Xa.SpeechSynthesisWordBoundaryEventArgs}});var Sp=U5();Object.defineProperty(t,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return Sp.SpeechSynthesisBookmarkEventArgs}});var bp=V5();Object.defineProperty(t,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return bp.SpeechSynthesisVisemeEventArgs}});var Za=W5();Object.defineProperty(t,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Za.SpeakerAudioDestination}});var ec=H5();Object.defineProperty(t,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return ec.ConversationTranscriptionCanceledEventArgs}});var Gn=K5();Object.defineProperty(t,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return Gn.PronunciationAssessmentGradingSystem}});var tc=G5();Object.defineProperty(t,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return tc.PronunciationAssessmentGranularity}});var Cp=J5();Object.defineProperty(t,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return Cp.PronunciationAssessmentConfig}});var rc=Q5();Object.defineProperty(t,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return rc.PronunciationAssessmentResult}})}(jl)),jl}var kP;function Y5(){if(kP)return Ri;kP=1;var t=w&&w.__extends||function(){var c=function(o,s){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,u){a.__proto__=u}||function(a,u){for(var p in u)u.hasOwnProperty(p)&&(a[p]=u[p])},c(o,s)};return function(o,s){c(o,s);function a(){this.constructor=o}o.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}();Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.IntentConnectionFactory=void 0;var e=yt(),r=F(),n=Vn(),i=H(),l=Lt(),f=function(c){t(o,c);function o(){var s=c!==null&&c.apply(this,arguments)||this;return s.create=function(a,u,p){var v=a.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint);if(!v){var g=a.parameters.getProperty(r.PropertyId.SpeechServiceConnection_IntentRegion),h=g&&g.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",d=a.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+g+".sr.speech"+h);v=d+"/speech/recognition/interactive/cognitiveservices/v1"}var y={format:"simple",language:a.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)};s.setCommonUrlParams(a,y,v);var m={};u.token!==void 0&&u.token!==""&&(m[u.headerName]=u.token),m[l.HeaderNames.ConnectionId]=p,a.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,v);var S=a.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(v,y,m,new i.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(a),S,p)},s}return o.prototype.getSpeechRegionFromIntentRegion=function(s){switch(s){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return s}},o}(n.ConnectionFactoryBase);return Ri.IntentConnectionFactory=f,Ri}var ev={},xP;function Jd(){return xP||(xP=1,function(t){var e=w&&w.__extends||function(){var a=function(u,p){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var h in g)g.hasOwnProperty(h)&&(v[h]=g[h])},a(u,p)};return function(u,p){a(u,p);function v(){this.constructor=u}u.prototype=p===null?Object.create(p):(v.prototype=p.prototype,new v)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.RecognitionEndedEvent=t.RecognitionCompletionStatus=t.RecognitionStartedEvent=t.ConnectingToServiceEvent=t.ListeningStartedEvent=t.RecognitionTriggeredEvent=t.SpeechRecognitionEvent=void 0;var r=K(),n=function(a){e(u,a);function u(p,v,g,h){h===void 0&&(h=r.EventType.Info);var d=a.call(this,p,h)||this;return d.privRequestId=v,d.privSessionId=g,d}return Object.defineProperty(u.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!1,configurable:!0}),u}(r.PlatformEvent);t.SpeechRecognitionEvent=n;var i=function(a){e(u,a);function u(p,v,g,h){var d=a.call(this,"RecognitionTriggeredEvent",p,v)||this;return d.privAudioSourceId=g,d.privAudioNodeId=h,d}return Object.defineProperty(u.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!1,configurable:!0}),u}(n);t.RecognitionTriggeredEvent=i;var l=function(a){e(u,a);function u(p,v,g,h){var d=a.call(this,"ListeningStartedEvent",p,v)||this;return d.privAudioSourceId=g,d.privAudioNodeId=h,d}return Object.defineProperty(u.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!1,configurable:!0}),u}(n);t.ListeningStartedEvent=l;var f=function(a){e(u,a);function u(p,v,g){var h=a.call(this,"ConnectingToServiceEvent",p,g)||this;return h.privAuthFetchEventid=v,h}return Object.defineProperty(u.prototype,"authFetchEventid",{get:function(){return this.privAuthFetchEventid},enumerable:!1,configurable:!0}),u}(n);t.ConnectingToServiceEvent=f;var c=function(a){e(u,a);function u(p,v,g,h,d){var y=a.call(this,"RecognitionStartedEvent",p,d)||this;return y.privAudioSourceId=v,y.privAudioNodeId=g,y.privAuthFetchEventId=h,y}return Object.defineProperty(u.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!1,configurable:!0}),u}(n);t.RecognitionStartedEvent=c;var o;(function(a){a[a.Success=0]="Success",a[a.AudioSourceError=1]="AudioSourceError",a[a.AudioSourceTimeout=2]="AudioSourceTimeout",a[a.AuthTokenFetchError=3]="AuthTokenFetchError",a[a.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",a[a.UnAuthorized=5]="UnAuthorized",a[a.ConnectTimeout=6]="ConnectTimeout",a[a.ConnectError=7]="ConnectError",a[a.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",a[a.UnknownError=9]="UnknownError"})(o=t.RecognitionCompletionStatus||(t.RecognitionCompletionStatus={}));var s=function(a){e(u,a);function u(p,v,g,h,d,y,m,S){var b=a.call(this,"RecognitionEndedEvent",p,d,m===o.Success?r.EventType.Info:r.EventType.Error)||this;return b.privAudioSourceId=v,b.privAudioNodeId=g,b.privAuthFetchEventId=h,b.privStatus=m,b.privError=S,b.privServiceTag=y,b}return Object.defineProperty(u.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"serviceTag",{get:function(){return this.privServiceTag},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"status",{get:function(){return this.privStatus},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"error",{get:function(){return this.privError},enumerable:!1,configurable:!0}),u}(n);t.RecognitionEndedEvent=s}(ev)),ev}var qo={},Fo={},jP;function vp(){if(jP)return Fo;jP=1;var t=w&&w.__extends||function(){var i=function(l,f){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,o){c.__proto__=o}||function(c,o){for(var s in o)o.hasOwnProperty(s)&&(c[s]=o[s])},i(l,f)};return function(l,f){i(l,f);function c(){this.constructor=l}l.prototype=f===null?Object.create(f):(c.prototype=f.prototype,new c)}}();Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.SpeechConnectionMessage=void 0;var e=K(),r=Lt(),n=function(i){t(l,i);function l(f,c,o,s,a,u,p,v){var g=this;if(!c)throw new e.ArgumentNullError("path");if(!o)throw new e.ArgumentNullError("requestId");var h={};if(h[r.HeaderNames.Path]=c,h[r.HeaderNames.RequestId]=o,h[r.HeaderNames.RequestTimestamp]=new Date().toISOString(),s&&(h[r.HeaderNames.ContentType]=s),u&&(h[r.HeaderNames.RequestStreamId]=u),p)for(var d in p)d&&(h[d]=p[d]);return v?g=i.call(this,f,a,h,v)||this:g=i.call(this,f,a,h)||this,g.privPath=c,g.privRequestId=o,g.privContentType=s,g.privStreamId=u,g.privAdditionalHeaders=p,g}return Object.defineProperty(l.prototype,"path",{get:function(){return this.privPath},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"contentType",{get:function(){return this.privContentType},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"streamId",{get:function(){return this.privStreamId},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"additionalHeaders",{get:function(){return this.privAdditionalHeaders},enumerable:!1,configurable:!0}),l.fromConnectionMessage=function(f){var c=null,o=null,s=null,a=null,u={};if(f.headers)for(var p in f.headers)p&&(p.toLowerCase()===r.HeaderNames.Path.toLowerCase()?c=f.headers[p]:p.toLowerCase()===r.HeaderNames.RequestId.toLowerCase()?o=f.headers[p]:p.toLowerCase()===r.HeaderNames.RequestTimestamp.toLowerCase()?f.headers[p]:p.toLowerCase()===r.HeaderNames.ContentType.toLowerCase()?s=f.headers[p]:p.toLowerCase()===r.HeaderNames.RequestStreamId.toLowerCase()?a=f.headers[p]:u[p]=f.headers[p]);return new l(f.messageType,c,o,s,f.body,a,u,f.id)},l}(e.ConnectionMessage);return Fo.SpeechConnectionMessage=n,Fo}var zP;function X5(){if(zP)return qo;zP=1;var t=w&&w.__awaiter||function(o,s,a,u){function p(v){return v instanceof a?v:new a(function(g){g(v)})}return new(a||(a=Promise))(function(v,g){function h(m){try{y(u.next(m))}catch(S){g(S)}}function d(m){try{y(u.throw(m))}catch(S){g(S)}}function y(m){m.done?v(m.value):p(m.value).then(h,d)}y((u=u.apply(o,s||[])).next())})},e=w&&w.__generator||function(o,s){var a={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},u,p,v,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(y){return function(m){return d([y,m])}}function d(y){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,p&&(v=y[0]&2?p.return:y[0]?p.throw||((v=p.return)&&v.call(p),0):p.next)&&!(v=v.call(p,y[1])).done)return v;switch(p=0,v&&(y=[y[0]&2,v.value]),y[0]){case 0:case 1:v=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,p=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(v=a.trys,!(v=v.length>0&&v[v.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!v||y[1]>v[0]&&y[1]<v[3])){a.label=y[1];break}if(y[0]===6&&a.label<v[1]){a.label=v[1],v=y;break}if(v&&a.label<v[2]){a.label=v[2],a.ops.push(y);break}v[2]&&a.ops.pop(),a.trys.pop();continue}y=s.call(o,a)}catch(m){y=[6,m],p=0}finally{u=v=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(qo,"__esModule",{value:!0}),qo.ServiceRecognizerBase=void 0;var r=yt(),n=K(),i=F(),l=H(),f=vp(),c=function(){function o(s,a,u,p,v){var g=this;if(this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendSpeechContext=function(h){var d=g.speechContext.toJSON();if(d)return h.send(new f.SpeechConnectionMessage(n.MessageType.Text,"speech.context",g.privRequestSession.requestId,"application/json",d))},this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.sendSpeechServiceConfig=function(h,d,y){if(o.telemetryDataEnabled!==!0){var m=JSON.parse(y),S={context:{system:m.context.system}};y=JSON.stringify(S)}if(g.privRecognizerConfig.parameters.getProperty("TranscriptionService_SingleChannel","false").toLowerCase()==="true"){var b=JSON.parse(y);b.context.DisableReferenceChannel="True",b.context.MicSpec="1_0_0",y=JSON.stringify(b)}if(y)return h.send(new f.SpeechConnectionMessage(n.MessageType.Text,"speech.config",d.requestId,"application/json",y))},!s)throw new n.ArgumentNullError("authentication");if(!a)throw new n.ArgumentNullError("connectionFactory");if(!u)throw new n.ArgumentNullError("audioSource");if(!p)throw new n.ArgumentNullError("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=s,this.privConnectionFactory=a,this.privAudioSource=u,this.privRecognizerConfig=p,this.privIsDisposed=!1,this.privRecognizer=v,this.privRequestSession=new l.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new n.EventSource,this.privServiceEvents=new n.EventSource,this.privDynamicGrammar=new l.DynamicGrammarBuilder,this.privSpeechContext=new l.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new l.AgentConfig,typeof Blob<"u"&&typeof Worker<"u"&&(this.privSetTimeout=n.Timeout.setTimeout),this.connectionEvents.attach(function(h){return t(g,void 0,void 0,function(){var d;return e(this,function(y){switch(y.label){case 0:return h.name!=="ConnectionClosedEvent"?[3,2]:(d=h,d.statusCode===1003||d.statusCode===1007||d.statusCode===1002||d.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount?[4,this.cancelRecognitionLocal(i.CancellationReason.Error,d.statusCode===1007?i.CancellationErrorCode.BadRequestParameters:i.CancellationErrorCode.ConnectionFailure,d.reason+" websocket error code: "+d.statusCode)]:[3,2]);case 1:y.sent(),y.label=2;case 2:return[2]}})})})}return Object.defineProperty(o.prototype,"audioSource",{get:function(){return this.privAudioSource},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"speechContext",{get:function(){return this.privSpeechContext},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dynamicGrammar",{get:function(){return this.privDynamicGrammar},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"agentConfig",{get:function(){return this.privAgentConfig},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"conversationTranslatorToken",{set:function(s){this.privRecognizerConfig.parameters.setProperty(i.PropertyId.ConversationTranslator_Token,s)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"authentication",{set:function(s){this.privAuthentication=this.authentication},enumerable:!1,configurable:!0}),o.prototype.isDisposed=function(){return this.privIsDisposed},o.prototype.dispose=function(s){return t(this,void 0,void 0,function(){var a;return e(this,function(u){switch(u.label){case 0:if(this.privIsDisposed=!0,!this.privConnectionConfigurationPromise)return[3,5];u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this.privConnectionConfigurationPromise];case 2:return a=u.sent(),[4,a.dispose(s)];case 3:return u.sent(),[3,5];case 4:return u.sent(),[2];case 5:return[2]}})})},Object.defineProperty(o.prototype,"connectionEvents",{get:function(){return this.privConnectionEvents},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"serviceEvents",{get:function(){return this.privServiceEvents},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"recognitionMode",{get:function(){return this.privRecognizerConfig.recognitionMode},enumerable:!1,configurable:!0}),o.prototype.recognize=function(s,a,u){return t(this,void 0,void 0,function(){var p,v,g,h,d,y,m,S,b,P=this;return e(this,function(C){switch(C.label){case 0:if(this.recognizeOverride!==void 0)return[2,this.recognizeOverride(s,a,u)];this.privConnectionConfigurationPromise=null,this.privRecognizerConfig.recognitionMode=s,this.privSuccessCallback=a,this.privErrorCallback=u,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events),p=this.connectImpl(),C.label=1;case 1:return C.trys.push([1,6,,8]),[4,this.audioSource.attach(this.privRequestSession.audioNodeId)];case 2:return g=C.sent(),[4,this.audioSource.format];case 3:return h=C.sent(),[4,this.audioSource.deviceInfo];case 4:return d=C.sent(),this.privIsLiveAudio=d.type&&d.type===l.type.Microphones,v=new r.ReplayableAudioNode(g,h.avgBytesPerSec),[4,this.privRequestSession.onAudioSourceAttachCompleted(v,!1)];case 5:return C.sent(),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:d},[3,8];case 6:return y=C.sent(),[4,this.privRequestSession.onStopRecognizing()];case 7:throw C.sent(),y;case 8:return C.trys.push([8,10,,12]),[4,p];case 9:return C.sent(),[3,12];case 10:return m=C.sent(),[4,this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,m)];case 11:return C.sent(),[2];case 12:return S=new i.SessionEventArgs(this.privRequestSession.sessionId),this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,S),this.receiveMessage(),b=this.sendAudio(v),b.catch(function(R){return t(P,void 0,void 0,function(){return e(this,function(O){switch(O.label){case 0:return[4,this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,R)];case 1:return O.sent(),[2]}})})}),[2]}})})},o.prototype.stopRecognizing=function(){return t(this,void 0,void 0,function(){return e(this,function(s){switch(s.label){case 0:if(!this.privRequestSession.isRecognizing)return[3,8];s.label=1;case 1:return s.trys.push([1,,6,8]),[4,this.audioSource.turnOff()];case 2:return s.sent(),[4,this.sendFinalAudio()];case 3:return s.sent(),[4,this.privRequestSession.onStopRecognizing()];case 4:return s.sent(),[4,this.privRequestSession.turnCompletionPromise];case 5:return s.sent(),[3,8];case 6:return[4,this.privRequestSession.dispose()];case 7:return s.sent(),[7];case 8:return[2]}})})},o.prototype.connect=function(){return t(this,void 0,void 0,function(){return e(this,function(s){switch(s.label){case 0:return[4,this.connectImpl()];case 1:return s.sent(),[2,Promise.resolve()]}})})},o.prototype.connectAsync=function(s,a){this.connectImpl().then(function(u){try{s&&s()}catch(p){a&&a(p)}},function(u){try{a&&a(u)}catch{}})},o.prototype.disconnect=function(){return t(this,void 0,void 0,function(){return e(this,function(s){switch(s.label){case 0:return[4,this.cancelRecognitionLocal(i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting")];case 1:return s.sent(),this.disconnectOverride===void 0?[3,3]:[4,this.disconnectOverride()];case 2:s.sent(),s.label=3;case 3:return s.trys.push([3,6,,7]),[4,this.privConnectionPromise];case 4:return[4,s.sent().dispose()];case 5:return s.sent(),[3,7];case 6:return s.sent(),[3,7];case 7:return this.privConnectionPromise=null,[2]}})})},o.prototype.sendMessage=function(s){},o.prototype.sendNetworkMessage=function(s,a){return t(this,void 0,void 0,function(){var u,p,v;return e(this,function(g){switch(g.label){case 0:return u=typeof a=="string"?n.MessageType.Text:n.MessageType.Binary,p=typeof a=="string"?"application/json":"",[4,this.fetchConnection()];case 1:return v=g.sent(),[2,v.send(new f.SpeechConnectionMessage(u,s,this.privRequestSession.requestId,p,a))]}})})},Object.defineProperty(o.prototype,"activityTemplate",{get:function(){return this.privActivityTemplate},set:function(s){this.privActivityTemplate=s},enumerable:!1,configurable:!0}),o.prototype.sendTelemetryData=function(){return t(this,void 0,void 0,function(){var s,a;return e(this,function(u){switch(u.label){case 0:if(s=this.privRequestSession.getTelemetry(),o.telemetryDataEnabled!==!0||this.privIsDisposed||s===null)return[2];if(o.telemetryData)try{o.telemetryData(s)}catch{}return[4,this.fetchConnection()];case 1:return a=u.sent(),[4,a.send(new f.SpeechConnectionMessage(n.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",s))];case 2:return u.sent(),[2]}})})},o.prototype.cancelRecognitionLocal=function(s,a,u){return t(this,void 0,void 0,function(){return e(this,function(p){switch(p.label){case 0:return this.privRequestSession.isRecognizing?[4,this.privRequestSession.onStopRecognizing()]:[3,2];case 1:p.sent(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s,a,u),p.label=2;case 2:return[2]}})})},o.prototype.receiveMessage=function(){return t(this,void 0,void 0,function(){var s,a,u,p,v,g,h,d,y,m;return e(this,function(S){switch(S.label){case 0:return S.trys.push([0,18,,19]),this.privIsDisposed?[2]:[4,this.fetchConnection()];case 1:return s=S.sent(),[4,s.read()];case 2:if(a=S.sent(),this.receiveMessageOverride!==void 0)return[2,this.receiveMessageOverride()];if(!a)return this.privRequestSession.isRecognizing?[2,this.receiveMessage()]:[2];if(this.privServiceHasSentMessage=!0,u=f.SpeechConnectionMessage.fromConnectionMessage(a),u.requestId.toLowerCase()!==this.privRequestSession.requestId.toLowerCase())return[3,17];switch(p=u.path.toLowerCase(),p){case"turn.start":return[3,3];case"speech.startdetected":return[3,4];case"speech.enddetected":return[3,5];case"turn.end":return[3,6]}return[3,15];case 3:return this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse(),[3,17];case 4:return v=l.SpeechDetected.fromJSON(u.textBody),g=new i.RecognitionEventArgs(v.Offset,this.privRequestSession.sessionId),this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,g),[3,17];case 5:return h=void 0,u.textBody.length>0?h=u.textBody:h="{ Offset: 0 }",d=l.SpeechDetected.fromJSON(h),this.privRecognizerConfig.isContinuousRecognition&&this.privRequestSession.onServiceRecognized(d.Offset+this.privRequestSession.currentTurnAudioOffset),y=new i.RecognitionEventArgs(d.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,y),[3,17];case 6:return[4,this.sendTelemetryData()];case 7:return S.sent(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream?(this.privMustReportEndOfStream=!1,[4,this.cancelRecognitionLocal(i.CancellationReason.EndOfStream,i.CancellationErrorCode.NoError,void 0)]):[3,9];case 8:S.sent(),S.label=9;case 9:return m=new i.SessionEventArgs(this.privRequestSession.sessionId),[4,this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition)];case 10:return S.sent(),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing?(this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,m),[2]):[3,11];case 11:return[4,this.fetchConnection()];case 12:return s=S.sent(),[4,this.sendPrePayloadJSON(s)];case 13:S.sent(),S.label=14;case 14:return[3,17];case 15:return[4,this.processTypeSpecificMessages(u)];case 16:S.sent()||this.privServiceEvents&&this.serviceEvents.onEvent(new n.ServiceEvent(u.path.toLowerCase(),u.textBody)),S.label=17;case 17:return[2,this.receiveMessage()];case 18:return S.sent(),[2,null];case 19:return[2]}})})},o.prototype.sendPrePayloadJSON=function(s){return t(this,void 0,void 0,function(){return e(this,function(a){switch(a.label){case 0:return this.sendPrePayloadJSONOverride!==void 0?[2,this.sendPrePayloadJSONOverride(s)]:[4,this.sendSpeechContext(s)];case 1:return a.sent(),[4,this.sendWaveHeader(s)];case 2:return a.sent(),[2]}})})},o.prototype.sendWaveHeader=function(s){return t(this,void 0,void 0,function(){var a;return e(this,function(u){switch(u.label){case 0:return[4,this.audioSource.format];case 1:return a=u.sent(),[2,s.send(new f.SpeechConnectionMessage(n.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",a.header))]}})})},o.prototype.connectImpl=function(){var s=this;return this.privConnectionPromise?this.privConnectionPromise.then(function(a){return a.state()===n.ConnectionState.Disconnected?(s.privConnectionId=null,s.privConnectionPromise=null,s.privServiceHasSentMessage=!1,s.connectImpl()):s.privConnectionPromise},function(a){return s.privConnectionId=null,s.privConnectionPromise=null,s.privServiceHasSentMessage=!1,s.connectImpl()}):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(function(){}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)},o.prototype.fetchConnection=function(){return t(this,void 0,void 0,function(){var s=this;return e(this,function(a){switch(a.label){case 0:return this.privConnectionConfigurationPromise?[2,this.privConnectionConfigurationPromise.then(function(u){return u.state()===n.ConnectionState.Disconnected?(s.privConnectionId=null,s.privConnectionConfigurationPromise=null,s.privServiceHasSentMessage=!1,s.fetchConnection()):s.privConnectionConfigurationPromise},function(u){return s.privConnectionId=null,s.privConnectionConfigurationPromise=null,s.privServiceHasSentMessage=!1,s.fetchConnection()})]:(this.privConnectionConfigurationPromise=this.configureConnection(),[4,this.privConnectionConfigurationPromise]);case 1:return[2,a.sent()]}})})},o.prototype.sendAudio=function(s){return t(this,void 0,void 0,function(){var a,u,p,v,g,h,d=this;return e(this,function(y){switch(y.label){case 0:return[4,this.audioSource.format];case 1:return a=y.sent(),u=Date.now(),p=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),v=a.avgBytesPerSec/1e3*parseInt(p,10),g=this.privRequestSession.recogNumber,h=function(){return t(d,void 0,void 0,function(){var m,S,b,P,C=this;return e(this,function(R){switch(R.label){case 0:return!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===g?[4,this.fetchConnection()]:[3,5];case 1:return m=R.sent(),[4,s.read()];case 2:return S=R.sent(),this.privRequestSession.isSpeechEnded?[2]:(b=void 0,P=void 0,!S||S.isEnd?(b=null,P=0):(b=S.buffer,this.privRequestSession.onAudioSent(b.byteLength),v>=this.privRequestSession.bytesSent?P=0:P=Math.max(0,u-Date.now())),P===0?[3,4]:[4,this.delay(P)]);case 3:R.sent(),R.label=4;case 4:if(b!==null&&(u=Date.now()+b.byteLength*1e3/(a.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===g)if(m.send(new f.SpeechConnectionMessage(n.MessageType.Binary,"audio",this.privRequestSession.requestId,null,b)).catch(function(){C.privRequestSession.onServiceTurnEndResponse(C.privRecognizerConfig.isContinuousRecognition).catch(function(){})}),S!=null&&S.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return[2,h()];R.label=5;case 5:return[2]}})})},[2,h()]}})})},o.prototype.retryableConnect=function(){return t(this,void 0,void 0,function(){var s,a,u,p,v,g,h,d,y=this;return e(this,function(m){switch(m.label){case 0:s=!1,this.privAuthFetchEventId=n.createNoDashGuid(),a=this.privRequestSession.sessionId,this.privConnectionId=a!==void 0?a:n.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId),u=0,p="",m.label=1;case 1:return this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount?(v=s?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId),[4,v]):[3,8];case 2:return g=m.sent(),[4,this.privRequestSession.onAuthCompleted(!1)];case 3:return m.sent(),h=this.privConnectionFactory.create(this.privRecognizerConfig,g,this.privConnectionId),this.privRequestSession.listenForServiceTelemetry(h.events),h.events.attach(function(S){y.connectionEvents.onEvent(S)}),[4,h.open()];case 4:return d=m.sent(),d.statusCode!==200?[3,6]:[4,this.privRequestSession.onConnectionEstablishCompleted(d.statusCode)];case 5:return m.sent(),[2,Promise.resolve(h)];case 6:d.statusCode===1006&&(s=!0),m.label=7;case 7:return u=d.statusCode,p=d.reason,this.privRequestSession.onRetryConnection(),[3,1];case 8:return[4,this.privRequestSession.onConnectionEstablishCompleted(u,p)];case 9:return m.sent(),[2,Promise.reject("Unable to contact server. StatusCode: "+u+", "+this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint)+" Reason: "+p)]}})})},o.prototype.delay=function(s){var a=this;return new Promise(function(u,p){a.privSetTimeout(u,s)})},o.prototype.writeBufferToConsole=function(s){var a="Buffer Size: ";if(s===null)a+="null";else{var u=new Uint8Array(s);a+=s.byteLength+`\r
`;for(var p=0;p<s.byteLength;p++)a+=u[p].toString(16).padStart(2,"0")+" "}console.info(a)},o.prototype.sendFinalAudio=function(){return t(this,void 0,void 0,function(){var s;return e(this,function(a){switch(a.label){case 0:return[4,this.fetchConnection()];case 1:return s=a.sent(),[4,s.send(new f.SpeechConnectionMessage(n.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))];case 2:return a.sent(),[2]}})})},o.prototype.configureConnection=function(){return t(this,void 0,void 0,function(){var s;return e(this,function(a){switch(a.label){case 0:return[4,this.connectImpl()];case 1:return s=a.sent(),this.configConnectionOverride!==void 0?[2,this.configConnectionOverride(s)]:[4,this.sendSpeechServiceConfig(s,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize())];case 2:return a.sent(),[4,this.sendPrePayloadJSON(s)];case 3:return a.sent(),[2,s]}})})},o.telemetryDataEnabled=!0,o}();return qo.ServiceRecognizerBase=c,qo}var tv={},NP;function Z5(){return NP||(NP=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.type=t.connectivity=t.Device=t.OS=t.System=t.Context=t.SpeechServiceConfig=t.RecognizerConfig=t.SpeechResultFormat=t.RecognitionMode=void 0;var e=F(),r;(function(s){s[s.Interactive=0]="Interactive",s[s.Conversation=1]="Conversation",s[s.Dictation=2]="Dictation"})(r=t.RecognitionMode||(t.RecognitionMode={})),function(s){s[s.Simple=0]="Simple",s[s.Detailed=1]="Detailed"}(t.SpeechResultFormat||(t.SpeechResultFormat={}));var n=function(){function s(a,u){this.privRecognitionMode=r.Interactive,this.privSpeechServiceConfig=a||new i(new l(null)),this.privParameters=u,this.privMaxRetryCount=parseInt(u.getProperty("SPEECH-Error-MaxRetryCount","4"),10)}return Object.defineProperty(s.prototype,"parameters",{get:function(){return this.privParameters},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"recognitionMode",{get:function(){return this.privRecognitionMode},set:function(a){this.privRecognitionMode=a,this.privRecognitionActivityTimeout=a===r.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=r[a]},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"SpeechServiceConfig",{get:function(){return this.privSpeechServiceConfig},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"recognitionActivityTimeout",{get:function(){return this.privRecognitionActivityTimeout},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isContinuousRecognition",{get:function(){return this.privRecognitionMode!==r.Interactive},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"autoDetectSourceLanguages",{get:function(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"maxRetryCount",{get:function(){return this.privMaxRetryCount},enumerable:!1,configurable:!0}),s}();t.RecognizerConfig=n;var i=function(){function s(a){var u=this;this.serialize=function(){return JSON.stringify(u,function(p,v){if(v&&typeof v=="object"){var g={};for(var h in v)Object.hasOwnProperty.call(v,h)&&(g[h&&h.charAt(0).toLowerCase()+h.substring(1)]=v[h]);return g}return v})},this.context=a}return Object.defineProperty(s.prototype,"Context",{get:function(){return this.context},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"Recognition",{get:function(){return this.recognition},set:function(a){this.recognition=a.toLowerCase()},enumerable:!1,configurable:!0}),s}();t.SpeechServiceConfig=i;var l=function(){function s(a){this.system=new f,this.os=a}return s}();t.Context=l;var f=function(){function s(){var a="1.17.0";this.name="SpeechSDK",this.version=a,this.build="JavaScript",this.lang="JavaScript"}return s}();t.System=f;var c=function(){function s(a,u,p){this.platform=a,this.name=u,this.version=p}return s}();t.OS=c;var o=function(){function s(a,u,p){this.manufacturer=a,this.model=u,this.version=p}return s}();t.Device=o,function(s){s.Bluetooth="Bluetooth",s.Wired="Wired",s.WiFi="WiFi",s.Cellular="Cellular",s.InBuilt="InBuilt",s.Unknown="Unknown"}(t.connectivity||(t.connectivity={})),function(s){s.Phone="Phone",s.Speaker="Speaker",s.Car="Car",s.Headset="Headset",s.Thermostat="Thermostat",s.Microphones="Microphones",s.Deskphone="Deskphone",s.RemoteControl="RemoteControl",s.Unknown="Unknown",s.File="File",s.Stream="Stream"}(t.type||(t.type={}))}(tv)),tv}var rv={},LP;function e7(){return LP||(LP=1,Object.defineProperty(rv,"__esModule",{value:!0})),rv}var Uo={},BP;function t7(){if(BP)return Uo;BP=1,Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.WebsocketMessageFormatter=void 0;var t=K(),e=`\r
`,r=function(){function n(){var i=this;this.toConnectionMessage=function(l){var f=new t.Deferred;try{if(l.messageType===t.MessageType.Text){var c=l.textContent,o={},s=null;if(c){var a=c.split(`\r
\r
`);a&&a.length>0&&(o=i.parseHeaders(a[0]),a.length>1&&(s=a[1]))}f.resolve(new t.ConnectionMessage(l.messageType,s,o,l.id))}else if(l.messageType===t.MessageType.Binary){var u=l.binaryContent,o={},s=null;if(!u||u.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");var p=new DataView(u),v=p.getInt16(0);if(u.byteLength<v+2)throw new Error("Invalid binary message format. Header content missing.");for(var g="",h=0;h<v;h++)g+=String.fromCharCode(p.getInt8(h+2));o=i.parseHeaders(g),u.byteLength>v+2&&(s=u.slice(2+v)),f.resolve(new t.ConnectionMessage(l.messageType,s,o,l.id))}}catch(d){f.reject("Error formatting the message. Error: "+d)}return f.promise},this.fromConnectionMessage=function(l){var f=new t.Deferred;try{if(l.messageType===t.MessageType.Text){var c=""+i.makeHeaders(l)+e+(l.textBody?l.textBody:"");f.resolve(new t.RawWebsocketMessage(t.MessageType.Text,c,l.id))}else if(l.messageType===t.MessageType.Binary){var o=i.makeHeaders(l),s=l.binaryBody,a=i.stringToArrayBuffer(o),u=new Int8Array(a),p=u.byteLength,v=new Int8Array(2+p+(s?s.byteLength:0));if(v[0]=p>>8&255,v[1]=p&255,v.set(u,2),s){var g=new Int8Array(s);v.set(g,2+p)}var c=v.buffer;f.resolve(new t.RawWebsocketMessage(t.MessageType.Binary,c,l.id))}}catch(h){f.reject("Error formatting the message. "+h)}return f.promise},this.makeHeaders=function(l){var f="";if(l.headers)for(var c in l.headers)c&&(f+=c+": "+l.headers[c]+e);return f},this.parseHeaders=function(l){var f={};if(l){var c=l.match(/[^\r\n]+/g);if(f)for(var o=0,s=c;o<s.length;o++){var a=s[o];if(a){var u=a.indexOf(":"),p=u>0?a.substr(0,u).trim().toLowerCase():a,v=u>0&&a.length>u+1?a.substr(u+1).trim():"";f[p]=v}}}return f},this.stringToArrayBuffer=function(l){for(var f=new ArrayBuffer(l.length),c=new DataView(f),o=0;o<l.length;o++)c.setUint8(o,l.charCodeAt(o));return f}}return n}();return Uo.WebsocketMessageFormatter=r,Uo}var Vo={},qP;function r7(){if(qP)return Vo;qP=1;var t=w&&w.__extends||function(){var s=function(a,u){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,v){p.__proto__=v}||function(p,v){for(var g in v)v.hasOwnProperty(g)&&(p[g]=v[g])},s(a,u)};return function(a,u){s(a,u);function p(){this.constructor=a}a.prototype=u===null?Object.create(u):(p.prototype=u.prototype,new p)}}();Object.defineProperty(Vo,"__esModule",{value:!0}),Vo.SpeechConnectionFactory=void 0;var e=yt(),r=H(),n=F(),i=Vn(),l=H(),f=Lt(),c=Un(),o=function(s){t(a,s);function a(){var u=s!==null&&s.apply(this,arguments)||this;return u.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",u.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",u.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",u.create=function(p,v,g){var h=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,void 0),d=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region,void 0),y=d&&d.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",m=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"wss://"+d+".stt.speech"+y),S={},b=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,void 0),P=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(b?(!h||h.search(c.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(S[c.QueryParameterNames.CustomSpeechDeploymentId]=b):P&&(!h||h.search(c.QueryParameterNames.Language)===-1)&&(S[c.QueryParameterNames.Language]=P),(!h||h.search(c.QueryParameterNames.Format)===-1)&&(S[c.QueryParameterNames.Format]=p.parameters.getProperty(r.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple]).toLowerCase()),p.autoDetectSourceLanguages!==void 0&&(S[c.QueryParameterNames.EnableLanguageId]="true"),u.setCommonUrlParams(p,S,h),!h)switch(p.recognitionMode){case l.RecognitionMode.Conversation:p.parameters.getProperty(r.ForceDictationPropertyName,"false")==="true"?h=m+u.dictationRelativeUri:h=m+u.conversationRelativeUri;break;case l.RecognitionMode.Dictation:h=m+u.dictationRelativeUri;break;default:h=m+u.interactiveRelativeUri;break}var C={};v.token!==void 0&&v.token!==""&&(C[v.headerName]=v.token),C[f.HeaderNames.ConnectionId]=g,p.parameters.setProperty(n.PropertyId.SpeechServiceConnection_Url,h);var R=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(h,S,C,new l.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),R,g)},u}return a}(i.ConnectionFactoryBase);return Vo.SpeechConnectionFactory=o,Vo}var Wo={},FP;function n7(){if(FP)return Wo;FP=1;var t=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}();Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.TranscriberConnectionFactory=void 0;var e=yt(),r=F(),n=Vn(),i=H(),l=Lt(),f=Un(),c=function(o){t(s,o);function s(){var a=o!==null&&o.apply(this,arguments)||this;return a.multiaudioRelativeUri="/speech/recognition/multiaudio",a.create=function(u,p,v){var g=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0),h=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,"centralus"),d=h&&h.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",y="wss://transcribe."+h+".cts.speech"+d+a.multiaudioRelativeUri,m=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,y),S={},b=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId,void 0),P=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);b?(!g||g.search(f.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(S[f.QueryParameterNames.CustomSpeechDeploymentId]=b):P&&(!g||g.search(f.QueryParameterNames.Language)===-1)&&(S[f.QueryParameterNames.Language]=P),a.setCommonUrlParams(u,S,g),g||(g=m);var C={};p.token!==void 0&&p.token!==""&&(C[p.headerName]=p.token),C[l.HeaderNames.ConnectionId]=v,u.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,g);var R=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(g,S,C,new i.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),R,v)},a}return s}(n.ConnectionFactoryBase);return Wo.TranscriberConnectionFactory=c,Wo}var Ho={},UP;function i7(){if(UP)return Ho;UP=1;var t=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}();Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.TranslationConnectionFactory=void 0;var e=yt(),r=F(),n=Vn(),i=H(),l=Lt(),f=Un(),c=function(o){t(s,o);function s(){var a=o!==null&&o.apply(this,arguments)||this;return a.create=function(u,p,v){var g=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!g){var h=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,void 0),d=h&&h.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",y=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+h+".s2s.speech"+d);g=y+"/speech/translation/cognitiveservices/v1"}var m={from:u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage),to:u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages)};a.setCommonUrlParams(u,m,g),a.setUrlParameter(r.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,f.QueryParameterNames.StableTranslation,u,m,g);var S="voice",b="features";u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(m[S]=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice),m[b]="texttospeech");var P={};p.token!==void 0&&p.token!==""&&(P[p.headerName]=p.token),P[l.HeaderNames.ConnectionId]=v,u.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,g);var C=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(g,m,P,new i.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),C,v)},a}return s}(n.ConnectionFactoryBase);return Ho.TranslationConnectionFactory=c,Ho}var Ko={},VP;function o7(){if(VP)return Ko;VP=1,Object.defineProperty(Ko,"__esModule",{value:!0}),Ko.SpeechSynthesisConnectionFactory=void 0;var t=yt(),e=F(),r=H(),n=Lt(),i=Un(),l=function(){function f(){var c=this;this.synthesisUri="/cognitiveservices/websocket/v1",this.create=function(o,s,a){var u=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0),p=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),v=p&&p.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",g=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),h=g===void 0?"tts":"voice",d=o.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+p+"."+h+".speech"+v),y={};u||(u=d+c.synthesisUri);var m={};s.token!==void 0&&s.token!==""&&(m[s.headerName]=s.token),m[n.HeaderNames.ConnectionId]=a,g!==void 0&&(m[i.QueryParameterNames.CustomVoiceDeploymentId]=g),o.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,u);var S=o.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new t.WebsocketConnection(u,y,m,new r.WebsocketMessageFormatter,t.ProxyInfo.fromParameters(o.parameters),S,a)}}return f}();return Ko.SpeechSynthesisConnectionFactory=l,Ko}var Go={},WP;function s7(){if(WP)return Go;WP=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.EnumTranslation=void 0;var t=F(),e=H(),r=function(){function n(){}return n.implTranslateRecognitionResult=function(i){var l=t.ResultReason.Canceled;switch(i){case e.RecognitionStatus.Success:l=t.ResultReason.RecognizedSpeech;break;case e.RecognitionStatus.NoMatch:case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:case e.RecognitionStatus.EndOfDictation:l=t.ResultReason.NoMatch;break;case e.RecognitionStatus.Error:default:l=t.ResultReason.Canceled;break}return l},n.implTranslateCancelResult=function(i){var l=t.CancellationReason.EndOfStream;switch(i){case e.RecognitionStatus.Success:case e.RecognitionStatus.EndOfDictation:case e.RecognitionStatus.NoMatch:l=t.CancellationReason.EndOfStream;break;case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:case e.RecognitionStatus.Error:default:l=t.CancellationReason.Error;break}return l},n.implTranslateCancelErrorCode=function(i){var l=t.CancellationErrorCode.NoError;switch(i){case e.RecognitionStatus.Error:l=t.CancellationErrorCode.ServiceError;break;case e.RecognitionStatus.TooManyRequests:l=t.CancellationErrorCode.TooManyRequests;break;default:l=t.CancellationErrorCode.NoError;break}return l},n}();return Go.EnumTranslation=r,Go}var nv={},HP;function a7(){return HP||(HP=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.RecognitionStatus=t.SynthesisStatus=void 0,function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(t.SynthesisStatus||(t.SynthesisStatus={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests"}(t.RecognitionStatus||(t.RecognitionStatus={}))}(nv)),nv}var Jo={},KP;function c7(){if(KP)return Jo;KP=1,Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.TranslationSynthesisEnd=void 0;var t=H(),e=function(){function r(n){this.privSynthesisEnd=JSON.parse(n),this.privSynthesisEnd.SynthesisStatus=t.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"SynthesisStatus",{get:function(){return this.privSynthesisEnd.SynthesisStatus},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"FailureReason",{get:function(){return this.privSynthesisEnd.FailureReason},enumerable:!1,configurable:!0}),r}();return Jo.TranslationSynthesisEnd=e,Jo}var Qo={},GP;function u7(){if(GP)return Qo;GP=1,Object.defineProperty(Qo,"__esModule",{value:!0}),Qo.TranslationHypothesis=void 0;var t=Vd(),e=function(){function r(n){this.privTranslationHypothesis=JSON.parse(n),this.privTranslationHypothesis.Translation.TranslationStatus=t.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus]}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"Duration",{get:function(){return this.privTranslationHypothesis.Duration},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Offset",{get:function(){return this.privTranslationHypothesis.Offset},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Text",{get:function(){return this.privTranslationHypothesis.Text},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Translation",{get:function(){return this.privTranslationHypothesis.Translation},enumerable:!1,configurable:!0}),r}();return Qo.TranslationHypothesis=e,Qo}var Yo={},JP;function p7(){if(JP)return Yo;JP=1,Object.defineProperty(Yo,"__esModule",{value:!0}),Yo.TranslationPhrase=void 0;var t=H(),e=Vd(),r=function(){function n(i){this.privTranslationPhrase=JSON.parse(i),this.privTranslationPhrase.RecognitionStatus=t.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus],this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=e.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus])}return n.fromJSON=function(i){return new n(i)},Object.defineProperty(n.prototype,"RecognitionStatus",{get:function(){return this.privTranslationPhrase.RecognitionStatus},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Offset",{get:function(){return this.privTranslationPhrase.Offset},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Duration",{get:function(){return this.privTranslationPhrase.Duration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Text",{get:function(){return this.privTranslationPhrase.Text},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Translation",{get:function(){return this.privTranslationPhrase.Translation},enumerable:!1,configurable:!0}),n}();return Yo.TranslationPhrase=r,Yo}var Xo={},QP;function f7(){if(QP)return Xo;QP=1;var t=w&&w.__extends||function(){var c=function(o,s){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,u){a.__proto__=u}||function(a,u){for(var p in u)u.hasOwnProperty(p)&&(a[p]=u[p])},c(o,s)};return function(o,s){c(o,s);function a(){this.constructor=o}o.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}(),e=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},r=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.TranslationServiceRecognizer=void 0;var n=K(),i=F(),l=H(),f=function(c){t(o,c);function o(s,a,u,p,v){var g=c.call(this,s,a,u,p,v)||this;return g.privTranslationRecognizer=v,g.connectionEvents.attach(function(h){return e(g,void 0,void 0,function(){return r(this,function(d){switch(d.label){case 0:return h.name!=="ConnectionEstablishedEvent"?[3,1]:(this.privTranslationRecognizer.onConnection(),[3,3]);case 1:return h.name!=="ConnectionClosedEvent"?[3,3]:[4,this.privTranslationRecognizer.onDisconnection()];case 2:d.sent(),d.label=3;case 3:return[2]}})})}),g}return o.prototype.processTypeSpecificMessages=function(s){return e(this,void 0,void 0,function(){var a,u,p,v,g,h,d,y,m,S,b,P,C,R;return r(this,function(O){switch(O.label){case 0:switch(a=new i.PropertyCollection,u=!1,s.messageType===n.MessageType.Text&&a.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,s.textBody),p=s.path.toLowerCase(),p){case"translation.hypothesis":return[3,1];case"translation.phrase":return[3,2];case"translation.synthesis":return[3,7];case"translation.synthesis.end":return[3,8]}return[3,9];case 1:if(v=this.fireEventForResult(l.TranslationHypothesis.fromJSON(s.textBody),a),this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+v.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,v)}catch{}return u=!0,[3,10];case 2:if(g=l.TranslationPhrase.fromJSON(s.textBody),this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+g.Offset+g.Duration),g.RecognitionStatus!==l.RecognitionStatus.Success)return[3,3];if(h=this.fireEventForResult(g,a),this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,h)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(h.result)}catch(z){this.privErrorCallback&&this.privErrorCallback(z)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}return[3,10];case 3:return d=l.EnumTranslation.implTranslateRecognitionResult(g.RecognitionStatus),y=new i.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,d,g.Text,g.Duration,this.privRequestSession.currentTurnAudioOffset+g.Offset,void 0,s.textBody,a),d!==i.ResultReason.Canceled?[3,5]:(m=l.EnumTranslation.implTranslateCancelResult(g.RecognitionStatus),[4,this.cancelRecognitionLocal(m,l.EnumTranslation.implTranslateCancelErrorCode(g.RecognitionStatus),void 0)]);case 4:return O.sent(),[3,6];case 5:if(!(this.privRequestSession.isSpeechEnded&&d===i.ResultReason.NoMatch&&g.RecognitionStatus!==l.RecognitionStatus.InitialSilenceTimeout)&&(S=new i.TranslationRecognitionEventArgs(y,y.offset,this.privRequestSession.sessionId),this.privTranslationRecognizer.recognized))try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,S)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(y)}catch(z){this.privErrorCallback&&this.privErrorCallback(z)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}O.label=6;case 6:return u=!0,[3,10];case 7:return this.sendSynthesisAudio(s.binaryBody,this.privRequestSession.sessionId),u=!0,[3,10];case 8:switch(b=l.TranslationSynthesisEnd.fromJSON(s.textBody),b.SynthesisStatus){case l.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){P=new i.TranslationSynthesisResult(i.ResultReason.Canceled,void 0),C=new i.TranslationSynthesisEventArgs(P,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,C)}catch{}}if(this.privTranslationRecognizer.canceled){R=new i.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,i.CancellationReason.Error,b.FailureReason,i.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,R)}catch{}}break;case l.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}return u=!0,[3,10];case 9:return[3,10];case 10:return[2,u]}})})},o.prototype.cancelRecognition=function(s,a,u,p,v){var g=new i.PropertyCollection;if(g.setProperty(l.CancellationErrorCodePropertyName,i.CancellationErrorCode[p]),this.privTranslationRecognizer.canceled){var h=new i.TranslationRecognitionCanceledEventArgs(s,u,v,p,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,h)}catch{}}if(this.privSuccessCallback){var d=new i.TranslationRecognitionResult(void 0,a,i.ResultReason.Canceled,void 0,void 0,void 0,v,void 0,g);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}},o.prototype.fireEventForResult=function(s,a){var u;if(s.Translation.Translations!==void 0){u=new i.Translations;for(var p=0,v=s.Translation.Translations;p<v.length;p++){var g=v[p];u.set(g.Language,g.Text)}}var h;s instanceof l.TranslationPhrase?s.Translation.TranslationStatus===n.TranslationStatus.Success?h=i.ResultReason.TranslatedSpeech:h=i.ResultReason.RecognizedSpeech:h=i.ResultReason.TranslatingSpeech;var d=s.Offset+this.privRequestSession.currentTurnAudioOffset,y=new i.TranslationRecognitionResult(u,this.privRequestSession.requestId,h,s.Text,s.Duration,d,s.Translation.FailureReason,JSON.stringify(s),a),m=new i.TranslationRecognitionEventArgs(y,d,this.privRequestSession.sessionId);return m},o.prototype.sendSynthesisAudio=function(s,a){var u=s===void 0?i.ResultReason.SynthesizingAudioCompleted:i.ResultReason.SynthesizingAudio,p=new i.TranslationSynthesisResult(u,s),v=new i.TranslationSynthesisEventArgs(p,a);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,v)}catch{}},o}(l.ServiceRecognizerBase);return Xo.TranslationServiceRecognizer=f,Xo}var Zo={},YP;function l7(){if(YP)return Zo;YP=1,Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.SpeechDetected=void 0;var t=function(){function e(r){this.privSpeechStartDetected=JSON.parse(r)}return e.fromJSON=function(r){return new e(r)},Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSpeechStartDetected.Offset},enumerable:!1,configurable:!0}),e}();return Zo.SpeechDetected=t,Zo}var es={},XP;function v7(){if(XP)return es;XP=1,Object.defineProperty(es,"__esModule",{value:!0}),es.SpeechHypothesis=void 0;var t=function(){function e(r){this.privSpeechHypothesis=JSON.parse(r)}return e.fromJSON=function(r){return new e(r)},Object.defineProperty(e.prototype,"Text",{get:function(){return this.privSpeechHypothesis.Text},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSpeechHypothesis.Offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privSpeechHypothesis.Duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Language",{get:function(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LanguageDetectionConfidence",{get:function(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SpeakerId",{get:function(){return this.privSpeechHypothesis.SpeakerId},enumerable:!1,configurable:!0}),e}();return es.SpeechHypothesis=t,es}var ts={},ZP;function h7(){if(ZP)return ts;ZP=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.SpeechKeyword=void 0;var t=function(){function e(r){this.privSpeechKeyword=JSON.parse(r)}return e.fromJSON=function(r){return new e(r)},Object.defineProperty(e.prototype,"Status",{get:function(){return this.privSpeechKeyword.Status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.privSpeechKeyword.Text},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSpeechKeyword.Offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privSpeechKeyword.Duration},enumerable:!1,configurable:!0}),e}();return ts.SpeechKeyword=t,ts}var rs={},ew;function d7(){if(ew)return rs;ew=1;var t=w&&w.__extends||function(){var f=function(c,o){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var u in a)a.hasOwnProperty(u)&&(s[u]=a[u])},f(c,o)};return function(c,o){f(c,o);function s(){this.constructor=c}c.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}}(),e=w&&w.__awaiter||function(f,c,o,s){function a(u){return u instanceof o?u:new o(function(p){p(u)})}return new(o||(o=Promise))(function(u,p){function v(d){try{h(s.next(d))}catch(y){p(y)}}function g(d){try{h(s.throw(d))}catch(y){p(y)}}function h(d){d.done?u(d.value):a(d.value).then(v,g)}h((s=s.apply(f,c||[])).next())})},r=w&&w.__generator||function(f,c){var o={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,a,u,p;return p={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function v(h){return function(d){return g([h,d])}}function g(h){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,a&&(u=h[0]&2?a.return:h[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,h[1])).done)return u;switch(a=0,u&&(h=[h[0]&2,u.value]),h[0]){case 0:case 1:u=h;break;case 4:return o.label++,{value:h[1],done:!1};case 5:o.label++,a=h[1],h=[0];continue;case 7:h=o.ops.pop(),o.trys.pop();continue;default:if(u=o.trys,!(u=u.length>0&&u[u.length-1])&&(h[0]===6||h[0]===2)){o=0;continue}if(h[0]===3&&(!u||h[1]>u[0]&&h[1]<u[3])){o.label=h[1];break}if(h[0]===6&&o.label<u[1]){o.label=u[1],u=h;break}if(u&&o.label<u[2]){o.label=u[2],o.ops.push(h);break}u[2]&&o.ops.pop(),o.trys.pop();continue}h=c.call(f,o)}catch(d){h=[6,d],a=0}finally{s=u=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}};Object.defineProperty(rs,"__esModule",{value:!0}),rs.SpeechServiceRecognizer=void 0;var n=F(),i=H(),l=function(f){t(c,f);function c(o,s,a,u,p){var v=f.call(this,o,s,a,u,p)||this;if(v.privSpeechRecognizer=p,u.autoDetectSourceLanguages!==void 0){var g=u.autoDetectSourceLanguages.split(",");v.privSpeechContext.setSection("languageId",{languages:g,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),v.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}})}return v}return c.prototype.processTypeSpecificMessages=function(o){return e(this,void 0,void 0,function(){var s,a,u,p,v,g,h,d,y,m,S,b;return r(this,function(P){switch(P.label){case 0:switch(a=new n.PropertyCollection,a.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,o.textBody),u=!1,p=o.path.toLowerCase(),p){case"speech.hypothesis":return[3,1];case"speech.fragment":return[3,1];case"speech.phrase":return[3,2]}return[3,6];case 1:if(v=i.SpeechHypothesis.fromJSON(o.textBody),g=v.Offset+this.privRequestSession.currentTurnAudioOffset,s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,n.ResultReason.RecognizingSpeech,v.Text,v.Duration,g,v.Language,v.LanguageDetectionConfidence,void 0,void 0,o.textBody,a),this.privRequestSession.onHypothesis(g),h=new n.SpeechRecognitionEventArgs(s,v.Duration,this.privRequestSession.sessionId),this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,h)}catch{}return u=!0,[3,7];case 2:return d=i.SimpleSpeechPhrase.fromJSON(o.textBody),y=i.EnumTranslation.implTranslateRecognitionResult(d.RecognitionStatus),this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+d.Offset+d.Duration),n.ResultReason.Canceled!==y?[3,4]:(m=i.EnumTranslation.implTranslateCancelResult(d.RecognitionStatus),[4,this.cancelRecognitionLocal(m,i.EnumTranslation.implTranslateCancelErrorCode(d.RecognitionStatus),void 0)]);case 3:return P.sent(),[3,5];case 4:if(!(this.privRequestSession.isSpeechEnded&&y===n.ResultReason.NoMatch&&d.RecognitionStatus!==i.RecognitionStatus.InitialSilenceTimeout)&&(this.privRecognizerConfig.parameters.getProperty(i.OutputFormatPropertyName)===n.OutputFormat[n.OutputFormat.Simple]?s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,y,d.DisplayText,d.Duration,d.Offset+this.privRequestSession.currentTurnAudioOffset,d.Language,d.LanguageDetectionConfidence,void 0,void 0,o.textBody,a):(S=i.DetailedSpeechPhrase.fromJSON(o.textBody),s=new n.SpeechRecognitionResult(this.privRequestSession.requestId,y,S.RecognitionStatus===i.RecognitionStatus.Success?S.NBest[0].Display:void 0,S.Duration,S.Offset+this.privRequestSession.currentTurnAudioOffset,S.Language,S.LanguageDetectionConfidence,void 0,void 0,o.textBody,a)),b=new n.SpeechRecognitionEventArgs(s,s.offset,this.privRequestSession.sessionId),this.privSpeechRecognizer.recognized))try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,b)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(C){this.privErrorCallback&&this.privErrorCallback(C)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}P.label=5;case 5:return u=!0,[3,7];case 6:return[3,7];case 7:return[2,u]}})})},c.prototype.cancelRecognition=function(o,s,a,u,p){var v=new n.PropertyCollection;if(v.setProperty(i.CancellationErrorCodePropertyName,n.CancellationErrorCode[u]),this.privSpeechRecognizer.canceled){var g=new n.SpeechRecognitionCanceledEventArgs(a,p,u,void 0,o);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,g)}catch{}}if(this.privSuccessCallback){var h=new n.SpeechRecognitionResult(s,n.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,p,void 0,v);try{this.privSuccessCallback(h),this.privSuccessCallback=void 0}catch{}}},c}(i.ServiceRecognizerBase);return rs.SpeechServiceRecognizer=l,rs}var ns={},tw;function g7(){if(tw)return ns;tw=1;var t=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}(),e=w&&w.__awaiter||function(o,s,a,u){function p(v){return v instanceof a?v:new a(function(g){g(v)})}return new(a||(a=Promise))(function(v,g){function h(m){try{y(u.next(m))}catch(S){g(S)}}function d(m){try{y(u.throw(m))}catch(S){g(S)}}function y(m){m.done?v(m.value):p(m.value).then(h,d)}y((u=u.apply(o,s||[])).next())})},r=w&&w.__generator||function(o,s){var a={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},u,p,v,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(y){return function(m){return d([y,m])}}function d(y){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,p&&(v=y[0]&2?p.return:y[0]?p.throw||((v=p.return)&&v.call(p),0):p.next)&&!(v=v.call(p,y[1])).done)return v;switch(p=0,v&&(y=[y[0]&2,v.value]),y[0]){case 0:case 1:v=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,p=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(v=a.trys,!(v=v.length>0&&v[v.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!v||y[1]>v[0]&&y[1]<v[3])){a.label=y[1];break}if(y[0]===6&&a.label<v[1]){a.label=v[1],v=y;break}if(v&&a.label<v[2]){a.label=v[2],a.ops.push(y);break}v[2]&&a.ops.pop(),a.trys.pop();continue}y=s.call(o,a)}catch(m){y=[6,m],p=0}finally{u=v=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(ns,"__esModule",{value:!0}),ns.TranscriptionServiceRecognizer=void 0;var n=K(),i=F(),l=H(),f=vp(),c=function(o){t(s,o);function s(a,u,p,v,g){var h=o.call(this,a,u,p,v,g)||this;return h.sendSpeechEvent=function(d,y){var m=JSON.stringify(y);if(m)return d.send(new f.SpeechConnectionMessage(n.MessageType.Text,"speech.event",h.privRequestSession.requestId,"application/json",m))},h.privTranscriberRecognizer=g,h.sendPrePayloadJSONOverride=h.sendTranscriptionStartJSON,h}return s.prototype.sendSpeechEventAsync=function(a,u){return e(this,void 0,void 0,function(){var p;return r(this,function(v){switch(v.label){case 0:return this.privRequestSession.isRecognizing?[4,this.fetchConnection()]:[3,3];case 1:return p=v.sent(),[4,this.sendSpeechEvent(p,this.createSpeechEventPayload(a,u))];case 2:v.sent(),v.label=3;case 3:return[2]}})})},s.prototype.processTypeSpecificMessages=function(a){return e(this,void 0,void 0,function(){var u,p,v,g,h,d,y,m,S,b,P,C;return r(this,function(R){switch(R.label){case 0:switch(p=new i.PropertyCollection,p.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),v=!1,g=a.path.toLowerCase(),g){case"speech.hypothesis":return[3,1];case"speech.fragment":return[3,1];case"speech.phrase":return[3,2]}return[3,6];case 1:if(h=l.SpeechHypothesis.fromJSON(a.textBody),d=h.Offset+this.privRequestSession.currentTurnAudioOffset,u=new i.SpeechRecognitionResult(this.privRequestSession.requestId,i.ResultReason.RecognizingSpeech,h.Text,h.Duration,d,h.Language,h.LanguageDetectionConfidence,h.SpeakerId,void 0,a.textBody,p),this.privRequestSession.onHypothesis(d),y=new i.SpeechRecognitionEventArgs(u,h.Duration,this.privRequestSession.sessionId),this.privTranscriberRecognizer.recognizing)try{this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,y)}catch{}return v=!0,[3,7];case 2:return m=l.SimpleSpeechPhrase.fromJSON(a.textBody),S=l.EnumTranslation.implTranslateRecognitionResult(m.RecognitionStatus),this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+m.Offset+m.Duration),i.ResultReason.Canceled!==S?[3,4]:(b=l.EnumTranslation.implTranslateCancelResult(m.RecognitionStatus),[4,this.cancelRecognitionLocal(b,l.EnumTranslation.implTranslateCancelErrorCode(m.RecognitionStatus),void 0)]);case 3:return R.sent(),[3,5];case 4:if(!(this.privRequestSession.isSpeechEnded&&S===i.ResultReason.NoMatch&&m.RecognitionStatus!==l.RecognitionStatus.InitialSilenceTimeout)&&(this.privRecognizerConfig.parameters.getProperty(l.OutputFormatPropertyName)===i.OutputFormat[i.OutputFormat.Simple]?u=new i.SpeechRecognitionResult(this.privRequestSession.requestId,S,m.DisplayText,m.Duration,m.Offset+this.privRequestSession.currentTurnAudioOffset,m.Language,m.LanguageDetectionConfidence,m.SpeakerId,void 0,a.textBody,p):(P=l.DetailedSpeechPhrase.fromJSON(a.textBody),u=new i.SpeechRecognitionResult(this.privRequestSession.requestId,S,P.RecognitionStatus===l.RecognitionStatus.Success?P.NBest[0].Display:void 0,P.Duration,P.Offset+this.privRequestSession.currentTurnAudioOffset,P.Language,P.LanguageDetectionConfidence,void 0,void 0,a.textBody,p)),C=new i.SpeechRecognitionEventArgs(u,u.offset,this.privRequestSession.sessionId),this.privTranscriberRecognizer.recognized))try{this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,C)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(u)}catch(O){this.privErrorCallback&&this.privErrorCallback(O)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}R.label=5;case 5:return v=!0,[3,7];case 6:return[3,7];case 7:return[2,v]}})})},s.prototype.cancelRecognition=function(a,u,p,v,g){var h=new i.PropertyCollection;if(h.setProperty(l.CancellationErrorCodePropertyName,i.CancellationErrorCode[v]),this.privTranscriberRecognizer.canceled){var d=new i.ConversationTranscriptionCanceledEventArgs(p,g,v,void 0,a);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,d)}catch{}}if(this.privSuccessCallback){var y=new i.SpeechRecognitionResult(u,i.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,g,void 0,h);try{this.privSuccessCallback(y),this.privSuccessCallback=void 0}catch{}}},s.prototype.sendTranscriptionStartJSON=function(a){return e(this,void 0,void 0,function(){var u,p;return r(this,function(v){switch(v.label){case 0:return[4,this.sendSpeechContext(a)];case 1:return v.sent(),u=this.privTranscriberRecognizer.getConversationInfo(),p=this.createSpeechEventPayload(u,"start"),[4,this.sendSpeechEvent(a,p)];case 2:return v.sent(),[4,this.sendWaveHeader(a)];case 3:return v.sent(),[2]}})})},s.prototype.createSpeechEventPayload=function(a,u){var p="meeting",v={id:p,name:u,meeting:a.conversationProperties},g="id",h="attendees",d="record";return v[p][g]=a.id,v[p][h]=a.participants,v[p][d]=a.conversationProperties.audiorecording==="on"?"true":"false",v},s}(l.ServiceRecognizerBase);return ns.TranscriptionServiceRecognizer=c,ns}var is={},rw;function y7(){if(rw)return is;rw=1,Object.defineProperty(is,"__esModule",{value:!0}),is.DetailedSpeechPhrase=void 0;var t=H(),e=function(){function r(n){this.privDetailedSpeechPhrase=JSON.parse(n),this.privDetailedSpeechPhrase.RecognitionStatus=t.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus]}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"RecognitionStatus",{get:function(){return this.privDetailedSpeechPhrase.RecognitionStatus},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"NBest",{get:function(){return this.privDetailedSpeechPhrase.NBest},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Duration",{get:function(){return this.privDetailedSpeechPhrase.Duration},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Offset",{get:function(){return this.privDetailedSpeechPhrase.Offset},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Language",{get:function(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"LanguageDetectionConfidence",{get:function(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence},enumerable:!1,configurable:!0}),r}();return is.DetailedSpeechPhrase=e,is}var os={},nw;function m7(){if(nw)return os;nw=1,Object.defineProperty(os,"__esModule",{value:!0}),os.SimpleSpeechPhrase=void 0;var t=H(),e=function(){function r(n){this.privSimpleSpeechPhrase=JSON.parse(n),this.privSimpleSpeechPhrase.RecognitionStatus=t.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus]}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"RecognitionStatus",{get:function(){return this.privSimpleSpeechPhrase.RecognitionStatus},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"DisplayText",{get:function(){return this.privSimpleSpeechPhrase.DisplayText},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Offset",{get:function(){return this.privSimpleSpeechPhrase.Offset},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Duration",{get:function(){return this.privSimpleSpeechPhrase.Duration},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Language",{get:function(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"LanguageDetectionConfidence",{get:function(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"SpeakerId",{get:function(){return this.privSimpleSpeechPhrase.SpeakerId},enumerable:!1,configurable:!0}),r}();return os.SimpleSpeechPhrase=e,os}var ss={},iw;function S7(){if(iw)return ss;iw=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.AddedLmIntent=void 0;var t=function(){function e(r,n){this.modelImpl=r,this.intentName=n}return e}();return ss.AddedLmIntent=t,ss}var as={},ow;function b7(){if(ow)return as;ow=1;var t=w&&w.__extends||function(){var c=function(o,s){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,u){a.__proto__=u}||function(a,u){for(var p in u)u.hasOwnProperty(p)&&(a[p]=u[p])},c(o,s)};return function(o,s){c(o,s);function a(){this.constructor=o}o.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}(),e=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},r=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(as,"__esModule",{value:!0}),as.IntentServiceRecognizer=void 0;var n=K(),i=F(),l=H(),f=function(c){t(o,c);function o(s,a,u,p,v){var g=c.call(this,s,a,u,p,v)||this;return g.privIntentRecognizer=v,g.privIntentDataSent=!1,g}return o.prototype.setIntents=function(s,a){this.privAddedLmIntents=s,this.privUmbrellaIntent=a,this.privIntentDataSent=!0},o.prototype.processTypeSpecificMessages=function(s){return e(this,void 0,void 0,function(){var a,u,p,v,g,h,d,y,m,S,b,P,C=this;return r(this,function(R){switch(p=!1,v=new i.PropertyCollection,s.messageType===n.MessageType.Text&&v.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,s.textBody),s.path.toLowerCase()){case"speech.hypothesis":if(g=l.SpeechHypothesis.fromJSON(s.textBody),a=new i.IntentRecognitionResult(void 0,this.privRequestSession.requestId,i.ResultReason.RecognizingIntent,g.Text,g.Duration,g.Offset+this.privRequestSession.currentTurnAudioOffset,g.Language,g.LanguageDetectionConfidence,void 0,s.textBody,v),this.privRequestSession.onHypothesis(a.offset),u=new i.IntentRecognitionEventArgs(a,g.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,u)}catch{}p=!0;break;case"speech.phrase":h=l.SimpleSpeechPhrase.fromJSON(s.textBody),a=new i.IntentRecognitionResult(void 0,this.privRequestSession.requestId,l.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),h.DisplayText,h.Duration,h.Offset+this.privRequestSession.currentTurnAudioOffset,h.Language,h.LanguageDetectionConfidence,void 0,s.textBody,v),u=new i.IntentRecognitionEventArgs(a,a.offset,this.privRequestSession.sessionId),d=function(){if(C.privIntentRecognizer.recognized)try{C.privIntentRecognizer.recognized(C.privIntentRecognizer,u)}catch{}if(C.privSuccessCallback){try{C.privSuccessCallback(a)}catch(O){C.privErrorCallback&&C.privErrorCallback(O)}C.privSuccessCallback=void 0,C.privErrorCallback=void 0}},this.privIntentDataSent===!1||i.ResultReason.NoMatch===u.result.reason?(this.privRequestSession.onPhraseRecognized(u.offset+u.result.duration),d()):this.privPendingIntentArgs=u,p=!0;break;case"response":if(u=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,u===void 0){if(s.textBody==="")return[2];u=new i.IntentRecognitionEventArgs(new i.IntentRecognitionResult,0,this.privRequestSession.sessionId)}if(y=l.IntentResponse.fromJSON(s.textBody),m=this.privAddedLmIntents[y.topScoringIntent.intent],this.privUmbrellaIntent!==void 0&&(m=this.privUmbrellaIntent),y!==null&&m!==void 0&&(S=m.intentName===void 0?y.topScoringIntent.intent:m.intentName,b=u.result.reason,S!==void 0&&(b=i.ResultReason.RecognizedIntent),P=u.result.properties!==void 0?u.result.properties:new i.PropertyCollection,P.setProperty(i.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,s.textBody),u=new i.IntentRecognitionEventArgs(new i.IntentRecognitionResult(S,u.result.resultId,b,u.result.text,u.result.duration,u.result.offset,void 0,void 0,u.result.errorDetails,u.result.json,P),u.offset,u.sessionId)),this.privRequestSession.onPhraseRecognized(u.offset+u.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,u)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(u.result)}catch(O){this.privErrorCallback&&this.privErrorCallback(O)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}p=!0;break}return[2,p]})})},o.prototype.cancelRecognition=function(s,a,u,p,v){var g=new i.PropertyCollection;if(g.setProperty(l.CancellationErrorCodePropertyName,i.CancellationErrorCode[p]),this.privIntentRecognizer.canceled){var h=new i.IntentRecognitionCanceledEventArgs(u,v,p,void 0,void 0,s);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,h)}catch{}}if(this.privSuccessCallback){var d=new i.IntentRecognitionResult(void 0,a,i.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,v,void 0,g);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}},o}(l.ServiceRecognizerBase);return as.IntentServiceRecognizer=f,as}var cs={},sw;function C7(){if(sw)return cs;sw=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.IntentResponse=void 0;var t=function(){function e(r){this.privIntentResponse=JSON.parse(r)}return e.fromJSON=function(r){return new e(r)},Object.defineProperty(e.prototype,"query",{get:function(){return this.privIntentResponse.query},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topScoringIntent",{get:function(){return this.privIntentResponse.topScoringIntent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entities",{get:function(){return this.privIntentResponse.entities},enumerable:!1,configurable:!0}),e}();return cs.IntentResponse=t,cs}var us={},ps={},aw;function P7(){if(aw)return ps;aw=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.ServiceTelemetryListener=void 0;var t=K(),e=Jd(),r=function(){function n(i,l,f){var c=this;this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.onEvent=function(o){c.privIsDisposed||(o instanceof e.RecognitionTriggeredEvent&&o.requestId===c.privRequestId&&(c.privListeningTriggerMetric={End:o.eventTime,Name:"ListeningTrigger",Start:o.eventTime}),o instanceof t.AudioStreamNodeAttachingEvent&&o.audioSourceId===c.privAudioSourceId&&o.audioNodeId===c.privAudioNodeId&&(c.privMicStartTime=o.eventTime),o instanceof t.AudioStreamNodeAttachedEvent&&o.audioSourceId===c.privAudioSourceId&&o.audioNodeId===c.privAudioNodeId&&(c.privMicStartTime=o.eventTime),o instanceof t.AudioSourceErrorEvent&&o.audioSourceId===c.privAudioSourceId&&(c.privMicMetric||(c.privMicMetric={End:o.eventTime,Error:o.error,Name:"Microphone",Start:c.privMicStartTime})),o instanceof t.AudioStreamNodeErrorEvent&&o.audioSourceId===c.privAudioSourceId&&o.audioNodeId===c.privAudioNodeId&&(c.privMicMetric||(c.privMicMetric={End:o.eventTime,Error:o.error,Name:"Microphone",Start:c.privMicStartTime})),o instanceof t.AudioStreamNodeDetachedEvent&&o.audioSourceId===c.privAudioSourceId&&o.audioNodeId===c.privAudioNodeId&&(c.privMicMetric||(c.privMicMetric={End:o.eventTime,Name:"Microphone",Start:c.privMicStartTime})),o instanceof e.ConnectingToServiceEvent&&o.requestId===c.privRequestId&&(c.privConnectionId=o.sessionId),o instanceof t.ConnectionStartEvent&&o.connectionId===c.privConnectionId&&(c.privConnectionStartTime=o.eventTime),o instanceof t.ConnectionEstablishedEvent&&o.connectionId===c.privConnectionId&&(c.privConnectionEstablishMetric||(c.privConnectionEstablishMetric={End:o.eventTime,Id:c.privConnectionId,Name:"Connection",Start:c.privConnectionStartTime})),o instanceof t.ConnectionEstablishErrorEvent&&o.connectionId===c.privConnectionId&&(c.privConnectionEstablishMetric||(c.privConnectionEstablishMetric={End:o.eventTime,Error:c.getConnectionError(o.statusCode),Id:c.privConnectionId,Name:"Connection",Start:c.privConnectionStartTime})),o instanceof t.ConnectionMessageReceivedEvent&&o.connectionId===c.privConnectionId&&o.message&&o.message.headers&&o.message.headers.path&&(c.privReceivedMessages[o.message.headers.path]||(c.privReceivedMessages[o.message.headers.path]=new Array),c.privReceivedMessages[o.message.headers.path].push(o.networkReceivedTime)))},this.getTelemetry=function(){var o=new Array;c.privListeningTriggerMetric&&o.push(c.privListeningTriggerMetric),c.privMicMetric&&o.push(c.privMicMetric),c.privConnectionEstablishMetric&&o.push(c.privConnectionEstablishMetric),c.privPhraseLatencies.length>0&&o.push({PhraseLatencyMs:c.privPhraseLatencies}),c.privHypothesisLatencies.length>0&&o.push({FirstHypothesisLatencyMs:c.privHypothesisLatencies});var s={Metrics:o,ReceivedMessages:c.privReceivedMessages},a=JSON.stringify(s);return c.privReceivedMessages={},c.privListeningTriggerMetric=null,c.privMicMetric=null,c.privConnectionEstablishMetric=null,c.privPhraseLatencies=[],c.privHypothesisLatencies=[],a},this.dispose=function(){c.privIsDisposed=!0},this.getConnectionError=function(o){switch(o){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+o.toString()}},this.privRequestId=i,this.privAudioSourceId=l,this.privAudioNodeId=f,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}return n.prototype.phraseReceived=function(i){i>0&&this.privPhraseLatencies.push(Date.now()-i)},n.prototype.hypothesisReceived=function(i){i>0&&this.privHypothesisLatencies.push(Date.now()-i)},Object.defineProperty(n.prototype,"hasTelemetry",{get:function(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0},enumerable:!1,configurable:!0}),n}();return ps.ServiceTelemetryListener=r,ps}var cw;function w7(){if(cw)return us;cw=1;var t=w&&w.__awaiter||function(f,c,o,s){function a(u){return u instanceof o?u:new o(function(p){p(u)})}return new(o||(o=Promise))(function(u,p){function v(d){try{h(s.next(d))}catch(y){p(y)}}function g(d){try{h(s.throw(d))}catch(y){p(y)}}function h(d){d.done?u(d.value):a(d.value).then(v,g)}h((s=s.apply(f,c||[])).next())})},e=w&&w.__generator||function(f,c){var o={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,a,u,p;return p={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function v(h){return function(d){return g([h,d])}}function g(h){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,a&&(u=h[0]&2?a.return:h[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,h[1])).done)return u;switch(a=0,u&&(h=[h[0]&2,u.value]),h[0]){case 0:case 1:u=h;break;case 4:return o.label++,{value:h[1],done:!1};case 5:o.label++,a=h[1],h=[0];continue;case 7:h=o.ops.pop(),o.trys.pop();continue;default:if(u=o.trys,!(u=u.length>0&&u[u.length-1])&&(h[0]===6||h[0]===2)){o=0;continue}if(h[0]===3&&(!u||h[1]>u[0]&&h[1]<u[3])){o.label=h[1];break}if(h[0]===6&&o.label<u[1]){o.label=u[1],u=h;break}if(u&&o.label<u[2]){o.label=u[2],o.ops.push(h);break}u[2]&&o.ops.pop(),o.trys.pop();continue}h=c.call(f,o)}catch(d){h=[6,d],a=0}finally{s=u=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}};Object.defineProperty(us,"__esModule",{value:!0}),us.RequestSession=void 0;var r=K(),n=Jd(),i=P7(),l=function(){function f(c){var o=this;this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.onPreConnectionStart=function(s,a){o.privAuthFetchEventId=s,o.privSessionId=a,o.onEvent(new n.ConnectingToServiceEvent(o.privRequestId,o.privAuthFetchEventId,o.privSessionId))},this.onServiceTurnStartResponse=function(){o.privTurnDeferral&&o.privInTurn&&(o.privTurnDeferral.reject("Another turn started before current completed."),o.privTurnDeferral.promise.then().catch(function(){})),o.privInTurn=!0,o.privTurnDeferral=new r.Deferred},this.getTelemetry=function(){return o.privServiceTelemetryListener.hasTelemetry?o.privServiceTelemetryListener.getTelemetry():null},this.onEvent=function(s){o.privServiceTelemetryListener&&o.privServiceTelemetryListener.onEvent(s),r.Events.instance.onEvent(s)},this.privAudioSourceId=c,this.privRequestId=r.createNoDashGuid(),this.privAudioNodeId=r.createNoDashGuid(),this.privTurnDeferral=new r.Deferred,this.privTurnDeferral.resolve()}return Object.defineProperty(f.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"turnCompletionPromise",{get:function(){return this.privTurnDeferral.promise},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isSpeechEnded",{get:function(){return this.privIsSpeechEnded},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isRecognizing",{get:function(){return this.privIsRecognizing},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"currentTurnAudioOffset",{get:function(){return this.privTurnStartAudioOffset},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"recogNumber",{get:function(){return this.privRecogNumber},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"numConnectionAttempts",{get:function(){return this.privConnectionAttempts},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"bytesSent",{get:function(){return this.privBytesSent},enumerable:!1,configurable:!0}),f.prototype.listenForServiceTelemetry=function(c){this.privServiceTelemetryListener&&this.privDetachables.push(c.attachListener(this.privServiceTelemetryListener))},f.prototype.startNewRecognition=function(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRequestId=r.createNoDashGuid(),this.privRecogNumber++,this.privServiceTelemetryListener=new i.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new n.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))},f.prototype.onAudioSourceAttachCompleted=function(c,o,s){return t(this,void 0,void 0,function(){return e(this,function(a){switch(a.label){case 0:return this.privAudioNode=c,this.privIsAudioNodeDetached=!1,o?[4,this.onComplete()]:[3,2];case 1:return a.sent(),[3,3];case 2:this.onEvent(new n.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId)),a.label=3;case 3:return[2]}})})},f.prototype.onAuthCompleted=function(c,o){return t(this,void 0,void 0,function(){return e(this,function(s){switch(s.label){case 0:return c?[4,this.onComplete()]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},f.prototype.onConnectionEstablishCompleted=function(c,o){return t(this,void 0,void 0,function(){return e(this,function(s){switch(s.label){case 0:return c!==200?[3,1]:(this.onEvent(new n.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0,[2]);case 1:return c!==403?[3,3]:[4,this.onComplete()];case 2:s.sent(),s.label=3;case 3:return[2]}})})},f.prototype.onServiceTurnEndResponse=function(c){return t(this,void 0,void 0,function(){return e(this,function(o){switch(o.label){case 0:return this.privTurnDeferral.resolve(),!c||this.isSpeechEnded?[4,this.onComplete()]:[3,2];case 1:return o.sent(),this.privInTurn=!1,[3,3];case 2:this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privRequestId=r.createNoDashGuid(),this.privAudioNode.replay(),o.label=3;case 3:return[2]}})})},f.prototype.onHypothesis=function(c){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(c)))},f.prototype.onPhraseRecognized=function(c){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(c)),this.onServiceRecognized(c)},f.prototype.onServiceRecognized=function(c){this.privLastRecoOffset=c,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(c),this.privConnectionAttempts=0},f.prototype.onAudioSent=function(c){this.privBytesSent+=c},f.prototype.onRetryConnection=function(){this.privConnectionAttempts++},f.prototype.dispose=function(c){return t(this,void 0,void 0,function(){var o,s,a;return e(this,function(u){switch(u.label){case 0:if(this.privIsDisposed)return[3,5];this.privIsDisposed=!0,o=0,s=this.privDetachables,u.label=1;case 1:return o<s.length?(a=s[o],[4,a.detach()]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1,u.label=5;case 5:return[2]}})})},f.prototype.onStopRecognizing=function(){return t(this,void 0,void 0,function(){return e(this,function(c){switch(c.label){case 0:return[4,this.onComplete()];case 1:return c.sent(),[2]}})})},f.prototype.onSpeechEnded=function(){this.privIsSpeechEnded=!0},f.prototype.onComplete=function(){return t(this,void 0,void 0,function(){return e(this,function(c){switch(c.label){case 0:return this.privIsRecognizing?(this.privIsRecognizing=!1,[4,this.detachAudioNode()]):[3,2];case 1:c.sent(),c.label=2;case 2:return[2]}})})},f.prototype.detachAudioNode=function(){return t(this,void 0,void 0,function(){return e(this,function(c){switch(c.label){case 0:return this.privIsAudioNodeDetached?[3,2]:(this.privIsAudioNodeDetached=!0,this.privAudioNode?[4,this.privAudioNode.detach()]:[3,2]);case 1:c.sent(),c.label=2;case 2:return[2]}})})},f}();return us.RequestSession=l,us}var fs={},uw;function R7(){if(uw)return fs;uw=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.SpeechContext=void 0;var t=function(){function e(r){this.privContext={},this.privDynamicGrammar=r}return e.prototype.setSection=function(r,n){this.privContext[r]=n},e.prototype.setPronunciationAssessmentParams=function(r){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(r),this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.format="Detailed",this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")===-1&&this.privContext.phraseOutput.detailed.options.push("WordTimings")},e.prototype.toJSON=function(){var r=this.privDynamicGrammar.generateGrammarObject();this.setSection("dgi",r);var n=JSON.stringify(this.privContext);return n},e}();return fs.SpeechContext=t,fs}var ls={},pw;function E7(){if(pw)return ls;pw=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.DynamicGrammarBuilder=void 0;var t=function(){function e(){}return e.prototype.addPhrase=function(r){this.privPhrases||(this.privPhrases=[]),r instanceof Array?this.privPhrases=this.privPhrases.concat(r):this.privPhrases.push(r)},e.prototype.clearPhrases=function(){this.privPhrases=void 0},e.prototype.addReferenceGrammar=function(r){this.privGrammars||(this.privGrammars=[]),r instanceof Array?this.privGrammars=this.privGrammars.concat(r):this.privGrammars.push(r)},e.prototype.clearGrammars=function(){this.privGrammars=void 0},e.prototype.generateGrammarObject=function(){if(!(this.privGrammars===void 0&&this.privPhrases===void 0)){var r={};if(r.ReferenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){var n=[];this.privPhrases.forEach(function(i,l,f){n.push({Text:i})}),r.Groups=[{Type:"Generic",Items:n}]}return r}},e}();return ls.DynamicGrammarBuilder=t,ls}var iv={},fw;function O7(){return fw||(fw=1,Object.defineProperty(iv,"__esModule",{value:!0})),iv}var vs={},hs={},ds={},ov={},lw;function jI(){return lw||(lw=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.MessageDataStreamType=t.ActivityPayloadResponse=void 0;var e=function(){function r(n){this.privActivityResponse=JSON.parse(n)}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"conversationId",{get:function(){return this.privActivityResponse.conversationId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"messageDataStreamType",{get:function(){return this.privActivityResponse.messageDataStreamType},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"messagePayload",{get:function(){return this.privActivityResponse.messagePayload},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"version",{get:function(){return this.privActivityResponse.version},enumerable:!1,configurable:!0}),r}();t.ActivityPayloadResponse=e,function(r){r[r.None=0]="None",r[r.TextToSpeechAudio=1]="TextToSpeechAudio"}(t.MessageDataStreamType||(t.MessageDataStreamType={}))}(ov)),ov}var vw;function _7(){if(vw)return ds;vw=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.DialogServiceTurnState=void 0;var t=lp(),e=Fn(),r=jI(),n=function(){function i(l,f){this.privRequestId=f,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=l,this.resetTurnEndTimeout()}return Object.defineProperty(i.prototype,"audioStream",{get:function(){return this.resetTurnEndTimeout(),this.privAudioStream},enumerable:!1,configurable:!0}),i.prototype.processActivityPayload=function(l,f){return l.messageDataStreamType===r.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=e.AudioOutputStream.createPullStream(),this.privAudioStream.format=f!==void 0?f:t.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream},i.prototype.endAudioStream=function(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()},i.prototype.complete=function(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()},i.prototype.resetTurnEndTimeout=function(){var l=this;this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(function(){l.privTurnManager.CompleteTurn(l.privRequestId)},2e3)},i}();return ds.DialogServiceTurnState=n,ds}var hw;function A7(){if(hw)return hs;hw=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.DialogServiceTurnStateManager=void 0;var t=Nt(),e=_7(),r=function(){function n(){this.privTurnMap=new Map}return n.prototype.StartTurn=function(i){if(this.privTurnMap.has(i))throw new t.InvalidOperationError("Service error: There is already a turn with id:"+i);var l=new e.DialogServiceTurnState(this,i);return this.privTurnMap.set(i,l),this.privTurnMap.get(i)},n.prototype.GetTurn=function(i){return this.privTurnMap.get(i)},n.prototype.CompleteTurn=function(i){if(!this.privTurnMap.has(i))throw new t.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+i);var l=this.privTurnMap.get(i);return l.complete(),this.privTurnMap.delete(i),l},n}();return hs.DialogServiceTurnStateManager=r,hs}var dw;function I7(){if(dw)return vs;dw=1;var t=w&&w.__extends||function(){var v=function(g,h){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,y){d.__proto__=y}||function(d,y){for(var m in y)y.hasOwnProperty(m)&&(d[m]=y[m])},v(g,h)};return function(g,h){v(g,h);function d(){this.constructor=g}g.prototype=h===null?Object.create(h):(d.prototype=h.prototype,new d)}}(),e=w&&w.__awaiter||function(v,g,h,d){function y(m){return m instanceof h?m:new h(function(S){S(m)})}return new(h||(h=Promise))(function(m,S){function b(R){try{C(d.next(R))}catch(O){S(O)}}function P(R){try{C(d.throw(R))}catch(O){S(O)}}function C(R){R.done?m(R.value):y(R.value).then(b,P)}C((d=d.apply(v,g||[])).next())})},r=w&&w.__generator||function(v,g){var h={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},d,y,m,S;return S={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function b(C){return function(R){return P([C,R])}}function P(C){if(d)throw new TypeError("Generator is already executing.");for(;h;)try{if(d=1,y&&(m=C[0]&2?y.return:C[0]?y.throw||((m=y.return)&&m.call(y),0):y.next)&&!(m=m.call(y,C[1])).done)return m;switch(y=0,m&&(C=[C[0]&2,m.value]),C[0]){case 0:case 1:m=C;break;case 4:return h.label++,{value:C[1],done:!1};case 5:h.label++,y=C[1],C=[0];continue;case 7:C=h.ops.pop(),h.trys.pop();continue;default:if(m=h.trys,!(m=m.length>0&&m[m.length-1])&&(C[0]===6||C[0]===2)){h=0;continue}if(C[0]===3&&(!m||C[1]>m[0]&&C[1]<m[3])){h.label=C[1];break}if(C[0]===6&&h.label<m[1]){h.label=m[1],m=C;break}if(m&&h.label<m[2]){h.label=m[2],h.ops.push(C);break}m[2]&&h.ops.pop(),h.trys.pop();continue}C=g.call(v,h)}catch(R){C=[6,R],y=0}finally{d=m=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}};Object.defineProperty(vs,"__esModule",{value:!0}),vs.DialogServiceAdapter=void 0;var n=yt(),i=PI(),l=K(),f=lp(),c=F(),o=A7(),s=H(),a=jI(),u=vp(),p=function(v){t(g,v);function g(h,d,y,m,S){var b=v.call(this,h,d,y,m,S)||this;return b.sendAgentConfig=function(P){if(b.agentConfig&&!b.agentConfigSent){if(b.privRecognizerConfig.parameters.getProperty(c.PropertyId.Conversation_DialogType)===c.DialogServiceConfig.DialogTypes.CustomCommands){var C=b.agentConfig.get();C.botInfo.commandsCulture=b.privRecognizerConfig.parameters.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),b.agentConfig.set(C)}b.onEvent(new i.SendingAgentContextMessageEvent(b.agentConfig));var R=b.agentConfig.toJsonString();return b.agentConfigSent=!0,P.send(new u.SpeechConnectionMessage(l.MessageType.Text,"agent.config",b.privRequestSession.requestId,"application/json",R))}},b.sendAgentContext=function(P){var C=l.createGuid(),R=b.privDialogServiceConnector.properties.getProperty(c.PropertyId.Conversation_Speech_Activity_Template),O={channelData:"",context:{interactionId:C},messagePayload:typeof R===void 0?void 0:R,version:.5},z=JSON.stringify(O);return P.send(new u.SpeechConnectionMessage(l.MessageType.Text,"speech.agent.context",b.privRequestSession.requestId,"application/json",z))},b.handleResponseMessage=function(P){var C=JSON.parse(P.textBody);switch(C.messageType.toLowerCase()){case"message":var R=P.requestId.toUpperCase(),O=a.ActivityPayloadResponse.fromJSON(P.textBody),z=b.privTurnStateManager.GetTurn(R);if(O.conversationId){var L=b.agentConfig.get();L.botInfo.conversationId=O.conversationId,b.agentConfig.set(L)}var E=z.processActivityPayload(O,f.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(b.privDialogServiceConnector.properties.getProperty(c.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),T=new c.ActivityReceivedEventArgs(O.messagePayload,E);if(b.privDialogServiceConnector.activityReceived)try{b.privDialogServiceConnector.activityReceived(b.privDialogServiceConnector,T)}catch{}break;case"messagestatus":if(b.privDialogServiceConnector.turnStatusReceived)try{b.privDialogServiceConnector.turnStatusReceived(b.privDialogServiceConnector,new c.TurnStatusReceivedEventArgs(P.textBody))}catch{}break;default:l.Events.instance.onEvent(new l.BackgroundEvent("Unexpected response of type "+C.messageType+". Ignoring."));break}},b.privEvents=new l.EventSource,b.privDialogServiceConnector=S,b.receiveMessageOverride=b.receiveDialogMessageOverride,b.privTurnStateManager=new o.DialogServiceTurnStateManager,b.recognizeOverride=b.listenOnce,b.postConnectImplOverride=b.dialogConnectImpl,b.configConnectionOverride=b.configConnection,b.disconnectOverride=b.privDisconnect,b.privDialogAudioSource=y,b.agentConfigSent=!1,b.privLastResult=null,b.connectionEvents.attach(function(P){return e(b,void 0,void 0,function(){return r(this,function(C){return P.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0),[2]})})}),b}return g.prototype.sendMessage=function(h){return e(this,void 0,void 0,function(){var d,y,m,S,b;return r(this,function(P){switch(P.label){case 0:return d=l.createGuid(),y=l.createNoDashGuid(),m={context:{interactionId:d},messagePayload:JSON.parse(h),version:.5},S=JSON.stringify(m),[4,this.fetchConnection()];case 1:return b=P.sent(),[4,b.send(new u.SpeechConnectionMessage(l.MessageType.Text,"agent",y,"application/json",S))];case 2:return P.sent(),[2]}})})},g.prototype.privDisconnect=function(){return e(this,void 0,void 0,function(){return r(this,function(h){switch(h.label){case 0:return[4,this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,c.CancellationReason.Error,c.CancellationErrorCode.NoError,"Disconnecting")];case 1:return h.sent(),this.terminateMessageLoop=!0,this.agentConfigSent=!1,[2]}})})},g.prototype.processTypeSpecificMessages=function(h){return e(this,void 0,void 0,function(){var d,y,m,S,b,P,C,R,O,z,L,E;return r(this,function(T){switch(d=new c.PropertyCollection,h.messageType===l.MessageType.Text&&d.setProperty(c.PropertyId.SpeechServiceResponse_JsonResult,h.textBody),h.path.toLowerCase()){case"speech.phrase":if(S=s.SimpleSpeechPhrase.fromJSON(h.textBody),this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+S.Offset+S.Duration),S.RecognitionStatus!==s.RecognitionStatus.TooManyRequests&&S.RecognitionStatus!==s.RecognitionStatus.Error&&(b=this.fireEventForResult(S,d),this.privLastResult=b.result,this.privDialogServiceConnector.recognized))try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,b)}catch{}m=!0;break;case"speech.hypothesis":if(P=s.SpeechHypothesis.fromJSON(h.textBody),C=P.Offset+this.privRequestSession.currentTurnAudioOffset,y=new c.SpeechRecognitionResult(this.privRequestSession.requestId,c.ResultReason.RecognizingSpeech,P.Text,P.Duration,C,P.Language,P.LanguageDetectionConfidence,void 0,void 0,h.textBody,d),this.privRequestSession.onHypothesis(C),R=new c.SpeechRecognitionEventArgs(y,P.Duration,this.privRequestSession.sessionId),this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,R)}catch{}m=!0;break;case"speech.keyword":if(O=s.SpeechKeyword.fromJSON(h.textBody),y=new c.SpeechRecognitionResult(this.privRequestSession.requestId,O.Status==="Accepted"?c.ResultReason.RecognizedKeyword:c.ResultReason.NoMatch,O.Text,O.Duration,O.Offset,void 0,void 0,void 0,void 0,h.textBody,d),O.Status!=="Accepted"&&(this.privLastResult=y),z=new c.SpeechRecognitionEventArgs(y,y.duration,y.resultId),this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,z)}catch{}m=!0;break;case"audio":{L=h.requestId.toUpperCase(),E=this.privTurnStateManager.GetTurn(L);try{h.binaryBody?E.audioStream.write(h.binaryBody):E.endAudioStream()}catch{}}m=!0;break;case"response":this.handleResponseMessage(h),m=!0;break}return[2,m]})})},g.prototype.cancelRecognition=function(h,d,y,m,S){return e(this,void 0,void 0,function(){var b,P,C;return r(this,function(R){switch(R.label){case 0:return this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing?[4,this.privRequestSession.onStopRecognizing()]:[3,2];case 1:R.sent(),R.label=2;case 2:if(this.privDialogServiceConnector.canceled){b=new c.PropertyCollection,b.setProperty(s.CancellationErrorCodePropertyName,c.CancellationErrorCode[m]),P=new c.SpeechRecognitionCanceledEventArgs(y,S,m,void 0,h);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,P)}catch{}if(this.privSuccessCallback){C=new c.SpeechRecognitionResult(void 0,c.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,S,void 0,b);try{this.privSuccessCallback(C),this.privSuccessCallback=void 0}catch{}}}return[2]}})})},g.prototype.listenOnce=function(h,d,y){return e(this,void 0,void 0,function(){var m,S,b,P,C,R,O,z,L,E=this;return r(this,function(T){switch(T.label){case 0:return this.privRecognizerConfig.recognitionMode=h,this.privSuccessCallback=d,this.privErrorCallback=y,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(c.PropertyId.Speech_SessionId,this.privRequestSession.sessionId),m=this.connectImpl(),S=this.sendPreAudioMessages(),[4,this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId)];case 1:return b=T.sent(),[4,this.privDialogAudioSource.format];case 2:return P=T.sent(),[4,this.privDialogAudioSource.deviceInfo];case 3:return C=T.sent(),R=new n.ReplayableAudioNode(b,P.avgBytesPerSec),[4,this.privRequestSession.onAudioSourceAttachCompleted(R,!1)];case 4:T.sent(),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:C},T.label=5;case 5:return T.trys.push([5,8,,10]),[4,m];case 6:return T.sent(),[4,S];case 7:return T.sent(),[3,10];case 8:return O=T.sent(),[4,this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,c.CancellationReason.Error,c.CancellationErrorCode.ConnectionFailure,O)];case 9:return T.sent(),[2,Promise.resolve()];case 10:return z=new c.SessionEventArgs(this.privRequestSession.sessionId),this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,z),L=this.sendAudio(R),L.then(function(){},function(A){return e(E,void 0,void 0,function(){return r(this,function(_){switch(_.label){case 0:return[4,this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,c.CancellationReason.Error,c.CancellationErrorCode.RuntimeError,A)];case 1:return _.sent(),[2]}})})}),[2]}})})},g.prototype.dialogConnectImpl=function(h){return this.privConnectionLoop=this.startMessageLoop(),h},g.prototype.receiveDialogMessageOverride=function(){var h=this,d=new l.Deferred,y=function(){return e(h,void 0,void 0,function(){var m,S,b,P,C,R,O,$,z,L,E,T,A,_,$,x,B;return r(this,function(U){switch(U.label){case 0:return U.trys.push([0,12,,13]),m=this.isDisposed(),S=!this.isDisposed()&&this.terminateMessageLoop,m||S?(d.resolve(void 0),[2]):[4,this.fetchConnection()];case 1:return b=U.sent(),[4,b.read()];case 2:if(P=U.sent(),!P)return[2,y()];switch(C=u.SpeechConnectionMessage.fromConnectionMessage(P),R=C.path.toLowerCase(),R){case"turn.start":return[3,3];case"speech.startdetected":return[3,4];case"speech.enddetected":return[3,5];case"turn.end":return[3,6]}return[3,10];case 3:return O=C.requestId.toUpperCase(),$=this.privRequestSession.requestId.toUpperCase(),O!==$?this.privTurnStateManager.StartTurn(O):this.privRequestSession.onServiceTurnStartResponse(),[3,11];case 4:return z=s.SpeechDetected.fromJSON(C.textBody),L=new c.RecognitionEventArgs(z.Offset,this.privRequestSession.sessionId),this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,L),[3,11];case 5:return E=void 0,C.textBody.length>0?E=C.textBody:E="{ Offset: 0 }",T=s.SpeechDetected.fromJSON(E),this.privRequestSession.onServiceRecognized(T.Offset+this.privRequestSession.currentTurnAudioOffset),A=new c.RecognitionEventArgs(T.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,A),[3,11];case 6:return _=C.requestId.toUpperCase(),$=this.privRequestSession.requestId.toUpperCase(),_===$?[3,7]:(this.privTurnStateManager.CompleteTurn(_),[3,9]);case 7:return x=new c.SessionEventArgs(this.privRequestSession.sessionId),[4,this.privRequestSession.onServiceTurnEndResponse(!1)];case 8:if(U.sent(),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,x),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(N){this.privErrorCallback&&this.privErrorCallback(N)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}U.label=9;case 9:return[3,11];case 10:this.processTypeSpecificMessages(C)||this.serviceEvents&&this.serviceEvents.onEvent(new l.ServiceEvent(C.path.toLowerCase(),C.textBody)),U.label=11;case 11:return B=y(),[2,B];case 12:return U.sent(),this.terminateMessageLoop=!0,d.resolve(),[3,13];case 13:return[2]}})})};return y().catch(function(m){l.Events.instance.onEvent(new l.BackgroundEvent(m))}),d.promise},g.prototype.startMessageLoop=function(){return e(this,void 0,void 0,function(){var h;return r(this,function(d){switch(d.label){case 0:this.terminateMessageLoop=!1,d.label=1;case 1:return d.trys.push([1,3,,5]),[4,this.receiveDialogMessageOverride()];case 2:return d.sent(),[3,5];case 3:return h=d.sent(),[4,this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,c.CancellationReason.Error,c.CancellationErrorCode.RuntimeError,h)];case 4:return d.sent(),[3,5];case 5:return[2,Promise.resolve()]}})})},g.prototype.configConnection=function(h){return e(this,void 0,void 0,function(){return r(this,function(d){switch(d.label){case 0:return this.terminateMessageLoop?(this.terminateMessageLoop=!1,[2,Promise.reject("Connection to service terminated.")]):[4,this.sendSpeechServiceConfig(h,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize())];case 1:return d.sent(),[4,this.sendAgentConfig(h)];case 2:return d.sent(),[2,h]}})})},g.prototype.sendPreAudioMessages=function(){return e(this,void 0,void 0,function(){var h;return r(this,function(d){switch(d.label){case 0:return[4,this.fetchConnection()];case 1:return h=d.sent(),this.addKeywordContextData(),[4,this.sendSpeechContext(h)];case 2:return d.sent(),[4,this.sendAgentContext(h)];case 3:return d.sent(),[4,this.sendWaveHeader(h)];case 4:return d.sent(),[2]}})})},g.prototype.fireEventForResult=function(h,d){var y=s.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),m=h.Offset+this.privRequestSession.currentTurnAudioOffset,S=new c.SpeechRecognitionResult(this.privRequestSession.requestId,y,h.DisplayText,h.Duration,m,h.Language,h.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(h),d),b=new c.SpeechRecognitionEventArgs(S,m,this.privRequestSession.sessionId);return b},g.prototype.onEvent=function(h){this.privEvents.onEvent(h),l.Events.instance.onEvent(h)},g.prototype.addKeywordContextData=function(){var h=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(h!==void 0){for(var d=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),y=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),m=h.split(";"),S=d===void 0?[]:d.split(";"),b=y===void 0?[]:y.split(";"),P=[],C=0;C<m.length;C++){var R={};R.text=m[C],C<S.length&&(R.offset=Number(S[C])),C<b.length&&(R.duration=Number(b[C])),P.push(R)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:P,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}},g}(s.ServiceRecognizerBase);return vs.DialogServiceAdapter=p,vs}var gs={},gw;function T7(){if(gw)return gs;gw=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.AgentConfig=void 0;var t=function(){function e(){}return e.prototype.toJsonString=function(){return JSON.stringify(this.iPrivConfig)},e.prototype.get=function(){return this.iPrivConfig},e.prototype.set=function(r){this.iPrivConfig=r},e}();return gs.AgentConfig=t,gs}var sv={},ys={},ms={},Ss={},yw;function Qd(){if(yw)return Ss;yw=1,Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.RestConfigBase=void 0;var t=function(){function e(){}return Object.defineProperty(e,"requestOptions",{get:function(){return e.privDefaultRequestOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e,"configParams",{get:function(){return e.privDefaultParams},enumerable:!1,configurable:!0}),Object.defineProperty(e,"restErrors",{get:function(){return e.privRestErrors},enumerable:!1,configurable:!0}),e.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},e.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},e.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},e}();return Ss.RestConfigBase=t,Ss}var mw;function Yd(){if(mw)return ms;mw=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(ms,"__esModule",{value:!0}),ms.ConversationConnectionConfig=void 0;var e=Qd(),r=function(n){t(i,n);function i(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(i,"host",{get:function(){return i.privHost},enumerable:!1,configurable:!0}),Object.defineProperty(i,"apiVersion",{get:function(){return i.privApiVersion},enumerable:!1,configurable:!0}),Object.defineProperty(i,"clientAppId",{get:function(){return i.privClientAppId},enumerable:!1,configurable:!0}),Object.defineProperty(i,"defaultLanguageCode",{get:function(){return i.privDefaultLanguageCode},enumerable:!1,configurable:!0}),Object.defineProperty(i,"restPath",{get:function(){return i.privRestPath},enumerable:!1,configurable:!0}),Object.defineProperty(i,"webSocketPath",{get:function(){return i.privWebSocketPath},enumerable:!1,configurable:!0}),Object.defineProperty(i,"speechHost",{get:function(){return i.privSpeechHost},enumerable:!1,configurable:!0}),Object.defineProperty(i,"speechPath",{get:function(){return i.privSpeechPath},enumerable:!1,configurable:!0}),Object.defineProperty(i,"transcriptionEventKeys",{get:function(){return i.privTranscriptionEventKeys},enumerable:!1,configurable:!0}),i.privHost="dev.microsofttranslator.com",i.privRestPath="/capito/room",i.privApiVersion="2.0",i.privDefaultLanguageCode="en-US",i.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",i.privWebSocketPath="/capito/translate",i.privSpeechHost="{region}.s2s.speech.microsoft.com",i.privSpeechPath="/speech/translation/cognitiveservices/v1",i.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferenciateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],i}(e.RestConfigBase);return ms.ConversationConnectionConfig=r,ms}var Vt={},Sw;function zI(){if(Sw)return Vt;Sw=1;var t=w&&w.__createBinding||(Object.create?function(p,v,g,h){h===void 0&&(h=g),Object.defineProperty(p,h,{enumerable:!0,get:function(){return v[g]}})}:function(p,v,g,h){h===void 0&&(h=g),p[h]=v[g]}),e=w&&w.__setModuleDefault||(Object.create?function(p,v){Object.defineProperty(p,"default",{enumerable:!0,value:v})}:function(p,v){p.default=v}),r=w&&w.__importStar||function(p){if(p&&p.__esModule)return p;var v={};if(p!=null)for(var g in p)g!=="default"&&Object.hasOwnProperty.call(p,g)&&t(v,p,g);return e(v,p),v};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.PromiseToEmptyCallback=Vt.request=Vt.extractHeaderValue=void 0;var n=Qd(),i=r(Dt);function l(p){return p===void 0&&(p={}),Object.keys(p).map(function(v){return encodeURIComponent(v)+"="+encodeURIComponent(p[v])}).join("&")}function f(p,v){v===void 0&&(v={});var g=l(v);return g?p+(p.indexOf("?")===-1?"?":"&")+g:p}function c(p){return{data:p.responseText,headers:p.getAllResponseHeaders(),json:function(){return JSON.parse(p.responseText)},ok:p.status>=200&&p.status<300,status:p.status,statusText:p.statusText}}function o(p,v){return v===void 0&&(v=null),{data:v||p.statusText,headers:p.getAllResponseHeaders(),json:function(){return JSON.parse(v||'"'+p.statusText+'"')},ok:!1,status:p.status,statusText:p.statusText}}function s(p,v){var g="";try{var h=v.trim().split(/[\r\n]+/),d={};h.forEach(function(y){var m=y.split(": "),S=m.shift().toLowerCase(),b=m.join(": ");d[S]=b}),g=d[p.toLowerCase()]}catch{}return g}Vt.extractHeaderValue=s;function a(p,v,g,h,d,y){g===void 0&&(g={}),h===void 0&&(h=null),d===void 0&&(d={});var m=n.RestConfigBase.requestOptions,S=d.ignoreCache||m.ignoreCache,b=d.headers||m.headers,P=d.timeout||m.timeout,C;typeof window>"u"?C=new i.XMLHttpRequest:C=new XMLHttpRequest,C.open(p,f(v,g),!0),b&&Object.keys(b).forEach(function(R){return C.setRequestHeader(R,b[R])}),S&&C.setRequestHeader("Cache-Control","no-cache"),C.timeout=P,C.onload=function(R){y(c(C))},C.onerror=function(R){y(o(C,"Failed to make request."))},C.ontimeout=function(R){y(o(C,"Request took longer than expected."))},p==="post"&&h?(C.setRequestHeader("Content-Type","application/json"),C.send(JSON.stringify(h))):C.send()}Vt.request=a;function u(p,v,g){p?p.then(function(h){try{v&&v()}catch(d){g&&g("'Unhandled error on promise callback: "+d+"'")}},function(h){try{g&&g(h)}catch{}}):g&&g("Null promise")}return Vt.PromiseToEmptyCallback=u,Vt}var bw;function M7(){if(bw)return ys;bw=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.ConversationManager=void 0;var t=te(),e=F(),r=Yd(),n=zI(),i=function(){function l(){this.privRequestParams=r.ConversationConnectionConfig.configParams,this.privErrors=r.ConversationConnectionConfig.restErrors,this.privHost=r.ConversationConnectionConfig.host,this.privApiVersion=r.ConversationConnectionConfig.apiVersion,this.privRestPath=r.ConversationConnectionConfig.restPath}return l.prototype.createOrJoin=function(f,c,o,s){var a=this;try{t.Contracts.throwIfNullOrUndefined(f,"args");var u=f.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,r.ConversationConnectionConfig.defaultLanguageCode),p=f.getProperty(e.PropertyId.ConversationTranslator_Name),v=f.getProperty(e.PropertyId.ConversationTranslator_Host,this.privHost),g=f.getProperty(e.PropertyId.ConversationTranslator_CorrelationId),h=f.getProperty(e.PropertyId.SpeechServiceConnection_Key),d=f.getProperty(e.PropertyId.SpeechServiceConnection_Region),y=f.getProperty(e.PropertyId.SpeechServiceAuthorization_Token);t.Contracts.throwIfNullOrWhitespace(u,"languageCode"),t.Contracts.throwIfNullOrWhitespace(p,"nickname"),t.Contracts.throwIfNullOrWhitespace(v,"endpointHost");var m={};m[this.privRequestParams.apiVersion]=this.privApiVersion,m[this.privRequestParams.languageCode]=u,m[this.privRequestParams.nickname]=p;var S={};g&&(S[this.privRequestParams.correlationId]=g),S[this.privRequestParams.clientAppId]=r.ConversationConnectionConfig.clientAppId,c!==void 0?m[this.privRequestParams.roomId]=c:(t.Contracts.throwIfNullOrUndefined(d,this.privErrors.authInvalidSubscriptionRegion),S[this.privRequestParams.subscriptionRegion]=d,h?S[this.privRequestParams.subscriptionKey]=h:y?S[this.privRequestParams.authorization]="Bearer "+y:t.Contracts.throwIfNullOrUndefined(h,this.privErrors.authInvalidSubscriptionKey));var b={};b.headers=S;var P="https://"+v+this.privRestPath;n.request("post",P,m,null,b,function(R){var O=n.extractHeaderValue(a.privRequestParams.requestId,R.headers);if(!R.ok){if(s){var z=a.privErrors.invalidCreateJoinConversationResponse.replace("{status}",R.status.toString()),L=void 0;try{L=JSON.parse(R.data),z+=" ["+L.error.code+": "+L.error.message+"]"}catch{z+=" ["+R.data+"]"}O&&(z+=" "+O),s(z)}return}var E=JSON.parse(R.data);if(E&&(E.requestId=O),o){try{o(E)}catch(T){s&&s(T)}o=void 0}})}catch(R){if(s)if(R instanceof Error){var C=R;s(C.name+": "+C.message)}else s(R)}},l.prototype.leave=function(f,c){var o=this;return new Promise(function(s,a){try{t.Contracts.throwIfNullOrUndefined(f,o.privErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrWhitespace(c,o.privErrors.invalidArgs.replace("{arg}","token"));var u=f.getProperty(e.PropertyId.ConversationTranslator_Host,o.privHost),p=f.getProperty(e.PropertyId.ConversationTranslator_CorrelationId),v={};v[o.privRequestParams.apiVersion]=o.privApiVersion,v[o.privRequestParams.sessionToken]=c;var g={};p&&(g[o.privRequestParams.correlationId]=p);var h={};h.headers=g;var d="https://"+u+o.privRestPath;n.request("delete",d,v,null,h,function(m){m.ok,s()})}catch(m){if(m instanceof Error){var y=m;a(y.name+": "+y.message)}else a(m)}})},l}();return ys.ConversationManager=i,ys}var $r={},bs={},Cs={},Ps={},Cw;function NI(){if(Cw)return Ps;Cw=1;var t=w&&w.__extends||function(){var n=function(i,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,c){f.__proto__=c}||function(f,c){for(var o in c)c.hasOwnProperty(o)&&(f[o]=c[o])},n(i,l)};return function(i,l){n(i,l);function f(){this.constructor=i}i.prototype=l===null?Object.create(l):(f.prototype=l.prototype,new f)}}();Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.ConversationConnectionMessage=void 0;var e=K(),r=function(n){t(i,n);function i(l,f,c,o){var s=n.call(this,l,f,c,o)||this,a=JSON.parse(s.textBody);return a.type!==void 0&&(s.privConversationMessageType=a.type),s}return Object.defineProperty(i.prototype,"conversationMessageType",{get:function(){return this.privConversationMessageType},enumerable:!1,configurable:!0}),i}(e.ConnectionMessage);return Ps.ConversationConnectionMessage=r,Ps}var Pw;function D7(){if(Pw)return Cs;Pw=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.ConversationWebsocketMessageFormatter=void 0;var t=K(),e=NI(),r=function(){function n(){this.toConnectionMessage=function(i){var l=new t.Deferred;try{if(i.messageType===t.MessageType.Text){var f=new e.ConversationConnectionMessage(i.messageType,i.textContent,{},i.id);l.resolve(f)}else i.messageType===t.MessageType.Binary&&l.resolve(new e.ConversationConnectionMessage(i.messageType,i.binaryContent,void 0,i.id))}catch(c){l.reject("Error formatting the message. Error: "+c)}return l.promise},this.fromConnectionMessage=function(i){var l=new t.Deferred;try{if(i.messageType===t.MessageType.Text){var f=""+(i.textBody?i.textBody:"");l.resolve(new t.RawWebsocketMessage(t.MessageType.Text,f,i.id))}}catch(c){l.reject("Error formatting the message. "+c)}return l.promise}}return n}();return Cs.ConversationWebsocketMessageFormatter=r,Cs}var ww;function $7(){if(ww)return bs;ww=1;var t=w&&w.__extends||function(){var s=function(a,u){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,v){p.__proto__=v}||function(p,v){for(var g in v)v.hasOwnProperty(g)&&(p[g]=v[g])},s(a,u)};return function(a,u){s(a,u);function p(){this.constructor=a}a.prototype=u===null?Object.create(u):(p.prototype=u.prototype,new p)}}();Object.defineProperty(bs,"__esModule",{value:!0}),bs.ConversationConnectionFactory=void 0;var e=yt(),r=K(),n=te(),i=F(),l=Vn(),f=Yd(),c=D7(),o=function(s){t(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a.prototype.create=function(u,p,v){var g=u.parameters.getProperty(i.PropertyId.ConversationTranslator_Host,f.ConversationConnectionConfig.host),h=u.parameters.getProperty(i.PropertyId.ConversationTranslator_CorrelationId,r.createGuid()),d="wss://"+g+f.ConversationConnectionConfig.webSocketPath,y=u.parameters.getProperty(i.PropertyId.ConversationTranslator_Token,void 0);n.Contracts.throwIfNullOrUndefined(y,"token");var m={};m[f.ConversationConnectionConfig.configParams.apiVersion]=f.ConversationConnectionConfig.apiVersion,m[f.ConversationConnectionConfig.configParams.token]=y,m[f.ConversationConnectionConfig.configParams.correlationId]=h;var S=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(d,m,{},new c.ConversationWebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),S,v)},a}(l.ConnectionFactoryBase);return bs.ConversationConnectionFactory=o,bs}var ws={},Rs={},Rw;function k7(){if(Rw)return Rs;Rw=1;var t=w&&w.__awaiter||function(i,l,f,c){function o(s){return s instanceof f?s:new f(function(a){a(s)})}return new(f||(f=Promise))(function(s,a){function u(g){try{v(c.next(g))}catch(h){a(h)}}function p(g){try{v(c.throw(g))}catch(h){a(h)}}function v(g){g.done?s(g.value):o(g.value).then(u,p)}v((c=c.apply(i,l||[])).next())})},e=w&&w.__generator||function(i,l){var f={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},c,o,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(v){return function(g){return p([v,g])}}function p(v){if(c)throw new TypeError("Generator is already executing.");for(;f;)try{if(c=1,o&&(s=v[0]&2?o.return:v[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,v[1])).done)return s;switch(o=0,s&&(v=[v[0]&2,s.value]),v[0]){case 0:case 1:s=v;break;case 4:return f.label++,{value:v[1],done:!1};case 5:f.label++,o=v[1],v=[0];continue;case 7:v=f.ops.pop(),f.trys.pop();continue;default:if(s=f.trys,!(s=s.length>0&&s[s.length-1])&&(v[0]===6||v[0]===2)){f=0;continue}if(v[0]===3&&(!s||v[1]>s[0]&&v[1]<s[3])){f.label=v[1];break}if(v[0]===6&&f.label<s[1]){f.label=s[1],s=v;break}if(s&&f.label<s[2]){f.label=s[2],f.ops.push(v);break}s[2]&&f.ops.pop(),f.trys.pop();continue}v=l.call(i,f)}catch(g){v=[6,g],o=0}finally{c=s=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}};Object.defineProperty(Rs,"__esModule",{value:!0}),Rs.ConversationRequestSession=void 0;var r=K(),n=function(){function i(l){var f=this;this.privIsDisposed=!1,this.privDetachables=new Array,this.onPreConnectionStart=function(c,o){f.privSessionId=o},this.onAuthCompleted=function(c,o){c&&f.onComplete()},this.onConnectionEstablishCompleted=function(c,o){c!==200&&c===403&&f.onComplete()},this.onServiceTurnEndResponse=function(c){c?f.privRequestId=r.createNoDashGuid():f.onComplete()},this.onComplete=function(){},this.privSessionId=l,this.privRequestId=r.createNoDashGuid(),this.privRequestCompletionDeferral=new r.Deferred}return Object.defineProperty(i.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"completionPromise",{get:function(){return this.privRequestCompletionDeferral.promise},enumerable:!1,configurable:!0}),i.prototype.dispose=function(l){return t(this,void 0,void 0,function(){var f,c,o;return e(this,function(s){switch(s.label){case 0:if(this.privIsDisposed)return[3,4];this.privIsDisposed=!0,f=0,c=this.privDetachables,s.label=1;case 1:return f<c.length?(o=c[f],[4,o.detach()]):[3,4];case 2:s.sent(),s.label=3;case 3:return f++,[3,1];case 4:return[2]}})})},i}();return Rs.ConversationRequestSession=n,Rs}var He={},Ew;function LI(){if(Ew)return He;Ew=1;var t=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}();Object.defineProperty(He,"__esModule",{value:!0}),He.ConversationReceivedTranslationEventArgs=He.ParticipantsListEventArgs=He.ParticipantAttributeEventArgs=He.ParticipantEventArgs=He.LockRoomEventArgs=He.MuteAllEventArgs=void 0;var e=F(),r=function(o){t(s,o);function s(a,u){var p=o.call(this,u)||this;return p.privIsMuted=a,p}return Object.defineProperty(s.prototype,"isMuted",{get:function(){return this.privIsMuted},enumerable:!1,configurable:!0}),s}(e.SessionEventArgs);He.MuteAllEventArgs=r;var n=function(o){t(s,o);function s(a,u){var p=o.call(this,u)||this;return p.privIsLocked=a,p}return Object.defineProperty(s.prototype,"isMuted",{get:function(){return this.privIsLocked},enumerable:!1,configurable:!0}),s}(e.SessionEventArgs);He.LockRoomEventArgs=n;var i=function(o){t(s,o);function s(a,u){var p=o.call(this,u)||this;return p.privParticipant=a,p}return Object.defineProperty(s.prototype,"participant",{get:function(){return this.privParticipant},enumerable:!1,configurable:!0}),s}(e.SessionEventArgs);He.ParticipantEventArgs=i;var l=function(o){t(s,o);function s(a,u,p,v){var g=o.call(this,v)||this;return g.privKey=u,g.privValue=p,g.privParticipantId=a,g}return Object.defineProperty(s.prototype,"value",{get:function(){return this.privValue},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"key",{get:function(){return this.privKey},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"id",{get:function(){return this.privParticipantId},enumerable:!1,configurable:!0}),s}(e.SessionEventArgs);He.ParticipantAttributeEventArgs=l;var f=function(o){t(s,o);function s(a,u,p,v,g,h,d,y,m){var S=o.call(this,m)||this;return S.privRoomId=a,S.privSessionToken=u,S.privTranslateTo=p,S.privProfanityFilter=v,S.privRoomProfanityFilter=g,S.privIsRoomLocked=h,S.privIsRoomLocked=d,S.privParticipants=y,S}return Object.defineProperty(s.prototype,"sessionToken",{get:function(){return this.privSessionToken},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"conversationId",{get:function(){return this.privRoomId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"translateTo",{get:function(){return this.privTranslateTo},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"profanityFilter",{get:function(){return this.privProfanityFilter},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"roomProfanityFilter",{get:function(){return this.privRoomProfanityFilter},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isRoomLocked",{get:function(){return this.privIsRoomLocked},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isMuteAll",{get:function(){return this.privIsMuteAll},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"participants",{get:function(){return this.privParticipants},enumerable:!1,configurable:!0}),s}(e.SessionEventArgs);He.ParticipantsListEventArgs=f;var c=function(){function o(s,a,u){this.privPayload=a,this.privCommand=s,this.privSessionId=u}return Object.defineProperty(o.prototype,"payload",{get:function(){return this.privPayload},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"command",{get:function(){return this.privCommand},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!1,configurable:!0}),o}();return He.ConversationReceivedTranslationEventArgs=c,He}var Wt={},Ow;function BI(){if(Ow)return Wt;Ow=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ConversationTranslatorCommandTypes=Wt.ConversationTranslatorMessageTypes=Wt.InternalParticipants=void 0;var t=function(){function e(r,n){r===void 0&&(r=[]),this.participants=r,this.meId=n}return e.prototype.addOrUpdateParticipant=function(r){if(r!==void 0){var n=this.getParticipantIndex(r.id);return n>-1?this.participants.splice(n,1,r):this.participants.push(r),this.getParticipant(r.id)}},e.prototype.getParticipantIndex=function(r){return this.participants.findIndex(function(n){return n.id===r})},e.prototype.getParticipant=function(r){return this.participants.find(function(n){return n.id===r})},e.prototype.deleteParticipant=function(r){this.participants=this.participants.filter(function(n){return n.id!==r})},Object.defineProperty(e.prototype,"host",{get:function(){return this.participants.find(function(r){return r.isHost===!0})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"me",{get:function(){return this.getParticipant(this.meId)},enumerable:!1,configurable:!0}),e}();return Wt.InternalParticipants=t,Wt.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},Wt.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},Wt}var av={},Es={},_w;function x7(){if(_w)return Es;_w=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.CommandResponsePayload=void 0;var t=function(){function e(r){this.privCommandResponse=JSON.parse(r)}return e.fromJSON=function(r){return new e(r)},Object.defineProperty(e.prototype,"type",{get:function(){return this.privCommandResponse.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"command",{get:function(){return this.privCommandResponse.command},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privCommandResponse.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nickname",{get:function(){return this.privCommandResponse.nickname},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"participantId",{get:function(){return this.privCommandResponse.participantId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roomid",{get:function(){return this.privCommandResponse.roomid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.privCommandResponse.value},enumerable:!1,configurable:!0}),e}();return Es.CommandResponsePayload=t,Es}var kr={},Aw;function j7(){if(Aw)return kr;Aw=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.ParticipantPayloadResponse=kr.ParticipantsListPayloadResponse=void 0;var t=function(){function r(n){this.privParticipantsPayloadResponse=JSON.parse(n)}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"roomid",{get:function(){return this.privParticipantsPayloadResponse.roomid},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"id",{get:function(){return this.privParticipantsPayloadResponse.id},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"command",{get:function(){return this.privParticipantsPayloadResponse.command},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"participants",{get:function(){return this.privParticipantsPayloadResponse.participants},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"token",{get:function(){return this.privParticipantsPayloadResponse.token},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"translateTo",{get:function(){return this.privParticipantsPayloadResponse.translateTo},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"profanityFilter",{get:function(){return this.privParticipantsPayloadResponse.profanityFilter},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"roomProfanityFilter",{get:function(){return this.privParticipantsPayloadResponse.roomProfanityFilter},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"roomLocked",{get:function(){return this.privParticipantsPayloadResponse.roomLocked},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"muteAll",{get:function(){return this.privParticipantsPayloadResponse.muteAll},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"type",{get:function(){return this.privParticipantsPayloadResponse.type},enumerable:!1,configurable:!0}),r}();kr.ParticipantsListPayloadResponse=t;var e=function(){function r(n){this.privParticipantPayloadResponse=JSON.parse(n)}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"nickname",{get:function(){return this.privParticipantPayloadResponse.nickname},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"locale",{get:function(){return this.privParticipantPayloadResponse.locale},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"usetts",{get:function(){return this.privParticipantPayloadResponse.usetts},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"ismuted",{get:function(){return this.privParticipantPayloadResponse.ismuted},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"ishost",{get:function(){return this.privParticipantPayloadResponse.ishost},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"participantId",{get:function(){return this.privParticipantPayloadResponse.participantId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"avatar",{get:function(){return this.privParticipantPayloadResponse.avatar},enumerable:!1,configurable:!0}),r}();return kr.ParticipantPayloadResponse=e,kr}var xr={},Iw;function z7(){if(Iw)return xr;Iw=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.TextResponsePayload=xr.SpeechResponsePayload=void 0;var t=function(){function r(n){this.privSpeechResponse=JSON.parse(n)}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"recognition",{get:function(){return this.privSpeechResponse.recognition},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"translations",{get:function(){return this.privSpeechResponse.translations},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"id",{get:function(){return this.privSpeechResponse.id},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"language",{get:function(){return this.privSpeechResponse.language},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"nickname",{get:function(){return this.privSpeechResponse.nickname},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"participantId",{get:function(){return this.privSpeechResponse.participantId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"roomid",{get:function(){return this.privSpeechResponse.roomid},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"timestamp",{get:function(){return this.privSpeechResponse.timestamp},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"type",{get:function(){return this.privSpeechResponse.type},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isFinal",{get:function(){return this.privSpeechResponse.type==="final"},enumerable:!1,configurable:!0}),r}();xr.SpeechResponsePayload=t;var e=function(){function r(n){this.privTextResponse=JSON.parse(n)}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"originalText",{get:function(){return this.privTextResponse.originalText},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"translations",{get:function(){return this.privTextResponse.translations},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"id",{get:function(){return this.privTextResponse.id},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"language",{get:function(){return this.privTextResponse.language},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"nickname",{get:function(){return this.privTextResponse.nickname},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"participantId",{get:function(){return this.privTextResponse.participantId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"roomid",{get:function(){return this.privTextResponse.roomid},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"timestamp",{get:function(){return this.privTextResponse.timestamp},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"type",{get:function(){return this.privTextResponse.type},enumerable:!1,configurable:!0}),r}();return xr.TextResponsePayload=e,xr}var Tw;function N7(){return Tw||(Tw=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=x7();Object.defineProperty(t,"CommandResponsePayload",{enumerable:!0,get:function(){return e.CommandResponsePayload}});var r=j7();Object.defineProperty(t,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantsListPayloadResponse}}),Object.defineProperty(t,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantPayloadResponse}});var n=z7();Object.defineProperty(t,"SpeechResponsePayload",{enumerable:!0,get:function(){return n.SpeechResponsePayload}}),Object.defineProperty(t,"TextResponsePayload",{enumerable:!0,get:function(){return n.TextResponsePayload}})}(av)),av}var Mw;function L7(){if(Mw)return ws;Mw=1;var t=w&&w.__extends||function(){var p=function(v,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var y in d)d.hasOwnProperty(y)&&(h[y]=d[y])},p(v,g)};return function(v,g){p(v,g);function h(){this.constructor=v}v.prototype=g===null?Object.create(g):(h.prototype=g.prototype,new h)}}(),e=w&&w.__awaiter||function(p,v,g,h){function d(y){return y instanceof g?y:new g(function(m){m(y)})}return new(g||(g=Promise))(function(y,m){function S(C){try{P(h.next(C))}catch(R){m(R)}}function b(C){try{P(h.throw(C))}catch(R){m(R)}}function P(C){C.done?y(C.value):d(C.value).then(S,b)}P((h=h.apply(p,v||[])).next())})},r=w&&w.__generator||function(p,v){var g={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},h,d,y,m;return m={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function S(P){return function(C){return b([P,C])}}function b(P){if(h)throw new TypeError("Generator is already executing.");for(;g;)try{if(h=1,d&&(y=P[0]&2?d.return:P[0]?d.throw||((y=d.return)&&y.call(d),0):d.next)&&!(y=y.call(d,P[1])).done)return y;switch(d=0,y&&(P=[P[0]&2,y.value]),P[0]){case 0:case 1:y=P;break;case 4:return g.label++,{value:P[1],done:!1};case 5:g.label++,d=P[1],P=[0];continue;case 7:P=g.ops.pop(),g.trys.pop();continue;default:if(y=g.trys,!(y=y.length>0&&y[y.length-1])&&(P[0]===6||P[0]===2)){g=0;continue}if(P[0]===3&&(!y||P[1]>y[0]&&P[1]<y[3])){g.label=P[1];break}if(P[0]===6&&g.label<y[1]){g.label=y[1],y=P;break}if(y&&g.label<y[2]){g.label=y[2],g.ops.push(P);break}y[2]&&g.ops.pop(),g.trys.pop();continue}P=v.call(p,g)}catch(C){P=[6,C],d=0}finally{h=y=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}};Object.defineProperty(ws,"__esModule",{value:!0}),ws.ConversationServiceAdapter=void 0;var n=K(),i=F(),l=H(),f=NI(),c=k7(),o=LI(),s=BI(),a=N7(),u=function(p){t(v,p);function v(g,h,d,y,m){var S=p.call(this,g,h,d,y,m)||this;return S.privLastPartialUtteranceId="",S.noOp=function(){},S.privConversationServiceConnector=m,S.privConversationAuthentication=g,S.receiveMessageOverride=S.receiveConversationMessageOverride,S.recognizeOverride=S.noOp,S.postConnectImplOverride=S.conversationConnectImpl,S.configConnectionOverride=S.configConnection,S.disconnectOverride=S.privDisconnect,S.privConversationRequestSession=new c.ConversationRequestSession(n.createNoDashGuid()),S.privConversationConnectionFactory=h,S.privConversationIsDisposed=!1,S}return v.prototype.isDisposed=function(){return p.prototype.isDisposed.call(this)||this.privConversationIsDisposed},v.prototype.dispose=function(g){return e(this,void 0,void 0,function(){var h;return r(this,function(d){switch(d.label){case 0:return this.privConversationIsDisposed=!0,this.privConnectionConfigPromise?[4,this.privConnectionConfigPromise]:[3,3];case 1:return h=d.sent(),[4,h.dispose(g)];case 2:d.sent(),d.label=3;case 3:return[4,p.prototype.dispose.call(this,g)];case 4:return d.sent(),[2]}})})},v.prototype.sendMessage=function(g){return e(this,void 0,void 0,function(){var h;return r(this,function(d){switch(d.label){case 0:return[4,this.fetchConnection()];case 1:return h=d.sent(),[2,h.send(new f.ConversationConnectionMessage(n.MessageType.Text,g))]}})})},v.prototype.sendMessageAsync=function(g){return e(this,void 0,void 0,function(){var h;return r(this,function(d){switch(d.label){case 0:return new n.Deferred,[4,this.fetchConnection()];case 1:return h=d.sent(),[4,h.send(new f.ConversationConnectionMessage(n.MessageType.Text,g))];case 2:return d.sent(),[2]}})})},v.prototype.privDisconnect=function(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()},v.prototype.processTypeSpecificMessages=function(g,h,d){return e(this,void 0,void 0,function(){return r(this,function(y){return[2,!0]})})},v.prototype.cancelRecognition=function(g,h,d,y,m){this.terminateMessageLoop=!0;var S=new i.ConversationTranslationCanceledEventArgs(d,m,y,void 0,g);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,S)}catch{}},v.prototype.conversationConnectImpl=function(g){return e(this,void 0,void 0,function(){return r(this,function(h){return this.privConnectionLoop=this.startMessageLoop(),[2,g]})})},v.prototype.receiveConversationMessageOverride=function(){return e(this,void 0,void 0,function(){var g,h,d,y,m,S,b,P,C,R,O,z,L,E,T,A;return r(this,function(_){switch(_.label){case 0:if(this.isDisposed()||this.terminateMessageLoop)return[2,Promise.resolve()];g=new n.Deferred,_.label=1;case 1:return _.trys.push([1,4,,5]),[4,this.fetchConnection()];case 2:return h=_.sent(),[4,h.read()];case 3:if(d=_.sent(),this.isDisposed()||this.terminateMessageLoop)return g.resolve(),[2,Promise.resolve()];if(!d)return[2,this.receiveConversationMessageOverride()];y=this.privConversationRequestSession.sessionId,m=!1;try{switch(d.conversationMessageType.toLowerCase()){case"info":case"participant_command":case"command":switch(S=a.CommandResponsePayload.fromJSON(d.textBody),S.command.toLowerCase()){case"participantlist":b=a.ParticipantsListPayloadResponse.fromJSON(d.textBody),P=b.participants.map(function($){var x={avatar:$.avatar,displayName:$.nickname,id:$.participantId,isHost:$.ishost,isMuted:$.ismuted,isUsingTts:$.usetts,preferredLanguage:$.locale};return x}),this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new o.ParticipantsListEventArgs(b.roomid,b.token,b.translateTo,b.profanityFilter,b.roomProfanityFilter,b.roomLocked,b.muteAll,P,y));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(S.participantId,s.ConversationTranslatorCommandTypes.setTranslateToLanguages,S.value,y));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(S.participantId,s.ConversationTranslatorCommandTypes.setProfanityFiltering,S.value,y));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(S.participantId,s.ConversationTranslatorCommandTypes.setMute,S.value,y));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new o.MuteAllEventArgs(S.value,y));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new i.ConversationExpirationEventArgs(S.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(S.participantId,s.ConversationTranslatorCommandTypes.setUseTTS,S.value,y));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new o.LockRoomEventArgs(S.value,y));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new o.ParticipantAttributeEventArgs(S.participantId,s.ConversationTranslatorCommandTypes.changeNickname,S.nickname,y));break;case"joinsession":C=a.ParticipantPayloadResponse.fromJSON(d.textBody),R={avatar:C.avatar,displayName:C.nickname,id:C.participantId,isHost:C.ishost,isMuted:C.ismuted,isUsingTts:C.usetts,preferredLanguage:C.locale},this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new o.ParticipantEventArgs(R,y));break;case"leavesession":O={id:S.participantId},this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new o.ParticipantEventArgs(O,y));break;case"disconnectsession":z={id:S.participantId};break;default:break}break;case"partial":case"final":L=a.SpeechResponsePayload.fromJSON(d.textBody),E=new i.ConversationTranslationResult(L.participantId,this.getTranslations(L.translations),L.language,void 0,void 0,L.recognition,void 0,void 0,d.textBody,void 0),L.isFinal?((E.text!==void 0&&E.text.length>0||L.id===this.privLastPartialUtteranceId)&&(m=!0),m&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new o.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.final,E,y))):E.text!==void 0&&(this.privLastPartialUtteranceId=L.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new o.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.partial,E,y)));break;case"translated_message":T=a.TextResponsePayload.fromJSON(d.textBody),A=new i.ConversationTranslationResult(T.participantId,this.getTranslations(T.translations),T.language,void 0,void 0,T.originalText,void 0,void 0,void 0,d.textBody,void 0),this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new o.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.instantMessage,A,y));break;default:break}}catch{}return[2,this.receiveConversationMessageOverride()];case 4:return _.sent(),this.terminateMessageLoop=!0,[3,5];case 5:return[2,g.promise]}})})},v.prototype.startMessageLoop=function(){return e(this,void 0,void 0,function(){var g,h,d;return r(this,function(y){switch(y.label){case 0:if(this.isDisposed())return[2,Promise.resolve()];this.terminateMessageLoop=!1,g=this.receiveConversationMessageOverride(),y.label=1;case 1:return y.trys.push([1,3,,4]),[4,g];case 2:return h=y.sent(),[2,h];case 3:return d=y.sent(),this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,d),[2,null];case 4:return[2]}})})},v.prototype.configConnection=function(){var g=this;return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise?this.privConnectionConfigPromise.then(function(h){return h.state()===n.ConnectionState.Disconnected?(g.privConnectionId=null,g.privConnectionConfigPromise=null,g.configConnection()):g.privConnectionConfigPromise},function(h){return g.privConnectionId=null,g.privConnectionConfigPromise=null,g.configConnection()}):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(function(h){return h}),this.privConnectionConfigPromise)},v.prototype.getTranslations=function(g){var h;if(g!==void 0){h=new i.Translations;for(var d=0,y=g;d<y.length;d++){var m=y[d];h.set(m.lang,m.translation)}}return h},v}(l.ServiceRecognizerBase);return ws.ConversationServiceAdapter=u,ws}var Dw;function B7(){if(Dw)return $r;Dw=1;var t=w&&w.__extends||function(){var p=function(v,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var y in d)d.hasOwnProperty(y)&&(h[y]=d[y])},p(v,g)};return function(v,g){p(v,g);function h(){this.constructor=v}v.prototype=g===null?Object.create(g):(h.prototype=g.prototype,new h)}}(),e=w&&w.__awaiter||function(p,v,g,h){function d(y){return y instanceof g?y:new g(function(m){m(y)})}return new(g||(g=Promise))(function(y,m){function S(C){try{P(h.next(C))}catch(R){m(R)}}function b(C){try{P(h.throw(C))}catch(R){m(R)}}function P(C){C.done?y(C.value):d(C.value).then(S,b)}P((h=h.apply(p,v||[])).next())})},r=w&&w.__generator||function(p,v){var g={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},h,d,y,m;return m={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function S(P){return function(C){return b([P,C])}}function b(P){if(h)throw new TypeError("Generator is already executing.");for(;g;)try{if(h=1,d&&(y=P[0]&2?d.return:P[0]?d.throw||((y=d.return)&&y.call(d),0):d.next)&&!(y=y.call(d,P[1])).done)return y;switch(d=0,y&&(P=[P[0]&2,y.value]),P[0]){case 0:case 1:y=P;break;case 4:return g.label++,{value:P[1],done:!1};case 5:g.label++,d=P[1],P=[0];continue;case 7:P=g.ops.pop(),g.trys.pop();continue;default:if(y=g.trys,!(y=y.length>0&&y[y.length-1])&&(P[0]===6||P[0]===2)){g=0;continue}if(P[0]===3&&(!y||P[1]>y[0]&&P[1]<y[3])){g.label=P[1];break}if(P[0]===6&&g.label<y[1]){g.label=y[1],y=P;break}if(y&&g.label<y[2]){g.label=y[2],g.ops.push(P);break}y[2]&&g.ops.pop(),g.trys.pop();continue}P=v.call(p,g)}catch(C){P=[6,C],d=0}finally{h=y=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}};Object.defineProperty($r,"__esModule",{value:!0}),$r.ConversationTranslatorRecognizer=$r.ConversationRecognizerFactory=void 0;var n=H(),i=K(),l=te(),f=F(),c=$7(),o=L7(),s=zI(),a=function(){function p(){}return p.fromConfig=function(v,g){return new u(v,g)},p}();$r.ConversationRecognizerFactory=a;var u=function(p){t(v,p);function v(g,h){var d=this,y=g;return l.Contracts.throwIfNull(y,"speechConfig"),d=p.call(this,h,y.properties,new c.ConversationConnectionFactory)||this,d.privIsDisposed=!1,d.privProperties=y.properties.clone(),d.privConnection=f.Connection.fromRecognizer(d),d}return Object.defineProperty(v.prototype,"connected",{set:function(g){this.privConnection.connected=g},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"disconnected",{set:function(g){this.privConnection.disconnected=g},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"speechRecognitionLanguage",{get:function(){return this.privSpeechRecognitionLanguage},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),v.prototype.isDisposed=function(){return this.privIsDisposed},v.prototype.connect=function(g,h,d){try{l.Contracts.throwIfDisposed(this.privIsDisposed),l.Contracts.throwIfNullOrWhitespace(g,"token"),this.privReco.conversationTranslatorToken=g,this.privReco.connectAsync(h,d)}catch(m){if(d)if(m instanceof Error){var y=m;d(y.name+": "+y.message)}else d(m)}},v.prototype.disconnect=function(g,h){try{l.Contracts.throwIfDisposed(this.privIsDisposed),this.privReco.disconnect().then(function(){g&&g()},function(y){h&&h(y)})}catch(y){if(h)if(y instanceof Error){var d=y;h(d.name+": "+d.message)}else h(y);this.dispose(!0).catch(function(m){i.Events.instance.onEvent(new i.BackgroundEvent(m))})}},v.prototype.sendRequest=function(g,h,d){try{l.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(g,h,d)}catch(m){if(d)if(m instanceof Error){var y=m;d(y.name+": "+y.message)}else d(m);this.dispose(!0).catch(function(S){i.Events.instance.onEvent(new i.BackgroundEvent(S))})}},v.prototype.close=function(){var g,h;return e(this,void 0,void 0,function(){return r(this,function(d){switch(d.label){case 0:return l.Contracts.throwIfDisposed(this.privIsDisposed),(g=this.privConnection)===null||g===void 0||g.closeConnection(),(h=this.privConnection)===null||h===void 0||h.close(),this.privConnection=void 0,[4,this.dispose(!0)];case 1:return d.sent(),[2]}})})},v.prototype.dispose=function(g){return e(this,void 0,void 0,function(){return r(this,function(h){switch(h.label){case 0:return this.privIsDisposed?[2]:g?(this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),[4,p.prototype.dispose.call(this,g)]):[3,2];case 1:h.sent(),h.label=2;case 2:return[2]}})})},v.prototype.createRecognizerConfig=function(g){return new n.RecognizerConfig(g,this.privProperties)},v.prototype.createServiceRecognizer=function(g,h,d,y){var m=d;return new o.ConversationServiceAdapter(g,h,m,y,this)},v.prototype.sendMessage=function(g,h,d){var y=this.privReco;s.PromiseToEmptyCallback(y.sendMessageAsync(g),h,d)},v}(f.Recognizer);return $r.ConversationTranslatorRecognizer=u,$r}var Os={},$w;function q7(){if($w)return Os;$w=1;var t=w&&w.__extends||function(){var o=function(s,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,p){u.__proto__=p}||function(u,p){for(var v in p)p.hasOwnProperty(v)&&(u[v]=p[v])},o(s,a)};return function(s,a){o(s,a);function u(){this.constructor=s}s.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}(),e=w&&w.__awaiter||function(o,s,a,u){function p(v){return v instanceof a?v:new a(function(g){g(v)})}return new(a||(a=Promise))(function(v,g){function h(m){try{y(u.next(m))}catch(S){g(S)}}function d(m){try{y(u.throw(m))}catch(S){g(S)}}function y(m){m.done?v(m.value):p(m.value).then(h,d)}y((u=u.apply(o,s||[])).next())})},r=w&&w.__generator||function(o,s){var a={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},u,p,v,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(y){return function(m){return d([y,m])}}function d(y){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,p&&(v=y[0]&2?p.return:y[0]?p.throw||((v=p.return)&&v.call(p),0):p.next)&&!(v=v.call(p,y[1])).done)return v;switch(p=0,v&&(y=[y[0]&2,v.value]),y[0]){case 0:case 1:v=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,p=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(v=a.trys,!(v=v.length>0&&v[v.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!v||y[1]>v[0]&&y[1]<v[3])){a.label=y[1];break}if(y[0]===6&&a.label<v[1]){a.label=v[1],v=y;break}if(v&&a.label<v[2]){a.label=v[2],a.ops.push(y);break}v[2]&&a.ops.pop(),a.trys.pop();continue}y=s.call(o,a)}catch(m){y=[6,m],p=0}finally{u=v=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(Os,"__esModule",{value:!0}),Os.TranscriberRecognizer=void 0;var n=K(),i=te(),l=F(),f=H(),c=function(o){t(s,o);function s(a,u){var p=this,v=a;return i.Contracts.throwIfNull(v,"speechTranslationConfig"),i.Contracts.throwIfNullOrWhitespace(v.speechRecognitionLanguage,l.PropertyId[l.PropertyId.SpeechServiceConnection_RecoLanguage]),p=o.call(this,u,v.properties,new f.TranscriberConnectionFactory)||this,p.privDisposedRecognizer=!1,p}return s.prototype.getConversationInfo=function(){return i.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo},Object.defineProperty(s.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(l.PropertyId.SpeechServiceAuthorization_Token)},set:function(a){i.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(l.PropertyId.SpeechServiceAuthorization_Token,a)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"conversation",{set:function(a){i.Contracts.throwIfNullOrUndefined(a,"Conversation"),this.privConversation=a},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"speechRecognitionLanguage",{get:function(){return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(l.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"properties",{get:function(){return this.privProperties},enumerable:!1,configurable:!0}),s.prototype.startContinuousRecognitionAsync=function(a,u){n.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(f.RecognitionMode.Conversation),a,u)},s.prototype.stopContinuousRecognitionAsync=function(a,u){n.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),a,u)},s.prototype.close=function(){return e(this,void 0,void 0,function(){return r(this,function(a){switch(a.label){case 0:return i.Contracts.throwIfDisposed(this.privDisposedRecognizer),[4,this.dispose(!0)];case 1:return a.sent(),[2]}})})},s.prototype.pushConversationEvent=function(a,u){return e(this,void 0,void 0,function(){var p;return r(this,function(v){switch(v.label){case 0:return p=this.privReco,i.Contracts.throwIfNullOrUndefined(p,"serviceRecognizer"),[4,p.sendSpeechEventAsync(a,u)];case 1:return v.sent(),[2]}})})},s.prototype.connectCallbacks=function(a){this.canceled=function(u,p){a.canceled&&a.canceled(a,p)},this.recognizing=function(u,p){a.transcribing&&a.transcribing(a,p)},this.recognized=function(u,p){a.transcribed&&a.transcribed(a,p)},this.sessionStarted=function(u,p){a.sessionStarted&&a.sessionStarted(a,p)},this.sessionStopped=function(u,p){a.sessionStopped&&a.sessionStopped(a,p)}},s.prototype.disconnectCallbacks=function(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0},s.prototype.dispose=function(a){return e(this,void 0,void 0,function(){return r(this,function(u){switch(u.label){case 0:return this.privDisposedRecognizer?[2]:a?(this.privDisposedRecognizer=!0,[4,this.implRecognizerStop()]):[3,2];case 1:u.sent(),u.label=2;case 2:return[4,o.prototype.dispose.call(this,a)];case 3:return u.sent(),[2]}})})},s.prototype.createRecognizerConfig=function(a){return new f.RecognizerConfig(a,this.properties)},s.prototype.createServiceRecognizer=function(a,u,p,v){var g=p;return new f.TranscriptionServiceRecognizer(a,u,g,v,this)},s}(l.Recognizer);return Os.TranscriberRecognizer=c,Os}var kw;function F7(){return kw||(kw=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=M7();Object.defineProperty(t,"ConversationManager",{enumerable:!0,get:function(){return e.ConversationManager}});var r=Yd();Object.defineProperty(t,"ConversationConnectionConfig",{enumerable:!0,get:function(){return r.ConversationConnectionConfig}});var n=B7();Object.defineProperty(t,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return n.ConversationRecognizerFactory}});var i=q7();Object.defineProperty(t,"TranscriberRecognizer",{enumerable:!0,get:function(){return i.TranscriberRecognizer}});var l=LI();Object.defineProperty(t,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return l.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(t,"LockRoomEventArgs",{enumerable:!0,get:function(){return l.LockRoomEventArgs}}),Object.defineProperty(t,"MuteAllEventArgs",{enumerable:!0,get:function(){return l.MuteAllEventArgs}}),Object.defineProperty(t,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return l.ParticipantAttributeEventArgs}}),Object.defineProperty(t,"ParticipantEventArgs",{enumerable:!0,get:function(){return l.ParticipantEventArgs}}),Object.defineProperty(t,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return l.ParticipantsListEventArgs}});var f=BI();Object.defineProperty(t,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return f.ConversationTranslatorCommandTypes}}),Object.defineProperty(t,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return f.ConversationTranslatorMessageTypes}}),Object.defineProperty(t,"InternalParticipants",{enumerable:!0,get:function(){return f.InternalParticipants}})}(sv)),sv}var cv={},xw;function U7(){return xw||(xw=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SynthesisAudioMetadata=t.MetadataType=void 0,function(r){r.WordBoundary="WordBoundary",r.Bookmark="Bookmark",r.Viseme="Viseme"}(t.MetadataType||(t.MetadataType={}));var e=function(){function r(n){this.privSynthesisAudioMetadata=JSON.parse(n)}return r.fromJSON=function(n){return new r(n)},Object.defineProperty(r.prototype,"Metadata",{get:function(){return this.privSynthesisAudioMetadata.Metadata},enumerable:!1,configurable:!0}),r}();t.SynthesisAudioMetadata=e}(cv)),cv}var _s={},As={},jw;function qI(){if(jw)return As;jw=1;var t=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},e=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(As,"__esModule",{value:!0}),As.SynthesisAdapterBase=void 0;var r=K(),n=F(),i=H(),l=vp(),f=function(){function c(o,s,a,u,p){var v=this;if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.sendSynthesisContext=function(g){var h=v.synthesisContext.toJSON();if(h)return g.send(new l.SpeechConnectionMessage(r.MessageType.Text,"synthesis.context",v.privSynthesisTurn.requestId,"application/json",h))},this.sendSpeechServiceConfig=function(g,h){if(h)return g.send(new l.SpeechConnectionMessage(r.MessageType.Text,"speech.config",v.privSynthesisTurn.requestId,"application/json",h))},this.sendSsmlMessage=function(g,h,d){return g.send(new l.SpeechConnectionMessage(r.MessageType.Text,"ssml",d,"application/ssml+xml",h))},!o)throw new r.ArgumentNullError("authentication");if(!s)throw new r.ArgumentNullError("connectionFactory");if(!a)throw new r.ArgumentNullError("synthesizerConfig");this.privAuthentication=o,this.privConnectionFactory=s,this.privSynthesizerConfig=a,this.privIsDisposed=!1,this.privSpeechSynthesizer=u,this.privSessionAudioDestination=p,this.privSynthesisTurn=new i.SynthesisTurn,this.privConnectionEvents=new r.EventSource,this.privServiceEvents=new r.EventSource,this.privSynthesisContext=new i.SynthesisContext(this.privSpeechSynthesizer),this.privAgentConfig=new i.AgentConfig,this.connectionEvents.attach(function(g){if(g.name==="ConnectionClosedEvent"){var h=g;h.statusCode!==1e3&&v.cancelSynthesisLocal(n.CancellationReason.Error,h.statusCode===1007?n.CancellationErrorCode.BadRequestParameters:n.CancellationErrorCode.ConnectionFailure,h.reason+" websocket error code: "+h.statusCode)}})}return Object.defineProperty(c.prototype,"synthesisContext",{get:function(){return this.privSynthesisContext},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"agentConfig",{get:function(){return this.privAgentConfig},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"connectionEvents",{get:function(){return this.privConnectionEvents},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"serviceEvents",{get:function(){return this.privServiceEvents},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"activityTemplate",{get:function(){return this.privActivityTemplate},set:function(o){this.privActivityTemplate=o},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"audioOutputFormat",{set:function(o){this.privAudioOutputFormat=o,this.privSynthesisTurn.audioOutputFormat=o,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=o),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=o)},enumerable:!1,configurable:!0}),c.addHeader=function(o,s){if(!s.hasHeader)return o;s.updateHeader(o.byteLength);var a=new Uint8Array(o.byteLength+s.header.byteLength);return a.set(new Uint8Array(s.header),0),a.set(new Uint8Array(o),s.header.byteLength),a.buffer},c.prototype.isDisposed=function(){return this.privIsDisposed},c.prototype.dispose=function(o){return t(this,void 0,void 0,function(){var s;return e(this,function(a){switch(a.label){case 0:return this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise?[4,this.privConnectionConfigurationPromise]:[3,3];case 1:return s=a.sent(),[4,s.dispose(o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},c.prototype.connect=function(){return t(this,void 0,void 0,function(){return e(this,function(o){switch(o.label){case 0:return[4,this.connectImpl()];case 1:return o.sent(),[2]}})})},c.prototype.sendNetworkMessage=function(o,s){return t(this,void 0,void 0,function(){var a,u,p;return e(this,function(v){switch(v.label){case 0:return a=typeof s=="string"?r.MessageType.Text:r.MessageType.Binary,u=typeof s=="string"?"application/json":"",[4,this.fetchConnection()];case 1:return p=v.sent(),[2,p.send(new l.SpeechConnectionMessage(a,o,this.privSynthesisTurn.requestId,u,s))]}})})},c.prototype.Speak=function(o,s,a,u,p,v){return t(this,void 0,void 0,function(){var g,h,d,y;return e(this,function(m){switch(m.label){case 0:if(s?g=o:g=this.privSpeechSynthesizer.buildSsml(o),this.speakOverride!==void 0)return[2,this.speakOverride(g,a,u,p)];this.privSuccessCallback=u,this.privErrorCallback=p,this.privSynthesisTurn.startNewSynthesis(a,o,s,v),m.label=1;case 1:return m.trys.push([1,6,,7]),[4,this.connectImpl()];case 2:return m.sent(),[4,this.fetchConnection()];case 3:return h=m.sent(),[4,this.sendSynthesisContext(h)];case 4:return m.sent(),[4,this.sendSsmlMessage(h,g,a)];case 5:return m.sent(),d=new n.SpeechSynthesisEventArgs(new n.SpeechSynthesisResult(a,n.ResultReason.SynthesizingAudioStarted)),this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,d),this.receiveMessage(),[3,7];case 6:return y=m.sent(),this.cancelSynthesisLocal(n.CancellationReason.Error,n.CancellationErrorCode.ConnectionFailure,y),[2,Promise.reject(y)];case 7:return[2]}})})},c.prototype.cancelSynthesis=function(o,s,a,u){var p=new n.PropertyCollection;p.setProperty(i.CancellationErrorCodePropertyName,n.CancellationErrorCode[a]);var v=new n.SpeechSynthesisResult(o,n.ResultReason.Canceled,void 0,u,p);if(this.privSpeechSynthesizer.SynthesisCanceled){var g=new n.SpeechSynthesisEventArgs(v);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,g)}catch{}}if(this.privSuccessCallback)try{this.privSuccessCallback(v)}catch{}},c.prototype.cancelSynthesisLocal=function(o,s,a){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,o,s,a))},c.prototype.processTypeSpecificMessages=function(o,s,a){return!0},c.prototype.receiveMessage=function(){return t(this,void 0,void 0,function(){var o,s,a,u,p,v,g,h,d,y,m,S,b,P,C,R;return e(this,function(O){switch(O.label){case 0:return O.trys.push([0,14,,15]),[4,this.fetchConnection()];case 1:return o=O.sent(),[4,o.read()];case 2:if(s=O.sent(),this.receiveMessageOverride!==void 0)return[2,this.receiveMessageOverride()];if(this.privIsDisposed)return[2];if(!s)return this.privSynthesisTurn.isSynthesizing?[2,this.receiveMessage()]:[2];if(this.privServiceHasSentMessage=!0,a=l.SpeechConnectionMessage.fromConnectionMessage(s),a.requestId.toLowerCase()!==this.privSynthesisTurn.requestId.toLowerCase())return[3,13];switch(u=a.path.toLowerCase(),u){case"turn.start":return[3,3];case"response":return[3,4];case"audio":return[3,5];case"audio.metadata":return[3,6];case"turn.end":return[3,7]}return[3,12];case 3:return this.privSynthesisTurn.onServiceTurnStartResponse(),[3,13];case 4:return this.privSynthesisTurn.onServiceResponseMessage(a.textBody),[3,13];case 5:if(this.privSynthesisTurn.streamId.toLowerCase()===a.streamId.toLowerCase()&&a.binaryBody){if(this.privSynthesisTurn.onAudioChunkReceived(a.binaryBody),this.privSpeechSynthesizer.synthesizing)try{p=c.addHeader(a.binaryBody,this.privSynthesisTurn.audioOutputFormat),v=new n.SpeechSynthesisEventArgs(new n.SpeechSynthesisResult(this.privSynthesisTurn.requestId,n.ResultReason.SynthesizingAudio,p)),this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,v)}catch{}this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(a.binaryBody)}return[3,13];case 6:for(g=i.SynthesisAudioMetadata.fromJSON(a.textBody).Metadata,h=0,d=g;h<d.length;h++)switch(y=d[h],y.Type){case i.MetadataType.WordBoundary:if(this.privSynthesisTurn.onWordBoundaryEvent(y.Data.text.Text),m=new n.SpeechSynthesisWordBoundaryEventArgs(y.Data.Offset,y.Data.text.Text,y.Data.text.Length,this.privSynthesisTurn.currentTextOffset),this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,m)}catch{}break;case i.MetadataType.Bookmark:if(S=new n.SpeechSynthesisBookmarkEventArgs(y.Data.Offset,y.Data.Bookmark),this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,S)}catch{}break;case i.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(y),y.Data.IsLastAnimation&&(b=new n.SpeechSynthesisVisemeEventArgs(y.Data.Offset,y.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation()),this.privSpeechSynthesizer.visemeReceived))try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,b)}catch{}break}return[3,13];case 7:this.privSynthesisTurn.onServiceTurnEndResponse(),P=void 0,O.label=8;case 8:return O.trys.push([8,10,,11]),[4,this.privSynthesisTurn.getAllReceivedAudioWithHeader()];case 9:return C=O.sent(),P=new n.SpeechSynthesisResult(this.privSynthesisTurn.requestId,n.ResultReason.SynthesizingAudioCompleted,C),this.privSuccessCallback&&this.privSuccessCallback(P),[3,11];case 10:return R=O.sent(),this.privErrorCallback&&this.privErrorCallback(R),[3,11];case 11:if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new n.SpeechSynthesisEventArgs(P))}catch{}return[3,13];case 12:this.processTypeSpecificMessages(a)||this.privServiceEvents&&this.serviceEvents.onEvent(new r.ServiceEvent(a.path.toLowerCase(),a.textBody)),O.label=13;case 13:return[2,this.receiveMessage()];case 14:return O.sent(),[3,15];case 15:return[2]}})})},c.prototype.connectImpl=function(o){var s=this;if(o===void 0&&(o=!1),this.privConnectionPromise)return this.privConnectionPromise.then(function(u){return u.state()===r.ConnectionState.Disconnected?(s.privConnectionId=null,s.privConnectionPromise=null,s.privServiceHasSentMessage=!1,s.connectImpl()):s.privConnectionPromise},function(u){return s.privConnectionId=null,s.privConnectionPromise=null,s.privServiceHasSentMessage=!1,s.connectImpl()});this.privAuthFetchEventId=r.createNoDashGuid(),this.privConnectionId=r.createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);var a=o?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=a.then(function(u){return t(s,void 0,void 0,function(){var p,v,g=this;return e(this,function(h){switch(h.label){case 0:return[4,this.privSynthesisTurn.onAuthCompleted(!1)];case 1:return h.sent(),p=this.privConnectionFactory.create(this.privSynthesizerConfig,u,this.privConnectionId),p.events.attach(function(d){g.connectionEvents.onEvent(d)}),[4,p.open()];case 2:return v=h.sent(),v.statusCode!==200?[3,4]:[4,this.privSynthesisTurn.onConnectionEstablishCompleted(v.statusCode)];case 3:return h.sent(),[2,Promise.resolve(p)];case 4:return v.statusCode===403&&!o?[2,this.connectImpl(!0)]:[3,5];case 5:return[4,this.privSynthesisTurn.onConnectionEstablishCompleted(v.statusCode,v.reason)];case 6:return h.sent(),[2,Promise.reject("Unable to contact server. StatusCode: "+v.statusCode+", "+this.privSynthesizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint)+" Reason: "+v.reason)]}})})},function(u){return t(s,void 0,void 0,function(){return e(this,function(p){switch(p.label){case 0:return[4,this.privSynthesisTurn.onAuthCompleted(!0,u)];case 1:throw p.sent(),new Error(u)}})})}),this.privConnectionPromise.catch(function(){}),this.privConnectionPromise},c.prototype.fetchConnection=function(){return t(this,void 0,void 0,function(){var o=this;return e(this,function(s){switch(s.label){case 0:return this.privConnectionConfigurationPromise?[2,this.privConnectionConfigurationPromise.then(function(a){return a.state()===r.ConnectionState.Disconnected?(o.privConnectionId=null,o.privConnectionConfigurationPromise=null,o.privServiceHasSentMessage=!1,o.fetchConnection()):o.privConnectionConfigurationPromise},function(a){return o.privConnectionId=null,o.privConnectionConfigurationPromise=null,o.privServiceHasSentMessage=!1,o.fetchConnection()})]:(this.privConnectionConfigurationPromise=this.configureConnection(),[4,this.privConnectionConfigurationPromise]);case 1:return[2,s.sent()]}})})},c.prototype.configureConnection=function(){return t(this,void 0,void 0,function(){var o;return e(this,function(s){switch(s.label){case 0:return[4,this.connectImpl()];case 1:return o=s.sent(),this.configConnectionOverride!==void 0?[2,this.configConnectionOverride(o)]:[4,this.sendSpeechServiceConfig(o,this.privSynthesizerConfig.SpeechServiceConfig.serialize())];case 2:return s.sent(),[2,o]}})})},c.telemetryDataEnabled=!0,c}();return As.SynthesisAdapterBase=f,As}var St={},zw;function V7(){if(zw)return St;zw=1;var t=w&&w.__extends||function(){var f=function(c,o){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var u in a)a.hasOwnProperty(u)&&(s[u]=a[u])},f(c,o)};return function(c,o){f(c,o);function s(){this.constructor=c}c.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}}();Object.defineProperty(St,"__esModule",{value:!0}),St.SynthesisStartedEvent=St.ConnectingToSynthesisServiceEvent=St.SynthesisTriggeredEvent=St.SpeechSynthesisEvent=void 0;var e=K(),r=function(f){t(c,f);function c(o,s,a){a===void 0&&(a=e.EventType.Info);var u=f.call(this,o,a)||this;return u.privRequestId=s,u}return Object.defineProperty(c.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!1,configurable:!0}),c}(e.PlatformEvent);St.SpeechSynthesisEvent=r;var n=function(f){t(c,f);function c(o,s,a){var u=f.call(this,"SynthesisTriggeredEvent",o)||this;return u.privSessionAudioDestinationId=s,u.privTurnAudioDestinationId=a,u}return Object.defineProperty(c.prototype,"audioSessionDestinationId",{get:function(){return this.privSessionAudioDestinationId},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"audioTurnDestinationId",{get:function(){return this.privTurnAudioDestinationId},enumerable:!1,configurable:!0}),c}(r);St.SynthesisTriggeredEvent=n;var i=function(f){t(c,f);function c(o,s){var a=f.call(this,"ConnectingToSynthesisServiceEvent",o)||this;return a.privAuthFetchEventId=s,a}return Object.defineProperty(c.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!1,configurable:!0}),c}(r);St.ConnectingToSynthesisServiceEvent=i;var l=function(f){t(c,f);function c(o,s){var a=f.call(this,"SynthesisStartedEvent",o)||this;return a.privAuthFetchEventId=s,a}return Object.defineProperty(c.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!1,configurable:!0}),c}(r);return St.SynthesisStartedEvent=l,St}var Nw;function W7(){if(Nw)return _s;Nw=1;var t=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},e=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(_s,"__esModule",{value:!0}),_s.SynthesisTurn=void 0;var r=K(),n=Fn(),i=qI(),l=V7(),f=function(){function c(){var o=this;this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.onPreConnectionStart=function(s,a){o.privAuthFetchEventId=s,o.onEvent(new l.ConnectingToSynthesisServiceEvent(o.privRequestId,o.privAuthFetchEventId))},this.onAuthCompleted=function(s,a){s&&o.onComplete()},this.onConnectionEstablishCompleted=function(s,a){if(s===200){o.onEvent(new l.SynthesisStartedEvent(o.requestId,o.privAuthFetchEventId)),o.privBytesReceived=0;return}else s===403&&o.onComplete()},this.onServiceResponseMessage=function(s){var a=JSON.parse(s);o.streamId=a.audio.streamId},this.onServiceTurnEndResponse=function(){o.privInTurn=!1,o.privTurnDeferral.resolve(),o.onComplete()},this.onServiceTurnStartResponse=function(){o.privTurnDeferral&&o.privInTurn&&(o.privTurnDeferral.reject("Another turn started before current completed."),o.privTurnDeferral.promise.then().catch(function(){})),o.privInTurn=!0,o.privTurnDeferral=new r.Deferred},this.dispose=function(s){o.privIsDisposed||(o.privIsDisposed=!0)},this.onEvent=function(s){r.Events.instance.onEvent(s)},this.onComplete=function(){o.privIsSynthesizing&&(o.privIsSynthesizing=!1,o.privIsSynthesisEnded=!0,o.privAudioOutputStream.close(),o.privInTurn=!1,o.privTurnAudioDestination!==void 0&&(o.privTurnAudioDestination.close(),o.privTurnAudioDestination=void 0))},this.privRequestId=r.createNoDashGuid(),this.privTurnDeferral=new r.Deferred,this.privTurnDeferral.resolve()}return Object.defineProperty(c.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"streamId",{get:function(){return this.privStreamId},set:function(o){this.privStreamId=o},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"audioOutputFormat",{get:function(){return this.privAudioOutputFormat},set:function(o){this.privAudioOutputFormat=o},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"turnCompletionPromise",{get:function(){return this.privTurnDeferral.promise},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"isSynthesisEnded",{get:function(){return this.privIsSynthesisEnded},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"isSynthesizing",{get:function(){return this.privIsSynthesizing},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"currentTextOffset",{get:function(){return this.privTextOffset},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"bytesReceived",{get:function(){return this.privBytesReceived},enumerable:!1,configurable:!0}),c.prototype.getAllReceivedAudio=function(){return t(this,void 0,void 0,function(){return e(this,function(o){switch(o.label){case 0:return this.privReceivedAudio?[2,Promise.resolve(this.privReceivedAudio)]:this.privIsSynthesisEnded?[4,this.readAllAudioFromStream()]:[2,null];case 1:return o.sent(),[2,Promise.resolve(this.privReceivedAudio)]}})})},c.prototype.getAllReceivedAudioWithHeader=function(){return t(this,void 0,void 0,function(){var o;return e(this,function(s){switch(s.label){case 0:return this.privReceivedAudioWithHeader?[2,this.privReceivedAudioWithHeader]:this.privIsSynthesisEnded?this.audioOutputFormat.hasHeader?[4,this.getAllReceivedAudio()]:[3,2]:[2,null];case 1:return o=s.sent(),this.privReceivedAudioWithHeader=i.SynthesisAdapterBase.addHeader(o,this.audioOutputFormat),[2,this.privReceivedAudioWithHeader];case 2:return[2,this.getAllReceivedAudio()]}})})},c.prototype.startNewSynthesis=function(o,s,a,u){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=o,this.privRawText=s,this.privIsSSML=a,this.privAudioOutputStream=new n.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privPartialVisemeAnimation="",u!==void 0&&(this.privTurnAudioDestination=u,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new l.SynthesisTriggeredEvent(this.requestId,void 0,u===void 0?void 0:u.id()))},c.prototype.onAudioChunkReceived=function(o){this.isSynthesizing&&(this.privAudioOutputStream.write(o),this.privBytesReceived+=o.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(o))},c.prototype.onWordBoundaryEvent=function(o){this.updateTextOffset(o)},c.prototype.onVisemeMetadataReceived=function(o){o.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=o.Data.AnimationChunk)},c.prototype.onStopSynthesizing=function(){this.onComplete()},c.prototype.getAndClearVisemeAnimation=function(){var o=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",o},c.prototype.updateTextOffset=function(o){this.privTextOffset>=0&&(this.privTextOffset=this.privRawText.indexOf(o,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+o.length),this.privIsSSML&&this.privRawText.indexOf("<",this.privTextOffset+1)>this.privRawText.indexOf(">",this.privTextOffset+1)&&this.updateTextOffset(o))},c.prototype.readAllAudioFromStream=function(){return t(this,void 0,void 0,function(){return e(this,function(o){switch(o.label){case 0:if(!this.privIsSynthesisEnded)return[3,4];this.privReceivedAudio=new ArrayBuffer(this.bytesReceived),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.privAudioOutputStream.read(this.privReceivedAudio)];case 2:return o.sent(),[3,4];case 3:return o.sent(),this.privReceivedAudio=new ArrayBuffer(0),[3,4];case 4:return[2]}})})},c}();return _s.SynthesisTurn=f,_s}var uv={},Lw;function H7(){return Lw||(Lw=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SynthesizerConfig=t.SynthesisServiceType=void 0;var e=H(),r;(function(i){i[i.Standard=0]="Standard",i[i.Custom=1]="Custom"})(r=t.SynthesisServiceType||(t.SynthesisServiceType={}));var n=function(){function i(l,f){this.privSynthesisServiceType=r.Standard,this.privSpeechServiceConfig=l||new e.SpeechServiceConfig(new e.Context(null)),this.privParameters=f}return Object.defineProperty(i.prototype,"parameters",{get:function(){return this.privParameters},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"synthesisServiceType",{get:function(){return this.privSynthesisServiceType},set:function(l){this.privSynthesisServiceType=l},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"SpeechServiceConfig",{get:function(){return this.privSpeechServiceConfig},enumerable:!1,configurable:!0}),i}();t.SynthesizerConfig=n}(uv)),uv}var Is={},Bw;function K7(){if(Bw)return Is;Bw=1,Object.defineProperty(Is,"__esModule",{value:!0}),Is.SynthesisContext=void 0;var t=function(){function e(r){this.privContext={},this.privSpeechSynthesizer=r}return e.prototype.setSection=function(r,n){this.privContext[r]=n},Object.defineProperty(e.prototype,"audioOutputFormat",{set:function(r){this.privAudioOutputFormat=r},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){var r=this.buildSynthesisContext();return this.setSection("synthesis",r),JSON.stringify(this.privContext)},e.prototype.buildSynthesisContext=function(){return{audio:{metadataOptions:{bookmarkEnabled:!!this.privSpeechSynthesizer.bookmarkReached,sentenceBoundaryEnabled:!1,visemeEnabled:!!this.privSpeechSynthesizer.visemeReceived,wordBoundaryEnabled:!!this.privSpeechSynthesizer.wordBoundary},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:this.privSpeechSynthesizer.autoDetectSourceLanguage}}},e}();return Is.SynthesisContext=t,Is}var Ts={},qw;function G7(){if(qw)return Ts;qw=1,Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.SpeakerRecognitionConfig=void 0;var t=H(),e=function(){function r(n,i){this.privContext=n||new t.Context(null),this.privParameters=i}return Object.defineProperty(r.prototype,"parameters",{get:function(){return this.privParameters},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Context",{get:function(){return this.privContext},enumerable:!1,configurable:!0}),r}();return Ts.SpeakerRecognitionConfig=e,Ts}var Ms={},Fw;function J7(){if(Fw)return Ms;Fw=1;var t=w&&w.__awaiter||function(l,f,c,o){function s(a){return a instanceof c?a:new c(function(u){u(a)})}return new(c||(c=Promise))(function(a,u){function p(h){try{g(o.next(h))}catch(d){u(d)}}function v(h){try{g(o.throw(h))}catch(d){u(d)}}function g(h){h.done?a(h.value):s(h.value).then(p,v)}g((o=o.apply(l,f||[])).next())})},e=w&&w.__generator||function(l,f){var c={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,s,a,u;return u={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function p(g){return function(h){return v([g,h])}}function v(g){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,s&&(a=g[0]&2?s.return:g[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,g[1])).done)return a;switch(s=0,a&&(g=[g[0]&2,a.value]),g[0]){case 0:case 1:a=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,s=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!a||g[1]>a[0]&&g[1]<a[3])){c.label=g[1];break}if(g[0]===6&&c.label<a[1]){c.label=a[1],a=g;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(g);break}a[2]&&c.ops.pop(),c.trys.pop();continue}g=f.call(l,c)}catch(h){g=[6,h],s=0}finally{o=a=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}};Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.SpeakerIdMessageAdapter=void 0;var r=yt(),n=F(),i=function(){function l(f){var c=f.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!c){var o=f.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region,"westus"),s=o&&o.toLowerCase().startsWith("china")?".azure.cn":".microsoft.com",a=f.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"https://"+o+".api.cognitive"+s+"/speaker/{mode}/v2.0/{dependency}");c=a+"/profiles"}this.privUri=c;var u=r.RestConfigBase.requestOptions;u.headers[r.RestConfigBase.configParams.subscriptionKey]=f.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Key,void 0),this.privRestAdapter=new r.RestMessageAdapter(u)}return l.prototype.createProfile=function(f,c){var o=this.getOperationUri(f);return this.privRestAdapter.setHeaders(r.RestConfigBase.configParams.contentTypeKey,"application/json"),this.privRestAdapter.request(r.RestRequestType.Post,o,{},{locale:c})},l.prototype.createEnrollment=function(f,c){var o=this;this.privRestAdapter.setHeaders(r.RestConfigBase.configParams.contentTypeKey,"multipart/form-data");var s=this.getOperationUri(f.profileType)+"/"+f.profileId+"/enrollments";return c.blob.then(function(a){return o.privRestAdapter.request(r.RestRequestType.File,s,{ignoreMinLength:"true"},null,a)})},l.prototype.verifySpeaker=function(f,c){return t(this,void 0,void 0,function(){var o,s,a;return e(this,function(u){switch(u.label){case 0:this.privRestAdapter.setHeaders(r.RestConfigBase.configParams.contentTypeKey,"multipart/form-data"),o=this.getOperationUri(f.voiceProfile.profileType)+"/"+f.voiceProfile.profileId+"/verify",u.label=1;case 1:return u.trys.push([1,3,,4]),[4,c.blob];case 2:return s=u.sent(),[2,this.privRestAdapter.request(r.RestRequestType.File,o,{ignoreMinLength:"true"},null,s)];case 3:return a=u.sent(),[2,Promise.resolve({data:a})];case 4:return[2]}})})},l.prototype.identifySpeaker=function(f,c){return t(this,void 0,void 0,function(){var o,s,a;return e(this,function(u){switch(u.label){case 0:this.privRestAdapter.setHeaders(r.RestConfigBase.configParams.contentTypeKey,"multipart/form-data"),o=this.getOperationUri(n.VoiceProfileType.TextIndependentIdentification)+"/identifySingleSpeaker",u.label=1;case 1:return u.trys.push([1,3,,4]),[4,c.blob];case 2:return s=u.sent(),[2,this.privRestAdapter.request(r.RestRequestType.File,o,{profileIds:f.voiceProfileIds,ignoreMinLength:"true"},null,s)];case 3:return a=u.sent(),[2,Promise.resolve({data:a})];case 4:return[2]}})})},l.prototype.getProfileStatus=function(f){var c=this.getOperationUri(f.profileType)+"/"+f.profileId;return this.privRestAdapter.request(r.RestRequestType.Get,c,{})},l.prototype.getProfiles=function(f){var c=this.getOperationUri(f);return this.privRestAdapter.request(r.RestRequestType.Get,c,{})},l.prototype.getAuthorizationPhrases=function(f){var c=(""+this.getOperationUri(n.VoiceProfileType.TextDependentVerification)).replace("profiles","phrases")+"/"+f;return this.privRestAdapter.request(r.RestRequestType.Get,c,{})},l.prototype.deleteProfile=function(f){var c=this.getOperationUri(f.profileType)+"/"+f.profileId;return this.privRestAdapter.request(r.RestRequestType.Delete,c,{})},l.prototype.resetProfile=function(f){var c=this.getOperationUri(f.profileType)+"/"+f.profileId+"/reset";return this.privRestAdapter.request(r.RestRequestType.Post,c,{})},l.prototype.getOperationUri=function(f){var c=f===n.VoiceProfileType.TextIndependentIdentification?"identification":"verification",o=f===n.VoiceProfileType.TextDependentVerification?"text-dependent":"text-independent";return this.privUri.replace("{mode}",c).replace("{dependency}",o)},l}();return Ms.SpeakerIdMessageAdapter=i,Ms}var Uw;function H(){return Uw||(Uw=1,function(t){var e=w&&w.__createBinding||(Object.create?function(n,i,l,f){f===void 0&&(f=l),Object.defineProperty(n,f,{enumerable:!0,get:function(){return i[l]}})}:function(n,i,l,f){f===void 0&&(f=l),n[f]=i[l]}),r=w&&w.__exportStar||function(n,i){for(var l in n)l!=="default"&&!i.hasOwnProperty(l)&&e(i,n,l)};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoDetectSourceLanguagesOpenRangeOptionName=t.ForceDictationPropertyName=t.ServicePropertiesPropertyName=t.CancellationErrorCodePropertyName=t.OutputFormatPropertyName=void 0,r(SG(),t),r(bG(),t),r(Wd(),t),r(CG(),t),r(PG(),t),r(Y5(),t),r(Jd(),t),r(X5(),t),r(Z5(),t),r(e7(),t),r(t7(),t),r(r7(),t),r(n7(),t),r(i7(),t),r(o7(),t),r(s7(),t),r(a7(),t),r(c7(),t),r(u7(),t),r(p7(),t),r(f7(),t),r(l7(),t),r(v7(),t),r(h7(),t),r(d7(),t),r(g7(),t),r(y7(),t),r(m7(),t),r(S7(),t),r(b7(),t),r(C7(),t),r(w7(),t),r(R7(),t),r(E7(),t),r(O7(),t),r(I7(),t),r(T7(),t),r(F7(),t),r(U7(),t),r(W7(),t),r(qI(),t),r(H7(),t),r(K7(),t),r(G7(),t),r(J7(),t),t.OutputFormatPropertyName="OutputFormat",t.CancellationErrorCodePropertyName="CancellationErrorCode",t.ServicePropertiesPropertyName="ServiceProperties",t.ForceDictationPropertyName="ForceDictation",t.AutoDetectSourceLanguagesOpenRangeOptionName="OpenRange"}($l)),$l}var Vw;function Q7(){return Vw||(Vw=1,function(t){var e=w&&w.__awaiter||function(c,o,s,a){function u(p){return p instanceof s?p:new s(function(v){v(p)})}return new(s||(s=Promise))(function(p,v){function g(y){try{d(a.next(y))}catch(m){v(m)}}function h(y){try{d(a.throw(y))}catch(m){v(m)}}function d(y){y.done?p(y.value):u(y.value).then(g,h)}d((a=a.apply(c,o||[])).next())})},r=w&&w.__generator||function(c,o){var s={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},a,u,p,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(d){return function(y){return h([d,y])}}function h(d){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,u&&(p=d[0]&2?u.return:d[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,d[1])).done)return p;switch(u=0,p&&(d=[d[0]&2,p.value]),d[0]){case 0:case 1:p=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,u=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(p=s.trys,!(p=p.length>0&&p[p.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!p||d[1]>p[0]&&d[1]<p[3])){s.label=d[1];break}if(d[0]===6&&s.label<p[1]){s.label=p[1],p=d;break}if(p&&s.label<p[2]){s.label=p[2],s.ops.push(d);break}p[2]&&s.ops.pop(),s.trys.pop();continue}d=o.call(c,s)}catch(y){d=[6,y],u=0}finally{a=p=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.MicAudioSource=t.AudioWorkletSourceURLPropertyName=void 0;var n=H(),i=K(),l=tn();t.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";var f=function(){function c(o,s,a,u){var p=this;this.privRecorder=o,this.deviceId=s,this.privStreams={},this.turnOn=function(){if(p.privInitializeDeferral)return p.privInitializeDeferral.promise;p.privInitializeDeferral=new i.Deferred;try{p.createAudioContext()}catch(m){if(m instanceof Error){var v=m;p.privInitializeDeferral.reject(v.name+": "+v.message)}else p.privInitializeDeferral.reject(m);return p.privInitializeDeferral.promise}var g=window.navigator,h=g.getUserMedia||g.webkitGetUserMedia||g.mozGetUserMedia||g.msGetUserMedia;if(g.mediaDevices&&(h=function(m,S,b){g.mediaDevices.getUserMedia(m).then(S).catch(b)}),h){var y=function(){p.onEvent(new i.AudioSourceInitializingEvent(p.privId)),p.privMediaStream&&p.privMediaStream.active?(p.onEvent(new i.AudioSourceReadyEvent(p.privId)),p.privInitializeDeferral.resolve()):h({audio:p.deviceId?{deviceId:p.deviceId}:!0,video:!1},function(m){p.privMediaStream=m,p.onEvent(new i.AudioSourceReadyEvent(p.privId)),p.privInitializeDeferral.resolve()},function(m){var S="Error occurred during microphone initialization: "+m;p.privInitializeDeferral.reject(S),p.onEvent(new i.AudioSourceErrorEvent(p.privId,S))})};p.privContext.state==="suspended"?p.privContext.resume().then(y).catch(function(m){p.privInitializeDeferral.reject("Failed to initialize audio context: "+m)}):y()}else{var d="Browser does not support getUserMedia.";p.privInitializeDeferral.reject(d),p.onEvent(new i.AudioSourceErrorEvent(d,""))}return p.privInitializeDeferral.promise},this.id=function(){return p.privId},this.attach=function(v){return p.onEvent(new i.AudioStreamNodeAttachingEvent(p.privId,v)),p.listen(v).then(function(g){return p.onEvent(new i.AudioStreamNodeAttachedEvent(p.privId,v)),{detach:function(){return e(p,void 0,void 0,function(){return r(this,function(h){return g.readEnded(),delete this.privStreams[v],this.onEvent(new i.AudioStreamNodeDetachedEvent(this.privId,v)),[2,this.turnOff()]})})},id:function(){return v},read:function(){return g.read()}}})},this.detach=function(v){v&&p.privStreams[v]&&(p.privStreams[v].close(),delete p.privStreams[v],p.onEvent(new i.AudioStreamNodeDetachedEvent(p.privId,v)))},this.listen=function(v){return e(p,void 0,void 0,function(){var g,h;return r(this,function(d){switch(d.label){case 0:return[4,this.turnOn()];case 1:d.sent(),g=new i.ChunkedArrayBufferStream(this.privOutputChunkSize,v),this.privStreams[v]=g;try{this.privRecorder.record(this.privContext,this.privMediaStream,g)}catch(y){throw this.onEvent(new i.AudioStreamNodeErrorEvent(this.privId,v,y)),y}return h=g,[2,h]}})})},this.onEvent=function(v){p.privEvents.onEvent(v),i.Events.instance.onEvent(v)},this.createAudioContext=function(){p.privContext||(p.privContext=l.AudioStreamFormatImpl.getAudioContext(c.AUDIOFORMAT.samplesPerSec))},this.privOutputChunkSize=c.AUDIOFORMAT.avgBytesPerSec/10,this.privId=a||i.createNoDashGuid(),this.privEvents=new i.EventSource,this.privMediaStream=u||null}return Object.defineProperty(c.prototype,"format",{get:function(){return Promise.resolve(c.AUDIOFORMAT)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"blob",{get:function(){return Promise.reject("Not implemented for Mic input")},enumerable:!1,configurable:!0}),c.prototype.turnOff=function(){return e(this,void 0,void 0,function(){var o,s;return r(this,function(a){switch(a.label){case 0:for(o in this.privStreams)o&&(s=this.privStreams[o],s&&s.close());return this.onEvent(new i.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral?[4,this.privInitializeDeferral]:[3,2];case 1:a.sent(),this.privInitializeDeferral=null,a.label=2;case 2:return[4,this.destroyAudioContext()];case 3:return a.sent(),[2]}})})},Object.defineProperty(c.prototype,"events",{get:function(){return this.privEvents},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"deviceInfo",{get:function(){return this.getMicrophoneLabel().then(function(o){return{bitspersample:c.AUDIOFORMAT.bitsPerSample,channelcount:c.AUDIOFORMAT.channels,connectivity:n.connectivity.Unknown,manufacturer:"Speech SDK",model:o,samplerate:c.AUDIOFORMAT.samplesPerSec,type:n.type.Microphones}})},enumerable:!1,configurable:!0}),c.prototype.setProperty=function(o,s){if(o===t.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(s);else throw new Error("Property '"+o+"' is not supported on Microphone.")},c.prototype.getMicrophoneLabel=function(){var o=this,s="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(s);this.privMicrophoneLabel=s;var a=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(a===void 0)return Promise.resolve(this.privMicrophoneLabel);var u=new i.Deferred;return navigator.mediaDevices.enumerateDevices().then(function(p){for(var v=0,g=p;v<g.length;v++){var h=g[v];if(h.deviceId===a){o.privMicrophoneLabel=h.label;break}}u.resolve(o.privMicrophoneLabel)},function(){return u.resolve(o.privMicrophoneLabel)}),u.promise},c.prototype.destroyAudioContext=function(){return e(this,void 0,void 0,function(){var o;return r(this,function(s){switch(s.label){case 0:return this.privContext?(this.privRecorder.releaseMediaResources(this.privContext),o=!1,"close"in this.privContext&&(o=!0),o?[4,this.privContext.close()]:[3,2]):[2];case 1:return s.sent(),this.privContext=null,[3,4];case 2:return this.privContext!==null&&this.privContext.state==="running"?[4,this.privContext.suspend()]:[3,4];case 3:s.sent(),s.label=4;case 4:return[2]}})})},c.AUDIOFORMAT=l.AudioStreamFormat.getDefaultInputFormat(),c}();t.MicAudioSource=f}(Dl)),Dl}var Ds={},Ww;function Y7(){if(Ww)return Ds;Ww=1;var t=w&&w.__awaiter||function(f,c,o,s){function a(u){return u instanceof o?u:new o(function(p){p(u)})}return new(o||(o=Promise))(function(u,p){function v(d){try{h(s.next(d))}catch(y){p(y)}}function g(d){try{h(s.throw(d))}catch(y){p(y)}}function h(d){d.done?u(d.value):a(d.value).then(v,g)}h((s=s.apply(f,c||[])).next())})},e=w&&w.__generator||function(f,c){var o={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,a,u,p;return p={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function v(h){return function(d){return g([h,d])}}function g(h){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,a&&(u=h[0]&2?a.return:h[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,h[1])).done)return u;switch(a=0,u&&(h=[h[0]&2,u.value]),h[0]){case 0:case 1:u=h;break;case 4:return o.label++,{value:h[1],done:!1};case 5:o.label++,a=h[1],h=[0];continue;case 7:h=o.ops.pop(),o.trys.pop();continue;default:if(u=o.trys,!(u=u.length>0&&u[u.length-1])&&(h[0]===6||h[0]===2)){o=0;continue}if(h[0]===3&&(!u||h[1]>u[0]&&h[1]<u[3])){o.label=h[1];break}if(h[0]===6&&o.label<u[1]){o.label=u[1],u=h;break}if(u&&o.label<u[2]){o.label=u[2],o.ops.push(h);break}u[2]&&o.ops.pop(),o.trys.pop();continue}h=c.call(f,o)}catch(d){h=[6,d],a=0}finally{s=u=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}};Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.FileAudioSource=void 0;var r=H(),n=K(),i=tn(),l=function(){function f(c,o,s){var a=this;this.privStreams={},this.privHeaderEnd=44,this.turnOn=function(){if(a.privFilename.lastIndexOf(".wav")!==a.privFilename.length-4){var u=a.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return a.onEvent(new n.AudioSourceErrorEvent(u,"")),Promise.reject(u)}a.onEvent(new n.AudioSourceInitializingEvent(a.privId)),a.onEvent(new n.AudioSourceReadyEvent(a.privId))},this.id=function(){return a.privId},this.attach=function(u){return t(a,void 0,void 0,function(){var p,v=this;return e(this,function(g){switch(g.label){case 0:return this.onEvent(new n.AudioStreamNodeAttachingEvent(this.privId,u)),[4,this.upload(u)];case 1:return p=g.sent(),this.onEvent(new n.AudioStreamNodeAttachedEvent(this.privId,u)),[2,Promise.resolve({detach:function(){return t(v,void 0,void 0,function(){return e(this,function(h){switch(h.label){case 0:return p.readEnded(),delete this.privStreams[u],this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,u)),[4,this.turnOff()];case 1:return h.sent(),[2]}})})},id:function(){return u},read:function(){return p.read()}})]}})})},this.detach=function(u){u&&a.privStreams[u]&&(a.privStreams[u].close(),delete a.privStreams[u],a.onEvent(new n.AudioStreamNodeDetachedEvent(a.privId,u)))},this.turnOff=function(){for(var u in a.privStreams)if(u){var p=a.privStreams[u];p&&!p.isClosed&&p.close()}return a.onEvent(new n.AudioSourceOffEvent(a.privId)),Promise.resolve()},this.onEvent=function(u){a.privEvents.onEvent(u),n.Events.instance.onEvent(u)},this.privId=s||n.createNoDashGuid(),this.privEvents=new n.EventSource,this.privSource=c,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=c.name:this.privFilename=o||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}return Object.defineProperty(f.prototype,"format",{get:function(){return this.privAudioFormatPromise},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"blob",{get:function(){return Promise.resolve(this.privSource)},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"events",{get:function(){return this.privEvents},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"deviceInfo",{get:function(){return this.privAudioFormatPromise.then(function(c){return Promise.resolve({bitspersample:c.bitsPerSample,channelcount:c.channels,connectivity:r.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:c.samplesPerSec,type:r.type.File})})},enumerable:!1,configurable:!0}),f.prototype.readHeader=function(){var c=this,o=512,s=this.privSource.slice(0,o),a=new n.Deferred,u=function(g){var h=new DataView(g),d=function(C){return String.fromCharCode(h.getUint8(C),h.getUint8(C+1),h.getUint8(C+2),h.getUint8(C+3))};if(d(0)!=="RIFF"){a.reject("Invalid WAV header in file, RIFF was not found");return}if(d(8)!=="WAVE"||d(12)!=="fmt "){a.reject("Invalid WAV header in file, WAVEfmt was not found");return}for(var y=h.getInt32(16,!0),m=h.getUint16(22,!0),S=h.getUint32(24,!0),b=h.getUint16(34,!0),P=36+Math.max(y-16,0);d(P)!=="data";P+=2)if(P>o-8){a.reject("Invalid WAV header in file, data block was not found");return}c.privHeaderEnd=P+8,a.resolve(i.AudioStreamFormat.getWaveFormatPCM(S,b,m))};if(typeof window<"u"&&typeof Blob<"u"&&s instanceof Blob){var p=new FileReader;p.onload=function(g){var h=g.target.result;u(h)},p.readAsArrayBuffer(s)}else{var v=s;u(v.buffer.slice(v.byteOffset,v.byteOffset+v.byteLength))}return a.promise},f.prototype.upload=function(c){return t(this,void 0,void 0,function(){var o,s,a,u,p,v,g,h,d=this;return e(this,function(y){switch(y.label){case 0:o=function(m){var S="Error occurred while processing '"+d.privFilename+"'. "+m;throw d.onEvent(new n.AudioStreamNodeErrorEvent(d.privId,c,S)),new Error(S)},y.label=1;case 1:return y.trys.push([1,4,,5]),[4,this.turnOn()];case 2:return y.sent(),[4,this.privAudioFormatPromise];case 3:return s=y.sent(),a=new n.ChunkedArrayBufferStream(s.avgBytesPerSec/10,c),this.privStreams[c]=a,u=this.privSource.slice(this.privHeaderEnd),p=function(m){a.isClosed||(a.writeStreamChunk({buffer:m,isEnd:!1,timeReceived:Date.now()}),a.close())},typeof window<"u"&&typeof Blob<"u"&&u instanceof Blob?(v=new FileReader,v.onerror=function(m){o(m.toString())},v.onload=function(m){var S=m.target.result;p(S)},v.readAsArrayBuffer(u)):(g=u,p(g.buffer.slice(g.byteOffset,g.byteOffset+g.byteLength))),[2,a];case 4:return h=y.sent(),o(h),[3,5];case 5:return[2]}})})},f}();return Ds.FileAudioSource=l,Ds}var $s={},Hw;function X7(){if(Hw)return $s;Hw=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.PcmRecorder=void 0;var t=K(),e=function(){function r(){var n=this;this.record=function(i,l,f){var c=16e3,o=function(){var u=0;try{return i.createScriptProcessor(u,1,1)}catch{u=2048;for(var p=i.sampleRate;u<16384&&p>=2*c;)u<<=1,p>>=1;return i.createScriptProcessor(u,1,1)}}(),s=new t.RiffPcmEncoder(i.sampleRate,c);o.onaudioprocess=function(u){var p=u.inputBuffer.getChannelData(0);if(f&&!f.isClosed){var v=s.encode(p);v&&f.writeStreamChunk({buffer:v,isEnd:!1,timeReceived:Date.now()})}};var a=i.createMediaStreamSource(l);n.privSpeechProcessorScript&&i.audioWorklet?i.audioWorklet.addModule(n.privSpeechProcessorScript).then(function(){var u=new AudioWorkletNode(i,"speech-processor");u.port.onmessage=function(p){var v=p.data;if(f&&!f.isClosed){var g=s.encode(v);g&&f.writeStreamChunk({buffer:g,isEnd:!1,timeReceived:Date.now()})}},a.connect(u),u.connect(i.destination),n.privMediaResources={scriptProcessorNode:u,source:a,stream:l}}).catch(function(){a.connect(o),o.connect(i.destination),n.privMediaResources={scriptProcessorNode:o,source:a,stream:l}}):(a.connect(o),o.connect(i.destination),n.privMediaResources={scriptProcessorNode:o,source:a,stream:l})},this.releaseMediaResources=function(i){n.privMediaResources&&(n.privMediaResources.scriptProcessorNode&&(n.privMediaResources.scriptProcessorNode.disconnect(i.destination),n.privMediaResources.scriptProcessorNode=null),n.privMediaResources.source&&(n.privMediaResources.source.disconnect(),n.privMediaResources.stream.getTracks().forEach(function(l){return l.stop()}),n.privMediaResources.source=null))}}return r.prototype.setWorkletUrl=function(n){this.privSpeechProcessorScript=n},r}();return $s.PcmRecorder=e,$s}var ks={},xs={},js={},Kw;function Z7(){if(Kw)return js;Kw=1;var t={},e=w&&w.__assign||function(){return e=Object.assign||function(m){for(var S,b=1,P=arguments.length;b<P;b++){S=arguments[b];for(var C in S)Object.prototype.hasOwnProperty.call(S,C)&&(m[C]=S[C])}return m},e.apply(this,arguments)},r=w&&w.__createBinding||(Object.create?function(m,S,b,P){P===void 0&&(P=b),Object.defineProperty(m,P,{enumerable:!0,get:function(){return S[b]}})}:function(m,S,b,P){P===void 0&&(P=b),m[P]=S[b]}),n=w&&w.__setModuleDefault||(Object.create?function(m,S){Object.defineProperty(m,"default",{enumerable:!0,value:S})}:function(m,S){m.default=S}),i=w&&w.__importStar||function(m){if(m&&m.__esModule)return m;var S={};if(m!=null)for(var b in m)b!=="default"&&Object.hasOwnProperty.call(m,b)&&r(S,m,b);return n(S,m),S},l=w&&w.__awaiter||function(m,S,b,P){function C(R){return R instanceof b?R:new b(function(O){O(R)})}return new(b||(b=Promise))(function(R,O){function z(T){try{E(P.next(T))}catch(A){O(A)}}function L(T){try{E(P.throw(T))}catch(A){O(A)}}function E(T){T.done?R(T.value):C(T.value).then(z,L)}E((P=P.apply(m,S||[])).next())})},f=w&&w.__generator||function(m,S){var b={label:0,sent:function(){if(R[0]&1)throw R[1];return R[1]},trys:[],ops:[]},P,C,R,O;return O={next:z(0),throw:z(1),return:z(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function z(E){return function(T){return L([E,T])}}function L(E){if(P)throw new TypeError("Generator is already executing.");for(;b;)try{if(P=1,C&&(R=E[0]&2?C.return:E[0]?C.throw||((R=C.return)&&R.call(C),0):C.next)&&!(R=R.call(C,E[1])).done)return R;switch(C=0,R&&(E=[E[0]&2,R.value]),E[0]){case 0:case 1:R=E;break;case 4:return b.label++,{value:E[1],done:!1};case 5:b.label++,C=E[1],E=[0];continue;case 7:E=b.ops.pop(),b.trys.pop();continue;default:if(R=b.trys,!(R=R.length>0&&R[R.length-1])&&(E[0]===6||E[0]===2)){b=0;continue}if(E[0]===3&&(!R||E[1]>R[0]&&E[1]<R[3])){b.label=E[1];break}if(E[0]===6&&b.label<R[1]){b.label=R[1],R=E;break}if(R&&b.label<R[2]){b.label=R[2],b.ops.push(E);break}R[2]&&b.ops.pop(),b.trys.pop();continue}E=S.call(m,b)}catch(T){E=[6,T],C=0}finally{P=R=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},c=w&&w.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(js,"__esModule",{value:!0}),js.CertCheckAgent=void 0;var o=i(Dt),s=i(jA),a=i(Dt),u=K(),p=c(Dt),v=c(Dt),g=c(Dt),h=i(Dt),d=OI(),y=function(){function m(S){S&&(this.privProxyInfo=S),m.privDiskCache||(m.privDiskCache=new v.default("microsoft-cognitiveservices-speech-sdk-cache",{supportBuffer:!0,location:typeof process<"u"&&t.SPEECH_OCSP_CACHE_ROOT?t.SPEECH_OCSP_CACHE_ROOT:void 0}))}return m.forceReinitDiskCache=function(){m.privDiskCache=void 0,m.privMemCache={}},m.prototype.GetAgent=function(S){var b=new p.default.Agent(this.CreateConnection);if(this.privProxyInfo!==void 0&&this.privProxyInfo.HostName!==void 0&&this.privProxyInfo.Port>0){var P="privProxyInfo";b[P]=this.privProxyInfo}return b},m.GetProxyAgent=function(S){var b={host:S.HostName,port:S.Port};S.UserName?b.headers={"Proxy-Authentication":"Basic "+new Buffer(S.UserName+":"+(S.Password===void 0)?"":S.Password).toString("base64")}:b.headers={},b.headers.requestOCSP="true";var P=new g.default(b);return P},m.OCSPCheck=function(S,b){return l(this,void 0,void 0,function(){var P,C,R,O,z,L=this;return f(this,function(E){switch(E.label){case 0:return R=!1,[4,S];case 1:return O=E.sent(),O.cork(),z=O,[2,new Promise(function(T,A){O.on("OCSPResponse",function(_){_&&(L.onEvent(new u.OCSPStapleReceivedEvent),C=_)}),O.on("error",function(_){R||(R=!0,O.destroy(),A(_))}),z.on("secure",function(){return l(L,void 0,void 0,function(){var _,$,x,B,U;return f(this,function(N){switch(N.label){case 0:_=z.getPeerCertificate(!0),N.label=1;case 1:return N.trys.push([1,6,,7]),[4,this.GetIssuer(_)];case 2:return $=N.sent(),P=a.request.generate(_.raw,$.raw),x=P.id.toString("hex"),C?[3,4]:[4,m.GetResponseFromCache(x,P,b)];case 3:B=N.sent(),C=B,N.label=4;case 4:return[4,this.VerifyOCSPResponse(C,P,b)];case 5:return N.sent(),O.uncork(),R=!0,T(O),[3,7];case 6:return U=N.sent(),O.destroy(),R=!0,A(U),[3,7];case 7:return[2]}})})})})]}})})},m.GetIssuer=function(S){return S.issuerCertificate?Promise.resolve(S.issuerCertificate):new Promise(function(b,P){var C=new a.Agent({});C.fetchIssuer(S,null,function(R,O){if(R){P(R);return}b(O)})})},m.GetResponseFromCache=function(S,b,P){return l(this,void 0,void 0,function(){var C,R,O,z,L,E,T,A=this;return f(this,function(_){switch(_.label){case 0:if(C=m.privMemCache[S],C&&this.onEvent(new u.OCSPMemoryCacheHitEvent(S)),C)return[3,4];_.label=1;case 1:return _.trys.push([1,3,,4]),[4,m.privDiskCache.get(S)];case 2:return R=_.sent(),R.isCached&&(m.onEvent(new u.OCSPDiskCacheHitEvent(S)),m.StoreMemoryCacheEntry(S,R.value),C=R.value),[3,4];case 3:return _.sent(),C=null,[3,4];case 4:if(!C)return[2,C];try{if(O=a.utils.parseResponse(C),z=O.value.tbsResponseData,z.responses.length<1)return this.onEvent(new u.OCSPCacheFetchErrorEvent(S,"Not enough data in cached response")),[2];L=z.responses[0].thisUpdate,E=z.responses[0].nextUpdate,E<Date.now()+this.testTimeOffset-6e4?(this.onEvent(new u.OCSPCacheEntryExpiredEvent(S,E)),C=null):(T=Math.min(24*60*60*1e3,(E-L)/2),E-(Date.now()+this.testTimeOffset)<T?(this.onEvent(new u.OCSPCacheEntryNeedsRefreshEvent(S,L,E)),this.UpdateCache(b,P).catch(function($){A.onEvent(new d.OCSPCacheUpdateErrorEvent(S,$.toString()))})):this.onEvent(new u.OCSPCacheHitEvent(S,L,E)))}catch($){this.onEvent(new u.OCSPCacheFetchErrorEvent(S,$)),C=null}return C||this.onEvent(new u.OCSPCacheMissEvent(S)),[2,C]}})})},m.VerifyOCSPResponse=function(S,b,P){return l(this,void 0,void 0,function(){var C,R=this;return f(this,function(O){switch(O.label){case 0:return C=S,b.certID.toString("hex"),C?[3,2]:[4,m.GetOCSPResponse(b,P)];case 1:C=O.sent(),O.label=2;case 2:return[2,new Promise(function(z,L){a.verify({request:b,response:C},function(E,T){E?(m.onEvent(new u.OCSPVerificationFailedEvent(b.id.toString("hex"),E)),S?R.VerifyOCSPResponse(null,b,P).then(function(){z()},function(A){L(A)}):L(E)):(S||m.StoreCacheEntry(b.id.toString("hex"),C),z())})})]}})})},m.UpdateCache=function(S,b){return l(this,void 0,void 0,function(){var P,C;return f(this,function(R){switch(R.label){case 0:return P=S.id.toString("hex"),this.onEvent(new u.OCSPCacheUpdateNeededEvent(P)),[4,this.GetOCSPResponse(S,b)];case 1:return C=R.sent(),this.StoreCacheEntry(P,C),this.onEvent(new u.OCSPCacheUpdatehCompleteEvent(S.id.toString("hex"))),[2]}})})},m.StoreCacheEntry=function(S,b){this.StoreMemoryCacheEntry(S,b),this.StoreDiskCacheEntry(S,b)},m.StoreMemoryCacheEntry=function(S,b){this.privMemCache[S]=b,this.onEvent(new u.OCSPMemoryCacheStoreEvent(S))},m.StoreDiskCacheEntry=function(S,b){var P=this;this.privDiskCache.set(S,b).then(function(){P.onEvent(new u.OCSPDiskCacheStoreEvent(S))})},m.GetOCSPResponse=function(S,b){var P=this,C="1.3.6.1.5.5.7.48.1",R={};if(b){var O=m.GetProxyAgent(b);R.agent=O}return new Promise(function(z,L){a.utils.getAuthorityInfo(S.cert,C,function(E,T){if(E){L(E);return}var A=s.default(T);A.path=A.pathname,R=e(e({},R),A),a.utils.getResponse(R,S.data,function(_,$){if(_){L(_);return}P.onEvent(new u.OCSPResponseRetrievedEvent(S.certID.toString("hex"))),z($)})})})},m.prototype.CreateConnection=function(S,b){var P=typeof process<"u"&&t.NODE_TLS_REJECT_UNAUTHORIZED!=="0"&&t.SPEECH_CONDUCT_OCSP_CHECK!=="0"&&b.secureEndpoint,C;if(b=e(e({},b),{requestOCSP:!m.forceDisableOCSPStapling,servername:b.host}),this.privProxyInfo){var R=m.GetProxyAgent(this.privProxyInfo),O=R;C=new Promise(function(z,L){O.callback(S,b,function(E,T){E?L(E):z(T)})})}else b.secureEndpoint?C=Promise.resolve(o.connect(b)):C=Promise.resolve(h.connect(b));return P?m.OCSPCheck(C,this.privProxyInfo):C},m.testTimeOffset=0,m.forceDisableOCSPStapling=!1,m.privMemCache={},m.onEvent=function(S){u.Events.instance.onEvent(S)},m}();return js.CertCheckAgent=y,js}var Gw;function FI(){if(Gw)return xs;Gw=1;var t=w&&w.__awaiter||function(o,s,a,u){function p(v){return v instanceof a?v:new a(function(g){g(v)})}return new(a||(a=Promise))(function(v,g){function h(m){try{y(u.next(m))}catch(S){g(S)}}function d(m){try{y(u.throw(m))}catch(S){g(S)}}function y(m){m.done?v(m.value):p(m.value).then(h,d)}y((u=u.apply(o,s||[])).next())})},e=w&&w.__generator||function(o,s){var a={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},u,p,v,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(y){return function(m){return d([y,m])}}function d(y){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,p&&(v=y[0]&2?p.return:y[0]?p.throw||((v=p.return)&&v.call(p),0):p.next)&&!(v=v.call(p,y[1])).done)return v;switch(p=0,v&&(y=[y[0]&2,v.value]),y[0]){case 0:case 1:v=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,p=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(v=a.trys,!(v=v.length>0&&v[v.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!v||y[1]>v[0]&&y[1]<v[3])){a.label=y[1];break}if(y[0]===6&&a.label<v[1]){a.label=v[1],v=y;break}if(v&&a.label<v[2]){a.label=v[2],a.ops.push(y);break}v[2]&&a.ops.pop(),a.trys.pop();continue}y=s.call(o,a)}catch(m){y=[6,m],p=0}finally{u=v=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},r=w&&w.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(xs,"__esModule",{value:!0}),xs.WebsocketMessageAdapter=void 0;var n=Lt(),i=K(),l=r(Dt),f=Z7(),c=function(){function o(s,a,u,p,v,g){var h=this;if(this.open=function(){if(h.privConnectionState===i.ConnectionState.Disconnected)return Promise.reject("Cannot open a connection that is in "+h.privConnectionState+" state");if(h.privConnectionEstablishDeferral)return h.privConnectionEstablishDeferral.promise;h.privConnectionEstablishDeferral=new i.Deferred,h.privCertificateValidatedDeferral=new i.Deferred,h.privConnectionState=i.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!o.forceNpmWebSocket)h.privCertificateValidatedDeferral.resolve(),h.privWebsocketClient=new WebSocket(h.privUri);else{var d={headers:h.privHeaders,perMessageDeflate:h.privEnableCompression};h.privCertificateValidatedDeferral.resolve();var y=new f.CertCheckAgent(h.proxyInfo);d.agent=y.GetAgent(),h.privWebsocketClient=new l.default(h.privUri,d)}h.privWebsocketClient.binaryType="arraybuffer",h.privReceivingMessageQueue=new i.Queue,h.privDisconnectDeferral=new i.Deferred,h.privSendMessageQueue=new i.Queue,h.processSendQueue().catch(function(m){i.Events.instance.onEvent(new i.BackgroundEvent(m))})}catch(m){return h.privConnectionEstablishDeferral.resolve(new i.ConnectionOpenResponse(500,m)),h.privConnectionEstablishDeferral.promise}return h.onEvent(new i.ConnectionStartEvent(h.privConnectionId,h.privUri)),h.privWebsocketClient.onopen=function(m){h.privCertificateValidatedDeferral.promise.then(function(){h.privConnectionState=i.ConnectionState.Connected,h.onEvent(new i.ConnectionEstablishedEvent(h.privConnectionId)),h.privConnectionEstablishDeferral.resolve(new i.ConnectionOpenResponse(200,""))},function(S){h.privConnectionEstablishDeferral.reject(S)})},h.privWebsocketClient.onerror=function(m){h.onEvent(new i.ConnectionErrorEvent(h.privConnectionId,m.message,m.type)),h.privLastErrorReceived=m.message},h.privWebsocketClient.onclose=function(m){h.privConnectionState===i.ConnectionState.Connecting?(h.privConnectionState=i.ConnectionState.Disconnected,h.privConnectionEstablishDeferral.resolve(new i.ConnectionOpenResponse(m.code,m.reason+" "+h.privLastErrorReceived))):(h.privConnectionState=i.ConnectionState.Disconnected,h.privWebsocketClient=null,h.onEvent(new i.ConnectionClosedEvent(h.privConnectionId,m.code,m.reason))),h.onClose(m.code,m.reason).catch(function(S){i.Events.instance.onEvent(new i.BackgroundEvent(S))})},h.privWebsocketClient.onmessage=function(m){var S=new Date().toISOString();if(h.privConnectionState===i.ConnectionState.Connected){var b=new i.Deferred;if(h.privReceivingMessageQueue.enqueueFromPromise(b.promise),m.data instanceof ArrayBuffer){var P=new i.RawWebsocketMessage(i.MessageType.Binary,m.data);h.privMessageFormatter.toConnectionMessage(P).then(function(C){h.onEvent(new i.ConnectionMessageReceivedEvent(h.privConnectionId,S,C)),b.resolve(C)},function(C){b.reject("Invalid binary message format. Error: "+C)})}else{var P=new i.RawWebsocketMessage(i.MessageType.Text,m.data);h.privMessageFormatter.toConnectionMessage(P).then(function(R){h.onEvent(new i.ConnectionMessageReceivedEvent(h.privConnectionId,S,R)),b.resolve(R)},function(R){b.reject("Invalid text message format. Error: "+R)})}}},h.privConnectionEstablishDeferral.promise},this.send=function(d){if(h.privConnectionState!==i.ConnectionState.Connected)return Promise.reject("Cannot send on connection that is in "+i.ConnectionState[h.privConnectionState]+" state");var y=new i.Deferred,m=new i.Deferred;return h.privSendMessageQueue.enqueueFromPromise(m.promise),h.privMessageFormatter.fromConnectionMessage(d).then(function(S){m.resolve({Message:d,RawWebsocketMessage:S,sendStatusDeferral:y})},function(S){m.reject("Error formatting the message. "+S)}),y.promise},this.read=function(){return h.privConnectionState!==i.ConnectionState.Connected?Promise.reject("Cannot read on connection that is in "+h.privConnectionState+" state"):h.privReceivingMessageQueue.dequeue()},this.close=function(d){if(h.privWebsocketClient)h.privConnectionState!==i.ConnectionState.Disconnected&&h.privWebsocketClient.close(1e3,d||"Normal closure by client");else return Promise.resolve();return h.privDisconnectDeferral.promise},this.sendRawMessage=function(d){try{if(!d)return Promise.resolve();if(h.onEvent(new i.ConnectionMessageSentEvent(h.privConnectionId,new Date().toISOString(),d.Message)),h.isWebsocketOpen)h.privWebsocketClient.send(d.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+h.privConnectionId+" "+d.Message.id+" "+new Error().stack);return Promise.resolve()}catch(y){return Promise.reject("websocket send error: "+y)}},this.onEvent=function(d){h.privConnectionEvents.onEvent(d),i.Events.instance.onEvent(d)},!s)throw new i.ArgumentNullError("uri");if(!u)throw new i.ArgumentNullError("messageFormatter");this.proxyInfo=p,this.privConnectionEvents=new i.EventSource,this.privConnectionId=a,this.privMessageFormatter=u,this.privConnectionState=i.ConnectionState.None,this.privUri=s,this.privHeaders=v,this.privEnableCompression=g,this.privHeaders[n.HeaderNames.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}return Object.defineProperty(o.prototype,"state",{get:function(){return this.privConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"events",{get:function(){return this.privConnectionEvents},enumerable:!1,configurable:!0}),o.prototype.onClose=function(s,a){return t(this,void 0,void 0,function(){var u;return e(this,function(p){switch(p.label){case 0:return u="Connection closed. "+s+": "+a,this.privConnectionState=i.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),[4,this.privReceivingMessageQueue.drainAndDispose(function(v){},u)];case 1:return p.sent(),[4,this.privSendMessageQueue.drainAndDispose(function(v){v.sendStatusDeferral.reject(u)},u)];case 2:return p.sent(),[2]}})})},o.prototype.processSendQueue=function(){return t(this,void 0,void 0,function(){var s,a,u;return e(this,function(p){switch(p.label){case 0:return s=this.privSendMessageQueue.dequeue(),[4,s];case 1:if(a=p.sent(),!a)return[2];p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.sendRawMessage(a)];case 3:return p.sent(),a.sendStatusDeferral.resolve(),[3,5];case 4:return u=p.sent(),a.sendStatusDeferral.reject(u),[3,5];case 5:return[3,0];case 6:return[2]}})})},Object.defineProperty(o.prototype,"isWebsocketOpen",{get:function(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN},enumerable:!1,configurable:!0}),o.forceNpmWebSocket=!1,o}();return xs.WebsocketMessageAdapter=c,xs}var Jw;function eJ(){if(Jw)return ks;Jw=1;var t=w&&w.__awaiter||function(l,f,c,o){function s(a){return a instanceof c?a:new c(function(u){u(a)})}return new(c||(c=Promise))(function(a,u){function p(h){try{g(o.next(h))}catch(d){u(d)}}function v(h){try{g(o.throw(h))}catch(d){u(d)}}function g(h){h.done?a(h.value):s(h.value).then(p,v)}g((o=o.apply(l,f||[])).next())})},e=w&&w.__generator||function(l,f){var c={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,s,a,u;return u={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function p(g){return function(h){return v([g,h])}}function v(g){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,s&&(a=g[0]&2?s.return:g[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,g[1])).done)return a;switch(s=0,a&&(g=[g[0]&2,a.value]),g[0]){case 0:case 1:a=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,s=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!a||g[1]>a[0]&&g[1]<a[3])){c.label=g[1];break}if(g[0]===6&&c.label<a[1]){c.label=a[1],a=g;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(g);break}a[2]&&c.ops.pop(),c.trys.pop();continue}g=f.call(l,c)}catch(h){g=[6,h],s=0}finally{o=a=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}};Object.defineProperty(ks,"__esModule",{value:!0}),ks.WebsocketConnection=void 0;var r=K(),n=FI(),i=function(){function l(f,c,o,s,a,u,p){var v=this;if(u===void 0&&(u=!1),this.privIsDisposed=!1,this.isDisposed=function(){return v.privIsDisposed},this.state=function(){return v.privConnectionMessageAdapter.state},this.open=function(){return v.privConnectionMessageAdapter.open()},this.send=function(S){return v.privConnectionMessageAdapter.send(S)},this.read=function(){return v.privConnectionMessageAdapter.read()},!f)throw new r.ArgumentNullError("uri");if(!s)throw new r.ArgumentNullError("messageFormatter");this.privMessageFormatter=s;var g="",h=0;if(c){for(var d in c)if(d){g+=h===0&&f.indexOf("?")===-1?"?":"&";var y=encodeURIComponent(c[d]);g+=d+"="+y,h++}}if(o){for(var m in o)if(m){g+=h===0&&f.indexOf("?")===-1?"?":"&";var y=encodeURIComponent(o[m]);g+=m+"="+y,h++}}this.privUri=f+g,this.privId=p||r.createNoDashGuid(),this.privConnectionMessageAdapter=new n.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,a,o,u)}return l.prototype.dispose=function(){return t(this,void 0,void 0,function(){return e(this,function(f){switch(f.label){case 0:return this.privIsDisposed=!0,this.privConnectionMessageAdapter?[4,this.privConnectionMessageAdapter.close()]:[3,2];case 1:f.sent(),f.label=2;case 2:return[2]}})})},Object.defineProperty(l.prototype,"id",{get:function(){return this.privId},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"events",{get:function(){return this.privConnectionMessageAdapter.events},enumerable:!1,configurable:!0}),l}();return ks.WebsocketConnection=i,ks}var zs={},Qw;function tJ(){if(Qw)return zs;Qw=1,Object.defineProperty(zs,"__esModule",{value:!0}),zs.ReplayableAudioNode=void 0;var t=function(){function r(n,i){var l=this;this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.id=function(){return l.privAudioNode.id()},this.privAudioNode=n,this.privBytesPerSecond=i}return r.prototype.read=function(){var n=this;if(this.privReplay&&this.privBuffers.length!==0){var i=this.privReplayOffset-this.privBufferStartOffset,l=Math.round(i*this.privBytesPerSecond*1e-7);l%2!==0&&l++;for(var f=0;f<this.privBuffers.length&&l>=this.privBuffers[f].chunk.buffer.byteLength;)l-=this.privBuffers[f++].chunk.buffer.byteLength;if(f<this.privBuffers.length){var c=this.privBuffers[f].chunk.buffer.slice(l);return this.privReplayOffset+=c.byteLength/this.privBytesPerSecond*1e7,f===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:c,isEnd:!1,timeReceived:this.privBuffers[f].chunk.timeReceived})}}return this.privAudioNode.read().then(function(o){return o&&o.buffer&&(n.privBuffers.push(new e(o,n.privBufferSerial++,n.privBufferedBytes)),n.privBufferedBytes+=o.buffer.byteLength),o})},r.prototype.detach=function(){return this.privBuffers=void 0,this.privAudioNode.detach()},r.prototype.replay=function(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)},r.prototype.shrinkBuffers=function(n){if(!(this.privBuffers===void 0||this.privBuffers.length===0)){this.privLastShrinkOffset=n;for(var i=n-this.privBufferStartOffset,l=Math.round(i*this.privBytesPerSecond*1e-7),f=0;f<this.privBuffers.length&&l>=this.privBuffers[f].chunk.buffer.byteLength;)l-=this.privBuffers[f++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(n-l/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(f)}},r.prototype.findTimeAtOffset=function(n){if(n<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(var i=0,l=this.privBuffers;i<l.length;i++){var f=l[i],c=f.byteOffset/this.privBytesPerSecond*1e7,o=c+f.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(n>=c&&n<=o)return f.chunk.timeReceived}return 0},r}();zs.ReplayableAudioNode=t;var e=function(){function r(n,i,l){this.chunk=n,this.serial=i,this.byteOffset=l}return r}();return zs}var Ns={},Yw;function rJ(){if(Yw)return Ns;Yw=1,Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.ProxyInfo=void 0;var t=F(),e=function(){function r(n,i,l,f){this.privProxyHostName=n,this.privProxyPort=i,this.privProxyUserName=l,this.privProxyPassword=f}return r.fromParameters=function(n){return new r(n.getProperty(t.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(n.getProperty(t.PropertyId.SpeechServiceConnection_ProxyPort),10),n.getProperty(t.PropertyId.SpeechServiceConnection_ProxyUserName),n.getProperty(t.PropertyId.SpeechServiceConnection_ProxyPassword))},r.fromRecognizerConfig=function(n){return this.fromParameters(n.parameters)},Object.defineProperty(r.prototype,"HostName",{get:function(){return this.privProxyHostName},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Port",{get:function(){return this.privProxyPort},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"UserName",{get:function(){return this.privProxyUserName},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"Password",{get:function(){return this.privProxyPassword},enumerable:!1,configurable:!0}),r}();return Ns.ProxyInfo=e,Ns}var pv={},Xw;function nJ(){return Xw||(Xw=1,function(t){var e=w&&w.__createBinding||(Object.create?function(o,s,a,u){u===void 0&&(u=a),Object.defineProperty(o,u,{enumerable:!0,get:function(){return s[a]}})}:function(o,s,a,u){u===void 0&&(u=a),o[u]=s[a]}),r=w&&w.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),n=w&&w.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var a in o)a!=="default"&&Object.hasOwnProperty.call(o,a)&&e(s,o,a);return r(s,o),s};Object.defineProperty(t,"__esModule",{value:!0}),t.RestMessageAdapter=t.RestRequestType=void 0;var i=K(),l=n(Dt),f;(function(o){o.Get="get",o.Post="post",o.Delete="delete",o.File="file"})(f=t.RestRequestType||(t.RestRequestType={}));var c=function(){function o(s,a){if(!s)throw new i.ArgumentNullError("configParams");this.privHeaders=s.headers,this.privTimeout=s.timeout,this.privIgnoreCache=s.ignoreCache}return o.prototype.setHeaders=function(s,a){this.privHeaders[s]=a},o.prototype.request=function(s,a,u,p,v){var g=this;u===void 0&&(u={}),p===void 0&&(p=null),v===void 0&&(v=null);var h=new i.Deferred,d;typeof XMLHttpRequest>"u"?d=new l.XMLHttpRequest:d=new XMLHttpRequest;var y=s===f.File?"post":s;return d.open(y,this.withQuery(a,u),!0),this.privHeaders&&Object.keys(this.privHeaders).forEach(function(m){return d.setRequestHeader(m,g.privHeaders[m])}),this.privIgnoreCache&&d.setRequestHeader("Cache-Control","no-cache"),d.timeout=this.privTimeout,d.onload=function(){h.resolve(g.parseXHRResult(d))},d.onerror=function(){h.resolve(g.errorResponse(d,"Failed to make request."))},d.ontimeout=function(){h.resolve(g.errorResponse(d,"Request took longer than expected."))},s===f.File&&v?(d.setRequestHeader("Content-Type","multipart/form-data"),d.send(v)):s===f.Post&&p?(d.setRequestHeader("Content-Type","application/json"),d.send(JSON.stringify(p))):d.send(),h.promise},o.prototype.parseXHRResult=function(s){return{data:s.responseText,headers:s.getAllResponseHeaders(),json:function(){return JSON.parse(s.responseText)},ok:s.status>=200&&s.status<300,status:s.status,statusText:s.statusText}},o.prototype.errorResponse=function(s,a){return a===void 0&&(a=null),{data:a||s.statusText,headers:s.getAllResponseHeaders(),json:function(){return JSON.parse(a||'"'+s.statusText+'"')},ok:!1,status:s.status,statusText:s.statusText}},o.prototype.withQuery=function(s,a){a===void 0&&(a={});var u=this.queryParams(a);return u?s+(s.indexOf("?")===-1?"?":"&")+u:s},o.prototype.queryParams=function(s){return s===void 0&&(s={}),Object.keys(s).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(s[a])}).join("&")},o}();t.RestMessageAdapter=c}(pv)),pv}var Zw;function yt(){return Zw||(Zw=1,function(t){var e=w&&w.__createBinding||(Object.create?function(n,i,l,f){f===void 0&&(f=l),Object.defineProperty(n,f,{enumerable:!0,get:function(){return i[l]}})}:function(n,i,l,f){f===void 0&&(f=l),n[f]=i[l]}),r=w&&w.__exportStar||function(n,i){for(var l in n)l!=="default"&&!i.hasOwnProperty(l)&&e(i,n,l)};Object.defineProperty(t,"__esModule",{value:!0}),r(yG(),t),r(mG(),t),r(Q7(),t),r(Y7(),t),r(X7(),t),r(eJ(),t),r(FI(),t),r(tJ(),t),r(rJ(),t),r(nJ(),t),r(Qd(),t)}(dl)),dl}var eR;function iJ(){return eR||(eR=1,function(t){var e=w&&w.__createBinding||(Object.create?function(l,f,c,o){o===void 0&&(o=c),Object.defineProperty(l,o,{enumerable:!0,get:function(){return f[c]}})}:function(l,f,c,o){o===void 0&&(o=c),l[o]=f[c]}),r=w&&w.__exportStar||function(l,f){for(var c in l)c!=="default"&&!f.hasOwnProperty(c)&&e(f,l,c)};Object.defineProperty(t,"__esModule",{value:!0});var n=yt(),i=K();i.Events.instance.attachListener(new n.ConsoleLoggingListener),r(F(),t)}(hl)),hl}var tR;function UI(){if(tR)return ai;tR=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.default=void 0;var t=iJ(),e={AudioConfig:t.AudioConfig,OutputFormat:t.OutputFormat,ResultReason:t.ResultReason,SpeechConfig:t.SpeechConfig,SpeechRecognizer:t.SpeechRecognizer};return ai.default=e,ai}var rR;function oJ(){if(rR)return Nc;rR=1;var t=qn;Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.default=f;var e=t(Q8()),r=t(UI()),n=r.default.ResultReason,i=n.RecognizingSpeech,l=n.RecognizedSpeech;function f(c){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.maxAlternatives,a=s===void 0?1/0:s,u=o.textNormalization,p=u===void 0?"display":u;if(c.reason===i||c.reason===l&&!c.json.NBest){var v=[{confidence:.5,transcript:c.text}];return c.reason===l&&(v.isFinal=!0),v}else if(c.reason===l){var g=(0,e.default)((c.json.NBest||[]).slice(0,a).map(function(h){var d=h.Confidence,y=h.Display,m=h.ITN,S=h.Lexical,b=h.MaskedITN;return{confidence:d,transcript:p==="itn"?m:p==="lexical"?S:p==="maskeditn"?b:y}}),{isFinal:!0});return g}return[]}return Nc}var Bc={};const sJ=rE(Lz);var nR;function aJ(){if(nR)return Bc;nR=1;var t=qn;Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.default=r;var e=t(sJ);function r(){var n,i=[],l=function(o){if(n){var s=n,a=s.resolve;n=null,a(o)}else i.push(o)},f=function(){return i.length?Promise.resolve(i.shift()):(n||(n=(0,e.default)())).promise};return{push:l,shift:f}}return Bc}var qc={},fv={exports:{}},lv={exports:{}},iR;function cJ(){return iR||(iR=1,function(t){function e(r,n){if(r==null)return{};var i={},l=Object.keys(r),f,c;for(c=0;c<l.length;c++)f=l[c],!(n.indexOf(f)>=0)&&(i[f]=r[f]);return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(lv)),lv.exports}var oR;function uJ(){return oR||(oR=1,function(t){var e=cJ();function r(n,i){if(n==null)return{};var l=e(n,i),f,c;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(c=0;c<o.length;c++)f=o[c],!(i.indexOf(f)>=0)&&Object.prototype.propertyIsEnumerable.call(n,f)&&(l[f]=n[f])}return l}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(fv)),fv.exports}var Fc={},sR;function pJ(){if(sR)return Fc;sR=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.default=t;function t(e){return typeof e=="function"?e():e}return Fc}var aR;function fJ(){if(aR)return qc;aR=1;var t=qn;Object.defineProperty(qc,"__esModule",{value:!0}),qc.default=a;var e=t(vI()),r=t(za()),n=t(gI()),i=t(uJ()),l=t(pJ()),f=["authorizationToken","credentials","looseEvent","looseEvents","region","subscriptionKey"];function c(u,p){var v=Object.keys(u);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(u);p&&(g=g.filter(function(h){return Object.getOwnPropertyDescriptor(u,h).enumerable})),v.push.apply(v,g)}return v}function o(u){for(var p=1;p<arguments.length;p++){var v=arguments[p]!=null?arguments[p]:{};p%2?c(Object(v),!0).forEach(function(g){(0,r.default)(u,g,v[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(v)):c(Object(v)).forEach(function(g){Object.defineProperty(u,g,Object.getOwnPropertyDescriptor(v,g))})}return u}var s=!0;function a(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=u.authorizationToken,v=u.credentials,g=u.looseEvent,h=u.looseEvents,d=u.region,y=d===void 0?"westus":d,m=u.subscriptionKey,S=(0,i.default)(u,f);if(typeof g<"u"&&(console.warn('web-speech-cognitive-services: The option "looseEvent" should be named as "looseEvents".'),h=g),!v){if(!p&&!m)throw new Error("web-speech-cognitive-services: Credentials must be specified.");console.warn("web-speech-cognitive-services: We are deprecating authorizationToken, region, and subscriptionKey. Please use credentials instead. The deprecated option will be removed on or after 2020-11-14."),v=function(){var b=(0,n.default)(e.default.mark(function P(){return e.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(!p){R.next=8;break}return R.next=3,(0,l.default)(p);case 3:R.t1=R.sent,R.t2=y,R.t0={authorizationToken:R.t1,region:R.t2},R.next=13;break;case 8:return R.t3=y,R.next=11,(0,l.default)(m);case 11:R.t4=R.sent,R.t0={region:R.t3,subscriptionKey:R.t4};case 13:return R.abrupt("return",R.t0);case 14:case"end":return R.stop()}},P)}));return function(){return b.apply(this,arguments)}}()}return o(o({},S),{},{fetchCredentials:function(){var b=(0,n.default)(e.default.mark(function C(){var R,O,z,L,E,T,A,_;return e.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,l.default)(v);case 2:if(R=x.sent,O=R.authorizationToken,z=R.customVoiceHostname,L=R.region,E=R.speechRecognitionHostname,T=R.speechSynthesisHostname,A=R.subscriptionKey,!(!O&&!A||O&&A)){x.next=13;break}throw new Error('web-speech-cognitive-services: Either "authorizationToken" or "subscriptionKey" must be provided.');case 13:if(!(!L&&!(E&&T))){x.next=17;break}throw new Error('web-speech-cognitive-services: Either "region" or "speechRecognitionHostname" and "speechSynthesisHostname" must be set.');case 17:if(!(L&&(z||E||T))){x.next=21;break}throw new Error('web-speech-cognitive-services: Only either "region" or "customVoiceHostname", "speechRecognitionHostname" and "speechSynthesisHostname" can be set.');case 21:if(!O){x.next=26;break}if(typeof O=="string"){x.next=24;break}throw new Error('web-speech-cognitive-services: "authorizationToken" must be a string.');case 24:x.next=28;break;case 26:if(typeof A=="string"){x.next=28;break}throw new Error('web-speech-cognitive-services: "subscriptionKey" must be a string.');case 28:return s&&A&&(console.warn("web-speech-cognitive-services: In production environment, subscription key should not be used, authorization token should be used instead."),s=!1),_=O?{authorizationToken:O}:{subscriptionKey:A},L?_.region=L:(_.customVoiceHostname=z,_.speechRecognitionHostname=E,_.speechSynthesisHostname=T),x.abrupt("return",_);case 32:case"end":return x.stop()}},C)}));function P(){return b.apply(this,arguments)}return P}(),looseEvents:h})}return qc}var Ls={},cR;function lJ(){if(cR)return Ls;cR=1;var t=qn;Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.default=void 0;var e=t(qd()),r=t(Bd()),n=function(){function i(){(0,e.default)(this,i),this._phrases=[]}return(0,r.default)(i,[{key:"addFromString",value:function(){throw new Error("JSGF is not supported")}},{key:"phrases",get:function(){return this._phrases},set:function(f){if(Array.isArray(f))this._phrases=f;else if(typeof f=="string")this._phrases=[f];else throw new Error("The provided value is not an array or of type 'string'")}}]),i}();return Ls.default=n,Ls}var rt=qn;Object.defineProperty(ja,"__esModule",{value:!0});ja.createSpeechRecognitionPonyfillFromRecognizer=JI;ja.default=void 0;var $t=rt(vI()),uR=rt(dI()),vJ=rt(za()),Tu=rt(gI()),VI=rt(Bd()),WI=rt(qd()),HI=rt(yI()),hJ=rt(SI()),pR=rt(fp()),ve=J8(),fR=rt(oJ()),dJ=rt(aJ()),gJ=rt(fJ()),vv=rt(lJ()),La=rt(UI());function lR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Mu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lR(Object(r),!0).forEach(function(n){(0,vJ.default)(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function KI(t){var e=yJ();return function(){var n=(0,pR.default)(t),i;if(e){var l=(0,pR.default)(this).constructor;i=Reflect.construct(n,arguments,l)}else i=n.apply(this,arguments);return(0,hJ.default)(this,i)}}function yJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mJ=La.default.AudioConfig,SJ=La.default.OutputFormat,bJ=La.default.ResultReason,Uc=La.default.SpeechConfig,GI=La.default.SpeechRecognizer;function vR(t){var e=t.duration,r=t.errorDetails,n=t.json,i=t.offset,l=t.properties,f=t.reason,c=t.resultId,o=t.text;return{duration:e,errorDetails:r,json:JSON.parse(n),offset:i,properties:l,reason:f,resultId:c,text:o}}function CJ(t){var e=new Int16Array(t);return[].reduce.call(e,function(r,n){return r+Math.abs(n)},0)/e.length}function hv(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Promise(function(i,l){return t.apply(void 0,r.concat([i,l]))})}}var we=function(t){(0,HI.default)(r,t);var e=KI(r);function r(n){var i,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=l.data,c=l.emma,o=l.interpretation,s=l.resultIndex,a=l.results;return(0,WI.default)(this,r),i=e.call(this,n),i.data=f,i.emma=c,i.interpretation=o,i.resultIndex=s,i.results=a,i}return(0,VI.default)(r)}(ve.Event);function PJ(t){var e=t.attach,r=t.attach.bind(t),n,i;return t.attach=(0,Tu.default)($t.default.mark(function l(){var f;return $t.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r();case 2:return f=o.sent,o.abrupt("return",Mu(Mu({},f),{},{read:function(){var s=(0,Tu.default)($t.default.mark(function u(){var p;return $t.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,f.read();case 2:if(p=g.sent,!n&&CJ(p.buffer)>150&&(t.events.onEvent({name:"FirstAudibleChunk"}),n=!0),!i){g.next=6;break}return g.abrupt("return",{buffer:new ArrayBuffer(0),isEnd:!0,timeReceived:Date.now()});case 6:return g.abrupt("return",p);case 7:case"end":return g.stop()}},u)}));function a(){return s.apply(this,arguments)}return a}()}));case 4:case"end":return o.stop()}},l)})),{audioConfig:t,pause:function(){i=!0},unprepare:function(){t.attach=e}}}function JI(t){var e=t.createRecognizer,r=t.enableTelemetry,n=t.looseEvents,i=t.referenceGrammars,l=t.textNormalization;GI.enableTelemetry(r!==!1);var f=function(c){(0,HI.default)(s,c);var o=KI(s);function s(){var a;return(0,WI.default)(this,s),a=o.call(this),a._continuous=!1,a._interimResults=!1,a._lang=typeof window<"u"?window.document.documentElement.getAttribute("lang")||window.navigator.language:"en-US",a._grammars=new vv.default,a._maxAlternatives=1,a}return(0,VI.default)(s,[{key:"emitCognitiveServices",value:function(u,p){this.dispatchEvent(new we("cognitiveservices",{data:Mu(Mu({},p),{},{type:u})}))}},{key:"continuous",get:function(){return this._continuous},set:function(u){this._continuous=u}},{key:"grammars",get:function(){return this._grammars},set:function(u){if(u instanceof vv.default)this._grammars=u;else throw new Error("The provided value is not of type 'SpeechGrammarList'")}},{key:"interimResults",get:function(){return this._interimResults},set:function(u){this._interimResults=u}},{key:"maxAlternatives",get:function(){return this._maxAlternatives},set:function(u){this._maxAlternatives=u}},{key:"lang",get:function(){return this._lang},set:function(u){this._lang=u}},{key:"onaudioend",get:function(){return(0,ve.getEventAttributeValue)(this,"audioend")},set:function(u){(0,ve.setEventAttributeValue)(this,"audioend",u)}},{key:"onaudiostart",get:function(){return(0,ve.getEventAttributeValue)(this,"audiostart")},set:function(u){(0,ve.setEventAttributeValue)(this,"audiostart",u)}},{key:"oncognitiveservices",get:function(){return(0,ve.getEventAttributeValue)(this,"cognitiveservices")},set:function(u){(0,ve.setEventAttributeValue)(this,"cognitiveservices",u)}},{key:"onend",get:function(){return(0,ve.getEventAttributeValue)(this,"end")},set:function(u){(0,ve.setEventAttributeValue)(this,"end",u)}},{key:"onerror",get:function(){return(0,ve.getEventAttributeValue)(this,"error")},set:function(u){(0,ve.setEventAttributeValue)(this,"error",u)}},{key:"onresult",get:function(){return(0,ve.getEventAttributeValue)(this,"result")},set:function(u){(0,ve.setEventAttributeValue)(this,"result",u)}},{key:"onsoundend",get:function(){return(0,ve.getEventAttributeValue)(this,"soundend")},set:function(u){(0,ve.setEventAttributeValue)(this,"soundend",u)}},{key:"onsoundstart",get:function(){return(0,ve.getEventAttributeValue)(this,"soundstart")},set:function(u){(0,ve.setEventAttributeValue)(this,"soundstart",u)}},{key:"onspeechend",get:function(){return(0,ve.getEventAttributeValue)(this,"speechend")},set:function(u){(0,ve.setEventAttributeValue)(this,"speechend",u)}},{key:"onspeechstart",get:function(){return(0,ve.getEventAttributeValue)(this,"speechstart")},set:function(u){(0,ve.setEventAttributeValue)(this,"speechstart",u)}},{key:"onstart",get:function(){return(0,ve.getEventAttributeValue)(this,"start")},set:function(u){(0,ve.setEventAttributeValue)(this,"start",u)}},{key:"start",value:function(){var u=this;this._startOnce().catch(function(p){u.dispatchEvent(new ErrorEvent("error",{error:p,message:p&&(p.stack||p.message)}))})}},{key:"_startOnce",value:function(){var a=(0,Tu.default)($t.default.mark(function p(){var v=this,g,h,d,y,m,S,b,P,C,R,O,z,L,E,T,A,_,$;return $t.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,e(this.lang);case 2:return g=B.sent,h=PJ(g.audioConfig),d=h.pause,y=h.unprepare,B.prev=4,m=(0,dJ.default)(),C=g.audioConfig.events.attach(function(U){var N=U.name;N==="AudioSourceReadyEvent"?m.push({audioSourceReady:{}}):N==="AudioSourceOffEvent"?m.push({audioSourceOff:{}}):N==="FirstAudibleChunk"&&m.push({firstAudibleChunk:{}})}),R=C.detach,g.canceled=function(U,N){var W=N.errorDetails,oe=N.offset,G=N.reason,pe=N.sessionId;m.push({canceled:{errorDetails:W,offset:oe,reason:G,sessionId:pe}})},g.recognized=function(U,N){var W=N.offset,oe=N.result,G=N.sessionId;m.push({recognized:{offset:W,result:vR(oe),sessionId:G}})},g.recognizing=function(U,N){var W=N.offset,oe=N.result,G=N.sessionId;m.push({recognizing:{offset:W,result:vR(oe),sessionId:G}})},g.sessionStarted=function(U,N){var W=N.sessionId;m.push({sessionStarted:{sessionId:W}})},g.sessionStopped=function(U,N){var W=N.sessionId;m.push({sessionStopped:{sessionId:W}})},g.speechStartDetected=function(U,N){var W=N.offset,oe=N.sessionId;m.push({speechStartDetected:{offset:W,sessionId:oe}})},g.speechEndDetected=function(U,N){var W=N.sessionId;m.push({speechEndDetected:{sessionId:W}})},O=this.grammars.phrases,z=g.privReco.dynamicGrammar,i&&i.length&&z.addReferenceGrammar(i),O&&O.length&&z.addPhrase(O),B.next=20,hv(g.startContinuousRecognitionAsync.bind(g))();case 20:g.stopContinuousRecognitionAsync?(this.abort=function(){return m.push({abort:{}})},this.stop=function(){return m.push({stop:{}})}):this.abort=this.stop=void 0,T=[],A=$t.default.mark(function U(N){var W,oe,G,pe,je,Bt,Ge,ut,pt,_t,nr,ir;return $t.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,m.shift();case 2:if(W=ie.sent,oe=W.abort,G=W.audioSourceOff,pe=W.audioSourceReady,je=W.canceled,Bt=W.firstAudibleChunk,Ge=W.recognized,ut=W.recognizing,pt=W.stop,Object.keys(W).forEach(function(yr){return v.emitCognitiveServices(yr,W[yr])}),_t=je&&je.errorDetails,!/Permission[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]denied/.test(_t||"")){ie.next=9;break}return E={error:"not-allowed",type:"error"},ie.abrupt("return","break");case 9:if(N||v.dispatchEvent(new we("start")),!_t){ie.next=15;break}return/1006/.test(_t)?(L||(v.dispatchEvent(new we("audiostart")),v.dispatchEvent(new we("audioend"))),E={error:"network",type:"error"}):E={error:"unknown",type:"error"},ie.abrupt("return","break");case 15:if(!(oe||pt)){ie.next=22;break}if(oe?(E={error:"aborted",type:"error"},P="abort"):(d(),P="stop"),!(oe&&g.stopContinuousRecognitionAsync)){ie.next=20;break}return ie.next=20,hv(g.stopContinuousRecognitionAsync.bind(g))();case 20:ie.next=61;break;case 22:if(!pe){ie.next=27;break}v.dispatchEvent(new we("audiostart")),L=!0,ie.next=61;break;case 27:if(!Bt){ie.next=32;break}v.dispatchEvent(new we("soundstart")),S=!0,ie.next=61;break;case 32:if(!G){ie.next=40;break}return b&&v.dispatchEvent(new we("speechend")),S&&v.dispatchEvent(new we("soundend")),L&&v.dispatchEvent(new we("audioend")),L=S=b=!1,ie.abrupt("return","break");case 40:if(P==="abort"){ie.next=61;break}if(!(Ge&&Ge.result&&Ge.result.reason===bJ.NoMatch)){ie.next=45;break}E={error:"no-speech",type:"error"},ie.next=61;break;case 45:if(!(Ge||ut)){ie.next=61;break}if(L||(v.dispatchEvent(new we("audiostart")),L=!0),S||(v.dispatchEvent(new we("soundstart")),S=!0),b||(v.dispatchEvent(new we("speechstart")),b=!0),!Ge){ie.next=60;break}if(nr=(0,fR.default)(Ge.result,{maxAlternatives:v.maxAlternatives,textNormalization:l}),ir=!!nr[0].transcript,ir&&(T=[].concat((0,uR.default)(T),[nr]),v.continuous&&v.dispatchEvent(new we("result",{results:T}))),v.continuous&&ir?E=null:E={results:T,type:"result"},!(!v.continuous&&g.stopContinuousRecognitionAsync)){ie.next=57;break}return ie.next=57,hv(g.stopContinuousRecognitionAsync.bind(g))();case 57:n&&E&&ir&&(v.dispatchEvent(new we(E.type,E)),E=null),ie.next=61;break;case 60:ut&&v.interimResults&&v.dispatchEvent(new we("result",{results:[].concat((0,uR.default)(T),[(0,fR.default)(ut.result,{maxAlternatives:v.maxAlternatives,textNormalization:l})])}));case 61:case"end":return ie.stop()}},U)}),_=0;case 24:if(!(!P||L)){B.next=32;break}return B.delegateYield(A(_),"t0",26);case 26:if($=B.t0,$!=="break"){B.next=29;break}return B.abrupt("break",32);case 29:_++,B.next=24;break;case 32:b&&this.dispatchEvent(new we("speechend")),S&&this.dispatchEvent(new we("soundend")),L&&this.dispatchEvent(new we("audioend")),E&&(E.type==="result"&&!E.results.length&&(E={error:"no-speech",type:"error"}),E.type==="error"?this.dispatchEvent(new ErrorEvent("error",E)):this.dispatchEvent(new we(E.type,E))),this.dispatchEvent(new we("end")),R(),B.next=44;break;case 40:throw B.prev=40,B.t1=B.catch(4),console.error(B.t1),B.t1;case 44:return B.prev=44,y(),g.dispose(),B.finish(44);case 48:case"end":return B.stop()}},p,this,[[4,40,44,48]])}));function u(){return a.apply(this,arguments)}return u}()}]),s}(ve.EventTarget);return{SpeechGrammarList:vv.default,SpeechRecognition:f,SpeechRecognitionEvent:we}}var wJ=function(e){var r=(0,gJ.default)(e),n=r.audioConfig,i=n===void 0?mJ.fromDefaultMicrophoneInput():n,l=r.enableTelemetry,f=l===void 0?!0:l,c=r.fetchCredentials,o=r.looseEvents,s=r.referenceGrammars,a=r.speechRecognitionEndpointId,u=r.textNormalization,p=u===void 0?"display":u;if(!i&&(!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia))return console.warn("web-speech-cognitive-services: This browser does not support WebRTC and it will not work with Cognitive Services Speech Services."),{};var v=function(){var g=(0,Tu.default)($t.default.mark(function h(d){var y,m,S,b,P,C,R;return $t.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,c();case 2:return y=z.sent,m=y.authorizationToken,S=y.region,b=y.speechRecognitionHostname,P=y.subscriptionKey,b?(R={hostname:b,port:443,protocol:"wss:"},m?(C=Uc.fromHost(R),C.authorizationToken=m):C=Uc.fromHost(R,P)):C=m?Uc.fromAuthorizationToken(m,S):Uc.fromSubscription(P,S),a&&(C.endpointId=a),C.outputFormat=SJ.Detailed,C.speechRecognitionLanguage=d||"en-US",z.abrupt("return",new GI(C,i));case 12:case"end":return z.stop()}},h)}));return function(d){return g.apply(this,arguments)}}();return JI({audioConfig:i,createRecognizer:v,enableTelemetry:f,looseEvents:o,referenceGrammars:s,textNormalization:p})};ja.default=wJ;(function(t){var e=pp;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createSpeechRecognitionPonyfillFromRecognizer",{enumerable:!0,get:function(){return r.createSpeechRecognitionPonyfillFromRecognizer}}),t.default=void 0;var r=i(ja);function n(f){if(typeof WeakMap!="function")return null;var c=new WeakMap,o=new WeakMap;return(n=function(a){return a?o:c})(f)}function i(f,c){if(f&&f.__esModule)return f;if(f===null||e(f)!=="object"&&typeof f!="function")return{default:f};var o=n(c);if(o&&o.has(f))return o.get(f);var s={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in f)if(u!=="default"&&Object.prototype.hasOwnProperty.call(f,u)){var p=a?Object.getOwnPropertyDescriptor(f,u):null;p&&(p.get||p.set)?Object.defineProperty(s,u,p):s[u]=f[u]}return s.default=f,o&&o.set(f,s),s}var l=r.default;t.default=l})(pI);var hR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ks=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Vc=0;Vc<hR.length;Vc++)Ks[hR.charCodeAt(Vc)]=Vc;var RJ=function(t){var e=t.length*.75,r=t.length,n,i=0,l,f,c,o;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var s=new ArrayBuffer(e),a=new Uint8Array(s);for(n=0;n<r;n+=4)l=Ks[t.charCodeAt(n)],f=Ks[t.charCodeAt(n+1)],c=Ks[t.charCodeAt(n+2)],o=Ks[t.charCodeAt(n+3)],a[i++]=l<<2|f>>4,a[i++]=(f&15)<<4|c>>2,a[i++]=(c&3)<<6|o&63;return s},mh={exports:{}},EJ=function(){var t={};return t.promise=new Promise(function(e,r){t.resolve=e,t.reject=r}),t};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(EJ);function n(o){return o&&o.__esModule?o:{default:o}}function i(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")}function l(o,s){for(var a=0;a<s.length;a++){var u=s[a];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(o,u.key,u)}}function f(o,s,a){return s&&l(o.prototype,s),o}var c=function(){function o(){var s=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};i(this,o),this.defers=[],this.upcomingDeferred=null,this.eventListener=this.eventListener.bind(this),this.options=a,this.one=this.one.bind(this),this.upcoming=this.upcoming.bind(this),this[Symbol.iterator]=function(){return{next:function(){return{done:!1,value:s.upcoming()}}}}}return f(o,[{key:"eventListener",value:function(a){var u=this.defers.shift(),p=this.options.array?[].slice.call(arguments):a;u&&u.resolve(p),this.upcomingDeferred&&(this.upcomingDeferred.resolve(p),this.upcomingDeferred=null)}},{key:"one",value:function(){var a=(0,r.default)();return this.defers.push(a),a.promise}},{key:"upcoming",value:function(){return this.upcomingDeferred||(this.upcomingDeferred=(0,r.default)()),this.upcomingDeferred.promise}}]),o}();e.default=c,t.exports=e.default,t.exports.default=e.default})(mh,mh.exports);var OJ=mh.exports;const dR=ne(OJ);var gR=H_,_J=zt,QI=function(t,e,r){return r.get&&gR(r.get,e,{getter:!0}),r.set&&gR(r.set,e,{setter:!0}),_J.f(t,e,r)},AJ=Xr,IJ=QI,TJ=tt,MJ=gt,yR=TJ("species"),DJ=function(t){var e=AJ(t);MJ&&e&&!e[yR]&&IJ(e,yR,{configurable:!0,get:function(){return this}})},$J=ud,kJ=TypeError,xJ=function(t,e){if($J(e,t))return t;throw new kJ("Incorrect invocation")},jJ=Bn,zJ=function(t,e,r){for(var n in e)jJ(t,n,e[n],r);return t},NJ=function(t,e){try{arguments.length===1?console.error(t):console.error(t,e)}catch{}},LJ=Ma,nu=Zt,Ba=gt,BJ=DJ,YI=Aa,qJ=tr,FJ=xJ,XI=We,UJ=Zu,VJ=er,iu=Ia,WJ=Bn,Xd=zJ,ZI=QI,Cn=NJ,HJ=tt,e0=rp,KJ=HJ("observable"),Zd="Observable",t0="Subscription",r0="SubscriptionObserver",eg=e0.getterFor,tg=e0.set,GJ=eg(Zd),n0=eg(t0),ou=eg(r0),i0=function(t){this.observer=qJ(t),this.cleanup=void 0,this.subscriptionObserver=void 0};i0.prototype={type:t0,clean:function(){var t=this.cleanup;if(t){this.cleanup=void 0;try{t()}catch(e){Cn(e)}}},close:function(){if(!Ba){var t=this.facade,e=this.subscriptionObserver;t.closed=!0,e&&(e.closed=!0)}this.observer=void 0},isClosed:function(){return this.observer===void 0}};var rg=function(t,e){var r=tg(this,new i0(t)),n;Ba||(this.closed=!1);try{(n=iu(t,"start"))&&nu(n,t,this)}catch(c){Cn(c)}if(!r.isClosed()){var i=r.subscriptionObserver=new ng(r);try{var l=e(i),f=l;UJ(l)||(r.cleanup=XI(l.unsubscribe)?function(){f.unsubscribe()}:YI(l))}catch(c){i.error(c);return}r.isClosed()&&r.clean()}};rg.prototype=Xd({},{unsubscribe:function(){var e=n0(this);e.isClosed()||(e.close(),e.clean())}});Ba&&ZI(rg.prototype,"closed",{configurable:!0,get:function(){return n0(this).isClosed()}});var ng=function(t){tg(this,{type:r0,subscriptionState:t}),Ba||(this.closed=!1)};ng.prototype=Xd({},{next:function(e){var r=ou(this).subscriptionState;if(!r.isClosed()){var n=r.observer;try{var i=iu(n,"next");i&&nu(i,n,e)}catch(l){Cn(l)}}},error:function(e){var r=ou(this).subscriptionState;if(!r.isClosed()){var n=r.observer;r.close();try{var i=iu(n,"error");i?nu(i,n,e):Cn(e)}catch(l){Cn(l)}r.clean()}},complete:function(){var e=ou(this).subscriptionState;if(!e.isClosed()){var r=e.observer;e.close();try{var n=iu(r,"complete");n&&nu(n,r)}catch(i){Cn(i)}e.clean()}}});Ba&&ZI(ng.prototype,"closed",{configurable:!0,get:function(){return ou(this).subscriptionState.isClosed()}});var o0=function(e){FJ(this,ig),tg(this,{type:Zd,subscriber:YI(e)})},ig=o0.prototype;Xd(ig,{subscribe:function(e){var r=arguments.length;return new rg(XI(e)?{next:e,error:r>1?arguments[1]:void 0,complete:r>2?arguments[2]:void 0}:VJ(e)?e:{},GJ(this).subscriber)}});WJ(ig,KJ,function(){return this});LJ({global:!0,constructor:!0,forced:!0},{Observable:o0});BJ(Zd);var JJ=tt,QJ=JJ("toStringTag"),s0={};s0[QJ]="z";var og=String(s0)==="[object z]",YJ=og,XJ=We,su=cd,ZJ=tt,e9=ZJ("toStringTag"),t9=Object,r9=su(function(){return arguments}())==="Arguments",n9=function(t,e){try{return t[e]}catch{}},hp=YJ?su:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=n9(e=t9(t),e9))=="string"?r:r9?su(e):(n=su(e))==="Object"&&XJ(e.callee)?"Arguments":n},i9=et,o9=dt,a0=We,s9=hp,a9=Xr,c9=U_,c0=function(){},u0=a9("Reflect","construct"),sg=/^\s*(?:class|function)\b/,u9=i9(sg.exec),p9=!sg.test(c0),Bs=function(e){if(!a0(e))return!1;try{return u0(c0,[],e),!0}catch{return!1}},p0=function(e){if(!a0(e))return!1;switch(s9(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p9||!!u9(sg,c9(e))}catch{return!0}};p0.sham=!0;var f0=!u0||o9(function(){var t;return Bs(Bs.call)||!Bs(Object)||!Bs(function(){t=!0})||t})?p0:Bs,qa={},f9=hp,mR=Ia,l9=Zu,v9=qa,h9=tt,d9=h9("iterator"),l0=function(t){if(!l9(t))return mR(t,d9)||mR(t,"@@iterator")||v9[f9(t)]},g9=Zt,y9=Aa,m9=tr,S9=pd,b9=l0,C9=TypeError,v0=function(t,e){var r=arguments.length<2?b9(t):e;if(y9(r))return m9(g9(r,t));throw new C9(S9(t)+" is not iterable")},P9=cd,w9=et,R9=function(t){if(P9(t)==="Function")return w9(t)},SR=R9,E9=Aa,O9=od,_9=SR(SR.bind),A9=function(t,e){return E9(t),e===void 0?t:O9?_9(t,e):function(){return t.apply(e,arguments)}},I9=tt,T9=qa,M9=I9("iterator"),D9=Array.prototype,$9=function(t){return t!==void 0&&(T9.Array===t||D9[M9]===t)},k9=Zt,bR=tr,x9=Ia,j9=function(t,e,r){var n,i;bR(t);try{if(n=x9(t,"return"),!n){if(e==="throw")throw r;return r}n=k9(n,t)}catch(l){i=!0,n=l}if(e==="throw")throw r;if(i)throw n;return bR(n),r},z9=A9,N9=Zt,L9=tr,B9=pd,q9=$9,F9=G_,CR=ud,U9=v0,V9=l0,PR=j9,W9=TypeError,au=function(t,e){this.stopped=t,this.result=e},wR=au.prototype,H9=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),l=!!(r&&r.IS_RECORD),f=!!(r&&r.IS_ITERATOR),c=!!(r&&r.INTERRUPTED),o=z9(e,n),s,a,u,p,v,g,h,d=function(m){return s&&PR(s,"normal",m),new au(!0,m)},y=function(m){return i?(L9(m),c?o(m[0],m[1],d):o(m[0],m[1])):c?o(m,d):o(m)};if(l)s=t.iterator;else if(f)s=t;else{if(a=V9(t),!a)throw new W9(B9(t)+" is not iterable");if(q9(a)){for(u=0,p=F9(t);p>u;u++)if(v=y(t[u]),v&&CR(wR,v))return v;return new au(!1)}s=U9(t,a)}for(g=l?t.next:s.next;!(h=N9(g,s)).done;){try{v=y(h.value)}catch(m){PR(s,"throw",m)}if(typeof v=="object"&&v&&CR(wR,v))return v}return new au(!1)},K9=Ma,G9=Xr,J9=Zt,RR=tr,Q9=f0,Y9=v0,X9=Ia,Z9=H9,eQ=tt,tQ=eQ("observable");K9({target:"Observable",stat:!0,forced:!0},{from:function(e){var r=Q9(this)?this:G9("Observable"),n=X9(RR(e),tQ);if(n){var i=RR(J9(n,e));return i.constructor===r?i:new r(function(f){return i.subscribe(f)})}var l=Y9(e);return new r(function(f){Z9(l,function(c,o){if(f.next(c),f.closed)return o()},{IS_ITERATOR:!0,INTERRUPTED:!0}),f.complete()})}});var rQ=Ma,h0=Xr,nQ=f0,iQ=h0("Array");rQ({target:"Observable",stat:!0,forced:!0},{of:function(){for(var e=nQ(this)?this:h0("Observable"),r=arguments.length,n=iQ(r),i=0;i<r;)n[i]=arguments[i++];return new e(function(l){for(var f=0;f<r;f++)if(l.next(n[f]),l.closed)return;l.complete()})}});var d0={},oQ=tt;d0.f=oQ;var ER=Cd,sQ=jt,aQ=d0,cQ=zt.f,uQ=function(t){var e=ER.Symbol||(ER.Symbol={});sQ(e,t)||cQ(e,t,{value:aQ.f(t)})},pQ=uQ;pQ("observable");var fQ=og,lQ=hp,vQ=fQ?{}.toString:function(){return"[object "+lQ(this)+"]"},hQ=og,dQ=Bn,gQ=vQ;hQ||dQ(Object.prototype,"toString",gQ,{unsafe:!0});var yQ=hp,mQ=String,g0=function(t){if(yQ(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return mQ(t)},ag=et,SQ=md,bQ=g0,CQ=ep,PQ=ag("".charAt),OR=ag("".charCodeAt),wQ=ag("".slice),_R=function(t){return function(e,r){var n=bQ(CQ(e)),i=SQ(r),l=n.length,f,c;return i<0||i>=l?t?"":void 0:(f=OR(n,i),f<55296||f>56319||i+1===l||(c=OR(n,i+1))<56320||c>57343?t?PQ(n,i):f:t?wQ(n,i,i+2):(f-55296<<10)+(c-56320)+65536)}},RQ={codeAt:_R(!1),charAt:_R(!0)},y0={},EQ=gt,OQ=L_,_Q=zt,AQ=tr,IQ=Ln,TQ=Y_;y0.f=EQ&&!OQ?Object.defineProperties:function(e,r){AQ(e);for(var n=IQ(r),i=TQ(r),l=i.length,f=0,c;l>f;)_Q.f(e,c=i[f++],n[c]);return e};var MQ=Xr,DQ=MQ("document","documentElement"),$Q=tr,kQ=y0,AR=Sd,xQ=gd,jQ=DQ,zQ=vd,NQ=dd,IR=">",TR="<",Sh="prototype",bh="script",m0=NQ("IE_PROTO"),dv=function(){},S0=function(t){return TR+bh+IR+t+TR+"/"+bh+IR},MR=function(t){t.write(S0("")),t.close();var e=t.parentWindow.Object;return t=null,e},LQ=function(){var t=zQ("iframe"),e="java"+bh+":",r;return t.style.display="none",jQ.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(S0("document.F=Object")),r.close(),r.F},Wc,cu=function(){try{Wc=new ActiveXObject("htmlfile")}catch{}cu=typeof document<"u"?document.domain&&Wc?MR(Wc):LQ():MR(Wc);for(var t=AR.length;t--;)delete cu[Sh][AR[t]];return cu()};xQ[m0]=!0;var b0=Object.create||function(e,r){var n;return e!==null?(dv[Sh]=$Q(e),n=new dv,dv[Sh]=null,n[m0]=e):n=cu(),r===void 0?n:kQ.f(n,r)},BQ=dt,qQ=We,FQ=er,DR=bd,UQ=Bn,VQ=tt,Ch=VQ("iterator"),C0=!1,Hr,gv,yv;[].keys&&(yv=[].keys(),"next"in yv?(gv=DR(DR(yv)),gv!==Object.prototype&&(Hr=gv)):C0=!0);var WQ=!FQ(Hr)||BQ(function(){var t={};return Hr[Ch].call(t)!==t});WQ&&(Hr={});qQ(Hr[Ch])||UQ(Hr,Ch,function(){return this});var P0={IteratorPrototype:Hr,BUGGY_SAFARI_ITERATORS:C0},HQ=zt.f,KQ=jt,GQ=tt,$R=GQ("toStringTag"),cg=function(t,e,r){t&&!r&&(t=t.prototype),t&&!KQ(t,$R)&&HQ(t,$R,{configurable:!0,value:e})},JQ=P0.IteratorPrototype,QQ=b0,YQ=ad,XQ=cg,ZQ=qa,eY=function(){return this},tY=function(t,e,r,n){var i=e+" Iterator";return t.prototype=QQ(JQ,{next:YQ(+!n,r)}),XQ(t,i,!1),ZQ[i]=eY,t},rY=et,nY=Aa,iY=function(t,e,r){try{return rY(nY(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},oY=er,sY=function(t){return oY(t)||t===null},aY=sY,cY=String,uY=TypeError,pY=function(t){if(aY(t))return t;throw new uY("Can't set "+cY(t)+" as a prototype")},fY=iY,lY=er,vY=ep,hY=pY,dY=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=fY(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,l){return vY(i),hY(l),lY(i)&&(t?r(i,l):i.__proto__=l),i}}():void 0),gY=Ma,yY=Zt,w0=F_,mY=We,SY=tY,kR=bd,xR=dY,bY=cg,CY=tp,mv=Bn,PY=tt,wY=qa,R0=P0,RY=w0.PROPER,EY=w0.CONFIGURABLE,jR=R0.IteratorPrototype,Hc=R0.BUGGY_SAFARI_ITERATORS,qs=PY("iterator"),zR="keys",Fs="values",NR="entries",OY=function(){return this},E0=function(t,e,r,n,i,l,f){SY(r,e,n);var c=function(y){if(y===i&&p)return p;if(!Hc&&y&&y in a)return a[y];switch(y){case zR:return function(){return new r(this,y)};case Fs:return function(){return new r(this,y)};case NR:return function(){return new r(this,y)}}return function(){return new r(this)}},o=e+" Iterator",s=!1,a=t.prototype,u=a[qs]||a["@@iterator"]||i&&a[i],p=!Hc&&u||c(i),v=e==="Array"&&a.entries||u,g,h,d;if(v&&(g=kR(v.call(new t)),g!==Object.prototype&&g.next&&(kR(g)!==jR&&(xR?xR(g,jR):mY(g[qs])||mv(g,qs,OY)),bY(g,o,!0))),RY&&i===Fs&&u&&u.name!==Fs&&(EY?CY(a,"name",Fs):(s=!0,p=function(){return yY(u,this)})),i)if(h={values:c(Fs),keys:l?p:c(zR),entries:c(NR)},f)for(d in h)(Hc||s||!(d in a))&&mv(a,d,h[d]);else gY({target:e,proto:!0,forced:Hc||s},h);return a[qs]!==p&&mv(a,qs,p,{name:i}),wY[e]=p,h},O0=function(t,e){return{value:t,done:e}},_Y=RQ.charAt,AY=g0,_0=rp,IY=E0,LR=O0,A0="String Iterator",TY=_0.set,MY=_0.getterFor(A0);IY(String,"String",function(t){TY(this,{type:A0,string:AY(t),index:0})},function(){var e=MY(this),r=e.string,n=e.index,i;return n>=r.length?LR(void 0,!0):(i=_Y(r,n),e.index+=i.length,LR(i,!1))});var DY={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},$Y=vd,Sv=$Y("span").classList,BR=Sv&&Sv.constructor&&Sv.constructor.prototype,kY=BR===Object.prototype?void 0:BR,xY=tt,jY=b0,zY=zt.f,Ph=xY("unscopables"),wh=Array.prototype;wh[Ph]===void 0&&zY(wh,Ph,{configurable:!0,value:jY(null)});var NY=function(t){wh[Ph][t]=!0},LY=Ln,ug=NY,qR=qa,I0=rp,BY=zt.f,qY=E0,Kc=O0,FY=gt,T0="Array Iterator",UY=I0.set,VY=I0.getterFor(T0),WY=qY(Array,"Array",function(t,e){UY(this,{type:T0,target:LY(t),index:0,kind:e})},function(){var t=VY(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=void 0,Kc(void 0,!0);switch(t.kind){case"keys":return Kc(r,!1);case"values":return Kc(e[r],!1)}return Kc([r,e[r]],!1)},"values"),FR=qR.Arguments=qR.Array;ug("keys");ug("values");ug("entries");if(FY&&FR.name!=="values")try{BY(FR,"name",{value:"values"})}catch{}var UR=ht,M0=DY,HY=kY,Gs=WY,VR=tp,KY=cg,GY=tt,bv=GY("iterator"),Cv=Gs.values,D0=function(t,e){if(t){if(t[bv]!==Cv)try{VR(t,bv,Cv)}catch{t[bv]=Cv}if(KY(t,e,!0),M0[e]){for(var r in Gs)if(t[r]!==Gs[r])try{VR(t,r,Gs[r])}catch{t[r]=Gs[r]}}}};for(var Pv in M0)D0(UR[Pv]&&UR[Pv].prototype,Pv);D0(HY,"DOMTokenList");var JY=Cd,QY=JY.Observable,YY=QY;const Gc=ne(YY);function XY(){let t=[],e={cancelAll:()=>{t.forEach(({cancel:r})=>r())},push:r=>{let n=du(),i=du(),l={promise:i.promise},f,c=l.cancel=()=>{r=()=>({result:Promise.reject(new Error("cancelled before start"))}),f&&f(),n.reject(new Error("cancelled in the midway"))},o=async()=>{let{abort:u,result:p}=r();f=u;try{i.resolve(await Promise.race([p,n.promise]))}catch(v){i.reject(v)}t=t.filter(v=>v!==l)},s=t[t.length-1],a=s&&s.promise||Promise.resolve();return t.push(l),a.then(o,o),{cancel:c,result:i.promise}}};return Object.defineProperty(e,"length",{get:()=>t.length}),e}function pg(t,e,...r){if(!t)throw new TypeError($0(e,r))}function $0(t,e){let r=0;return t.replace(/%[os]/gu,()=>k0(e[r++]))}function k0(t){return typeof t!="object"||t===null?String(t):Object.prototype.toString.call(t)}var ZY;function eX(t){try{let e=t instanceof Error?t:new Error(k0(t));if(typeof dispatchEvent=="function"&&typeof ErrorEvent=="function")dispatchEvent(new ErrorEvent("error",{error:e,message:e.message}));else if(typeof process<"u"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)}catch{}}var Rt=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:typeof globalThis<"u"?globalThis:void 0,tX,rr=class{constructor(t,e){this.code=t,this.message=e}warn(...t){var e;try{let r=((e=new Error().stack)!==null&&e!==void 0?e:"").replace(/^(?:.+?\n){2}/gu,`
`);console.warn(this.message,...t,r)}catch{}}},rX=new rr("W01","Unable to initialize event under dispatching."),nX=new rr("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),iX=new rr("W03","Assigning any truthy value to 'returnValue' property has no effect."),oX=new rr("W04","Unable to preventDefault on non-cancelable events."),sX=new rr("W05","Unable to preventDefault inside passive event listener invocation."),aX=new rr("W06","An event listener wasn't added because it has been added already: %o, %o"),wv=new rr("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),WR=new rr("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o"),cX=new rr("W09","Event attribute handler must be a function: %o"),Ot=class{static get NONE(){return HR}static get CAPTURING_PHASE(){return KR}static get AT_TARGET(){return GR}static get BUBBLING_PHASE(){return JR}constructor(t,e){Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let r=e??{};Rh.set(this,{type:String(t),bubbles:!!r.bubbles,cancelable:!!r.cancelable,composed:!!r.composed,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}get type(){return Oe(this).type}get target(){return Oe(this).target}get srcElement(){return Oe(this).target}get currentTarget(){return Oe(this).currentTarget}composedPath(){let t=Oe(this).currentTarget;return t?[t]:[]}get NONE(){return HR}get CAPTURING_PHASE(){return KR}get AT_TARGET(){return GR}get BUBBLING_PHASE(){return JR}get eventPhase(){return Oe(this).dispatchFlag?2:0}stopPropagation(){Oe(this).stopPropagationFlag=!0}get cancelBubble(){return Oe(this).stopPropagationFlag}set cancelBubble(t){t?Oe(this).stopPropagationFlag=!0:nX.warn()}stopImmediatePropagation(){let t=Oe(this);t.stopPropagationFlag=t.stopImmediatePropagationFlag=!0}get bubbles(){return Oe(this).bubbles}get cancelable(){return Oe(this).cancelable}get returnValue(){return!Oe(this).canceledFlag}set returnValue(t){t?iX.warn():QR(Oe(this))}preventDefault(){QR(Oe(this))}get defaultPrevented(){return Oe(this).canceledFlag}get composed(){return Oe(this).composed}get isTrusted(){return!1}get timeStamp(){return Oe(this).timeStamp}initEvent(t,e=!1,r=!1){let n=Oe(this);if(n.dispatchFlag){rX.warn();return}Rh.set(this,{...n,type:String(t),bubbles:!!e,cancelable:!!r,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1})}},HR=0,KR=1,GR=2,JR=3,Rh=new WeakMap;function Oe(t,e="this"){let r=Rh.get(t);return pg(r!=null,"'%s' must be an object that Event constructor created, but got another one: %o",e,t),r}function QR(t){if(t.inPassiveListenerFlag){sX.warn();return}if(!t.cancelable){oX.warn();return}t.canceledFlag=!0}Object.defineProperty(Ot,"NONE",{enumerable:!0});Object.defineProperty(Ot,"CAPTURING_PHASE",{enumerable:!0});Object.defineProperty(Ot,"AT_TARGET",{enumerable:!0});Object.defineProperty(Ot,"BUBBLING_PHASE",{enumerable:!0});var Rv=Object.getOwnPropertyNames(Ot.prototype);for(let t=0;t<Rv.length;++t)Rv[t]!=="constructor"&&Object.defineProperty(Ot.prototype,Rv[t],{enumerable:!0});typeof Rt<"u"&&typeof Rt.Event<"u"&&Object.setPrototypeOf(Ot.prototype,Rt.Event.prototype);function uX(t){return Rt.DOMException?new Rt.DOMException(t,"InvalidStateError"):(hn==null&&(hn=class x0 extends Error{constructor(r){super(r),Error.captureStackTrace&&Error.captureStackTrace(this,x0)}get code(){return 11}get name(){return"InvalidStateError"}},Object.defineProperties(hn.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),XR(hn),XR(hn.prototype)),new hn(t))}var hn,YR={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function XR(t){let e=Object.keys(YR);for(let r=0;r<e.length;++r){let n=e[r],i=YR[n];Object.defineProperty(t,n,{get(){return i},configurable:!0,enumerable:!0})}}var dp=class extends Ot{static wrap(t){return new(z0(t))(t)}constructor(t){super(t.type,{bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}),t.cancelBubble&&super.stopPropagation(),t.defaultPrevented&&super.preventDefault(),j0.set(this,{original:t});let e=Object.keys(t);for(let r=0;r<e.length;++r){let n=e[r];n in this||Object.defineProperty(this,n,N0(t,n))}}stopPropagation(){super.stopPropagation();let{original:t}=cr(this);"stopPropagation"in t&&t.stopPropagation()}get cancelBubble(){return super.cancelBubble}set cancelBubble(t){super.cancelBubble=t;let{original:e}=cr(this);"cancelBubble"in e&&(e.cancelBubble=t)}stopImmediatePropagation(){super.stopImmediatePropagation();let{original:t}=cr(this);"stopImmediatePropagation"in t&&t.stopImmediatePropagation()}get returnValue(){return super.returnValue}set returnValue(t){super.returnValue=t;let{original:e}=cr(this);"returnValue"in e&&(e.returnValue=t)}preventDefault(){super.preventDefault();let{original:t}=cr(this);"preventDefault"in t&&t.preventDefault()}get timeStamp(){let{original:t}=cr(this);return"timeStamp"in t?t.timeStamp:super.timeStamp}},j0=new WeakMap;function cr(t){let e=j0.get(t);return pg(e!=null,"'this' is expected an Event object, but got",t),e}var Du=new WeakMap;Du.set(Object.prototype,dp);typeof Rt<"u"&&typeof Rt.Event<"u"&&Du.set(Rt.Event.prototype,dp);function z0(t){let e=Object.getPrototypeOf(t);if(e==null)return dp;let r=Du.get(e);return r==null&&(r=pX(z0(e),e),Du.set(e,r)),r}function pX(t,e){class r extends t{}let n=Object.keys(e);for(let i=0;i<n.length;++i)Object.defineProperty(r.prototype,n[i],N0(e,n[i]));return r}function N0(t,e){let r=Object.getOwnPropertyDescriptor(t,e);return{get(){let n=cr(this).original,i=n[e];return typeof i=="function"?i.bind(n):i},set(n){let i=cr(this).original;i[e]=n},configurable:r.configurable,enumerable:r.enumerable}}function fX(t,e,r,n,i,l){return{callback:t,flags:(e?1:0)|(r?2:0)|(n?4:0),signal:i,signalListener:l}}function lX(t){t.flags|=8}function L0(t){return(t.flags&1)===1}function B0(t){return(t.flags&2)===2}function q0(t){return(t.flags&4)===4}function vX(t){return(t.flags&8)===8}function hX({callback:t},e,r){try{typeof t=="function"?t.call(e,r):typeof t.handleEvent=="function"&&t.handleEvent(r)}catch(n){eX(n)}}function F0({listeners:t},e,r){for(let n=0;n<t.length;++n)if(t[n].callback===e&&L0(t[n])===r)return n;return-1}function U0(t,e,r,n,i,l){let f;l&&(f=fg.bind(null,t,e,r),l.addEventListener("abort",f));let c=fX(e,r,n,i,l,f);return t.cow?(t.cow=!1,t.listeners=[...t.listeners,c]):t.listeners.push(c),c}function fg(t,e,r){let n=F0(t,e,r);return n!==-1?V0(t,n):!1}function V0(t,e,r=!1){let n=t.listeners[e];return lX(n),n.signal&&n.signal.removeEventListener("abort",n.signalListener),t.cow&&!r?(t.cow=!1,t.listeners=t.listeners.filter((i,l)=>l!==e),!1):(t.listeners.splice(e,1),!0)}function dX(){return Object.create(null)}function W0(t,e){var r;return(r=t[e])!==null&&r!==void 0?r:t[e]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}var gp=class{constructor(){H0.set(this,dX())}addEventListener(t,e,r){let n=wn(this),{callback:i,capture:l,once:f,passive:c,signal:o,type:s}=gX(t,e,r);if(i==null||o!=null&&o.aborted)return;let a=W0(n,s),u=F0(a,i,l);if(u!==-1){mX(a.listeners[u],c,f,o);return}U0(a,i,l,c,f,o)}removeEventListener(t,e,r){let n=wn(this),{callback:i,capture:l,type:f}=yX(t,e,r),c=n[f];i!=null&&c&&fg(c,i,l)}dispatchEvent(t){let e=wn(this)[String(t.type)];if(e==null)return!0;let r=t instanceof Ot?t:dp.wrap(t),n=Oe(r,"event");if(n.dispatchFlag)throw uX("This event has been in dispatching.");if(n.dispatchFlag=!0,n.target=n.currentTarget=this,!n.stopPropagationFlag){let{cow:i,listeners:l}=e;e.cow=!0;for(let f=0;f<l.length;++f){let c=l[f];if(!vX(c)&&(q0(c)&&V0(e,f,!i)&&(f-=1),n.inPassiveListenerFlag=B0(c),hX(c,this,r),n.inPassiveListenerFlag=!1,n.stopImmediatePropagationFlag))break}i||(e.cow=!1)}return n.target=null,n.currentTarget=null,n.stopImmediatePropagationFlag=!1,n.stopPropagationFlag=!1,n.dispatchFlag=!1,!n.canceledFlag}},H0=new WeakMap;function wn(t,e="this"){let r=H0.get(t);return pg(r!=null,"'%s' must be an object that EventTarget constructor created, but got another one: %o",e,t),r}function gX(t,e,r){var n;return K0(e),typeof r=="object"&&r!==null?{type:String(t),callback:e??void 0,capture:!!r.capture,passive:!!r.passive,once:!!r.once,signal:(n=r.signal)!==null&&n!==void 0?n:void 0}:{type:String(t),callback:e??void 0,capture:!!r,passive:!1,once:!1,signal:void 0}}function yX(t,e,r){return K0(e),typeof r=="object"&&r!==null?{type:String(t),callback:e??void 0,capture:!!r.capture}:{type:String(t),callback:e??void 0,capture:!!r}}function K0(t){if(!(typeof t=="function"||typeof t=="object"&&t!==null&&typeof t.handleEvent=="function")){if(t==null||typeof t=="object"){WR.warn(t);return}throw new TypeError($0(WR.message,[t]))}}function mX(t,e,r,n){aX.warn(L0(t)?"capture":"bubble",t.callback),B0(t)!==e&&wv.warn("passive"),q0(t)!==r&&wv.warn("once"),t.signal!==n&&wv.warn("signal")}var Ev=Object.getOwnPropertyNames(gp.prototype);for(let t=0;t<Ev.length;++t)Ev[t]!=="constructor"&&Object.defineProperty(gp.prototype,Ev[t],{enumerable:!0});typeof Rt<"u"&&typeof Rt.EventTarget<"u"&&Object.setPrototypeOf(gp.prototype,Rt.EventTarget.prototype);function Js(t,e){var r,n;return(n=(r=wn(t,"target")[e])===null||r===void 0?void 0:r.attrCallback)!==null&&n!==void 0?n:null}function Qs(t,e,r){r!=null&&typeof r!="function"&&cX.warn(r),typeof r=="function"||typeof r=="object"&&r!==null?SX(t,e,r):bX(t,e)}function SX(t,e,r){let n=W0(wn(t,"target"),String(e));n.attrCallback=r,n.attrListener==null&&(n.attrListener=U0(n,CX(n),!1,!1,!1,void 0))}function bX(t,e){let r=wn(t,"target")[String(e)];r&&r.attrListener&&(fg(r,r.attrListener.callback,!1),r.attrCallback=r.attrListener=void 0)}function CX(t){return function(e){let r=t.attrCallback;typeof r=="function"&&r.call(this,e)}}var G0=gp;function PX(t){let e=t.numberOfChannels;for(let r=0;r<e;r++){let n=t.getChannelData(r);[].fill.call(n,0)}}function wX(t,e){let r=t.numberOfChannels;for(let n=0;n<r;n++){let i=e[+n];if(t.copyToChannel)t.copyToChannel(i,n);else{let{length:l}=i,f=t.getChannelData(n);for(let c=0;c<l;c++)f[+c]=i[+c]}}}function RX(t,{channels:e,samplesPerSec:r},n){let i=new Array(3).fill().map(()=>t.createBuffer(e,n,r)),l=[],f,c=[],o=()=>{typeof f!="number"&&(f=t.currentTime);let s=t.createBufferSource(),a=c.shift();if(typeof a=="function")a();else if(a){let u=i.shift();if(!u){c.unshift(a);return}PX(u),wX(u,a),s.buffer=u,s.connect(t.destination),s.start(f),l.push(s),f+=u.duration,s.addEventListener("ended",()=>{l=l.filter(p=>p!==s),i.push(u),o()})}};return{cancelAll:()=>{c.splice(0),l.forEach(s=>s.stop())},flush:()=>new Promise(s=>c.push(s)),push:s=>{if(!s)throw new Error("multiChannelArray must not be falsy.");c.push(s),o()}}}var EX=44100,ZR=4096;function OX(t){return t.reduce((e,r)=>e+r,0)/t.length}function Ov(t,e){let r=new Float32Array(t.length);for(let n=0;n<t.length;n++)r[+n]=t[+n]/e;return r}function _X({bitsPerSample:t},e){switch(t){case 8:return Ov(new Int8Array(e),128);case 16:return Ov(new Int16Array(e),32768);case 32:return Ov(new Int32Array(e),2147483648);default:throw new Error("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}function AX(t){return new Promise((e,r)=>{t.onabort=()=>r(new Error("aborted"))})}function IX(t,{channels:e}){let r=new Array(e),n=t.length/e;for(let i=0;i<e;i++){let l=new Float32Array(n);r[+i]=l;for(let f=0;f<n;f++)l[+f]=t[f*e+i]}return r}function TX(t,e){if(e===1)return t;let r=new Array(e).fill(t[0]),n=new Float32Array(t.length*e);for(let i=0;i<t.length;i++){let l=t[+i],f=i*e;for(let c=0;c<e;c++)r.shift(),r.push(l),n[f+c]=OX(r)}return n}async function MX(t,e,{signal:r={}}={}){if(t)if(e)if(e.format){if(typeof e.read!="function")throw new Error("botframework-directlinespeech-sdk: stream is missing read().")}else throw new Error("botframework-directlinespeech-sdk: stream is missing format.");else throw new Error("botframework-directlinespeech-sdk: stream must be specified.");else throw new Error("botframework-directlinespeech-sdk: audioContext must be specified.");let n=[];try{let{format:i}=e,l=AX(r),f=new Uint8Array(ZR),c=()=>Promise.race([l.catch(()=>{}),e.read(f.buffer).then(p=>p===f.byteLength?f:p?f.slice(0,p):void 0)]);if(r.aborted)throw new Error("aborted");let{samplesPerSec:o}=i;i.requestAudioFormatString==="audio-24khz-48kbitrate-mono-mp3"&&(o=16e3);let s=o,a=1;for(;s<EX&&s<96e3;)a++,s=o*a;let u=RX(t,{...i,samplesPerSec:s},ZR/(i.bitsPerSample/8)*a);for(let p=await c(),v=0;p&&v<1e3&&!r.aborted&&!r.aborted;p=await c(),v++){let g=_X(i,p.buffer),h=IX(g,i).map(d=>TX(d,a));u.push(h)}if(l.catch(()=>u.cancelAll()),r.aborted)throw new Error("aborted");await Promise.race([l,u.flush()])}finally{n.forEach(i=>i.stop())}}var DX="SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU3LjU2LjEwMQAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU3LjY0AAAAAAAAAAAAAAAAJAUHAAAAAAAAAYYoRBqpAAAAAAD/+xDEAAPAAAGkAAAAIAAANIAAAARMQU1FMy45OS41VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7EMQpg8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";function $X(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function kX(t,e){return new Promise((r,n)=>{let i=t.decodeAudioData(e,r,n);i&&typeof i.then=="function"&&r(i)})}function xX(t,e,r){return new Promise((n,i)=>{let l=new dR,f=new dR,c=$X(t,"statechange",({target:{state:o}})=>o==="closed"&&l.eventListener());try{r.buffer=e,r.onended=f.eventListener,r.connect(t.destination),r.start(0),Promise.race([l.upcoming(),f.upcoming()]).then(n)}catch(o){i(o)}finally{c()}})}async function jX(t){let e=t.createBufferSource(),r=await kX(t,RJ(DX));await xX(t,r,e)}var zX=class extends G0{constructor(t){if(super(),t&&!(t.format&&typeof t.read=="function"))throw new Error("botframework-directlinespeech-sdk: If the first argument is specified, it must be a Cognitive Services audio stream.");this.audioStream=t}get onboundary(){return Js(this,"boundary")}set onboundary(t){Qs(this,"boundary",t)}get onend(){return Js(this,"end")}set onend(t){Qs(this,"end",t)}get onerror(){return Js(this,"error")}set onerror(t){Qs(this,"error",t)}get onstart(){return Js(this,"start")}set onstart(t){Qs(this,"start",t)}},J0=zX;function NX({audioContext:t,enableTelemetry:e,ponyfill:r={AudioContext:window.AudioContext||window.webkitAudioContext},recognizer:n,textNormalization:i}){return r.AudioContext?()=>{let{SpeechGrammarList:l,SpeechRecognition:f}=pI.createSpeechRecognitionPonyfillFromRecognizer({createRecognizer:()=>n,enableTelemetry:e,looseEvents:!0,textNormalization:i});t||(t=new r.AudioContext);let{cancelAll:c,push:o}=XY();class s extends G0{cancel(){c()}getVoices(){return[]}speak(u){let{result:p}=o(()=>{let v=new z8,{signal:g}=v;return{abort:v.abort.bind(v),result:(async()=>{u.dispatchEvent(new Ot("start"));try{u.audioStream?await MX(t,u.audioStream,{signal:g}):await jX(t)}catch(h){if(h.message!=="aborted")return u.dispatchEvent(new ErrorEvent(h))}u.dispatchEvent(new Ot("end"))})()}});p.catch(v=>{if(!/^cancelled/iu.test(v.message))throw v})}get onvoiceschanged(){return Js(this,"voiceschanged")}set onvoiceschanged(u){Qs(this,"voiceschanged",u)}}return{SpeechGrammarList:l,SpeechRecognition:f,speechSynthesis:new s,SpeechSynthesisUtterance:J0}}:(console.warn("botframework-directlinespeech-sdk: This browser does not support Web Audio API. Speech support is disabled."),()=>({}))}function eE(t){let e=[],r;return new Observable(n=>(r||(r=t.subscribe({complete(){e.forEach(i=>i.complete())},error(i){e.forEach(l=>l.error(i))},next(i){e.forEach(l=>l.next(i))}})),e.push(n),()=>{e=e.filter(i=>i!==n),e.length||(r.unsubscribe(),r=null)}))}function LX(){return sT().toString(36).substr(2)}var BX=class{constructor({dialogServiceConnector:t}){let e;this.dialogServiceConnector=t,this.activity$=eE(new Gc(r=>{this._activityObserver=r,e.next(0),e.next(1),t.connect(()=>{e.next(2)},n=>{e.next(4),console.warn("botframework-directlinespeech-sdk: Failed to connect",{error:n})})})),this.connectionStatus$=eE(new Gc(r=>{e=r})),t.activityReceived=(r,{activity:n,audioStream:i})=>{try{this._activityObserver&&this._activityObserver.next({...n,channelData:{...n.channelData,speechSynthesisUtterance:new J0(i)},from:{...n.from,role:"bot"},replyToId:void 0,timestamp:new Date().toISOString()})}catch(l){console.error(l)}}}end(){try{this.dialogServiceConnector.close()}catch(t){if(!~t.message.indexOf("already disposed"))throw t}}postActivity(t){var e;t={...t,from:{role:"user"}};try{let r=LX();return(e=t.channelData)!=null&&e.speech||this.dialogServiceConnector.sendActivityAsync(JSON.stringify(t)),this._activityObserver&&this._activityObserver.next({...t,id:r,timestamp:new Date().toISOString()}),Gc.of(r)}catch(r){return new Gc(n=>n.error(r))}}};function _v(t,e,r){return(...n)=>{n=e?e(...n):n;let i=t(...n);return r?r(i):i}}function qX(t){let e;return t.listenOnceAsync=_v(t.listenOnceAsync.bind(t),(r,n,...i)=>(e=du(),[_v(r,null,l=>(e.resolve(l),l)),_v(n,null,l=>(e.reject(l),l)),...i])),t.startContinuousRecognitionAsync=(r,n)=>{t.listenOnceAsync(()=>{},i=>{r=null,n&&n(i)}),setTimeout(()=>{n=null,r&&r()},0)},t}async function FX(t,e){let r=await fetch(t,{...e,headers:{...e.headers,accept:"application/json"}});if(!r.ok)throw new Error(`Failed to fetch JSON from server due to ${r.status}`);return r.json()}async function UX(t){let{token:e}=await FX("https://directline.botframework.com/v3/directline/tokens/refresh",{headers:{authorization:`Bearer ${t}`},method:"POST"});return e}function tE(t){return typeof t=="function"?t():t}var VX=9e5,WX=12e4;async function YZ({audioConfig:t,audioContext:e,audioInputDeviceId:r,enableInternalHTTPSupport:n,enableTelemetry:i,fetchCredentials:l,speechRecognitionEndpointId:f,speechRecognitionLanguage:c=typeof window<"u"&&typeof window.navigator<"u"&&window.navigator.language||"en-US",speechSynthesisDeploymentId:o,speechSynthesisOutputFormat:s,textNormalization:a,userID:u,username:p}){if(!l)throw new Error('"fetchCredentials" must be specified.');let{authorizationToken:v,directLineToken:g,directLineSpeechHostname:h,region:d,subscriptionKey:y}=await tE(l);if(!v&&!y||v&&y||v&&typeof v!="string"||y&&typeof y!="string"||n&&!g)throw new Error('"fetchCredentials" must return either "authorizationToken" or "subscriptionKey" as a non-empty string only. If enableInternalHTTPSupport is set to true, then it should also return a non-empty "directLineToken"');if(typeof i<"u"&&console.warn("botframework-directlinespeech: Telemetry options are not yet supported. Please refer to Cognitive Services documentation for details."),h&&d||!h&&!d)throw new Error('"fetchCredentials" must return either "directLineSpeechHostname" or "region" and it must not be an empty string.');if(h){if(typeof h!="string")throw new Error('"fetchCredentials" must return "directLineSpeechHostname" as a string.');if(n)throw new Error('"fetchCredentials" must not return "directLineSpeechHostname" if "enableInternalHTTPSupport" is set.')}else if(typeof d!="string")throw new Error('"fetchCredentials" must return "region" as a string.');t&&r?console.warn('botframework-directlinespeech-sdk: Only "audioConfig" or "audioInputDeviceId" can be specified, but not both; ignoring "audioInputDeviceId".'):t||(r?t=ca.fromMicrophoneInput(r):t=ca.fromDefaultMicrophoneInput()),f&&console.warn('botframework-directlinespeech: Custom Speech is currently not supported; ignoring "speechRecognitionEndpointId".'),o&&console.warn('botframework-directlinespeech: Custom Voice is currently not supported; ignoring "speechSynthesisDeploymentId".'),s&&console.warn('botframework-directlinespeech: Synthesis output format is currently not supported; ignoring "speechSynthesisOutputFormat".'),a&&console.warn('botframework-directlinespeech: Text normalization is currently not supported; ignoring "textNormalization".'),(u||p)&&console.warn('botframework-directlinespeech: Custom "userId" and "username" are currently not supported and are ignored.');let m;h?v?(m=Ec.fromHost(new URL(`wss://${h}`)),m.setProperty(j.SpeechServiceAuthorization_Token,v)):m=Ec.fromHost(new URL(`wss://${h}`),y):(v?m=Ec.fromAuthorizationToken(v,d):m=Ec.fromSubscription(y,d),n&&(m.setProperty(j.SpeechServiceConnection_Endpoint,`wss://${encodeURI(d)}.convai.speech.microsoft.com/directline/api/v1`),m.setProperty(j.Conversation_Agent_Connection_Id,g))),m.setProperty(j.SpeechServiceConnection_RecoLanguage,c),u&&m.setProperty(j.Conversation_From_Id,u);let S=qX(new LW(m,t));if(v){let C=setInterval(async()=>{S.privIsDisposed&&clearInterval(C);let{authorizationToken:R,directLineSpeechHostname:O,region:z}=await tE(l);if(!R)return console.warn('botframework-directlinespeech-sdk: Renew token failed because "fetchCredentials" call returned no authorization token.');if(h){if(h!==O)return console.warn('botframework-directlinespeech-sdk: "directLineSpeechHostname" change is not supported for renewed token. Authorization token is not renewed.')}else if(d!==z)return console.warn("botframework-directlinespeech-sdk: Region change is not supported for renewed token. Authorization token is not renewed.");S.authorizationToken=R},WX)}if(n){let C=setInterval(async()=>{S.privIsDisposed&&clearInterval(C);let R=await UX(g);if(!R)return console.warn("botframework-directlinespeech-sdk: Renew token failed because call to refresh token Direct Line API did not return a new token.");m.setProperty(j.Conversation_Agent_Connection_Id,R),S.properties.setProperty(j.Conversation_Agent_Connection_Id,R),S.connect()},VX)}let b=new BX({dialogServiceConnector:S}),P=NX({audioContext:e,enableTelemetry:i,recognizer:S,textNormalization:a});return{directLine:b,webSpeechPonyfillFactory:P}}var HX="tsup",KX="esmodules";if(typeof HTMLDocument<"u"&&typeof document<"u"&&document instanceof HTMLDocument){let t="4.18.0",e=document.createElement("meta");e.setAttribute("name","botframework-directlinespeech:version"),e.setAttribute("content",t),document.head.appendChild(e);let r=document.createElement("meta");r.setAttribute("name","botframework-directlinespeech"),r.setAttribute("content",`version=${t}; build_tool=${HX}; format=${KX}`),document.head.appendChild(r)}/*! For license information please see botframework-directlinespeech-sdk.mjs.LEGAL.txt */export{vt as $,WM as A,ga as B,PO as C,Hh as D,wO as E,bE as F,Th as G,Kh as H,sT as I,Bu as J,Be as K,oD as L,Qt as M,la as N,_F as O,Yq as P,h_ as Q,Mt as R,f_ as S,mm as T,S_ as U,b3 as V,Ve as W,C3 as X,Ue as Y,ct as Z,gu as _,oN as a,TE as a0,ue as a1,Eh as a2,zu as a3,Dh as a4,iN as a5,XL as a6,aB as a7,kB as a8,aq as a9,YZ as aA,du as aB,oF as aa,dF as ab,wF as ac,bq as ad,Iq as ae,Lq as af,va as ag,xn as ah,Yt as ai,IB as aj,pE as ak,ku as al,zh as am,Jq as an,O3 as ao,B3 as ap,Q3 as aq,Xt as ar,Ca as as,xz as at,Dt as au,Nu as av,Xv as aw,lt as ax,X3 as ay,u4 as az,Y as b,cN as c,Le as d,Vs as e,ce as f,t_ as g,cB as h,Ra as i,uq as j,Fq as k,$n as l,Zh as m,gm as n,Jr as o,cq as p,he as q,qE as r,ha as s,lr as t,Ie as u,ba as v,ux as w,$u as x,Te as y,aE as z};
